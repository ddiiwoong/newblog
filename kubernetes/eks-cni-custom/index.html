<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Act as a catalyst RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Act as a catalyst Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="Act as a catalyst JSON Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-4ZT898XDT2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4ZT898XDT2"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-4ZT898XDT2",{anonymize_ip:!0})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Cloud Catalyst" href="/opensearch.xml">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4362752107119680" crossorigin="anonymous"></script><title data-rh="true">EKS CNI Custom Networking | Cloud Catalyst</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ddii.dev/kubernetes/eks-cni-custom/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="naver-site-verification" content="cbcc03783e5594725d3951f4e7f16ede80e69881"><meta data-rh="true" property="og:title" content="EKS CNI Custom Networking | Cloud Catalyst"><meta data-rh="true" name="description" content="Terraform null_resource를 활용하여 EKS CNI network를 구성하는 방법"><meta data-rh="true" property="og:description" content="Terraform null_resource를 활용하여 EKS CNI network를 구성하는 방법"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-12-16T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://www.linkedin.com/in/ddiiwoong/"><meta data-rh="true" property="article:tag" content="Kubernetes,EKS,CNI,Terraform"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ddii.dev/kubernetes/eks-cni-custom/"><link data-rh="true" rel="alternate" href="https://ddii.dev/kubernetes/eks-cni-custom/" hreflang="en"><link data-rh="true" rel="alternate" href="https://ddii.dev/kubernetes/eks-cni-custom/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://UTLA0DRN66-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.1e7a31ee.css">
<link rel="preload" href="/assets/js/runtime~main.e513b537.js" as="script">
<link rel="preload" href="/assets/js/main.da01ed83.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_ObN2"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-catalyst.svg" alt="Cloud Catalyst" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo-catalyst.svg" alt="Cloud Catalyst" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Cloud Catalyst</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Posts</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" docid="introduction" href="/docs/prometheus/introduction/">Docs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/prometheus/introduction/">Prometheus</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/tags/">Tags</a><a class="navbar__item navbar__link" href="/presentation/">Presentation</a><a class="navbar__item navbar__link" href="/archive/">Archive</a><a class="navbar__item navbar__link" href="/about/">About</a><a class="navbar__item navbar__link" href="/pang4u/">Pang4u</a><a href="https://github.com/ddiiwoong/newblog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_a9qW thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_uKok margin-bottom--md">Recent Posts</div><ul class="sidebarItemList_Kvuv"><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kubernetes/k6-prometheus/">prometheus grafana 스택으로 k6 테스트 결과 확인하기</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kubernetes/kyverno/">kyverno를 활용한 Kubernetes 정책 엔진 적용</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kubernetes/argo-rollout-advanced/">Advanced Argo Rollout</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kubernetes/kops-cilium/">kOps with Cilium</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kubernetes/kops-cloud9/">kOps with Cloud9</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_rzP5" itemprop="headline">EKS CNI Custom Networking</h1><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2022-12-16T00:00:00.000Z" itemprop="datePublished">December 16, 2022</time> · <!-- -->11 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://www.linkedin.com/in/ddiiwoong/" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://s.gravatar.com/avatar/e8bfebcbeacb5b9a0c90614e792febf2?s=80" alt="Jinwoong Kim"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://www.linkedin.com/in/ddiiwoong/" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Jinwoong Kim</span></a></div><small class="avatar__subtitle" itemprop="description">Technologist and Cloud Consultant</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="eks-cni-networking-제약사항">EKS CNI Networking 제약사항<a class="hash-link" href="#eks-cni-networking-제약사항" title="Direct link to heading">​</a></h2><p><a href="https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/cni-custom-network.html#custom-networking-automatically-apply-eniconfig" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/cni-custom-network.html#custom-networking-automatically-apply-eniconfig</a>  </p><p>AWS에는 기본 ENI가 포함된 서브넷에서 사용할 수 있는 IP개수는 제한되어 있다. 파드의 수 제한이 발생할 수 있기 때문에 secondary ENI에 다른 서브넷을 사용하여 가용 IP개수를 늘릴수 있다. 또한 보안상의 이유로 파드는 노드의 기본 네트워크 인터페이스와 다른 서브넷 또는 보안 그룹을 사용해야 할 수 있다.   </p><p>CNI Custom Networking이 활성화가 되면 파드는 다른 서브넷에 생성이 되고, 노드 서브넷의 아이피를 사용하지 않는다.</p><p>EKS에서 파드 대역을 분리 하기 위해서 CNI Custom Networking 설정을 진행한다. 해당 env 값을 변경하면 즉시 aws-node 가 교체된다.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl set env daemonset aws-node -n kube-system AWS_VPC_K8S_CNI_CUSTOM_NETWORK_CFG=true</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>파드를 배포하려는 각 서브넷에 대해서 아래와 같은 형식으로 ENIConfig 리소스를 생성해야 한다. 사용하려는 서브넷과 SG을 선언해야 기본적인 구성이 가능하다. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: crd.k8s.amazonaws.com/v1alpha1  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: ENIConfig  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name: &quot;ap-northeast-2a&quot;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subnet: &quot;${subnet_a}&quot;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">securityGroups:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- ${NODE_SG}  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: crd.k8s.amazonaws.com/v1alpha1  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: ENIConfig  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name: &quot;ap-northeast-2b&quot;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subnet: &quot;${subnet_c}&quot;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">securityGroups:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- ${NODE_SG}  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: crd.k8s.amazonaws.com/v1alpha1  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: ENIConfig  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name: &quot;ap-northeast-2c&quot;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subnet: &quot;${subnet_d}&quot;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">securityGroups:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- ${NODE_SG}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>aws-node</code> <code>DaemonSet</code>를 업데이트하여 클러스터에 생성된 모든 노드에 가용 영역의 <code>ENIConfig</code>를 자동으로 적용할 수 있다.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl set env daemonset aws-node -n kube-system ENI_CONFIG_LABEL_DEF=topology.kubernetes.io/zone</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>이때 몇가지 제약사항이 생기게 된다.</p><ul><li><p>해당 설정을 배포하고 난 이후 추가된 노드에 대해서만 새로운 서브넷 IP로 할당이 되기 때문에, 기존 노드를 재시작하거나 삭제를 해야 파드에 새로운 IP가 할당이 된다.</p></li><li><p>CNI Custom Networking 설정에서는 다중 서브넷을 할당할 수 없고 서브넷 별로 custom name으로 설정하고 모든 node 각각에 입력한 별도의 annotation을 추가해야한다. (<a href="https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/cni-custom-network.html#custom-networking-deploy-nodes" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/cni-custom-network.html#custom-networking-deploy-nodes</a>)</p></li><li><p>AWS의 인스턴스 타입별 ENI 개수 제한으로 Pod 생성이 불가능할 수 있으므로 Kubelet BootstrapArguments 파라미터를 launch template 에서 사전에 정의된 값으로 변경하여 노드가 생성되도록 한다.</p></li><li><p>MAX PODS = (Number of network interfaces × <!-- -->[the number of IP addresses per network interface – 1]<!-- -->) + 2</p></li><li><p><a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-eni.html#AvailableIpPerENI" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-eni.html#AvailableIpPerENI</a></p></li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">MIME-Version: 1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: multipart/mixed; boundary=&quot;==MYBOUNDARY==&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--==MYBOUNDARY==</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: text/x-shellscript; charset=&quot;us-ascii&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/eks/bootstrap.sh {Cluster Name} --use-max-pods false --kubelet-extra-args &#x27;--max-pods=110&#x27;--==MYBOUNDARY==--\</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>이러한 제약사항들을 처리하기 위해서 CNI Custom Networking 구현을 Terraform Pipeline으로 구현을 진행한다.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="terraform-으로-cni-구성하는-스크립트-실행">Terraform 으로 CNI 구성하는 스크립트 실행<a class="hash-link" href="#terraform-으로-cni-구성하는-스크립트-실행" title="Direct link to heading">​</a></h2><p>EKS를 프로비저닝 하는 Terraform 코드는 많이 공개되어 있기 때문에 이번 포스트에서는 생략하기로 하고 VPC Custom CNI를 구성하는 부분만 살펴보자.</p><p>기본적으로 VPC CNI를 배포하게 되면 aws-node 재시작이 되기 때문에 Workload NodeGroup이 구성되기 이전에 아래 스크립트를 <code>null_resource</code> 리소스를 사용하여 다음과 같은 순서로 Batch를 실행하도록 했다.</p><ul><li><p>kubectl 설치</p></li><li><p>AWS Authentication (Assume role)</p></li><li><p>kubeconfig update</p></li><li><p>VPC CNI Custom manifest (버전 v1.11.2) 적용 - <a href="https://github.com/aws/amazon-vpc-cni-k8s" target="_blank" rel="noopener noreferrer">https://github.com/aws/amazon-vpc-cni-k8s</a></p></li><li><p>기본 템플릿 : <a href="https://raw.githubusercontent.com/aws/amazon-vpc-cni-k8s/v1.11.2/config/master/aws-k8s-cni.yaml" target="_blank" rel="noopener noreferrer">https://raw.githubusercontent.com/aws/amazon-vpc-cni-k8s/v1.11.2/config/master/aws-k8s-cni.yaml</a></p></li><li><p><code>ENABLE_POD_ENI=true</code> : Security Group for Pods를 위한 구성으로 Node에 trunk ENI 추가를 하기 위한 <code>vpc.amazonaws.com/has-trunk-attached</code> 를 추가한다. </p><ul><li>Pod ENI를 활성화한 경우 Branch ENI를 생성하는 부분에서 ENI 생성 <a href="https://github.com/aws/amazon-vpc-resource-controller-k8s/blob/master/pkg/aws/vpc/limits.go" target="_blank" rel="noopener noreferrer">제약사항</a>이 발생할수 있다.</li></ul></li><li><p><code>DISABLE_TCP_EARLY_DEMUX=true</code> : <code>ENABLE_POD_ENI</code>가 true로 설정된 경우 kubelet이 TCP를 통해 포드 보안 그룹을 사용하는 포드에 연결하려면 <code>DISABLE_TCP_EARLY_DEMUX</code>를 initcontainers 컨테이너(amazon-k8s-cni-init)를 통해 true로 설정해야 한다.</p></li><li><p><code>AWS_VPC_K8S_CNI_CUSTOM_NETWORK_CFG=true</code> : worker 노드에서 파드가 별도의 서브넷 및 보안 그룹을 사용할 수 있다고 지정한다. IPAMD가 ENI 할당을 위해 worker 노드의 <code>ENIConfig</code>에서 지정한 보안 그룹과 VPC 서브넷을 사용하게 된다. </p></li><li><p><code>ENI_CONFIG_LABEL_DEF=topology.kubernetes.io/zone</code> - <code>ENIConfig</code>와 매칭되도록 노드에서 사용할 가용영역을 zone 별로 구성하는 label을 추가한다.</p><ul><li><code>ENIConfig</code> 라는 커스텀 리소스를 생성한다. 해당 설정은 파드용 IP대역을 위한 secondary ENI에 적용될 값으로 subnet id와 sg 값을 spec에 지정해야 한다. 아래 subnet과 sg id는 terraform에서 EKS클러스터가 프로비저닝 될때 결과를 env로 저장된 값을 가져오는 방식으로 처리 할수 있도록 하였다.</li><li><code>ENIConfig</code>를 사용할 가용 영역과 동일하게 <code>ENIConfig</code>의 name을 지정하는 것이 좋다. 만약 custom name으로 설정하게 되면 모든 node 각각에 입력한 별도의 annotation을 추가해야 한다. (<a href="https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/cni-custom-network.html#custom-networking-deploy-nodes" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/cni-custom-network.html#custom-networking-deploy-nodes</a>)</li></ul></li><li><p><code>ENABLE_PREFIX_DELEGATION=true</code> 파라미터를 사용하여 네트워크 인터페이스에 접두사를 할당하도록 VPC CNI 플러그인을 구성한다. </p></li><li><p><code>WARM_IP_TARGET=1</code>, <code>MINIMUM_IP_TARGET=30</code></p><ul><li>AWS VPC CNI에는 두 가지 구성 요소가 있다. CNI 플러그인 바이너리 (/opt/cni/bin/aws-cni)및 로컬IP 주소를 관리하는 <code>ipamd</code>는 aws-node라는 kubernetes daemonset 으로 실행되며 인스턴스에 연결된 모든 ENI 및 IP를 추적하는 모든 노드에 파드를 추가한다.</li><li>CNI 플러그인은 호스트 네트워크 연결과 올바른 네트워크 인터페이스를 파드의 네임스페이스에 추가하는 역할을 한다. CNI 플러그인은 원격 프로시저 호출(gRPC)을 통해 <code>IPAMD</code>와 통신한다.</li><li><code>WARM_IP_TARGET</code>은 ENI 전체를 Warm Pool로 가져가지 않고 특정 IP 개수만큼만 Warm Pool을 확보하겠다라는 설정이다. <code>WARM_IP_TARGET=1</code>로 설정되면 Pod이 생성될 때마다 Secondary IP를 1개씩 추가로 할당한다.</li><li>Pod의 생성과 종료가 빈번한 경우, 인스턴스에 IP를 Attach/Detach 하는 API call의 수가 늘어나 ENI를 추가하거나 IP를 추가하는 throttling을 방지하기 위해 <code>MINIMUM_IP_TARGET</code>을 함께 설정한다. 노드에 일반적으로 유지되는 Pod의 수를 <code>MINIMUM_IP_TARGET</code>으로 지정해 놓으면 해당 수만큼 ENI에 미리 IP가 할당된다. </li><li><code>WARM_PREFIX_TARGET=1</code> 는 위 설정을 적용하면 재정의 된다.</li></ul></li><li><p><code>AWS_VPC_K8S_CNI_EXTERNALSNAT=true</code> : 파드별 ENI에 할당된 IP주소를 제어할수 있도록 Node IP로 SNAT 되지않도록 설정하는 구성이다.</p></li><li><p><code>ENIConfig</code> 구성을 위해 Pod가 사용할 대역을 변수(<code>subnet_a</code>,<code>subnet_b</code>,<code>subnet_c</code>)로 받아 kubectl로 설정한다.</p></li></ul><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KUBE_CONFIG=&quot;$(mktemp)&quot;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws eks update-kubeconfig --name &quot;${CLUSTER_NAME}&quot; --kubeconfig &quot;${KUBE_CONFIG}&quot;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Apply VPC CNI manifests (origin: https://raw.githubusercontent.com/aws/amazon-vpc-cni-k8s/v1.11.2/config/master/aws-k8s-cni.yaml)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Security group for pod env configurations ; ENABLE_POD_ENI=true  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># https://github.com/aws/amazon-vpc-cni-k8s#disable_tcp_early_demux-v173 ; DISABLE_TCP_EARLY_DEMUX=true  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom networking ; AWS_VPC_K8S_CNI_CUSTOM_NETWORK_CFG=true  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom networking ; ENI_CONFIG_LABEL_DEF=topology.kubernetes.io/zone  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom networking ; WARM_IP_TARGET=1  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom networking ; MINIMUM_IP_TARGET=30  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom networking ; WARM_PREFIX_TARGET=1  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Fewer API calls required to EC2 control plane ; ENABLE_PREFIX_DELEGATION=true  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Source NAT disabled ; AWS_VPC_K8S_CNI_EXTERNALSNAT=true  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KUBE_CONFIG=&quot;$(mktemp)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws eks update-kubeconfig --name &quot;${CLUSTER_NAME}&quot; --kubeconfig &quot;${KUBE_CONFIG}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Apply VPC CNI manifests (origin: https://raw.githubusercontent.com/aws/amazon-vpc-cni-k8s/v1.11.2/config/master/aws-k8s-cni.yaml)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Security group for pod env configurations ; ENABLE_POD_ENI=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># https://github.com/aws/amazon-vpc-cni-k8s#disable_tcp_early_demux-v173 ; DISABLE_TCP_EARLY_DEMUX=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom networking ; AWS_VPC_K8S_CNI_CUSTOM_NETWORK_CFG=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom networking ; ENI_CONFIG_LABEL_DEF=topology.kubernetes.io/zone</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom networking ; WARM_IP_TARGET=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom networking ; MINIMUM_IP_TARGET=30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom networking ; WARM_PREFIX_TARGET=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Fewer API calls required to EC2 control plane ; ENABLE_PREFIX_DELEGATION=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Source NAT disabled ; AWS_VPC_K8S_CNI_EXTERNALSNAT=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --kubeconfig &quot;${KUBE_CONFIG}&quot; apply -f ./scripts/aws-k8s-cni.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># set up ENIConfig </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subnet_a=$(echo ${SUBNETS} |awk -F&quot;,&quot; &#x27;{print $1}&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subnet_b=$(echo ${SUBNETS} |awk -F&quot;,&quot; &#x27;{print $2}&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subnet_c=$(echo ${SUBNETS} |awk -F&quot;,&quot; &#x27;{print $3}&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl --kubeconfig &quot;${KUBE_CONFIG}&quot; apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: crd.k8s.amazonaws.com/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: ENIConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: &quot;ap-northeast-2a&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  subnet: &quot;${subnet_a}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  securityGroups:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - ${CLUSTER_SG}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl --kubeconfig &quot;${KUBE_CONFIG}&quot; apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: crd.k8s.amazonaws.com/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: ENIConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: &quot;ap-northeast-2b&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  subnet: &quot;${subnet_b}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  securityGroups:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - ${CLUSTER_SG}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl --kubeconfig &quot;${KUBE_CONFIG}&quot; apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: crd.k8s.amazonaws.com/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: ENIConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: &quot;ap-northeast-2c&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  subnet: &quot;${subnet_c}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  securityGroups:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - ${CLUSTER_SG}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># remobe creds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rm &quot;${KUBE_CONFIG}&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>다음은 위 스크립트를 실행하는 테라폼 코드의 예시이다.</p><ul><li>기본적으로 null_resource를 사용한다. <ul><li><a href="https://registry.terraform.io/providers/hashicorp/null/latest/docs/resources/resource" target="_blank" rel="noopener noreferrer">https://registry.terraform.io/providers/hashicorp/null/latest/docs/resources/resource</a></li></ul></li><li>위에서 작성한 스크립트를 network.sh 에서 환경변수를 받아서 실행할 수 있도록 구성한다. </li><li>eks 모듈의 의존성을 걸어 eks 클러스터 배포가 완료된 이후에 해당 스크립트가 동작하도록 한다. </li></ul><div class="codeBlockContainer_I0IT language-terraform theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-terraform codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain"># Configure CNI custom network</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">resource &quot;null_resource&quot; &quot;cni_patch&quot; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  triggers = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cluster_name  = local.cluster_name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cluster_sg    = module.eks.cluster_primary_security_group_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    intra_subnets = join(&quot;,&quot;, module.vpc.intra_subnets)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    content       = file(&quot;${path.module}/scripts/network.sh&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  provisioner &quot;local-exec&quot; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    environment = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      CLUSTER_NAME = self.triggers.cluster_name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      CLUSTER_SG   = self.triggers.cluster_sg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      SUBNETS      = self.triggers.intra_subnets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    command     = &quot;${path.cwd}/scripts/network.sh&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    interpreter = [&quot;bash&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  depends_on = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    module.eks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="정리">정리<a class="hash-link" href="#정리" title="Direct link to heading">​</a></h2><p>초반에 언급한 EKS CNI Custom Networking 제약사항을 처리하고 null_resource로 EKS CNI를 배포할 때 원하는 형태로 수정하여 <code>aws_node</code> 재기동 없이 배포하는 방법을 작성해봤다. </p><p>샘플 코드는 아래 저장소에서 확인할 수 있다.
<a href="https://github.com/jinwoongk/eks-cni-custom" target="_blank" rel="noopener noreferrer">https://github.com/jinwoongk/eks-cni-custom</a></p><blockquote><p>해당 포스팅은 현재 재직중인 회사에 관련이 없고, 개인 역량 개발을 위한 자료로 활용할 예정입니다.</p></blockquote></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_h6_j"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/kubernetes/">Kubernetes</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/eks/">EKS</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/cni/">CNI</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/terraform/">Terraform</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/ddiiwoong/newblog/tree/main/blog/2022-12-16-eks-cni-custom.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><div></div><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/kubernetes/kops-cloud9/"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">kOps with Cloud9</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/kubernetes/eks-anywhere-adv/"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">EKS Anywhere Advanced Usages</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_cNA8 thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#eks-cni-networking-제약사항" class="table-of-contents__link toc-highlight">EKS CNI Networking 제약사항</a></li><li><a href="#terraform-으로-cni-구성하는-스크립트-실행" class="table-of-contents__link toc-highlight">Terraform 으로 CNI 구성하는 스크립트 실행</a></li><li><a href="#정리" class="table-of-contents__link toc-highlight">정리</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">Home</a></li><li class="footer__item"><a class="footer__link-item" href="/archive/">Archive</a></li><li class="footer__item"><a class="footer__link-item" href="/tags/">Tags</a></li></ul></div><div class="col footer__col"><div class="footer__title">Sponsors</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/pang4u/">Pang4U</a></li><li class="footer__item"><a href="https://ko-fi.com/ddiiwoong" target="_blank" rel="noopener noreferrer" class="footer__link-item">Buy Me a Coffee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/ddiiwoong" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/ddiiwoong" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/ddiiwoong" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://kr.linkedin.com/in/ddiiwoong" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
<script src="/assets/js/runtime~main.e513b537.js"></script>
<script src="/assets/js/main.da01ed83.js"></script>
</body>
</html>