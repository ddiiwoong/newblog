<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Act as a catalyst RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Act as a catalyst Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="Act as a catalyst JSON Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-4ZT898XDT2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4ZT898XDT2"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-4ZT898XDT2",{anonymize_ip:!0})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Cloud Catalyst" href="/opensearch.xml">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4362752107119680" crossorigin="anonymous"></script><title data-rh="true">vSphere with Tanzu homelab running on ASUS PN50 (2/2) | Cloud Catalyst</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ddii.dev/kubernetes/vSphere-with-Tanzu-homelab-2/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="naver-site-verification" content="cbcc03783e5594725d3951f4e7f16ede80e69881"><meta data-rh="true" property="og:title" content="vSphere with Tanzu homelab running on ASUS PN50 (2/2) | Cloud Catalyst"><meta data-rh="true" name="description" content="이번 포스트에서는 Tanzu Cluster를 단일 홈랩 vSphere 서버에 올려본다"><meta data-rh="true" property="og:description" content="이번 포스트에서는 Tanzu Cluster를 단일 홈랩 vSphere 서버에 올려본다"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2020-12-06T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="Kubernetes,Tanzu,vSphere,Homelab,ASUS,PN50"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ddii.dev/kubernetes/vSphere-with-Tanzu-homelab-2/"><link data-rh="true" rel="alternate" href="https://ddii.dev/kubernetes/vSphere-with-Tanzu-homelab-2/" hreflang="en"><link data-rh="true" rel="alternate" href="https://ddii.dev/kubernetes/vSphere-with-Tanzu-homelab-2/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://UTLA0DRN66-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.1e7a31ee.css">
<link rel="preload" href="/assets/js/runtime~main.9db69a56.js" as="script">
<link rel="preload" href="/assets/js/main.6585914c.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_ObN2"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-catalyst.svg" alt="Cloud Catalyst" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo-catalyst.svg" alt="Cloud Catalyst" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Cloud Catalyst</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Posts</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" docid="introduction" href="/docs/prometheus/introduction/">Docs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/prometheus/introduction/">Prometheus</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/tags/">Tags</a><a class="navbar__item navbar__link" href="/presentation/">Presentation</a><a class="navbar__item navbar__link" href="/archive/">Archive</a><a class="navbar__item navbar__link" href="/about/">About</a><a class="navbar__item navbar__link" href="/pang4u/">Pang4u</a><a href="https://github.com/ddiiwoong/newblog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_a9qW thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_uKok margin-bottom--md">Recent Posts</div><ul class="sidebarItemList_Kvuv"><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kubernetes/k6-prometheus/">prometheus grafana 스택으로 k6 테스트 결과 확인하기</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kubernetes/argo-rollout-advanced/">Advanced Argo Rollout</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kubernetes/kops-cilium/">kOps with Cilium</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kubernetes/kops-cloud9/">kOps with Cloud9</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kubernetes/eks-cni-custom/">EKS CNI Custom Networking</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_rzP5" itemprop="headline">vSphere with Tanzu homelab running on ASUS PN50 (2/2)</h1><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2020-12-06T00:00:00.000Z" itemprop="datePublished">December 6, 2020</time> · <!-- -->18 min read</div></header><div id="post-content" class="markdown" itemprop="articleBody"><p>지난글에 이어 이번에는 네트워크 구성하는 방법과 vSphere Cluster에 추가적인 Kubernetes 클러스터를 배포하는 것에 대해 이야기 하고자 한다. 이번 글도 지난글과 동일하게 <a href="https://www.virtuallyghetto.com/" target="_blank" rel="noopener noreferrer">virtuallyGhetto</a> 블로그 포스팅을 참고하여 그대로 진행한 내용이라고 보면 된다.</p><p><a href="https://www.virtuallyghetto.com/2020/11/complete-vsphere-with-tanzu-homelab-with-just-32gb-of-memory.html" target="_blank" rel="noopener noreferrer">https://www.virtuallyghetto.com/2020/11/complete-vsphere-with-tanzu-homelab-with-just-32gb-of-memory.html</a></p><p>지난 포스팅은 다음 링크에서 확인할 수 있다.</p><blockquote><p>이전글 - <a href="https://ddii.dev/kubernetes/vSphere-with-Tanzu-homelab/" target="_blank" rel="noopener noreferrer">vSphere with Tanzu homelab running on ASUS PN50 (1/2)</a></p></blockquote><p><img loading="lazy" alt="vcsa" src="/assets/images/vcsa-21b40b1ba6ed8f23180bd647230b492b.png" width="1143" height="625" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="vdsvsphere-distributed-switch-구성">VDS(vSphere Distributed Switch) 구성<a class="hash-link" href="#vdsvsphere-distributed-switch-구성" title="Direct link to heading">​</a></h2><p>이번 구성의 경우에는 usb nic를 하나만을 사용해서 진행하기 때문에 위에서 설정했던 3개의 네트워크(Management, Frontend, Workload)로 분리하기 위해 VDS를 신규로 생성하고 기존 네트워크 어댑터를 변경하는 작업을 수행해야 한다.  </p><p>먼저 신규 구성한 vCenter UI(<a href="https://vcsa.tanzu.local/ui" target="_blank" rel="noopener noreferrer">https://vcsa.tanzu.local/ui</a>)로 접속해 <code>Networking</code> 메뉴로 이동해서 <code>VDS</code> 메뉴 우클릭 후 <code>Add and Manage Hosts</code>를 선택한다. </p><p><img loading="lazy" alt="network" src="/assets/images/vcsa_network_menu-7d5081225e5a1d27d8ffc03e95c166cf.png" width="911" height="451" class="img_E7b_"></p><p>VDS 설정하는 6단계를 진행한다. </p><ul><li>1단계 -  <code>Add hosts</code>를 선택한다.</li><li>2단계 - ESXi host를 선택한다. </li><li>3단계 - pyhysical adapter를 생성한 후에 선택하게 되는데 구성한 랩에서는 USB TYPE NIC를 사용하여 <code>vusb0</code> 어댑터를 선택하고 <code>Assign uplink</code>에서 <code>dvUplink1</code>를 Assign한다.</li><li>4단계 - VMkernel adapter에서 vmk0을 선택하고 <code>Assign port group</code>에서 Network를 Management를 Assign한다.</li><li>5단계 - VM Migration은 생략한다.</li><li>6단계 - 설정되는 내용을 확인하고 Finish를 하게 되면 기존 VCSA의 기본 네트워크가 <code>vSwitch</code>에서 <code>VDS</code>로 변경되었기 때문에 VSCA Client 접속이 끊어지게 된다. </li></ul><p>다시 ESXi Client로 접속해서 VCSA Port Group(네트워크)을 아래와 같이 기존 <code>VM Network</code>에서 <code>Management</code>로 변경하면 다시 VSCA Client로 접속이 가능하게 된다.</p><p><img loading="lazy" alt="network_adapter" src="/assets/images/vcsa_network-8a0d605b125e949f2ff5adf466e9867c.png" width="720" height="502" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="routervm의-network-port-group-추가frontend-workload">RouterVM의 Network Port Group 추가(Frontend, Workload)<a class="hash-link" href="#routervm의-network-port-group-추가frontend-workload" title="Direct link to heading">​</a></h2><p>이전 포스팅에서 생성한 Router VM은 구성할 내부 네트워크(10.10.0.0/24 &amp; 10.20.0.0/24)로의 라우팅과 외부 네트워크로 NAT 및 포워딩을 위해서 필요하기 때문에 vSphere 또는 VCSA Client에서 <code>router.tanzu.local</code>의 네트워크 어댑터를 <code>Frontend</code>, <code>Workload</code>로 추가하는 작업이 필요하다.</p><p><img loading="lazy" alt="routervm" src="/assets/images/routervm-0ec21646dbb1c8a57fee486e93e78920.png" width="723" height="502" class="img_E7b_"></p><p>구성을 완료한 후에 간단한 네트워크 구성을 보면 다음과 같다.  </p><p><img loading="lazy" alt="vswitch" src="/assets/images/vswitch-cd0a014db46be6a31193bca2c2a153cd.png" width="789" height="604" class="img_E7b_"></p><p>물리 인터페이스 <code>vusb0</code> 아래 가상 스위치가 3개 구성되어 있고 외부에서도 RouterVM을 통해 접속이 가능하도록 접속하는 로컬 머신에서 라우팅 경로 추가가 필요하다.</p><ul><li><p>Windows<br>
<code>route print</code> 명령으로 인터페이스 ID를 먼저 확인하고 아래와 같이 설정한다.</p><div class="codeBlockContainer_I0IT language-powershell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-powershell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">route ADD 10.10.0.0 MASK 255.255.255.0 192.168.0.201 METRIC 3 IF 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">route ADD 10.20.0.0 MASK 255.255.255.0 192.168.0.201 METRIC 3 IF 5</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li><li><p>MacOS</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">sudo route -n add -net 10.10.0.0/24 192.168.0.201</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo route -n add -net 10.20.0.0/24 192.168.0.201</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li><li><p>WSL</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">sudo route -n add -net 10.10.0.0/24 gw &lt;Gateway IP&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo route -n add -net 10.20.0.0/24 gw &lt;Gateway IP&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="haproxyvm-설정">HAProxyVM 설정<a class="hash-link" href="#haproxyvm-설정" title="Direct link to heading">​</a></h2><p>이전 포스팅에서 생성한 HAProxy도 추가된 네트워크 환경으로 설정을 하기 위해 다음 스크립트를 사용한다.   </p><ul><li><a href="https://github.com/lamw/vsphere-with-tanzu-homelab-scripts/blob/master/deploy_3nic_haproxy.ps1" target="_blank" rel="noopener noreferrer">https://github.com/lamw/vsphere-with-tanzu-homelab-scripts/blob/master/deploy_3nic_haproxy.ps1</a></li></ul><p>구성한 환경에 맞게 스크립트내 변수들을 수정한 후 실행한다.</p><div class="codeBlockContainer_I0IT language-powershell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-powershell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyOVA = &quot;C:\esxi\vmware-haproxy-v0.1.8.ova&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$Cluster = &quot;Tanzu-Cluster&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$VMHost = &quot;esxi-01.tanzu.local&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$Datastore = &quot;datastore1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyDisplayName = &quot;haproxy.tanzu.local&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyHostname = &quot;haproxy.tanzu.local&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyDNS = &quot;192.168.0.201&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyManagementNetwork = &quot;Management&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyManagementIPAddress = &quot;192.168.0.203/24&quot; # Format is IP Address/CIDR Prefix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyManagementGateway = &quot;192.168.0.1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyFrontendNetwork = &quot;Frontend&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyFrontendIPAddress = &quot;10.10.0.2/24&quot; # Format is IP Address/CIDR Prefix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyFrontendGateway = &quot;10.10.0.1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyWorkloadNetwork = &quot;Workload&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyWorkloadIPAddress = &quot;10.20.0.2/24&quot; # Format is IP Address/CIDR Prefix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyWorkloadGateway = &quot;10.20.0.1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyLoadBalanceIPRange = &quot;10.10.0.64/26&quot; # Format is Network CIDR Notation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyOSPassword = &quot;VMware1!&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyPort = &quot;5556&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyUsername = &quot;wcp&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyPassword = &quot;VMware1!&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-powershell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-powershell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">./deploy_3nic_haproxy.ps1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>이후 HAProxy VM내에서 여러 인터페이스에서 <code>Reverse Path Filtering</code>을 <code>Disable</code>하기 위해 다음 스크립트를 실행한다. </p><p>*<a href="https://github.com/lamw/vsphere-with-tanzu-homelab-scripts/blob/master/setup_haproxy.sh" target="_blank" rel="noopener noreferrer">setup_haproxy.sh</a>  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">touch /etc/sysctl.d/999-tanzu.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod +x /etc/sysctl.d/999-tanzu.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IFS=$&#x27;\n&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for i in $(sysctl -a | grep rp_filter | grep 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SYSCTL_SETTING=$(echo ${i} | awk &#x27;{print $1}&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Update live system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sysctl -w ${SYSCTL_SETTING}=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Persist settings upon reboot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;${SYSCTL_SETTING}=0&quot; &gt;&gt; /etc/sysctl.d/999-tanzu.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><blockquote><p><code>Reverse Path Filtering</code>는 기본적으로 하나의 인스턴스에서 여러개의 인터페이스로 들어오는 패킷의 소스IP에 대해서 라우팅 테이블을 확인한 후 패킷이 들어온 동일한 인터페이스로 다시 나가는지 확인하는 것을 말한다. <code>rp_filter</code>가 1로 설정이 되어있으면, 특정 인터페이스로 들어온 패킷 정보와 OS의 FIB(Forward Information Base)에 정의된 정보와 일치하지 않을경우, 들어온 패킷을 버리는 기능을 하기 때문에 위 스크립트를 통해 rp_filter 값을 모두 0으로 변경하는 것이다. 자세한 내용은 <a href="https://access.redhat.com/solutions/53031" target="_blank" rel="noopener noreferrer">https://access.redhat.com/solutions/53031</a>를 참고하자.</p></blockquote><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="content-library-구성">Content Library 구성<a class="hash-link" href="#content-library-구성" title="Direct link to heading">​</a></h2><p><code>Content Library</code>는 레포지토리의 개념으로 여러 vApp 템플릿과 ISO 이미지 등과 같은 파일들과 컨테이너 개체를 저장하고 관리할 수 있는 도구이다. 레지스트리(Registry)와 유사하지만 <code>Content Library</code>에는 VM templates, OVA, OVF 파일 등이 저장된다.  </p><p><code>Menu</code> -&gt; <code>Content Libraries</code>로 이동해서 새로운 라이브러리를 추가를 한다. 이름과 vCenter Server를 선택하고 2번째 단계에서 Subscribed content library를 선택하고 <code>Subscription URL</code>에 <a href="https://wp-content.vmware.com/v2/latest/lib.json" target="_blank" rel="noopener noreferrer">https://wp-content.vmware.com/v2/latest/lib.json</a> 를 입력하고 3번째 단계에서 저장될 데이터스토어를 선택하면 된다.  </p><p>실제 위 URL은 <code>OVF Template</code> 여러개를 다운받는데 Tanzu Cluster내에서 Master와 Worker Node들로 쓰일 Kubernetes 1.16 ~ 1.18까지 여러개의 VM이미지 (photon OS)들이 추가가 되는것을 알 수 있다. 아래 그림을 보면 현재 Tanzu에서 사용되는 Kubernetes 클러스터 버전이 1.18.5라는 것을 알 수 있다.</p><p><img loading="lazy" alt="tkg" src="/assets/images/content_tkg-375173ad9665d2e90a26db7433cc49d4.png" width="1259" height="692" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="workload-management-구성">Workload Management 구성<a class="hash-link" href="#workload-management-구성" title="Direct link to heading">​</a></h2><p>Workload Management란 쉽게 생각하면 vSphere 기반에서 Kubernetes 클러스트를 프로비저닝하는 역할을 하는 도구라 보면 된다.  </p><p>Workload Management는 다음과 같은 역할을 한다.  </p><ul><li>Kubernetes 클러스터의 컴퓨팅, 스토리지 리소스에 대한 사이징 및 네임스페이스 관리</li><li>Kubernetes 클러스터의 네트워크 및 DNS, NTP 및 VDS같은 네트워크 관리</li><li>Kubernetes 클러스터 상세 정보 (Node 개수 및 상태 정보)</li></ul><p>Workload Management에서 클러스터 생성을 스크립트로 진행하기 전에 PowerCLI를 통해 접속 테스트를 한다. </p><div class="codeBlockContainer_I0IT language-powershell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-powershell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Connect-VIServer -Server vcsa.tanzu.local -User administrator@vsphere.local -Password VMware1!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connect-CisServer -Server vcsa.tanzu.local -User administrator@vsphere.local -Password VMware1!</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>그리고 PowerCLI Workload Management 모듈을 설치하고 여러 환경변수들을 설정한다. 기존에 사용한 정보들과 위에서 만든 Content Library 이름으로 변경하고 실행한다.  </p><div class="codeBlockContainer_I0IT language-powershell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-powershell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Import-Module VMware.WorkloadManagement</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$vSphereWithTanzuParams = @{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ClusterName = &quot;Tanzu-Cluster&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TanzuvCenterServer = &quot;vcsa.tanzu.local&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TanzuvCenterServerUsername = &quot;administrator@vsphere.local&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TanzuvCenterServerPassword = &quot;VMware1!&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TanzuContentLibrary = &quot;TKG&quot;; # Content Library 이름</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ControlPlaneSize = &quot;TINY&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MgmtNetwork = &quot;Management&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MgmtNetworkStartIP = &quot;192.168.0.220&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MgmtNetworkSubnet = &quot;255.255.255.0&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MgmtNetworkGateway = &quot;192.168.0.1&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MgmtNetworkDNS = @(&quot;192.168.0.201&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MgmtNetworkDNSDomain = &quot;tanzu.local&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MgmtNetworkNTP = @(&quot;162.159.200.123&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WorkloadNetwork = &quot;Workload&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WorkloadNetworkStartIP = &quot;10.20.0.10&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WorkloadNetworkIPCount = 20;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WorkloadNetworkSubnet = &quot;255.255.255.0&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WorkloadNetworkGateway = &quot;10.20.0.1&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WorkloadNetworkDNS = @(&quot;192.168.0.201&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WorkloadNetworkServiceCIDR = &quot;10.96.0.0/24&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    StoragePolicyName = &quot;Tanzu-Storage-Policy&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HAProxyVMvCenterServer = &quot;vcsa.tanzu.local&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HAProxyVMvCenterUsername = &quot;administrator@vsphere.local&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HAProxyVMvCenterPassword = &quot;VMware1!&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HAProxyVMName = &quot;haproxy.tanzu.local&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HAProxyIPAddress = &quot;192.168.0.203&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HAProxyRootPassword = &quot;VMware1!&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HAProxyPassword = &quot;VMware1!&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LoadBalancerStartIP = &quot;10.10.0.64&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LoadBalancerIPCount = 64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">New-WorkloadManagement2 @vSphereWithTanzuParams</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>클러스터를 생성하는 시간은 약 40분 이상 소요되는데 Tanzu-Cluster의 Control Plane Node (Master Node) 생성이 완료되면 IP가 10.10.0.64(HAProxy Load Balancer에서 할당된 첫번째 주소)로 할당이 되는 것을 확인할 수 있다.  </p><p>다음은 Namespace를 생성하는 과정을 진행한다. <code>Workload Management</code>에서 <code>NEW NAMESPACE</code>메뉴를 클릭하고 위에서 생성한 <code>Tanzu-Cluster</code>를 선택하고 이름(test)을 입력하고 Namespace를 생성한다. </p><p><img loading="lazy" alt="tkg_permission" src="/assets/images/tkg_permission-9ef770e7197c1de2636adb2d065b4f58.png" width="568" height="367" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="cluster-접속--kubernetes-cli">Cluster 접속  (Kubernetes CLI)<a class="hash-link" href="#cluster-접속--kubernetes-cli" title="Direct link to heading">​</a></h2><p>생성된걸 확인한 후 브라우저에 해당 클러스터의 Control Plane IP (<a href="https://10.10.0.64)%EB%A1%9C" target="_blank" rel="noopener noreferrer">https://10.10.0.64)로</a> 접속하면 OS별(Linux, MacOS, Windows)로 CLI 플러그인을 설치할 수 있다.  </p><p>설치 및 PATH 설정을 진행하고 아래와 같이 Control Plane으로 CLI 로그인을 하면 현재 설정된 Context 확인이 가능하다. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl vsphere login --server=10.10.0.64 -u administrator@vsphere.local --insecure-skip-tls-verify</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        🥳vSphere with Tanzu Basic Cluster enabled by William Lam&#x27;s Script 🥳</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Password:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Logged in successfully.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">You have access to the following contexts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   10.10.0.64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   docker-desktop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   nexclipper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If the context you wish to use is not in this list, you may need to try</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logging in again later, or contact your cluster administrator.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To change context, use `kubectl config use-context &lt;workload name&gt;`</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl config use-context nexclipper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Switched to context &quot;nexclipper&quot;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl get nodes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                               STATUS   ROLES    AGE     VERSION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">422f46864113e3de3361943d14073728   Ready    master   4d21h   v1.18.2-6+38ac483e736488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">422faddc15554b09d82907c0dfb57752   Ready    master   4d21h   v1.18.2-6+38ac483e736488</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>nexclipper namespace로 context를 전환하고 node를 확인하면 master node를 2개 확인할 수 있는데 이는 <code>nexclipper</code>라는 네임스페이스를 총괄하는 Super Master(Control Plane) 같은 개념이라고 볼 수 있다. 처음에 클러스터 배포전에 Namespace 리소스를 만들길래 다소 헷갈리긴 했지만 Tanzu에서의 Namespace는 기존 쿠버네티스의 리소스를 논리적으로 나누는 컨셉이 아닌, 정해진 리소스와 유저와 그룹의 권한을 먼저 Namespace로 할당하고 그담에 다시 조직이나 어플리케이션 별로 Kubernetes Workload를 다시 제공하는 컨셉이라고 보면된다.  </p><p>최근에 <code>SKT</code>나 <code>Kakao Enterprise</code> 처럼 쿠버네티스 클러스터의 라이프사이클을 쿠버네티스로 관리하는 컨셉으로 이해하면 좋다. 아래 그림을 참고하면 쉽게 이해할 수 있을 것이다.  </p><p><img loading="lazy" src="https://docs.vmware.com/en/VMware-vSphere/7.0/vmware-vsphere-with-tanzu/img/GUID-DF8905E1-C098-4882-BFC1-B0BAC668B424-high.png" alt="tanzu" class="img_E7b_"><br>
<!-- -->참조 : <a href="https://docs.vmware.com/en/VMware-vSphere/7.0/vmware-vsphere-with-tanzu/img/GUID-DF8905E1-C098-4882-BFC1-B0BAC668B424-high.png" target="_blank" rel="noopener noreferrer">https://docs.vmware.com/en/VMware-vSphere/7.0/vmware-vsphere-with-tanzu/img/GUID-DF8905E1-C098-4882-BFC1-B0BAC668B424-high.png</a></p><p>TanzuKubernetesCluster CRD를 통해 클러스터를 신규로 생성한다.<br>
<code>namespace: nexclipper</code>로 설정하고 원하는 배포 버전과 이름, CNI, Control Plane, Worker Node 개수 등을 기재하게 되는데 특이한 것은 CNI는 <a href="https://github.com/vmware-tanzu/antrea" target="_blank" rel="noopener noreferrer">Antrea</a>를 사용하는것을 확인할 수 있다.  </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> run.tanzu.vmware.com/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> TanzuKubernetesCluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nexclipper</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nexclipper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">distribution</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1.17.8+vmware.1</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">tkg.1.5417466</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">settings</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">network</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">cni</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> antrea</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">pods</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">cidrBlocks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 193.0.2.0/16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">serviceDomain</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> managedcluster.local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">cidrBlocks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 195.51.100.0/12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">topology</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">controlPlane</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">class</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> best</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">effort</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xsmall</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">count</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">storageClass</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tanzu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">storage</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">policy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">workers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">class</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> best</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">effort</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xsmall</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">count</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">storageClass</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tanzu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">storage</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">policy</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>신규 TKG 클러스터를 배포한다. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl apply -f tkc.yaml  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tanzukubernetescluster.run.tanzu.vmware.com/nexclipper-cluster created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>배포하고 tanzukubernetescluster 를 조회해보면 Control Plane 1개, Worker Node 1개의  v1.17.8 버전의 클러스터가 배포된것을 알 수 있다. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl get tanzukubernetescluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                 CONTROL PLANE   WORKER   DISTRIBUTION                     AGE   PHASE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nexclipper-cluster   1               1        v1.17.8+vmware.1-tkg.1.5417466   33m   running</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>생성한 tanzukubernetescluster로 접속하여 클러스터 정보를 확인한다.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl-vsphere login --server=10.10.0.64 -u administrator@vsphere.local --insecure-skip-tls-verify --tanzu-kubernetes-cluster-name nexclipper-cluster --tanzu-kubernetes-cluster-namespace nexclipper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl config use-context nexclipper-cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Switched to context &quot;nexclipper-cluster&quot;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl get nodes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                                STATUS   ROLES    AGE     VERSION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nexclipper-cluster-control-plane-95nhv              Ready    master   3h10m   v1.17.8+vmware.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nexclipper-cluster-workers-kp68q-78df45db5c-jzmmv   Ready    &lt;none&gt;   3h6m    v1.17.8+vmware.1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>생성한 클러스터에 간단한 앱을 배포한다.<br>
<a href="https://github.com/storax/kubedoom" target="_blank" rel="noopener noreferrer">Kubedoom</a>은 Doom 게임내에서 애플리케이션(괴물)을 일부러 종료시켜 복원성을 보게하는 재미있는 앱이다.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; git clone https://github.com/storax/kubedoom.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; cd kubedoom</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl apply -f manifest/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl -n kubedoom port-forward deployment/kubedoom 5900:5900</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Forwarding from 127.0.0.1:5900 -&gt; 5900</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Forwarding from [::1]:5900 -&gt; 5900</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>배포한후에 포트포워딩을 한 앱으로 VNC viewer로 접속하면 재미있는 화면을 볼 수 있을 것이다. VNC 패스워드는 <code>idbehold</code>이다.</p><p><img loading="lazy" alt="doom" src="/assets/images/doom-05a849f186a914571aa3c73ce8d9070c.png" width="642" height="512" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="tanzu-장단점-개인의견">Tanzu 장단점 (개인의견)<a class="hash-link" href="#tanzu-장단점-개인의견" title="Direct link to heading">​</a></h2><p>하드웨서 고민, 구매, ESXi 설치, vCenter, TKG을 설치하고 아키텍처들을 찾아보면서 몇가지 장단점이 눈에 보였는데 가장 큰 장점은 하나의 네임스페이스를 만들어 Super Master(Control Plane)를 먼저 구성하고 자원(컴퓨팅, 네트워크, 스토리지 등)과 기존에 보유하고 있는 권한 체계로 할당을 한 뒤 필요할때 마다 특정 팀이나 조직에게 별도의 클러스터를 할당하는 아키텍처를 추구하고 있어 VMware 환경에서 Kubernetes를 신규 도입하고 엔터프라이즈에 적용하기 용이하다는 점이다.  </p><p>또한 기본적으로 갖춰야 하는 Security Policy나 리소스 할당이 클러스터 구축이후에 되는 것이 아니라 이미 정의된 규칙으로 클러스터 구성이 이후에 진행되기 때문에 관리적인 측면에서도 장점이 있다고 볼 수 있다. </p><p>하지만 개인적으로 생각하는 단점들도 몇가지 있는데 첫번째는 용어의 중복으로 인한 혼동이 있었다는점이다. 네임스페이스나 기존 쿠버네티스에서 많이 사용되는 용어보다는 VMware에서 만든 CRD등을 미리 학습하거나 알고 있지 않으면 기존 경험이 있는 유저도 접근성이 떨어질 것 같다는 생각이 들었다. </p><p>비용 측면에서는 일단 <code>vCenter</code> 이외에 <code>Workload Management</code> 라이센스가 별도로 필요하기 때문에 자세히 알아보진 않았지만 적지 않은 비용이 들 것으로 예상된다. 게다가 많은 구성요소로 인한 자원이 소요가 있어 하나의 작은 클러스터만 띄웠음에도 64GB 머신의 메모리 사용량이 거의 60GB에 육박했기 때문에 기존 인프라 비용에 추가적인 비용에 대한 고려가 반드시 필요할 것 같다. </p><p>위에도 언급했지만 러닝커브에 대한 부분도 문제점이 될 수 있을것이다. NSX기반의 새로운 CNI뿐만 아니라 기존 VMware 운영을 하던 DevOps팀이나 인프라 운영조직의 러닝커브, 추상화 레벨이 높아져서 내가 원하는 클러스터의 이벤트나 로그를 확인할 때 탐색적으로 메뉴를 찾기가 쉽지 않은 부분들이 있었다. 그래서 트러블슈팅 때에도 로그의 원천을 찾는데 시간이 다소 걸리기도 했다. </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="정리">정리<a class="hash-link" href="#정리" title="Direct link to heading">​</a></h2><p>한 일주일동안 스토리지 오류로 씨름하다가 겨우 앱을 배포했지만 거의 2주동안 재미있게 구성해볼수 있었다. 솔직히 이야기하자면 개인 클러스터로 구성하는데는 추천하지 않지만 Tanzu를 공부하고 운영해야 하는 경우나 자격증을 취득하는 부분이 필요하다면 한번쯤은 해볼 가치가 있다고 생각한다.  </p><p>거의 1년만에 포스팅을 작성했는데 다음 포스팅에는 Security Policy 관련한 테스트를 진행하면서 연말을 정리해볼 생각이다.</p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_h6_j"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/kubernetes/">Kubernetes</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/tanzu/">Tanzu</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/v-sphere/">vSphere</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/homelab/">Homelab</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/asus/">ASUS</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/pn-50/">PN50</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/ddiiwoong/newblog/tree/main/blog/2020-12-06-vSphere-with-Tanzu-homelab-2.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><div></div><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/prometheus/synology-prometheus/"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Synology monitoring with Prometheus and snmp exporter</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/kubernetes/vSphere-with-Tanzu-homelab/"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">vSphere with Tanzu homelab running on ASUS PN50 (1/2)</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_cNA8 thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#vdsvsphere-distributed-switch-구성" class="table-of-contents__link toc-highlight">VDS(vSphere Distributed Switch) 구성</a></li><li><a href="#routervm의-network-port-group-추가frontend-workload" class="table-of-contents__link toc-highlight">RouterVM의 Network Port Group 추가(Frontend, Workload)</a></li><li><a href="#haproxyvm-설정" class="table-of-contents__link toc-highlight">HAProxyVM 설정</a></li><li><a href="#content-library-구성" class="table-of-contents__link toc-highlight">Content Library 구성</a></li><li><a href="#workload-management-구성" class="table-of-contents__link toc-highlight">Workload Management 구성</a></li><li><a href="#cluster-접속--kubernetes-cli" class="table-of-contents__link toc-highlight">Cluster 접속  (Kubernetes CLI)</a></li><li><a href="#tanzu-장단점-개인의견" class="table-of-contents__link toc-highlight">Tanzu 장단점 (개인의견)</a></li><li><a href="#정리" class="table-of-contents__link toc-highlight">정리</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">Home</a></li><li class="footer__item"><a class="footer__link-item" href="/archive/">Archive</a></li><li class="footer__item"><a class="footer__link-item" href="/tags/">Tags</a></li></ul></div><div class="col footer__col"><div class="footer__title">Sponsors</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/pang4u/">Pang4U</a></li><li class="footer__item"><a href="https://ko-fi.com/ddiiwoong" target="_blank" rel="noopener noreferrer" class="footer__link-item">Buy Me a Coffee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/ddiiwoong" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/ddiiwoong" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/ddiiwoong" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://kr.linkedin.com/in/ddiiwoong" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
<script src="/assets/js/runtime~main.9db69a56.js"></script>
<script src="/assets/js/main.6585914c.js"></script>
</body>
</html>