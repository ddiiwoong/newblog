<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Act as a catalyst RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Act as a catalyst Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="Act as a catalyst JSON Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-4ZT898XDT2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4ZT898XDT2"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-4ZT898XDT2",{anonymize_ip:!0})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Cloud Catalyst" href="/opensearch.xml">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4362752107119680" crossorigin="anonymous"></script><title data-rh="true">One post tagged with &quot;network policy&quot; | Cloud Catalyst</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ddii.dev/tags/network-policy/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="naver-site-verification" content="cbcc03783e5594725d3951f4e7f16ede80e69881"><meta data-rh="true" property="og:title" content="One post tagged with &quot;network policy&quot; | Cloud Catalyst"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ddii.dev/tags/network-policy/"><link data-rh="true" rel="alternate" href="https://ddii.dev/tags/network-policy/" hreflang="en"><link data-rh="true" rel="alternate" href="https://ddii.dev/tags/network-policy/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://UTLA0DRN66-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.1e7a31ee.css">
<link rel="preload" href="/assets/js/runtime~main.581a1a45.js" as="script">
<link rel="preload" href="/assets/js/main.868c5c64.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_ObN2"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-catalyst.svg" alt="Cloud Catalyst" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo-catalyst.svg" alt="Cloud Catalyst" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Cloud Catalyst</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Posts</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" docid="introduction" href="/docs/prometheus/introduction/">Docs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/prometheus/introduction/">Prometheus</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/tags/">Tags</a><a class="navbar__item navbar__link" href="/presentation/">Presentation</a><a class="navbar__item navbar__link" href="/archive/">Archive</a><a class="navbar__item navbar__link" href="/about/">About</a><a class="navbar__item navbar__link" href="/pang4u/">Pang4u</a><a href="https://github.com/ddiiwoong/newblog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_a9qW thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_uKok margin-bottom--md">Recent Posts</div><ul class="sidebarItemList_Kvuv"><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kubernetes/headless-service/">Kubernetes Headless Service</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kubernetes/externaldns/">ExternalDNS</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kubernetes/multus-on-kind/">Multus on Kind cluster</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kubernetes/readinessandprobe/">파드 Readiness &amp; Probe</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kubernetes/kernelhardening/">커널 강화 도구 사용하기</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><header class="margin-bottom--xl"><h1>One post tagged with &quot;network policy&quot;</h1><a href="/tags/">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/kubernetes/cilium-1/">Cilium</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2018-07-06T00:00:00.000Z" itemprop="datePublished">July 6, 2018</time> · <!-- -->17 min read</div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="cilium-누구냐-넌">Cilium 누구냐 넌?<a class="hash-link" href="#cilium-누구냐-넌" title="Direct link to heading">​</a></h2><p>처음에 놀랐다. 번역하면 &#x27;자궁&#x27;, &#x27;섬모&#x27;, &#x27;속눈썹&#x27;등 익숙치 않은 단어라서 놀랐지만 차근히 보다보니 결국 OS내부(리눅스 커널)에서부터 컨테이너간 또는 외부와의 연결을 보호하는 역할이라고 하니 이해가 되는 것 같다.</p><p>홈페이지에 정의된 내용을 보면 아래 내용과 같다. </p><blockquote><p><a href="https://cilium.readthedocs.io/en/v1.1/intro/#what-is-cilium" target="_blank" rel="noopener noreferrer">Cilium</a> - Docker 및 Kubernetes와 같은 Linux 컨테이너 관리 플랫폼을 사용하여 배포된 응용 프로그램 서비스 간의 네트워크 연결을 보호하는 오픈 소스 소프트웨어</p></blockquote><p>페북에 <a href="https://www.facebook.com/groups/korelnxuser/" target="_blank" rel="noopener noreferrer">한국 리눅스 사용자 그룹</a>에서도 <a href="https://www.facebook.com/tommy.lee.98229" target="_blank" rel="noopener noreferrer">Tommy Lee</a>님이나 <a href="https://www.facebook.com/changan.song" target="_blank" rel="noopener noreferrer">송창안</a>님이 몇몇 게시물을 올려주셔서 관심있게 보던중에 아래와 같은 내용을 보고 이거다 하고 파보기 시작했다.</p><blockquote><p>Cilium은 Docker 및 Kubernetes와 같은 리눅스 컨테이너 프레임 워크에 API 기반의 네트워크 보안 필터링을 제공하며,
또한, BPF라는 새로운 Linux 커널 기술을 사용하여 컨테이너/POD ID를 기반으로 네트워크 계층 및 응용 프로그램 계층 보안 정책을 정의 및 적용하는 것에 있어서 간단하면서 효율적인 방법을 제공하고 있습니다.</p></blockquote><p>윗분들처럼 커널 자체를 분석하고 공부하고 기여하려면 소요되는 시간이 더 걸릴거 같고 서비스를 운영하고 개발하는 입장에서는 내 프로젝트에 적용 가능성을 검증하는것이 나을것 같아 정리를 해본다.</p><p>iptables을 기반으로 IP와 Port기반의 전통적인 포워딩 기술은 벌써 20년이라는 세월동안 널리 사용되어 왔다. 특히 퍼블릭/프라이빗 클라우드 제품군들 모두 iptables기반의 Security Group등을 기본으로 제공하고 있고 Kubernetes 마저도 CNI 핵심으로 iptables을 활용하고 있다.  </p><p>동적으로 변화하고 매우 복잡한 마이크로서비스를 사용하는 시대에 전통적인 방식의 IP, Port관리는 비효율적인 측면이 없지 않다. BPF(아래인용)을 활용하여 리눅스 커널내에서 데이터 포워딩을 할 수 있고 Kubernetes Service기반 Load Balancing이나 istio와 같은 Service Mesh를 위한 Proxy Injection 을 통해 여러 활용을 할 수 있을거라고 Cilium 프로젝트는 이야기 하고 있다. </p><blockquote><p>버클리 패킷 필터(Berkeley Packet Filter, BPF)</p><p>BPF는 버클리 패킷 필터(Berkeley Packet Filter)의 줄임말이다. 이름 그대로 패킷을 걸러내는 필터이다. 그런데 BSD에서의 BPF는 네트워크 탭(리눅스의 PF_PACKET)까지 아우르는 개념이다. 옛날 옛적에 유닉스에는 CSPF(CMU/Stanford Packet Filter)라는 게 있었는데 BPF라는 새 구조가 이를 대체했다. 이후 리눅스에서는 네트워크 탭을 나름의 방식으로 구현하고 패킷 필터 부분만 가져왔다. 리눅스의 패킷 필터를 리눅스 소켓 필터링(LSF: Linux Socket Filtering)이라고도 한다.<br>
<!-- -->(발췌) <a href="https://wariua.github.io/facility/extended-bpf.html" target="_blank" rel="noopener noreferrer">https://wariua.github.io/facility/extended-bpf.html</a> </p></blockquote><p>Cilium은 Dockercon 2017에서 최초 <a href="https://www.youtube.com/watch?v=ilKlmTDdFgk" target="_blank" rel="noopener noreferrer">announce</a>를 하였고 2018년 4월 24일에 1.0이 정식 Release된 이후 많은 관심을 받을것으로 예상되어 실제 서비스에 적용해볼 필요가 있을거 같아 minikube로 테스트한 내용을 끄젹여 본다. </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="cilium-architecture">Cilium Architecture<a class="hash-link" href="#cilium-architecture" title="Direct link to heading">​</a></h2><p><img loading="lazy" alt="Cilium Architecture" src="/assets/images/cilium_arch-96f6efd4a70465e9cbfd890e9da1f159.png" width="700" height="624" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="main-feature">Main Feature<a class="hash-link" href="#main-feature" title="Direct link to heading">​</a></h2><ul><li>고효율 BPF Datapath  <ul><li>모든 데이터 경로가 클러스터 전체에 완전 분산</li><li>Envoy같은 proxy injection 제공, 추후 sidecar proxy 형태 제공예정</li></ul></li><li>CNI, CMM plugins  <ul><li>Kubernetes, Mesos, Docker에 쉽게 통합가능</li></ul></li><li>Packet, API 네트워크 보안<br>패킷기반 네트워크 보안과 API 인증을 결합하여 전통적인 패킷기반 네트워크 보안과 마이크로서비스 아키텍처 모두에게 보안 제공가능  <ul><li><a href="http://docs.cilium.io/en/doc-1.0/concepts/#arch-id-security" target="_blank" rel="noopener noreferrer">ID기반</a> - Source IP에만 의존하지 않고 모든패킷에 workload identity를 encoding하여 식별성 강화  </li><li><a href="http://docs.cilium.io/en/doc-1.0/policy/language/#ip-cidr-based" target="_blank" rel="noopener noreferrer">IP/CIDR기반</a>이외에도 <a href="http://docs.cilium.io/en/doc-1.0/policy/language/#services-based" target="_blank" rel="noopener noreferrer">Kubernetes Service기반</a>으로 정책 설정가능</li><li>L7기반 <a href="http://docs.cilium.io/en/doc-1.0/policy/language/#layer-7-examples" target="_blank" rel="noopener noreferrer">API보안</a> 적용가능</li></ul></li><li>분산,확장가능한 Load Balacing
BPF를 사용한 고성능 L3,L4 Load Balancer 제공
(Hasing, Weighted round-robin)<ul><li>kube-proxy 대체 - Kubernetes ClusterIP가 생성될때 BPF기반으로 자동으로 적용됨 </li><li><a href="http://docs.cilium.io/en/doc-1.0/api/" target="_blank" rel="noopener noreferrer">API driven</a> - 직접 API를 활용하여 확장가능</li></ul></li><li>단순화된 네트워크 모델<br>Overlay/VXLAN, Direct/Native Routing 지원</li><li>가시성  <ul><li><a href="https://github.com/cilium/microscope" target="_blank" rel="noopener noreferrer">Microscope</a> - 클러스터 레벨에서 모든 이벤트 필터링 가능</li><li>API기반 가시성 제공</li></ul></li><li>운영<ul><li>클러스터 헬스체크 - HTTP, ICMP기준 클러스터 latency 체크가능</li><li>Prometheus 통합 - 모든 메트릭을 Prometheus로 전달가능</li><li>클러스터 분석 및 <a href="http://docs.cilium.io/en/doc-1.0/troubleshooting/#cluster-diagnosis-tool" target="_blank" rel="noopener noreferrer">리포트툴</a> </li></ul></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="requirement">Requirement<a class="hash-link" href="#requirement" title="Direct link to heading">​</a></h2><ul><li>kubectl &gt;= 1.7.0</li><li>minikube &gt;= 0.22.3</li></ul><p><a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/" target="_blank" rel="noopener noreferrer">kubectl</a> 설치와 <a href="https://github.com/kubernetes/minikube/releases" target="_blank" rel="noopener noreferrer">minikube</a> 구성은 별도로 해야한다.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="start-minikube">Start minikube<a class="hash-link" href="#start-minikube" title="Direct link to heading">​</a></h2><p>넉넉하게 4GB 이상 메모리로 minikube를 구동한다.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ minikube start --kubernetes-version v1.9.0 --network-plugin=cni --extra-config=kubelet.network-plugin=cni --memory=5120 </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="check-minikube-cluster-status">Check minikube cluster status<a class="hash-link" href="#check-minikube-cluster-status" title="Direct link to heading">​</a></h2><p>minikube구성이 완료되면 아래와 같이 클러스터 상태를 확인할수 있다. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                 STATUS    MESSAGE              ERROR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">controller-manager   Healthy   ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scheduler            Healthy   ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">etcd-0               Healthy   {&quot;health&quot;: &quot;true&quot;}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="install-etcd-dependency-of-cilium">Install etcd (dependency of cilium)<a class="hash-link" href="#install-etcd-dependency-of-cilium" title="Direct link to heading">​</a></h2><p>cilium 의존성을 위해 etcd를 별도로 배포한다. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create -n kube-system -f https://raw.githubusercontent.com/cilium/cilium/v1.1/examples/kubernetes/addons/etcd/standalone-etcd.yaml  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service &quot;etcd-cilium&quot; created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">statefulset.apps &quot;etcd-cilium&quot; created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="check-all-pods-etcd">Check all pods (etcd)<a class="hash-link" href="#check-all-pods-etcd" title="Direct link to heading">​</a></h2><p>모든 pod가 <code>Running</code> 상태인지 확인한다.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pods --all-namespaces</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAMESPACE     NAME                               READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   etcd-cilium-0                      1/1       Running   0          1m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   etcd-minikube                      1/1       Running   0          3m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-addon-manager-minikube        1/1       Running   0          4m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-apiserver-minikube            1/1       Running   0          3m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-controller-manager-minikube   1/1       Running   0          3m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-dns-86f4d74b45-lhzfv          3/3       Running   0          4m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-proxy-tcd7h                   1/1       Running   0          4m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-scheduler-minikube            1/1       Running   0          4m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   storage-provisioner                1/1       Running   0          4m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="install-cilium">Install Cilium<a class="hash-link" href="#install-cilium" title="Direct link to heading">​</a></h2><p>Kubernetes 클러스터에 Cilium을 인스톨한다. 기본적으로 DaemonSet 형태로 배포되기 때문에 Node당 한개의 Cilium Pod를 볼 수 있다. Cilium은 <code>kube-system</code> namespace에서 실행된다.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create -f https://raw.githubusercontent.com/cilium/cilium/v1.1/examples/kubernetes/1.9/cilium.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">configmap &quot;cilium-config&quot; created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">secret &quot;cilium-etcd-secrets&quot; created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">daemonset.extensions &quot;cilium&quot; created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusterrolebinding.rbac.authorization.k8s.io &quot;cilium&quot; created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusterrole.rbac.authorization.k8s.io &quot;cilium&quot; created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">serviceaccount &quot;cilium&quot; created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>kube-system namespace에 RBAC설정과 함께 Cilium이 배포되고, ConfigMap, DaemonSet 형태로 배포가 된다. </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="check-deployment">Check deployment<a class="hash-link" href="#check-deployment" title="Direct link to heading">​</a></h2><p>Cilium Deployment가 <code>READY</code> 상태로 바뀔때까지 기다린다.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get daemonsets -n kube-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME      DESIRED   CURRENT   READY     UP-TO-DATE   AVAILABLE   NODE SELECTOR   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cilium    1         1         1         1            0           &lt;none&gt;          2m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="deploy-demo-app">Deploy Demo App.<a class="hash-link" href="#deploy-demo-app" title="Direct link to heading">​</a></h2><p>아래 데모그림을 보면 스타워즈의 영감을 받아서인지 deathstar, xwing 등으로 구분한것을 확인할수 있다. deathstar deployments의 경우 80포트로 http 웹서버가 2개의 pod replica로 Load Balancing되고 있다. deathstar 서비스는 우주선이 착륙할수 있도록 활주로를 서비스하고 있다. 하지만 제국군의 tiefighter 만 착륙하도록 해야하므로 보안설정을 해야하는 상황이다. </p><p><img loading="lazy" src="https://cilium.readthedocs.io/en/v1.1/_images/cilium_http_gsg.png" alt="starwars" class="img_E7b_"></p><p>아래 <code>http-sw-app.yaml</code> 은 세가지 deployment를 가지고 있고 각각의 deployment는 <code>(org=empire, class=deathstar)</code>, <code>(org=empire, class=tiefighter)</code>, <code>(org=alliance, class=xwing)</code>와 같이 label 정보를 가진다. deathstar Service는 <code>(org=empire, class=deathstar)</code> label을 가지고 Load Balancing을 한다. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create -f https://raw.githubusercontent.com/cilium/cilium/v1.1/examples/minikube/http-sw-app.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service &quot;deathstar&quot; created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment &quot;deathstar&quot; created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment &quot;tiefighter&quot; created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment &quot;xwing&quot; created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>총 4개의 pod와 1개의 서비스를 확인할수 있다.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pods,svc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                             READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/deathstar-566c89f458-mqgfs   1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/deathstar-566c89f458-wlc4c   1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/tiefighter                   1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/xwing                        1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                 TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service/deathstar    ClusterIP   10.109.80.174   &lt;none&gt;        80/TCP    1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service/kubernetes   ClusterIP   10.96.0.1       &lt;none&gt;        443/TCP   4h</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>각각의 pod는 Cilium에서는 <a href="https://cilium.readthedocs.io/en/v1.1/concepts/#endpoint" target="_blank" rel="noopener noreferrer">Endpoints</a>형태로 표현된다. 아래와 같이 ingress, egress policy를 확인할수 있고 아직 아무런 network policy 적용을 하지 않았기 때문에 모두 <code>Disabled</code> 상태로 보인다.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl -n kube-system get pods -l k8s-app=cilium</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME           READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cilium-jmxk2   1/1       Running   0          4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl -n kube-system exec cilium-jmxk2 -- cilium endpoint list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENDPOINT   POLICY (ingress)   POLICY (egress)   IDENTITY   LABELS (source:key[=value])                                                    IPv6                 IPv4            STATUS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           ENFORCEMENT        ENFORCEMENT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5023       Disabled           Disabled          2008       k8s:io.cilium.k8s.policy.serviceaccount=istio-ingress-service-account          f00d::a0f:0:0:139f   10.15.170.241   ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:istio=ingress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">7415       Disabled           Disabled          9270       k8s:class=deathstar                                                            f00d::a0f:0:0:1cf7   10.15.16.224    ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.cilium.k8s.policy.serviceaccount=default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:org=empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">7979       Disabled           Disabled          4          reserved:health                                                                f00d::a0f:0:0:1f2b   10.15.96.215    ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">17917      Disabled           Disabled          60941      k8s:class=tiefighter                                                           f00d::a0f:0:0:45fd   10.15.58.61     ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.cilium.k8s.policy.serviceaccount=default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:org=empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22602      Disabled           Disabled          53004      k8s:io.cilium.k8s.policy.serviceaccount=istio-mixer-service-account            f00d::a0f:0:0:584a   10.15.190.2     ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:istio-mixer-type=telemetry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:istio=mixer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">31992      Disabled           Disabled          33709      k8s:io.cilium.k8s.policy.serviceaccount=istio-egressgateway-service-account    f00d::a0f:0:0:7cf8   10.15.85.192    ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:istio=egressgateway</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">33958      Disabled           Disabled          64389      k8s:io.cilium.k8s.policy.serviceaccount=istio-citadel-service-account          f00d::a0f:0:0:84a6   10.15.59.151    ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:istio=citadel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">49215      Disabled           Disabled          40629      k8s:io.cilium.k8s.policy.serviceaccount=istio-mixer-service-account            f00d::a0f:0:0:c03f   10.15.48.171    ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:istio-mixer-type=policy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:istio=mixer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">55129      Disabled           Disabled          9270       k8s:class=deathstar                                                            f00d::a0f:0:0:d759   10.15.17.253    ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.cilium.k8s.policy.serviceaccount=default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:org=empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">55930      Disabled           Disabled          46893      k8s:app=prometheus                                                             f00d::a0f:0:0:da7a   10.15.196.220   ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.cilium.k8s.policy.serviceaccount=prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">57491      Disabled           Disabled          775        k8s:io.cilium.k8s.policy.serviceaccount=istio-mixer-service-account            f00d::a0f:0:0:e093   10.15.253.210   ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:istio=statsd-prom-bridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">57651      Disabled           Disabled          44171      k8s:io.cilium.k8s.policy.serviceaccount=istio-ingressgateway-service-account   f00d::a0f:0:0:e133   10.15.74.164    ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:istio=ingressgateway</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">61352      Disabled           Disabled          888        k8s:io.cilium.k8s.policy.serviceaccount=istio-pilot-service-account            f00d::a0f:0:0:efa8   10.15.118.68    ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:istio=pilot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">61355      Disabled           Disabled          36797      k8s:class=xwing                                                                f00d::a0f:0:0:efab   10.15.56.79     ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.cilium.k8s.policy.serviceaccount=default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:org=alliance</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>현재 상태에서는 모든 우주선이 deathstar에 착륙이 가능하다.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl exec xwing -- curl -s -XPOST deathstar.default.svc.cluster.local/v1/request-landing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ship landed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl exec tiefighter -- curl -s -XPOST deathstar.default.svc.cluster.local/v1/request-landing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ship landed</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="l3l4-policy-적용">L3/L4 Policy 적용<a class="hash-link" href="#l3l4-policy-적용" title="Direct link to heading">​</a></h2><p>결국 하고 싶은건 제국군 우주선 즉, tiefighter만 접근이 가능해야 하므로 아래처럼 정책을 설정한다. </p><p>정책은 직관적으로 설정이 가능하다.</p><p><code>org=empire, class=deathstar</code> label을 가진 endpoint로의 ingress 방향의 80포트 접근은 <code>org=empire</code> label을 가진 pod만 가능하도록 한다는 의미이다. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: &quot;cilium.io/v2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: CiliumNetworkPolicy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">description: &quot;L3-L4 policy to restrict deathstar access to empire ships only&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: &quot;rule1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  endpointSelector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    matchLabels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      org: empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      class: deathstar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ingress:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - fromEndpoints:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - matchLabels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        org: empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    toPorts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - port: &quot;80&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        protocol: TCP</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>또는 </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create -f https://raw.githubusercontent.com/cilium/cilium/v1.1/examples/minikube/sw_l3_l4_policy.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>위와 같이 설정하고 나서 tiefighter를 착륙시켜보자.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl exec tiefighter -- curl -s -XPOST deathstar.default.svc.cluster.local/v1/request-landing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ship landed</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>정상착륙!<br>
<!-- -->이번에는 xwing 차례</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl exec xwing -- curl -s -XPOST deathstar.default.svc.cluster.local/v1/request-landing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>착륙실패!</p><p>이어서 정책을 다시 확인해보면 Enabled로 변한 정책 2개를 확인할 수 있다.<br>
<!-- -->(pod가 2개이므로 2개의 정책을 볼 수 있다)</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl -n kube-system exec cilium-jmxk2 -- cilium endpoint list</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>상세 정책 확인 (Very Simple!!)</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get cnp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME            AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-sidecar   2h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rule1           5m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$  kubectl describe cnp rule1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name:         rule1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Namespace:    default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Labels:       &lt;none&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Annotations:  &lt;none&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">API Version:  cilium.io/v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Kind:         CiliumNetworkPolicy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Cluster Name:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Creation Timestamp:  2018-07-06T07:25:15Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Generation:          0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Resource Version:    30312</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Self Link:           /apis/cilium.io/v2/namespaces/default/ciliumnetworkpolicies/rule1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UID:                 ba0d7964-80ed-11e8-8077-080027b1075c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Endpoint Selector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Match Labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Any : Class:  deathstar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Any : Org:    empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Ingress:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    From Endpoints:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Match Labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Any : Org:  empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    To Ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Port:      80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Protocol:  TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Status:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Nodes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Minikube:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Enforcing:              true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Last Updated:           0001-01-01T00:00:00Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Local Policy Revision:  65</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Ok:                     true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Events:                       &lt;none&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="l7-정책-적용">L7 정책 적용<a class="hash-link" href="#l7-정책-적용" title="Direct link to heading">​</a></h2><p>마지막으로 deathstar API를 호출하는 서비스에 대한 정책을 제어하는것을 테스트해본다.</p><p>아래 예시처럼 exhaust-port API(포트를 소진시키는 API)를 수행하면 특정 pod가 에러가 나고 재기동 되는것을 확인할수 있다. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl exec tiefighter -- curl -s -XPUT deathstar.default.svc.cluster.local/v1/exhaust-port</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Panic: deathstar exploded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">goroutine 1 [running]:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">main.HandleGarbage(0x2080c3f50, 0x2, 0x4, 0x425c0, 0x5, 0xa)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /code/src/github.com/empire/deathstar/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        temp/main.go:9 +0x64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">main.main()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /code/src/github.com/empire/deathstar/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        temp/main.go:5 +0x85</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                         READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deathstar-566c89f458-mqgfs   0/1       Error     0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deathstar-566c89f458-wlc4c   1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tiefighter                   1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xwing                        1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                         READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deathstar-566c89f458-mqgfs   1/1       Running   1          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deathstar-566c89f458-wlc4c   1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tiefighter                   1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xwing                        1/1       Running   0          1h</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>그래서 이번에는 exhaust-port API는 차단하고 request-landing API만 허용하는 정책을 테스트해본다.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: &quot;cilium.io/v2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: CiliumNetworkPolicy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">description: &quot;L7 policy to restrict access to specific HTTP call&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: &quot;rule1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  endpointSelector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    matchLabels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      org: empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      class: deathstar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ingress:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - fromEndpoints:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - matchLabels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        org: empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    toPorts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - port: &quot;80&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        protocol: TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      rules:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        http:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - method: &quot;POST&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          path: &quot;/v1/request-landing&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>또는</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl apply -f https://raw.githubusercontent.com/cilium/cilium/v1.1/examples/minikube/sw_l3_l4_l7_policy.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ciliumnetworkpolicy.cilium.io/rule1 configured</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>이후 동일한 테스트를 해보면 다른 결과를 확인할 수 있다. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl exec tiefighter -- curl -s -XPOST deathstar.default.svc.cluster.local/v1/request-landing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ship landed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl exec tiefighter -- curl -s -XPUT deathstar.default.svc.cluster.local/v1/exhaust-port</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Access denied</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>다시한번 상세 정책 확인을 해보면 ingress POST 허용정책을 확인할 수 있다.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl describe ciliumnetworkpolicies rule1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name:         rule1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Namespace:    default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Labels:       &lt;none&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Annotations:  kubectl.kubernetes.io/last-applied-configuration={&quot;apiVersion&quot;:&quot;cilium.io/v2&quot;,&quot;description&quot;:&quot;L7 policy to restrict access to specific HTTP call&quot;,&quot;kind&quot;:&quot;CiliumNetworkPolicy&quot;,&quot;metadata&quot;:{&quot;annotations&quot;:...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">API Version:  cilium.io/v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Kind:         CiliumNetworkPolicy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Cluster Name:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Creation Timestamp:  2018-07-06T07:25:15Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Generation:          0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Resource Version:    32814</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Self Link:           /apis/cilium.io/v2/namespaces/default/ciliumnetworkpolicies/rule1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UID:                 ba0d7964-80ed-11e8-8077-080027b1075c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Endpoint Selector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Match Labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Any : Class:  deathstar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Any : Org:    empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Ingress:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    From Endpoints:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Match Labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Any : Org:  empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    To Ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Port:      80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Protocol:  TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Rules:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Http:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          Method:  POST</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          Path:    /v1/request-landing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Status:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Nodes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Minikube:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Annotations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Kubectl . Kubernetes . Io / Last - Applied - Configuration:  {&quot;apiVersion&quot;:&quot;cilium.io/v2&quot;,&quot;description&quot;:&quot;L7 policy to restrict access to specific HTTP call&quot;,&quot;kind&quot;:&quot;CiliumNetworkPolicy&quot;,&quot;metadata&quot;:{&quot;annotations&quot;:{},&quot;name&quot;:&quot;rule1&quot;,&quot;namespace&quot;:&quot;default&quot;},&quot;spec&quot;:{&quot;endpointSelector&quot;:{&quot;matchLabels&quot;:{&quot;class&quot;:&quot;deathstar&quot;,&quot;org&quot;:&quot;empire&quot;}},&quot;ingress&quot;:[{&quot;fromEndpoints&quot;:[{&quot;matchLabels&quot;:{&quot;org&quot;:&quot;empire&quot;}}],&quot;toPorts&quot;:[{&quot;ports&quot;:[{&quot;port&quot;:&quot;80&quot;,&quot;protocol&quot;:&quot;TCP&quot;}],&quot;rules&quot;:{&quot;http&quot;:[{&quot;method&quot;:&quot;POST&quot;,&quot;path&quot;:&quot;/v1/request-landing&quot;}]}}]}]}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Enforcing:              true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Last Updated:           0001-01-01T00:00:00Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Local Policy Revision:  70</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Ok:                     true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Events:                       &lt;none&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>cilium CLI로도 확인이 가능하다.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain"> kubectl -n kube-system exec cilium-jmxk2 cilium policy get</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;endpointSelector&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;matchLabels&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;reserved:init&quot;: &quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;ingress&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;fromEntities&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;host&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;egress&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;toPorts&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;ports&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;port&quot;: &quot;53&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;protocol&quot;: &quot;UDP&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;toEntities&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;all&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;toEndpoints&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;matchLabels&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              &quot;k8s:io.kubernetes.pod.namespace&quot;: &quot;istio-system&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;labels&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;key&quot;: &quot;io.cilium.k8s.policy.name&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;value&quot;: &quot;istio-sidecar&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;source&quot;: &quot;k8s&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;key&quot;: &quot;io.cilium.k8s.policy.namespace&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;value&quot;: &quot;default&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;source&quot;: &quot;k8s&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;endpointSelector&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;matchLabels&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;any:class&quot;: &quot;deathstar&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;any:org&quot;: &quot;empire&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;k8s:io.kubernetes.pod.namespace&quot;: &quot;default&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;ingress&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;fromEndpoints&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;matchLabels&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              &quot;any:org&quot;: &quot;empire&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              &quot;k8s:io.kubernetes.pod.namespace&quot;: &quot;default&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;toPorts&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;ports&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;port&quot;: &quot;80&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;protocol&quot;: &quot;TCP&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;rules&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              &quot;http&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  &quot;path&quot;: &quot;/v1/request-landing&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  &quot;method&quot;: &quot;POST&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;labels&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;key&quot;: &quot;io.cilium.k8s.policy.name&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;value&quot;: &quot;rule1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;source&quot;: &quot;k8s&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;key&quot;: &quot;io.cilium.k8s.policy.namespace&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;value&quot;: &quot;default&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;source&quot;: &quot;k8s&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Revision: 71</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>이외에도 Cilium Metric을 Prometheus에서 확인하는것도 간단하게 할수 있다고 한다. </p><p>여기까지가 기본적으로 L3/L4, L7 기반 network policy를 적용해본것이고 다음번에는 istio와 연계 부분이나 실제 Cluster 구성방법에 대해서 다뤄보도록 하겠다.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/cilium/">Cilium</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/kubernetes/">Kubernetes</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/network-policy/">network policy</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/istio/">Istio</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/bpf/">BPF</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/cni/">CNI</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Cilium" href="/kubernetes/cilium-1/"><b>Read More</b></a></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">Home</a></li><li class="footer__item"><a class="footer__link-item" href="/archive/">Archive</a></li><li class="footer__item"><a class="footer__link-item" href="/tags/">Tags</a></li></ul></div><div class="col footer__col"><div class="footer__title">Sponsors</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/pang4u/">Pang4U</a></li><li class="footer__item"><a href="https://ko-fi.com/ddiiwoong" target="_blank" rel="noopener noreferrer" class="footer__link-item">Buy Me a Coffee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/ddiiwoong" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/ddiiwoong" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/ddiiwoong" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://kr.linkedin.com/in/ddiiwoong" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
<script src="/assets/js/runtime~main.581a1a45.js"></script>
<script src="/assets/js/main.868c5c64.js"></script>
</body>
</html>