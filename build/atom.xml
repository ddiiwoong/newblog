<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://ddii.dev/</id>
    <title>Act as a catalyst</title>
    <updated>2024-09-21T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://ddii.dev/"/>
    <subtitle>Act as a cloud catalyst</subtitle>
    <icon>https://ddii.dev/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[Multus on Kind cluster]]></title>
        <id>kubernetes/multus-on-kind/</id>
        <link href="https://ddii.dev/kubernetes/multus-on-kind/"/>
        <updated>2024-09-21T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Multusë¥¼ Kind clusterì— ì„¤ì¹˜í•˜ëŠ” ë°©ë²•]]></summary>
        <content type="html"><![CDATA[<p>ì´ì „ ì§ì¥ì—ì„œ í”„ë¡œì íŠ¸ ì¤‘ì— <code>Multus</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ 5Gí™˜ê²½ì—ì„œ ë©€í‹° ë„¤íŠ¸ì›Œí¬ CNIë¥¼ ì‚¬ìš©í•´ì„œ íŒ¨í‚·ì„ ë¯¸ëŸ¬ë§í•˜ê³  í•´ë‹¹ íŒ¨í‚·ì„ ë¶„ì„í•˜ëŠ” í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í–ˆì—ˆëŠ”ë°, ë‹¹ì‹œì— ì—¬ëŸ¬ ì‚¬ì •ìœ¼ë¡œ ì•„ì‰½ê²Œ ëœ í”„ë¡œì íŠ¸ë„ ì¡´ì¬í•˜ê³  í•´ì„œ ì´ë²ˆ ê¸°íšŒì— ì‹œë¦¬ì¦ˆë¡œ ì •ë¦¬ í•´ë³´ë ¤ê³  í•œë‹¤. ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ” <code>Kind</code> clusterì— <code>Multus</code>ë¥¼ êµ¬ì„±í•˜ê³  ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ë…¸ë“œë¼ë¦¬ í†µì‹ í•  ìˆ˜ ìˆë„ë¡ <code>koko</code>ë¥¼ ì‚¬ìš©í•´ì„œ ë…¸ë“œê°„ ë©€í‹° ë„¤íŠ¸ì›Œí¬ í™˜ê²½ì„ êµ¬ì„±í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì •ë¦¬í•´ë³´ë ¤ê³  í•œë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="requirements">Requirements<a class="hash-link" href="#requirements" title="Direct link to heading">â€‹</a></h2><ul><li><a href="https://kind.sigs.k8s.io/" target="_blank" rel="noopener noreferrer">Kind</a>: Kind(Kubernetes IN Docker)ëŠ” Docker ì»¨í…Œì´ë„ˆë¥¼ ì‚¬ìš©í•˜ì—¬ ë¡œì»¬ Kubernetes í´ëŸ¬ìŠ¤í„°ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ë„êµ¬ë‹¤. ì£¼ë¡œ í…ŒìŠ¤íŠ¸ ë° ê°œë°œ ëª©ì ìœ¼ë¡œ ì‚¬ìš©ë˜ë©°, ë¹ ë¥´ê³  ì‰½ê²Œ Kubernetes í™˜ê²½ì„ êµ¬ì¶•í•  ìˆ˜ ìˆë‹¤. </li><li><a href="https://github.com/k8snetworkplumbingwg/multus-cni" target="_blank" rel="noopener noreferrer">Multus</a>: MultusëŠ” Kubernetesì—ì„œ ì—¬ëŸ¬ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì§€ì›í•˜ê¸° ìœ„í•œ CNI í”ŒëŸ¬ê·¸ì¸ì´ë‹¤. Multusë¥¼ í†µí•´ ê° Podê°€ ì—¬ëŸ¬ ë„¤íŠ¸ì›Œí¬ì— ì—°ê²°ë  ìˆ˜ ìˆìœ¼ë©°, ë‹¤ì–‘í•œ ë„¤íŠ¸ì›Œí¬ ìš”êµ¬ ì‚¬í•­ì„ ì¶©ì¡±í•  ìˆ˜ ìˆë‹¤. íŠ¹íˆ 5G ì›Œí¬ë¡œë“œì—ì„œ SR-IOVì™€ í•¨ê»˜ ì‚¬ìš©ë  ë•Œ, MultusëŠ” ê¸°ë³¸ ë„¤íŠ¸ì›Œí¬ ì™¸ì—ë„ ê³ ì„±ëŠ¥ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•  ìˆ˜ ìˆë‹¤.<ul><li><a href="https://github.com/k8snetworkplumbingwg/sriov-network-device-plugin" target="_blank" rel="noopener noreferrer">SR-IOV</a>: SR-IOV(Single Root I/O Virtualization)ëŠ” í•˜ë‚˜ì˜ ë¬¼ë¦¬ì  ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì—¬ëŸ¬ ê°€ìƒ í•¨ìˆ˜(VF)ë¡œ ë‚˜ëˆ„ì–´ ê° Podì— ì§ì ‘ í• ë‹¹í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ê¸°ìˆ ì´ë‹¤. ì´ë¥¼ í†µí•´ ë„¤íŠ¸ì›Œí¬ ì„±ëŠ¥ì„ í¬ê²Œ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆìœ¼ë©°, íŠ¹íˆ ê³ ì„±ëŠ¥ ë„¤íŠ¸ì›Œí‚¹ì´ í•„ìš”í•œ 5G ë° NFV(Network Function Virtualization) í™˜ê²½ì—ì„œ ì¤‘ìš”í•˜ê²Œ ì‚¬ìš©ë˜ëŠ” ê¸°ìˆ ì´ë‹¤.</li></ul></li><li><a href="https://github.com/redhat-nfvpe/koko" target="_blank" rel="noopener noreferrer">Koko</a>: KokoëŠ” ì»¨í…Œì´ë„ˆ ê°„ ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ ìœ„í•œ ë„êµ¬ë¡œ, íŠ¹íˆ ì—¬ëŸ¬ ë„¤íŠ¸ì›Œí¬ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ê°„ì˜ ê°€ìƒ ì´ë”ë„· í˜ì–´ë¥¼ ìƒì„±í•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤. kind clusterì—ì„œ ì»¨í…Œì´ë„ˆë¡œ êµ¬ì„±ëœ ë…¸ë“œê°„ í†µì‹ ì„ ìœ„í•´ì„œ ì‚¬ìš©ëœë‹¤.</li><li><a href="https://github.com/containernetworking/plugins/tree/main/plugins/main/macvlan" target="_blank" rel="noopener noreferrer">Macvlan</a>: Macvlanì€ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ ê°€ìƒí™”í•˜ì—¬ ì—¬ëŸ¬ ê°œì˜ ê°€ìƒ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ ìƒì„±í•  ìˆ˜ ìˆëŠ” ê¸°ìˆ ì´ë‹¤. ì´ë¥¼ í†µí•´ ê° ì»¨í…Œì´ë„ˆê°€ ê³ ìœ í•œ MAC ì£¼ì†Œë¥¼ ê°€ì§€ë©°, ë¬¼ë¦¬ ë„¤íŠ¸ì›Œí¬ì™€ ì§ì ‘ í†µì‹ í•  ìˆ˜ ìˆë‹¤.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="architecture">Architecture<a class="hash-link" href="#architecture" title="Direct link to heading">â€‹</a></h2><p><img loading="lazy" alt="koko" src="/assets/images/koko-27e3b38a60609fafbf86757382304d85.png" width="1281" height="861" class="img_E7b_"></p><p>ìœ„ ê·¸ë¦¼ì€ êµ¬ì„±í•˜ë ¤ê³  í•˜ëŠ” Kind í´ëŸ¬ìŠ¤í„°ì™€ ë„¤íŠ¸ì›Œí¬ êµ¬ì„±ì„ ë³´ì—¬ì¤€ë‹¤. Multusë¥¼ ì‚¬ìš©í•˜ë©´ Podê°€ ì—¬ëŸ¬ ë„¤íŠ¸ì›Œí¬ì— ë™ì‹œì— ì—°ê²°ë  ìˆ˜ ìˆì–´ ë³µì¡í•œ ë„¤íŠ¸ì›Œí¬ í† í´ë¡œì§€ë¥¼ ì§€ì›í•  ìˆ˜ ìˆë‹¤.</p><ol><li><p><strong>Kind í´ëŸ¬ìŠ¤í„°</strong>: ê¸°ë³¸ì ìœ¼ë¡œ Docker ì»¨í…Œì´ë„ˆë¥¼ ì‚¬ìš©í•˜ì—¬ ë…¸ë“œë¥¼ ìƒì„±í•œë‹¤.</p><ul><li><strong>Control Plane</strong>: í´ëŸ¬ìŠ¤í„°ì˜ ì œì–´ ì˜ì—­ì„ ë‹´ë‹¹í•˜ë©°, <code>eth0</code> ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ Docker Bridgeì™€ ì—°ê²°ëœë‹¤.</li><li><strong>Worker Node 1 &amp; 2</strong>: ê°ê°ì˜ ì›Œì»¤ ë…¸ë“œëŠ” Pod í˜•íƒœë¡œ ì‹¤í–‰ë˜ë©°, <code>eth0</code> ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ Docker Bridgeì™€ ì—°ê²°ëœë‹¤.</li></ul></li><li><p><strong>ë„¤íŠ¸ì›Œí¬ êµ¬ì„±</strong>:</p><ul><li><strong>Primary Interface (eth0)</strong>: ê° ë…¸ë“œì˜ ê¸°ë³¸ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¡œ, Kindnet CNI í”ŒëŸ¬ê·¸ì¸ì„ í†µí•´ ì—°ê²°ëœë‹¤.</li><li><strong>Additional Interface (eth1)</strong>: Multus CNI í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•˜ì—¬ ì¶”ê°€ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•œë‹¤. ì—¬ê¸°ì„œëŠ” <code>macvlan</code> í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•˜ì—¬ Podì— ì¶”ê°€ ë„¤íŠ¸ì›Œí¬ë¥¼ ì œê³µí•œë‹¤.</li></ul></li><li><p><strong>Multus CNI</strong>:</p><ul><li>MultusëŠ” ì—¬ëŸ¬ CNI í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ë©€í‹°í”Œë ‰ì„œ ì—­í• ì„ í•œë‹¤. ìœ„ ê·¸ë¦¼ì—ì„œ ì²˜ëŸ¼ Kindnetê³¼ Macvlanì„ í•¨ê»˜ ì‚¬ìš©í•œë‹¤.</li></ul></li><li><p><strong>Docker ë¸Œë¦¬ì§€</strong>:</p><ul><li>ì»¨í…Œì´ë„ˆë¡œ ìƒì„±ëœ ê° ë…¸ë“œì˜ <code>eth0</code> ì¸í„°í˜ì´ìŠ¤ëŠ” Docker ë¸Œë¦¬ì§€ì™€ ì—°ê²°ë˜ì–´ ìˆìœ¼ë©°, <code>veth</code> í˜ì–´ë¥¼ í†µí•´ í†µì‹ í•œë‹¤.</li></ul></li><li><p><strong>Koko</strong>:</p><ul><li>ì»¨í…Œì´ë„ˆ ê°„ Point-to-Point ì—°ê²°ì„ ê´€ë¦¬í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ë„êµ¬ì´ë‹¤. ê·¸ë¦¼ì—ì„œ ë‘ ì›Œì»¤ ë…¸ë“œ ê°„ì˜ ì§ì ‘ì ì¸ ì—°ê²°ì„ ì„¤ì •í•˜ëŠ” ì—­í• ì„ í•œë‹¤.</li><li>KokoëŠ” ê°€ìƒ ì´ë”ë„· í˜ì–´ë¥¼ ìƒì„±í•˜ì—¬ ì„œë¡œ ë‹¤ë¥¸ ë„¤íŠ¸ì›Œí¬ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ê°„ì˜ ì§ì ‘ ì—°ê²°ì„ ê°€ëŠ¥í•˜ê²Œ í•œë‹¤. ì´ë¥¼ í†µí•´ Kind í´ëŸ¬ìŠ¤í„° ë‚´ì˜ ì›Œì»¤ ë…¸ë“œ ê°„ì— ì¶”ê°€ì ì¸ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤(eth1)ë¥¼ ìƒì„±í•˜ê³  ì—°ê²°í•  ìˆ˜ ìˆë‹¤.</li><li>Kokoë¥¼ ì‚¬ìš©í•˜ë©´ ë³µì¡í•œ ë„¤íŠ¸ì›Œí¬ í† í´ë¡œì§€ë¥¼ ì‰½ê²Œ êµ¬ì„±í•  ìˆ˜ ìˆìœ¼ë©°, íŠ¹íˆ ë©€í‹° ë„¤íŠ¸ì›Œí¬ í™˜ê²½ì—ì„œ ìœ ìš©í•˜ë‹¤.</li></ul></li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kind-cluster-ìƒì„±">Kind Cluster ìƒì„±<a class="hash-link" href="#kind-cluster-ìƒì„±" title="Direct link to heading">â€‹</a></h2><p>ì´ë²ˆ êµ¬ì„±ì€ Intel ê¸°ë°˜ Ubuntu 22.04 í™˜ê²½ì—ì„œ ì§„í–‰ë˜ì—ˆë‹¤.</p><p><code>config-3node.yml</code> íŒŒì¼ì„ ì¤€ë¹„í•œë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ <code>kindnet</code> CNI í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•˜ê²Œ ë  ê²ƒì´ë‹¤. ì£¼ì„ì²˜ë¦¬ëœ êµ¬ë¬¸ì€ ì»¤ìŠ¤í…€ CNI í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì— ì‚¬ìš©ëœë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kind.x</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">k8s.io/v1alpha4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> multus</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">nodes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">role</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> control</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">plane</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">role</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> worker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">role</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> worker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Note: uncomment if you install cni plugin by yourself</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#networking:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#  disableDefaultCNI: true</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìƒì„±í•œ yml íŒŒì¼ì„ ì‚¬ìš©í•˜ì—¬ í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kind create cluster --config config-3node.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Creating cluster </span><span class="token string" style="color:#e3116c">"multus-cluster"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> âœ“ Ensuring </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> image </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kindest/node:v1.31.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> ğŸ–¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> âœ“ Preparing nodes ğŸ“¦ ğŸ“¦ ğŸ“¦  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> âœ“ Writing configuration ğŸ“œ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> âœ“ Starting control-plane ğŸ•¹ï¸ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> âœ“ Installing CNI ğŸ”Œ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> âœ“ Installing StorageClass ğŸ’¾ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> âœ“ Joining worker nodes ğŸšœ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Set kubectl context to </span><span class="token string" style="color:#e3116c">"kind-multus-cluster"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">You can now use your cluster with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl cluster-info --context kind-multus-cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Not sure what to </span><span class="token keyword" style="color:#00009f">do</span><span class="token plain"> next? ğŸ˜…  Check out https://kind.sigs.k8s.io/docs/user/quick-start/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í´ëŸ¬ìŠ¤í„° ì •ë³´ë¥¼ í™•ì¸í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl cluster-info --context kind-multus-cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Kubernetes control plane is running at https://127.0.0.1:32935</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CoreDNS is running at https://127.0.0.1:32935/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>kubeconfigë¥¼ export í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kind </span><span class="token builtin class-name">export</span><span class="token plain"> kubeconfig --name multus-cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Set kubectl context to </span><span class="token string" style="color:#e3116c">"kind-multus-cluster"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í´ëŸ¬ìŠ¤í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆëŠ”ì§€ kubectlê³¼ docker ëª…ë ¹ì–´ë¡œ í™•ì¸í•  í•˜ë©´, ì›Œì»¤ ë…¸ë“œ ì´ë¦„ê³¼ docker ì»¨í…Œì´ë„ˆ ì´ë¦„ì´ ê°™ì€ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get nodes </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                           STATUS   ROLES           AGE     VERSION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">multus-cluster-control-plane   Ready    control-plane   7m11s   v1.31.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">multus-cluster-worker          Ready    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">          6m59s   v1.31.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">multus-cluster-worker2         Ready    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">          6m59s   v1.31.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONTAINER ID   IMAGE                  COMMAND                  CREATED         STATUS         PORTS                       NAMES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6e4420eeaf93   kindest/node:v1.31.0   </span><span class="token string" style="color:#e3116c">"/usr/local/bin/entrâ€¦"</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"> minutes ago   Up </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"> minutes   </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1:32935-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">6443</span><span class="token plain">/tcp   multus-cluster-control-plane</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">923ca6407417   kindest/node:v1.31.0   </span><span class="token string" style="color:#e3116c">"/usr/local/bin/entrâ€¦"</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"> minutes ago   Up </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"> minutes                               multus-cluster-worker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">de238256402a   kindest/node:v1.31.0   </span><span class="token string" style="color:#e3116c">"/usr/local/bin/entrâ€¦"</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"> minutes ago   Up </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"> minutes                               multus-cluster-worker2</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë…¸ë“œ ì»¨í…Œì´ë„ˆì— shë¡œ ì ‘ì†í•´ì„œ <code>ip a</code> ëª…ë ¹ì–´ë¡œ ì¸í„°í˜ì´ìŠ¤ ì •ë³´ë¥¼ í™•ì¸í•´ë³´ë©´, ë…¸ë“œì—ëŠ” <code>eth0</code> ì¸í„°í˜ì´ìŠ¤ë§Œ ì—°ê²°ë˜ì–´ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ëŠ” <code>kindnet</code> CNI í”ŒëŸ¬ê·¸ì¸ì´ ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µí•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ì´ë‹¤. </p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> </span><span class="token builtin class-name">exec</span><span class="token plain"> -it multus-cluster-worker </span><span class="token function" style="color:#d73a49">sh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ip a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">: lo: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">LOOPBACK,UP,LOWER_UP</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:#36acaa">65536</span><span class="token plain"> qdisc noqueue state UNKNOWN group default qlen </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1/8 scope </span><span class="token function" style="color:#d73a49">host</span><span class="token plain"> lo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet6 ::1/128 scope </span><span class="token function" style="color:#d73a49">host</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">23</span><span class="token plain">: eth0@if24: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">BROADCAST,MULTICAST,UP,LOWER_UP</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:#36acaa">1500</span><span class="token plain"> qdisc noqueue state UP group default </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/ether 02:42:ac:12:00:03 brd ff:ff:ff:ff:ff:ff link-netnsid </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.0.3/16 brd </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.255.255 scope global eth0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet6 fc00:f853:ccd:e793::3/64 scope global nodad </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet6 fe80::42:acff:fe12:3/64 scope </span><span class="token function" style="color:#d73a49">link</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="multus-ì„¤ì¹˜">Multus ì„¤ì¹˜<a class="hash-link" href="#multus-ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h2><p>MultusëŠ” <code>CRD</code>, <code>clusterrole</code>, <code>clusterrolebinding</code>, <code>serviceaccount</code>, <code>configmap</code>, <code>daemonset</code>ì„ ì„¤ì¹˜í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì„¤ì¹˜í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl apply -f https://raw.githubusercontent.com/k8snetworkplumbingwg/multus-cni/master/deployments/multus-daemonset.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">customresourcedefinition.apiextensions.k8s.io/network-attachment-definitions.k8s.cni.cncf.io created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusterrole.rbac.authorization.k8s.io/multus created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusterrolebinding.rbac.authorization.k8s.io/multus created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">serviceaccount/multus created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">configmap/multus-cni-config created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">daemonset.apps/kube-multus-ds created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kokoë¥¼-ì‚¬ìš©í•œ-ë…¸ë“œê°„-í†µì‹ -ì„¤ì •"><code>koko</code>ë¥¼ ì‚¬ìš©í•œ ë…¸ë“œê°„ í†µì‹  ì„¤ì •<a class="hash-link" href="#kokoë¥¼-ì‚¬ìš©í•œ-ë…¸ë“œê°„-í†µì‹ -ì„¤ì •" title="Direct link to heading">â€‹</a></h2><p><code>koko</code>ëŠ” Docker ì»¨í…Œì´ë„ˆ ë˜ëŠ” Linux ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ê°„ì— veth ì¥ì¹˜ë¥¼ ì‚¬ìš©í•˜ì—¬ í¬ì¸íŠ¸ íˆ¬ í¬ì¸íŠ¸ ì—°ê²°ì„ ì„¤ì •í•˜ëŠ” ë„êµ¬ì´ë‹¤. kokoëŠ” í•˜ë‚˜ì˜ í˜¸ìŠ¤íŠ¸ì—ì„œ ë‘ ê°œì˜ ì»¨í…Œì´ë„ˆì— ëŒ€í•´ì„œëŠ” vethë¥¼, ë³„ë„ì˜ í˜¸ìŠ¤íŠ¸ì—ì„œ ë‘ ê°œì˜ ì»¨í…Œì´ë„ˆì— ëŒ€í•´ì„œëŠ” vxlanë¡œ ì—°ê²°ì„ ì§€ì›í•œë‹¤. </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="koko-ì„¤ì¹˜">koko ì„¤ì¹˜<a class="hash-link" href="#koko-ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h3><p>í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•  ë…¸ë“œì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ <code>koko</code>ë¥¼ ì„¤ì¹˜í•œë‹¤. <code>koko</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆ í˜¸ìŠ¤íŠ¸ì—ì„œ ì»¨í…Œì´ë„ˆë¥¼ ì—°ê²°í•˜ëŠ” ë°©ë²•ì€ vethë¥¼ ì‚¬ìš©í•œë‹¤. <a href="https://github.com/redhat-nfvpe/koko/blob/main/docs/Connecting-containers-in-container-host-using-veth.md" target="_blank" rel="noopener noreferrer">Connecting containers in container host using veth</a> ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ë©´ ëœë‹¤. </p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">./koko </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">-c </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">linkname</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        -d </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">container</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">,</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">linkname</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">,</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">IP addr</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">prefixlen</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">,</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        -n </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">netns name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">,</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">linkname</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">,</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">IP addr</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">prefixlen</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">,</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        -p </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">pid</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">,</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">linkname</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">,</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">IP addr</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">prefixlen</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">,</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        -c </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">linkname</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">-d </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">container</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">,</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">linkname</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">,</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">IP addr</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">prefixlen</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">,</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        -n </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">netns name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">,</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">linkname</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">,</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">IP addr</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">prefixlen</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">,</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        -p </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">pid</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">,</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">linkname</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">,</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">IP addr</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">prefixlen</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">,</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        -c </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">linkname</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -LO https://github.com/redhat-nfvpe/koko/releases/download/v0.83/koko_0.83_linux_amd64</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë‹¤ìš´ë°›ì€ koko íŒŒì¼ì— ì‹¤í–‰ ê¶Œí•œì„ ì¶”ê°€í•˜ê³ , sudo ê¶Œí•œìœ¼ë¡œ ê° ë…¸ë“œ ì»¨í…Œì´ë„ˆì— <code>eth1</code> ì¸í„°í˜ì´ìŠ¤ë¥¼ ì¶”ê°€í•˜ëŠ” ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•œë‹¤. ì•„ë˜ ëª…ë ¹ì–´ëŠ” <code>multus-cluster-worker</code>ì™€ <code>multus-cluster-worker2</code>ë¼ëŠ” ë‘ Kind ë…¸ë“œ ê°„ì— veth í˜ì–´ë¥¼ ìƒì„±í•˜ê³ , ê° ë…¸ë“œì— ì¸í„°í˜ì´ìŠ¤ë¥¼ í• ë‹¹í•˜ê²Œ ëœë‹¤. </p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> +x koko_0.83_linux_amd64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> ./koko_0.83_linux_amd64 -d multus-cluster-worker,eth1 -d multus-cluster-worker2,eth1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Create veth</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.done</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>"Create veth...done" ë©”ì‹œì§€ëŠ” ì‹¤ì œë¡œ ìƒˆ vethê°€ ìƒì„±ë˜ì—ˆë‹¤ê¸° ë³´ë‹¤ëŠ” pairê°€ ìƒì„±ë˜ì–´ì„œ ê¸°ì¡´ docker bridgeì— ì—°ê²°ëœ vethì— ê° ë…¸ë“œ ì»¨í…Œì´ë„ˆì˜ <code>eth1</code> ì¸í„°í˜ì´ìŠ¤ê°€ ë§¤í•‘ë˜ì–´ ì¶”ê°€ëœ ê²ƒì´ë‹¤. ìƒì„¸ ì½”ë“œëŠ” <a href="https://github.com/redhat-nfvpe/koko/blob/bbe26f6c7e0124815573e22a2f28ff70bfd0db61/koko.go#L595" target="_blank" rel="noopener noreferrer">koko.go íŒŒì¼</a>ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><p><code>ip a</code> ëª…ë ¹ì–´ë¡œ ì¸í„°í˜ì´ìŠ¤ ì •ë³´ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ë³´ë©´, ê° ë…¸ë“œ ì»¨í…Œì´ë„ˆì— ìƒˆë¡œìš´ <code>eth1</code> ì¸í„°í˜ì´ìŠ¤ê°€ ì¶”ê°€ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> </span><span class="token builtin class-name">exec</span><span class="token plain"> -it multus-cluster-worker </span><span class="token function" style="color:#d73a49">ip</span><span class="token plain"> a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">: lo: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">LOOPBACK,UP,LOWER_UP</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:#36acaa">65536</span><span class="token plain"> qdisc noqueue state UNKNOWN group default qlen </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1/8 scope </span><span class="token function" style="color:#d73a49">host</span><span class="token plain"> lo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet6 ::1/128 scope </span><span class="token function" style="color:#d73a49">host</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">23</span><span class="token plain">: eth0@if24: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">BROADCAST,MULTICAST,UP,LOWER_UP</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:#36acaa">1500</span><span class="token plain"> qdisc noqueue state UP group default </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/ether 02:42:ac:12:00:03 brd ff:ff:ff:ff:ff:ff link-netnsid </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.0.3/16 brd </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.255.255 scope global eth0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet6 fc00:f853:ccd:e793::3/64 scope global nodad </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet6 fe80::42:acff:fe12:3/64 scope </span><span class="token function" style="color:#d73a49">link</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">28</span><span class="token plain">: eth1@if27: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">BROADCAST,MULTICAST,UP,LOWER_UP</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:#36acaa">1500</span><span class="token plain"> qdisc noqueue state UP group default </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/ether 3e:da:c1:0e:3a:5d brd ff:ff:ff:ff:ff:ff link-netnsid </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet6 fe80::3cda:c1ff:fe0e:3a5d/64 scope </span><span class="token function" style="color:#d73a49">link</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="cni-ë ˆí¼ëŸ°ìŠ¤-í”ŒëŸ¬ê·¸ì¸-ì„¤ì¹˜">CNI ë ˆí¼ëŸ°ìŠ¤ í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜<a class="hash-link" href="#cni-ë ˆí¼ëŸ°ìŠ¤-í”ŒëŸ¬ê·¸ì¸-ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h2><p><a href="https://github.com/containernetworking/plugins" target="_blank" rel="noopener noreferrer">CNI ë ˆí¼ëŸ°ìŠ¤ í”ŒëŸ¬ê·¸ì¸</a>ì€ ì»¨í…Œì´ë„ˆ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤(Container Network Interface)ì˜ í‘œì¤€ êµ¬í˜„ì²´ì´ë‹¤. ì´ í”ŒëŸ¬ê·¸ì¸ë“¤ì€ Kubernetesì™€ ê°™ì€ ì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ í”Œë«í¼ì—ì„œ ë„¤íŠ¸ì›Œí¬ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤. CNI ë ˆí¼ëŸ°ìŠ¤ í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•¨ìœ¼ë¡œì¨ í´ëŸ¬ìŠ¤í„° ê´€ë¦¬ìëŠ” ë‹¤ì–‘í•œ ë„¤íŠ¸ì›Œí‚¹ ìš”êµ¬ì‚¬í•­ì„ ì¶©ì¡±ì‹œí‚¤ê³ , ì»¨í…Œì´ë„ˆ ê°„ í†µì‹ ì„ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤. ì´ë²ˆ í…ŒìŠ¤íŠ¸ì—ì„œëŠ” macvlan êµ¬ì„±ì„ ì§„í–‰í•˜ì—¬ ìƒˆë¡œìš´ MAC ì£¼ì†Œë¥¼ ìƒì„±í•˜ê³ , ëª¨ë“  íŠ¸ë˜í”½ì„ í•´ë‹¹ ì»¨í…Œì´ë„ˆë¡œ ì „ë‹¬í•˜ëŠ” ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤. ì„¤ì¹˜ëŠ” ë‹¤ìŒ yamlë¥¼ ì‚¬ìš©í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ConfigMap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">install</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kube</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">install_cni.sh</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    cd /tmp</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    wget https://github.com/containernetworking/plugins/releases/download/v1.5.1/cni-plugins-linux-amd64-v1.5.1.tgz</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    cd /host/opt/cni/bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    tar xvfzp /tmp/cni-plugins-linux-amd64-v1.5.1.tgz</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    sleep infinite</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apps/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> DaemonSet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> install</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kube</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">matchLabels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">template</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">hostNetwork</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">nodeSelector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">kubernetes.io/arch</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> amd64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">tolerations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">operator</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">effect</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> NoSchedule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> install</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> alpine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">"/bin/sh"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"/scripts/install_cni.sh"</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">requests</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">cpu</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"100m"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">memory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"50Mi"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">limits</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">cpu</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"100m"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">memory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"50Mi"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">securityContext</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">privileged</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">volumeMounts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /host/opt/cni/bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> scripts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /scripts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">hostPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt/cni/bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> scripts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">configMap</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">install</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">items</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> install_cni.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> install_cni.sh</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>cni ì¸ìŠ¤í†¨ì„ ì„¤ì¹˜í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ëŠ” cni-install-sh configmapì— ì •ì˜ë˜ì–´ ìˆë‹¤. í•´ë‹¹ í”ŒëŸ¬ê·¸ì¸ì€ ë…¸ë“œë§ˆë‹¤ ì„¤ì¹˜ë˜ì–´ì•¼ í•˜ë¯€ë¡œ daemonsetìœ¼ë¡œ ì„¤ì¹˜í•œë‹¤. ê¸€ì“°ëŠ” ë‹¹ì‹œì˜ ìµœì‹  ë²„ì „ì¸ 1.5.1ìœ¼ë¡œ ì„¤ì¹˜í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create -f cni.yaml </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">configmap/cni-install-sh created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">daemonset.apps/install-cni-plugins created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="macvlanì„-ì‚¬ìš©í•˜ì—¬-ë‘-ê°œì˜-ì»¨í…Œì´ë„ˆ-ìƒì„±">macvlanì„ ì‚¬ìš©í•˜ì—¬ ë‘ ê°œì˜ ì»¨í…Œì´ë„ˆ ìƒì„±<a class="hash-link" href="#macvlanì„-ì‚¬ìš©í•˜ì—¬-ë‘-ê°œì˜-ì»¨í…Œì´ë„ˆ-ìƒì„±" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="macvlan">macvlan<a class="hash-link" href="#macvlan" title="Direct link to heading">â€‹</a></h3><p><code>macvlan</code>ì€ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ ê°€ìƒí™”í•˜ì—¬ ì—¬ëŸ¬ ê°œì˜ ê°€ìƒ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ ìƒì„±í•  ìˆ˜ ìˆëŠ” ê¸°ìˆ ì´ë‹¤. ì´ë¥¼ í†µí•´ ê° ì»¨í…Œì´ë„ˆê°€ ê³ ìœ í•œ MAC ì£¼ì†Œë¥¼ ê°€ì§€ë©°, ë¬¼ë¦¬ ë„¤íŠ¸ì›Œí¬ì™€ ì§ì ‘ í†µì‹ í•  ìˆ˜ ìˆë‹¤. macvlanì€ Parent Intefaceë¥¼ ì´ìš©í•˜ì—¬ ì—¬ëŸ¬ê°œì˜ Child Interfaceë¥¼ ìƒì„±í•œë‹¤. Child InterfaceëŠ” ê°ê° ë³„ë„ì˜ MAC Addressì™€ macvlan Modeë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë‹¤. Modeì— ë”°ë¼ì„œ Child Intefaceê°„ì˜ í†µì‹ ì€ ê°€ëŠ¥í•˜ì§€ë§Œ, Modeì— ê´€ê³„ì—†ì´ Parent Interfaceì™€ Child InterfaceëŠ” ì„œë¡œ ì ˆëŒ€ë¡œ í†µì‹ ì´ ë¶ˆê°€ëŠ¥í•œê²Œ macvlanì˜ íŠ¹ì§• ì¤‘ í•˜ë‚˜ì´ë‹¤.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="networkattachmentdefinition">NetworkAttachmentDefinition<a class="hash-link" href="#networkattachmentdefinition" title="Direct link to heading">â€‹</a></h3><p><code>NetworkAttachmentDefinition</code>ì€ Multus CNIë¥¼ ì‚¬ìš©í•˜ì—¬ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì¶”ê°€í•  ë•Œ ì‚¬ìš©ë˜ëŠ” ì˜¤ë¸Œì íŠ¸ì´ë‹¤. ì´ë¥¼ í†µí•´ ì»¨í…Œì´ë„ˆì— ì¶”ê°€ì ì¸ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ í• ë‹¹í•  ìˆ˜ ìˆë‹¤. ì•„ë˜ì™€ ê°™ì´ macvlanì„ ì‚¬ìš©í•˜ì—¬ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì¶”ê°€í•´ë³´ì.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"k8s.cni.cncf.io/v1"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> NetworkAttachmentDefinition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> macvlan</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> '</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">"cniVersion"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0.3.1"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">"plugins"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">"type"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"macvlan"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">"capabilities"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">"ips"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">"master"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"eth1"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">"mode"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"bridge"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">"ipam"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">"type"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"static"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">"routes"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">"dst"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0.0.0.0/0"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">"gw"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"10.1.1.1"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">"capabilities"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">"mac"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">"type"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"tuning"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">'</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´ <code>NetworkAttachmentDefinition</code>ì˜ ê° ë¶€ë¶„ì„ í•˜ë‚˜ì”© ì‚´í´ë³´ì. ì´ êµ¬ì„±ì€ <code>macvlan</code>ì„ ì‚¬ìš©í•˜ì—¬ ìƒˆë¡œìš´ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ ìƒì„±í•˜ê³ , ì •ì  IP í• ë‹¹ ë° ë¼ìš°íŒ…ì„ ì„¤ì •í•œë‹¤. ë˜í•œ <code>tuning</code> í”ŒëŸ¬ê·¸ì¸ì„ í†µí•´ MAC ì£¼ì†Œ ì„¤ì • ê¸°ëŠ¥ì„ ì¶”ê°€ë¡œ ì œê³µí•˜ê²Œ ëœë‹¤. </p><ul><li>name: "macvlan-conf"ë¡œ ì´ <code>NetworkAttachmentDefinition</code>ì˜ ì´ë¦„ì„ ì§€ì •í•œë‹¤.</li><li>cniVersion: ì‚¬ìš©ë˜ëŠ” CNI ìŠ¤í™ ë²„ì „ì„ ë‚˜íƒ€ë‚¸ë‹¤. ì—¬ê¸°ì„œëŠ” 0.3.1 ë²„ì „ì„ ì‚¬ìš©í•œë‹¤.</li><li>plugins: CNI í”ŒëŸ¬ê·¸ì¸ ëª©ë¡ì„ ì •ì˜í•œë‹¤.<ul><li>type: "macvlan" í”ŒëŸ¬ê·¸ì¸ ì‚¬ìš©</li><li>capabilities: IP ì£¼ì†Œ í• ë‹¹ ê¸°ëŠ¥ í™œì„±í™”</li><li>master: "eth1"ì„ ë§ˆìŠ¤í„° ì¸í„°í˜ì´ìŠ¤ë¡œ ì‚¬ìš©</li><li>mode: "bridge" ëª¨ë“œë¡œ ë™ì‘</li><li>ipam: IP ì£¼ì†Œ ê´€ë¦¬ ì„¤ì •<ul><li>type: "static"ìœ¼ë¡œ ì •ì  IP í• ë‹¹ ì‚¬ìš©</li><li>routes: ê¸°ë³¸ ë¼ìš°íŠ¸ ì„¤ì • (ê²Œì´íŠ¸ì›¨ì´: 10.1.1.1)</li></ul></li><li>capabilities: MAC ì£¼ì†Œ ì„¤ì • ê¸°ëŠ¥ í™œì„±í™”</li><li>type: "tuning" í”ŒëŸ¬ê·¸ì¸ì€ MAC ì£¼ì†Œ ì„¤ì • ê¸°ëŠ¥ì„ í™œì„±í™”í•˜ê¸° ìœ„í•´ ì‚¬ìš©</li></ul></li></ul><p><code>NetworkAttachmentDefinition</code> ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl apply -f nad.yaml </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">networkattachmentdefinition.k8s.cni.cncf.io/macvlan-conf created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ëª¨ë“  ì¤€ë¹„ê°€ ì™„ë£Œë˜ì—ˆë‹¤. ì´ì œ ë©€í‹° ë„¤íŠ¸ì›Œí¬ íŒŒë“œë¥¼ ìƒì„±í•´ë³´ì. </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ë©€í‹°-ë„¤íŠ¸ì›Œí¬-íŒŒë“œ-ìƒì„±">ë©€í‹° ë„¤íŠ¸ì›Œí¬ íŒŒë“œ ìƒì„±<a class="hash-link" href="#ë©€í‹°-ë„¤íŠ¸ì›Œí¬-íŒŒë“œ-ìƒì„±" title="Direct link to heading">â€‹</a></h3><p>ë©€í‹° ë„¤íŠ¸ì›Œí¬ íŒŒë“œë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ì„œëŠ” <code>annotations</code>ì— ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì¶”ê°€í•´ì•¼ í•œë‹¤. ì´ì „ì— êµ¬ì„±í–ˆë˜ macvlan-confë¥¼ ì¶”ê°€í•˜ê³ , ê° íŒŒë“œì— í• ë‹¹ë  IP ì£¼ì†Œì™€ ê²Œì´íŠ¸ì›¨ì´ë¥¼ ì„¤ì •í•œë‹¤. ê·¸ë¦¬ê³  <code>netshoot</code> ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒë“œë¥¼ ìƒì„±í•œë‹¤. ë˜í•œ íŒŒë“œì— ëŒ€í•œ ë„¤íŠ¸ì›Œí¬ ëª…ë ¹ì–´ ì‹¤í–‰ì„ ìœ„í•´ <code>securityContext</code>ë¥¼ í†µí•´ íŒŒë“œì— ëŒ€í•œ ê¶Œí•œì„ ì„¤ì •í•˜ê³ , íŒŒë“œê°€ ì¢…ë£Œë  ë•Œ ìì›ì„ ì •ë¦¬í•˜ëŠ” ì„¤ì •ì„ í•œë‹¤. ê·¸ë¦¬ê³  ê° ë…¸ë“œì— ëŒ€í•œ ì„ íƒê³¼ í†µì‹  í™•ì¸ì„ ìœ„í•´ <code>nodeSelector</code> ì„¤ì •ìœ¼ë¡œ ì´ë¯¸ êµ¬ì„±í•œ ê° ë…¸ë“œ ì»¨í…Œì´ë„ˆì— íŒŒë“œë¥¼ ë°°ì¹˜í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> pod1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">annotations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">k8s.v1.cni.cncf.io/networks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> '</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">"name"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"macvlan-conf"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">"ips"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"10.1.1.101/24"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">"gateway"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"10.1.1.1"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> pod1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nicolaka/netshoot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">"tail"</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">args</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">"-f"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"/dev/null"</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">securityContext</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">privileged</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">terminationGracePeriodSeconds</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">nodeSelector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">kubernetes.io/hostname</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> multus</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cluster</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">worker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> pod2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">annotations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">k8s.v1.cni.cncf.io/networks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> '</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">"name"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"macvlan-conf"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">"ips"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"10.1.1.102/24"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">"gateway"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"10.1.1.1"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> pod2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nicolaka/netshoot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">"tail"</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">args</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">"-f"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"/dev/null"</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">securityContext</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">privileged</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">terminationGracePeriodSeconds</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">nodeSelector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">kubernetes.io/hostname</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> multus</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cluster</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">worker2</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>íŒŒë“œë¥¼ ìƒì„±í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl apply -f pod.yaml                                                                   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/pod1 created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/pod2 created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="íŒŒë“œê°„-ì‹ ê·œ-ë„¤íŠ¸ì›Œí¬-ì¸í„°í˜ì´ìŠ¤-í†µì‹ -í™•ì¸">íŒŒë“œê°„ ì‹ ê·œ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ í†µì‹  í™•ì¸<a class="hash-link" href="#íŒŒë“œê°„-ì‹ ê·œ-ë„¤íŠ¸ì›Œí¬-ì¸í„°í˜ì´ìŠ¤-í†µì‹ -í™•ì¸" title="Direct link to heading">â€‹</a></h2><p>ë¨¼ì € íŒŒë“œì— í• ë‹¹ëœ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ í™•ì¸í•œë‹¤. ë¨¼ì € ì•„í‚¤í…ì²˜ êµ¬ì„±ë„ì— ë”°ë¼ì„œ íŒŒë“œì— í• ë‹¹ëœ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ í™•ì¸ í•  ìˆ˜ ìˆë‹¤. eth0ì€ ë…¸ë“œì˜ ê¸°ì¡´ kindnet ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ì´ê³ , net1ì€ multusì— ì˜í•´ ìƒˆë¡œ ìƒì„±ëœ macvlan ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ì´ë‹¤.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> -it pod1 -- </span><span class="token function" style="color:#d73a49">ip</span><span class="token plain"> a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">: lo: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">LOOPBACK,UP,LOWER_UP</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:#36acaa">65536</span><span class="token plain"> qdisc noqueue state UNKNOWN group default qlen </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1/8 scope </span><span class="token function" style="color:#d73a49">host</span><span class="token plain"> lo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet6 ::1/128 scope </span><span class="token function" style="color:#d73a49">host</span><span class="token plain"> proto kernel_lo </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2</span><span class="token plain">: eth0@if2: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">BROADCAST,MULTICAST,UP,LOWER_UP</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:#36acaa">1500</span><span class="token plain"> qdisc noqueue state UP group default </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/ether ba:aa:3b:d1:7c:50 brd ff:ff:ff:ff:ff:ff link-netnsid </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet </span><span class="token number" style="color:#36acaa">10.244</span><span class="token plain">.1.2/24 brd </span><span class="token number" style="color:#36acaa">10.244</span><span class="token plain">.1.255 scope global eth0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet6 fe80::b8aa:3bff:fed1:7c50/64 scope </span><span class="token function" style="color:#d73a49">link</span><span class="token plain"> proto kernel_ll </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3</span><span class="token plain">: net1@if20: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">BROADCAST,MULTICAST,UP,LOWER_UP</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:#36acaa">1500</span><span class="token plain"> qdisc noqueue state UP group default </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/ether a6:64:d5:ee:c4:91 brd ff:ff:ff:ff:ff:ff link-netnsid </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet </span><span class="token number" style="color:#36acaa">10.1</span><span class="token plain">.1.101/24 brd </span><span class="token number" style="color:#36acaa">10.1</span><span class="token plain">.1.255 scope global net1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet6 fe80::a464:d5ff:feee:c491/64 scope </span><span class="token function" style="color:#d73a49">link</span><span class="token plain"> proto kernel_ll </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> -it pod2 -- </span><span class="token function" style="color:#d73a49">ip</span><span class="token plain"> a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">: lo: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">LOOPBACK,UP,LOWER_UP</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:#36acaa">65536</span><span class="token plain"> qdisc noqueue state UNKNOWN group default qlen </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1/8 scope </span><span class="token function" style="color:#d73a49">host</span><span class="token plain"> lo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet6 ::1/128 scope </span><span class="token function" style="color:#d73a49">host</span><span class="token plain"> proto kernel_lo </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2</span><span class="token plain">: eth0@if2: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">BROADCAST,MULTICAST,UP,LOWER_UP</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:#36acaa">1500</span><span class="token plain"> qdisc noqueue state UP group default </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/ether fa:82:35:f3:28:62 brd ff:ff:ff:ff:ff:ff link-netnsid </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet </span><span class="token number" style="color:#36acaa">10.244</span><span class="token plain">.2.2/24 brd </span><span class="token number" style="color:#36acaa">10.244</span><span class="token plain">.2.255 scope global eth0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet6 fe80::f882:35ff:fef3:2862/64 scope </span><span class="token function" style="color:#d73a49">link</span><span class="token plain"> proto kernel_ll </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3</span><span class="token plain">: net1@if19: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">BROADCAST,MULTICAST,UP,LOWER_UP</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:#36acaa">1500</span><span class="token plain"> qdisc noqueue state UP group default </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/ether 7e:af:c9:aa:18:8b brd ff:ff:ff:ff:ff:ff link-netnsid </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet </span><span class="token number" style="color:#36acaa">10.1</span><span class="token plain">.1.102/24 brd </span><span class="token number" style="color:#36acaa">10.1</span><span class="token plain">.1.255 scope global net1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet6 fe80::7caf:c9ff:feaa:188b/64 scope </span><span class="token function" style="color:#d73a49">link</span><span class="token plain"> proto kernel_ll </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë…¸ë“œì—ì„œ í™•ì¸í•´ë³´ë©´ íŒŒë“œì— í• ë‹¹ëœ <code>veth</code> ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ê°€ ì¶”ê°€ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> </span><span class="token builtin class-name">exec</span><span class="token plain"> -it multus-cluster-worker </span><span class="token function" style="color:#d73a49">ip</span><span class="token plain"> a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">: lo: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">LOOPBACK,UP,LOWER_UP</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:#36acaa">65536</span><span class="token plain"> qdisc noqueue state UNKNOWN group default qlen </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1/8 scope </span><span class="token function" style="color:#d73a49">host</span><span class="token plain"> lo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet6 ::1/128 scope </span><span class="token function" style="color:#d73a49">host</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2</span><span class="token plain">: veth3775384b@if2: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">BROADCAST,MULTICAST,UP,LOWER_UP</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:#36acaa">1500</span><span class="token plain"> qdisc noqueue state UP group default </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/ether </span><span class="token number" style="color:#36acaa">52</span><span class="token plain">:f5:78:4b:a1:0b brd ff:ff:ff:ff:ff:ff link-netns cni-2632d959-3e52-354c-cde2-3b5e27ba6d86</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet </span><span class="token number" style="color:#36acaa">10.244</span><span class="token plain">.1.1/32 scope global veth3775384b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet6 fe80::50f5:78ff:fe4b:a10b/64 scope </span><span class="token function" style="color:#d73a49">link</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">23</span><span class="token plain">: eth0@if24: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">BROADCAST,MULTICAST,UP,LOWER_UP</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:#36acaa">1500</span><span class="token plain"> qdisc noqueue state UP group default </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/ether 02:42:ac:12:00:03 brd ff:ff:ff:ff:ff:ff link-netnsid </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.0.3/16 brd </span><span class="token number" style="color:#36acaa">172.18</span><span class="token plain">.255.255 scope global eth0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet6 fc00:f853:ccd:e793::3/64 scope global nodad </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet6 fe80::42:acff:fe12:3/64 scope </span><span class="token function" style="color:#d73a49">link</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">28</span><span class="token plain">: eth1@if27: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">BROADCAST,MULTICAST,UP,LOWER_UP</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:#36acaa">1500</span><span class="token plain"> qdisc noqueue state UP group default </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/ether 3e:da:c1:0e:3a:5d brd ff:ff:ff:ff:ff:ff link-netnsid </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet6 fe80::3cda:c1ff:fe0e:3a5d/64 scope </span><span class="token function" style="color:#d73a49">link</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê° íŒŒë“œì—ì„œ ì‹ ê·œë¡œ ì¶”ê°€ëœ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¡œì˜ í†µì‹ ì„ í™•ì¸í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> -it pod1 -- </span><span class="token function" style="color:#d73a49">ping</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10.1</span><span class="token plain">.1.102</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PING </span><span class="token number" style="color:#36acaa">10.1</span><span class="token plain">.1.102 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10.1</span><span class="token plain">.1.102</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">56</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">84</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> bytes of data.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> bytes from </span><span class="token number" style="color:#36acaa">10.1</span><span class="token plain">.1.102: </span><span class="token assign-left variable" style="color:#36acaa">icmp_seq</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">ttl</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">time</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.065</span><span class="token plain"> ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> bytes from </span><span class="token number" style="color:#36acaa">10.1</span><span class="token plain">.1.102: </span><span class="token assign-left variable" style="color:#36acaa">icmp_seq</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">ttl</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">time</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.034</span><span class="token plain"> ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> bytes from </span><span class="token number" style="color:#36acaa">10.1</span><span class="token plain">.1.102: </span><span class="token assign-left variable" style="color:#36acaa">icmp_seq</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">ttl</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">time</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.035</span><span class="token plain"> ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> -it pod2 -- </span><span class="token function" style="color:#d73a49">ping</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10.1</span><span class="token plain">.1.101</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PING </span><span class="token number" style="color:#36acaa">10.1</span><span class="token plain">.1.101 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10.1</span><span class="token plain">.1.101</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">56</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">84</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> bytes of data.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> bytes from </span><span class="token number" style="color:#36acaa">10.1</span><span class="token plain">.1.101: </span><span class="token assign-left variable" style="color:#36acaa">icmp_seq</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">ttl</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">time</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.027</span><span class="token plain"> ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> bytes from </span><span class="token number" style="color:#36acaa">10.1</span><span class="token plain">.1.101: </span><span class="token assign-left variable" style="color:#36acaa">icmp_seq</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">ttl</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">time</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.032</span><span class="token plain"> ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> bytes from </span><span class="token number" style="color:#36acaa">10.1</span><span class="token plain">.1.101: </span><span class="token assign-left variable" style="color:#36acaa">icmp_seq</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">ttl</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">time</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.026</span><span class="token plain"> ms</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì›ë˜ CNIë¥¼ í†µí•´ í• ë‹¹ëœ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ëŠ” íŒŒë“œê°„ í†µì‹ ë„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> -it pod1 -- </span><span class="token function" style="color:#d73a49">ping</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10.244</span><span class="token plain">.2.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PING </span><span class="token number" style="color:#36acaa">10.244</span><span class="token plain">.2.2 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10.244</span><span class="token plain">.2.2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">56</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">84</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> bytes of data.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> bytes from </span><span class="token number" style="color:#36acaa">10.244</span><span class="token plain">.2.2: </span><span class="token assign-left variable" style="color:#36acaa">icmp_seq</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">ttl</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">62</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">time</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.136</span><span class="token plain"> ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> bytes from </span><span class="token number" style="color:#36acaa">10.244</span><span class="token plain">.2.2: </span><span class="token assign-left variable" style="color:#36acaa">icmp_seq</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">ttl</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">62</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">time</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.081</span><span class="token plain"> ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> bytes from </span><span class="token number" style="color:#36acaa">10.244</span><span class="token plain">.2.2: </span><span class="token assign-left variable" style="color:#36acaa">icmp_seq</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">ttl</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">62</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">time</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.079</span><span class="token plain"> ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> -it pod2 -- </span><span class="token function" style="color:#d73a49">ping</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10.244</span><span class="token plain">.2.1                                                    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PING </span><span class="token number" style="color:#36acaa">10.244</span><span class="token plain">.2.1 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10.244</span><span class="token plain">.2.1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">56</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">84</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> bytes of data.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> bytes from </span><span class="token number" style="color:#36acaa">10.244</span><span class="token plain">.2.1: </span><span class="token assign-left variable" style="color:#36acaa">icmp_seq</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">ttl</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">time</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.041</span><span class="token plain"> ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> bytes from </span><span class="token number" style="color:#36acaa">10.244</span><span class="token plain">.2.1: </span><span class="token assign-left variable" style="color:#36acaa">icmp_seq</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">ttl</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">time</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.045</span><span class="token plain"> ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> bytes from </span><span class="token number" style="color:#36acaa">10.244</span><span class="token plain">.2.1: </span><span class="token assign-left variable" style="color:#36acaa">icmp_seq</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">ttl</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">time</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.031</span><span class="token plain"> ms</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ì´ í¬ìŠ¤íŠ¸ì—ì„œëŠ” Kind í´ëŸ¬ìŠ¤í„°ì— Multusë¥¼ ì„¤ì¹˜í•˜ê³  kokoë¥¼ ì‚¬ìš©í•˜ì—¬ ë…¸ë“œ ê°„ ë©€í‹° ë„¤íŠ¸ì›Œí¬ í™˜ê²½ì„ êµ¬ì„±í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë´¤ë‹¤. ì£¼ìš” ë‚´ìš©ì„ ìš”ì•½í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.</p><ol><li>Kindë¥¼ ì‚¬ìš©í•˜ì—¬ í•˜ë‚˜ì˜ í˜¸ìŠ¤íŠ¸ì—ì„œ Kubernetes í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•œë‹¤.</li><li>Multus CNIë¥¼ ì„¤ì¹˜í•˜ì—¬ ë‹¤ì¤‘ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ ì§€ì›ì„ ì¶”ê°€í•œë‹¤.</li><li>koko ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ë…¸ë“œ ê°„ ì§ì ‘ í†µì‹ ì„ ìœ„í•œ veth í˜ì–´ë¥¼ ìƒì„±í•œë‹¤.</li><li>CNI ë ˆí¼ëŸ°ìŠ¤ í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•˜ì—¬ macvlan ë„¤íŠ¸ì›Œí¬ë¥¼ êµ¬ì„±í•œë‹¤.</li><li>NetworkAttachmentDefinitionì„ ìƒì„±í•˜ì—¬ Multusì— macvlan ë„¤íŠ¸ì›Œí¬ë¥¼ ì •ì˜í•œë‹¤.</li><li>í…ŒìŠ¤íŠ¸ìš© íŒŒë“œë¥¼ ë°°í¬í•˜ì—¬ ì¶”ê°€ëœ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•œ í†µì‹ ì„ í™•ì¸í•œë‹¤.</li></ol><p>ì´ êµ¬ì„±ì„ í†µí•´ ë‹¨ì¼ Kind í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ ë‹¤ì¤‘ ë„¤íŠ¸ì›Œí¬ í™˜ê²½ì„ ì‹œë®¬ë ˆì´ì…˜í•  ìˆ˜ ìˆì—ˆë‹¤. ì´ëŠ” ë³µì¡í•œ ë„¤íŠ¸ì›Œí¬ í† í´ë¡œì§€ê°€ í•„ìš”í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œ ë° í…ŒìŠ¤íŠ¸ì— ìœ ìš©í•  ìˆ˜ ìˆë‹¤. íŠ¹íˆ 5G ë„¤íŠ¸ì›Œí¬ë‚˜ NFV í™˜ê²½ê³¼ ê°™ì´ ê³ ì„±ëŠ¥ ë„¤íŠ¸ì›Œí‚¹ì´ í•„ìš”í•œ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ì´ëŸ¬í•œ ì„¤ì •ì´ ë„ì›€ì´ ë  ìˆ˜ ìˆë‹¤.</p><p>ì´ ì ‘ê·¼ ë°©ì‹ì€ ê°œë°œ ë° í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ìœ ìš©í•˜ì§€ë§Œ, í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” ì¶”ê°€ì ì¸ ê³ ë ¤ì‚¬í•­ê³¼ ìµœì í™”ê°€ í•„ìš”í•  ìˆ˜ ìˆë‹¤. ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ, ì„±ëŠ¥, í™•ì¥ì„± ë“±ì˜ ì¸¡ë©´ì—ì„œ ë” ê¹Šì´ ìˆëŠ” ê²€í† ê°€ í•„ìš”í•  ê²ƒì´ë‹¤.</p><p>ì´ˆë°˜ì— ë©€í‹° ë„¤íŠ¸ì›Œí¬ CNIë¥¼ ì‚¬ìš©í•´ì„œ íŒ¨í‚·ì„ ë¯¸ëŸ¬ë§í•˜ê³  í•´ë‹¹ íŒ¨í‚·ì„ ë¶„ì„í•˜ëŠ” í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í–ˆì—ˆë‹¤ëŠ” ë‚´ìš©ì„ ì–¸ê¸‰í–ˆì—ˆëŠ”ë°, ë‹¤ìŒ í¬ìŠ¤íŒ…ì—ì„œëŠ” multusì™€ ì»¨í…Œì´ë„ˆ ë¯¸ëŸ¬ë§ ë„êµ¬ë¡œ íŒ¨í‚·ì„ ë¯¸ëŸ¬ë§í•˜ê³  pcap exporterë¥¼ ì‚¬ìš©í•´ì„œ íŒ¨í‚·ì˜ 5-tuple ì •ë³´ë¥¼ ë¶„ì„í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì ì–´ë³´ë ¤ê³  í•œë‹¤.</p>]]></content>
        <author>
            <name>Jinwoong Kim</name>
            <uri>https://www.linkedin.com/in/ddiiwoong/</uri>
        </author>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="multus" term="multus"/>
        <category label="cni" term="cni"/>
        <category label="kind" term="kind"/>
        <category label="multiple network" term="multiple network"/>
        <category label="macvlan" term="macvlan"/>
        <category label="koko" term="koko"/>
        <category label="kindnet" term="kindnet"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[íŒŒë“œ Readiness & Probe]]></title>
        <id>kubernetes/readinessandprobe/</id>
        <link href="https://ddii.dev/kubernetes/readinessandprobe/"/>
        <updated>2024-09-08T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[íŒŒë“œ Readiness & Probeë¥¼ í†µí•œ ìƒíƒœ ëª¨ë‹ˆí„°ë§]]></summary>
        <content type="html"><![CDATA[<p>Kubernetesì—ì„œ íŒŒë“œì˜ Readiness ë° í”„ë¡œë¸ŒëŠ” íŒŒë“œì˜ ìƒíƒœë¥¼ ëª¨ë‹ˆí„°ë§í•˜ê³  íŠ¸ë˜í”½ì„ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ì¤‘ìš”í•œ ë©”ì»¤ë‹ˆì¦˜ì´ë‹¤. í”„ë¡œë¸ŒëŠ” íŒŒë“œê°€ ìš”ì²­ì„ ì²˜ë¦¬í•  ì¤€ë¹„ê°€ ë˜ì—ˆëŠ”ì§€ë¥¼ íŒë‹¨í•˜ëŠ” ë° ì‚¬ìš©ë˜ë©°, Kubernetesê°€ íŒŒë“œë¥¼ ê´€ë¦¬í•˜ê³  ì—…ë°ì´íŠ¸í•˜ëŠ” ë° ì¤‘ìš”í•œ ì—­í• ì„ í•œë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="íŒŒë“œ-readiness-ë°-í”„ë¡œë¸Œ">íŒŒë“œ Readiness ë° í”„ë¡œë¸Œ<a class="hash-link" href="#íŒŒë“œ-readiness-ë°-í”„ë¡œë¸Œ" title="Direct link to heading">â€‹</a></h2><p>íŒŒë“œ ReadinessëŠ” ë”°ë¼ íŒŒë“œê°€ íŠ¸ë˜í”½ì„ ì²˜ë¦¬í•  ì¤€ë¹„ê°€ ë˜ì—ˆëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì¶”ê°€ì ì¸ ì§€í‘œì´ë‹¤. íŒŒë“œ ReadinessëŠ” ì™¸ë¶€ ì†ŒìŠ¤ì—ì„œ íŒŒë“œ ì£¼ì†Œê°€ Endpoints ê°ì²´ì— í‘œì‹œë˜ëŠ”ì§€ë¥¼ ê²°ì •í•œë‹¤. Kubernetesì—ì„œ íŒŒë“œë¥¼ ê´€ë¦¬í•˜ëŠ” ë‹¤ë¥¸ ë¦¬ì†ŒìŠ¤ë“¤, ì˜ˆë¥¼ ë“¤ì–´ Deployment ê°™ì€ ê²ƒë“¤ì€ íŒŒë“œ Readinessë¥¼ ê³ ë ¤í•˜ì—¬ ë¡¤ë§ ì—…ë°ì´íŠ¸ ì‹œ ì˜ì‚¬ ê²°ì •ì„ í•œë‹¤. ë¡¤ë§ ë°°í¬ ì¤‘ì— ìƒˆ íŒŒë“œê°€ ì¤€ë¹„ë˜ì—ˆì§€ë§Œ ì„œë¹„ìŠ¤, ë„¤íŠ¸ì›Œí¬ ì •ì±… ë˜ëŠ” ë¡œë“œ ë°¸ëŸ°ì„œê°€ ì–´ë–¤ ì´ìœ ë¡œ ì¸í•´ ì•„ì§ ìƒˆ íŒŒë“œì— ëŒ€í•´ ì¤€ë¹„ë˜ì§€ ì•Šì€ ê²½ìš°ê°€ ìˆì„ ìˆ˜ ìˆë‹¤. ë§Œì•½ íŒŒë“œì˜ Readiness í”„ë¡œë¸Œê°€ ì‹¤íŒ¨í•˜ë©´, í•´ë‹¹ íŒŒë“œì˜ IP ì£¼ì†ŒëŠ” <code>Endpoints</code> ê°ì²´ì—ì„œ ì œê±°ë˜ì–´ ì„œë¹„ìŠ¤ê°€ ê·¸ íŒŒë“œë¡œ íŠ¸ë˜í”½ì„ ë¼ìš°íŒ…í•˜ì§€ ì•ŠëŠ”ë‹¤. ì´ëŠ” ì„œë¹„ìŠ¤ ì¤‘ë‹¨ì„ ë°©ì§€í•˜ê¸° ìœ„í•œ ë©”ì»¤ë‹ˆì¦˜ì´ë‹¤. Readiness í”„ë¡œë¸ŒëŠ” íŒŒë“œ <code>.Status.Phase</code> ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆìœ¼ë©°, Kubeletì´ ì´ë¥¼ ì‹¤í–‰í•˜ì—¬ ì„±ê³µ ë˜ëŠ” ì‹¤íŒ¨ì— ë”°ë¼ íŒŒë“œ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•œë‹¤. </p><p>íŒŒë“œì— í”„ë¡œë¸Œê°€ ëª…ì‹œë˜ì–´ ìˆì§€ ì•Šìœ¼ë©´ Kubernetesê°€ ê¸°ë³¸ì ìœ¼ë¡œ í•´ë‹¹ í”„ë¡œë¸Œì˜ ìƒíƒœë¥¼ ì„±ê³µìœ¼ë¡œ ê°„ì£¼í•œë‹¤. ì´ëŸ° ê²½ìš° Kubernetesê°€ ì»¨í…Œì´ë„ˆë¥¼ Ready ìƒíƒœë¡œ ê°„ì£¼í•˜ì—¬ ì„œë¹„ìŠ¤ì˜ Endpointsì— í¬í•¨ì‹œí‚¤ê³  íŠ¸ë˜í”½ì„ ë°›ì„ ìˆ˜ ìˆë„ë¡ í•œë‹¤. ê·¸ëŸ¬ë‚˜ ì´ëŠ” ì‹¤ì œë¡œ ì»¨í…Œì´ë„ˆê°€ ì¤€ë¹„ë˜ì§€ ì•Šì•˜ì„ ë•Œë„ íŠ¸ë˜í”½ì„ ë°›ì„ ìˆ˜ ìˆì–´ ì‚¬ìš©ì ê²½í—˜ì— ë¶€ì •ì ì¸ ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ, ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ìƒíƒœë¥¼ ì •í™•íˆ ë°˜ì˜í•˜ê¸° ìœ„í•´ ì ì ˆí•œ í”„ë¡œë¸Œë¥¼ ì„¤ì •í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.</p><p>ë‹¤ìŒì€ íŒŒë“œ ë‹¨ê³„ë³„ ì„¤ëª…ì´ë‹¤. </p><ul><li><code>Pending</code>: í´ëŸ¬ìŠ¤í„°ì—ì„œ íŒŒë“œë¥¼ ìˆ˜ë½í–ˆì§€ë§Œ í•˜ë‚˜ ì´ìƒì˜ ì»¨í…Œì´ë„ˆê°€ ì„¤ì •ë˜ì–´ ì‹¤í–‰í•  ì¤€ë¹„ê°€ ë˜ì§€ ì•Šì€ ê²ƒì„ ë§í•¨. íŒŒë“œê°€ ìŠ¤ì¼€ì¤„ì„ ê¸°ë‹¤ë¦¬ëŠ” ì‹œê°„ê³¼ ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•´ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ëŠ” ë° ì†Œìš”ë˜ëŠ” ì‹œê°„ì´ í¬í•¨ëœë‹¤. </li><li><code>Running</code>: íŒŒë“œê°€ ë…¸ë“œì— ìŠ¤ì¼€ì¤„ë˜ì—ˆê³  ëª¨ë“  ì»¨í…Œì´ë„ˆê°€ ìƒì„±ëœ ê²½ìš°ì´ë‹¤. í•˜ë‚˜ ì´ìƒì˜ ì»¨í…Œì´ë„ˆê°€ ì—¬ì „íˆ ì‹¤í–‰ ì¤‘ì´ê±°ë‚˜ ì‹œì‘ ë˜ëŠ” ì¬ì‹œì‘ ì¤‘ì¸ ê²½ìš°ê°€ ìˆë‹¤. ì¼ë¶€ ì»¨í…Œì´ë„ˆëŠ” <code>CrashLoopBackoff</code> ì™€ ê°™ì´ ì‹¤íŒ¨í•œ ìƒíƒœì¼ ìˆ˜ ìˆë‹¤.</li><li><code>Succeeded</code>: íŒŒë“œì˜ ëª¨ë“  ì»¨í…Œì´ë„ˆê°€ ì„±ê³µì ìœ¼ë¡œ ì¢…ë£Œë˜ì—ˆìœ¼ë©° ë‹¤ì‹œ ì‹œì‘ë˜ì§€ ì•ŠëŠ”ë‹¤.</li><li><code>Failed</code>: íŒŒë“œì˜ ëª¨ë“  ì»¨í…Œì´ë„ˆê°€ ì¢…ë£Œë˜ì—ˆê³  í•˜ë‚˜ ì´ìƒì˜ ì»¨í…Œì´ë„ˆê°€ ì‹¤íŒ¨ë¡œ ì¢…ë£Œë˜ì—ˆì„ ê²½ìš°ì´ë‹¤. ì»¨í…Œì´ë„ˆê°€ <code>nonzero</code> ìƒíƒœë¡œ ì¢…ë£Œë˜ì—ˆê±°ë‚˜ ì‹œìŠ¤í…œì— ì˜í•´ ì¢…ë£Œëœ ê²½ìš°ì´ë‹¤.</li><li><code>Unknown</code>: íŠ¹ì • ì´ìœ ë¡œ íŒŒë“œì˜ ìƒíƒœë¥¼ í™•ì¸í•  ìˆ˜ ì—†ëŠ” ê²½ìš°ë‹¤. ì´ ë‹¨ê³„ëŠ” ì¼ë°˜ì ìœ¼ë¡œ íŒŒë“œê°€ ì‹¤í–‰ë˜ì–´ì•¼ í•˜ëŠ” Kubeletê³¼ì˜ í†µì‹  ì˜¤ë¥˜ë¡œ ì¸í•´ ë°œìƒí•œë‹¤. </li></ul><p>Kubeletì€ Kubernetes ë…¸ë“œì—ì„œ ì‹¤í–‰ë˜ëŠ” ì—ì´ì „íŠ¸ë¡œ, íŒŒë“œì˜ ê°œë³„ ì»¨í…Œì´ë„ˆì— ëŒ€í•´ ë‹¤ì–‘í•œ í—¬ìŠ¤ ì²´í¬ë¥¼ ìˆ˜í–‰í•œë‹¤. ì´ í—¬ìŠ¤ ì²´í¬ëŠ” <code>livenessProbe</code>, <code>readinessProbe</code>, <code>startupProbe</code> ì„¸ ê°€ì§€ ìœ í˜•ìœ¼ë¡œ ë‚˜ë‰œë‹¤. ê° í”„ë¡œë¸ŒëŠ” íŠ¹ì • ì§„ë‹¨ì„ ìˆ˜í–‰í•˜ë©°, ê·¸ ê²°ê³¼ëŠ” ë‹¤ìŒ ì„¸ ê°€ì§€ ì¤‘ í•˜ë‚˜ë¡œ ë‚˜íƒ€ë‚œë‹¤.</p><ul><li><code>Success</code>: ì»¨í…Œì´ë„ˆê°€ ì§„ë‹¨ì„ í†µê³¼í–ˆìŒ</li><li><code>Failure</code>: ì»¨í…Œì´ë„ˆê°€ ì§„ë‹¨ì„ í†µê³¼í•˜ì§€ ëª»í–ˆìŒ</li><li><code>Unknown</code>: ì§„ë‹¨ ìì²´ê°€ ì‹¤íŒ¨í•˜ì—¬ ì•„ë¬´ëŸ° ì¡°ì¹˜ë¥¼ ì·¨í•  ìˆ˜ ì—†ëŠ” ìƒíƒœ</li></ul><p>ì´ëŸ¬í•œ í”„ë¡œë¸ŒëŠ” HTTP ìš”ì²­, ë°”ì´ë„ˆë¦¬ ëª…ë ¹ ì‹¤í–‰, TCP ì—°ê²°ì„ í†µí•´ ìˆ˜í–‰ë  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, HTTP í”„ë¡œë¸ŒëŠ” íŠ¹ì • ì—”ë“œí¬ì¸íŠ¸ì— HTTP GET ìš”ì²­ì„ ë³´ë‚´ ì‘ë‹µ ì½”ë“œê°€ ì„±ê³µ(ì˜ˆ: 200 OK)ì¸ì§€ë¥¼ í™•ì¸í•œë‹¤. TCP í”„ë¡œë¸ŒëŠ” íŠ¹ì • í¬íŠ¸ê°€ ì—´ë ¤ ìˆëŠ”ì§€ë¥¼ í™•ì¸í•˜ë©°, ëª…ë ¹ í”„ë¡œë¸ŒëŠ” ì»¨í…Œì´ë„ˆ ë‚´ì—ì„œ ëª…ë ¹ì„ ì‹¤í–‰í•˜ì—¬ ì„±ê³µ ì—¬ë¶€ë¥¼ íŒë‹¨í•œë‹¤. í”„ë¡œë¸Œê°€ <code>failureThreshold</code>ë³´ë‹¤ ë” ë§ì´ ì‹¤íŒ¨í•˜ë©´, ê²€ì‚¬ì— ì‹¤íŒ¨í•œ ê²ƒìœ¼ë¡œ ê°„ì£¼í•œë‹¤. </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="liveness-í”„ë¡œë¸Œ">Liveness í”„ë¡œë¸Œ<a class="hash-link" href="#liveness-í”„ë¡œë¸Œ" title="Direct link to heading">â€‹</a></h3><p>Liveness í”„ë¡œë¸ŒëŠ” ì˜ëª» ì‚¬ìš©í•˜ê±°ë‚˜ ì˜ëª» êµ¬ì„±í•˜ë©´ ì˜ˆê¸°ì¹˜ ì•Šì€ ì¥ì• ë¥¼ ì‰½ê²Œ ì¼ìœ¼í‚¬ ìˆ˜ ìˆë‹¤. Liveness í”„ë¡œë¸Œë¥¼ ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ëŠ” ì»¨í…Œì´ë„ˆë¥¼ ë‹¤ì‹œ ì‹œì‘í•´ì•¼ í•  ì‹œê¸°ë¥¼ Kubeletì— ì•Œë ¤ì£¼ëŠ” ê²ƒì´ë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‚´ì•„ìˆê³  ì‘ë‹µ ê°€ëŠ¥í•œ ìƒíƒœì¸ì§€ë¥¼ í™•ì¸í•œë‹¤. ë§Œì•½ ì´ í”„ë¡œë¸Œê°€ ì‹¤íŒ¨í•˜ë©´, ì»¨í…Œì´ë„ˆëŠ” ì¬ì‹œì‘ëœë‹¤. ì´ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë°ë“œë½ ìƒíƒœì— ë¹ ì¡Œì„ ë•Œì—ë„ ìœ ìš©í•˜ë‹¤.</p><p>í•˜ì§€ë§Œ ì˜ëª» ì‚¬ìš©í•˜ë©´ ìœ„í—˜í•œ ì „ëµì´ ë  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì›¹ ë©”ì¸ í˜ì´ì§€ë¥¼ ë¡œë“œí•˜ëŠ” Liveness í”„ë¡œë¸Œë¥¼ ìƒì„±í•œ ìƒíƒœì—ì„œ ì™¸ë¶€ì˜ ì‹œìŠ¤í…œ ë³€ê²½ìœ¼ë¡œ ì¸í•´ ë©”ì¸ í˜ì´ì§€ê°€ 404 ë˜ëŠ” 500 ì—ëŸ¬ë¥¼ ë°˜í™˜í•œë‹¤ê³  ê°€ì •í•´ ë³´ì. ì´ëŸ¬í•œ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ Liveness í”„ë¡œë¸ŒëŠ” ì»¨í…Œì´ë„ˆë¥¼ ì¬ì‹œì‘í•œë‹¤. ì»¨í…Œì´ë„ˆë¥¼ ë‹¤ì‹œ ì‹œì‘í•œë‹¤ê³  í•´ì„œ ì‹œìŠ¤í…œì˜ ë‹¤ë¥¸ ê³³ì—ì„œ ë¬¸ì œê°€ í•´ê²°ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì˜¤íˆë ¤ ì¥ì• ë¥¼ ì•…í™”ì‹œí‚¬ ìˆ˜ ìˆë‹¤. ì»¨í…Œì´ë„ˆ <code>CrashLoopBackoff</code>ê°€ ë°œìƒí•˜ê²Œ ë˜ëŠ”ë° ìˆëŠ”ë°, ì´ëŠ” ì‹¤íŒ¨í•œ ì»¨í…Œì´ë„ˆë¥¼ ì¬ì‹œì‘í•˜ëŠ” ë° ì‹œê°„ì„ ê³„ì† ì¦ê°€ì‹œí‚¨ë‹¤. </p><ul><li>HTTP probe: ì»¨í…Œì´ë„ˆ IP ì£¼ì†Œë¡œ HTTP GET ìš”ì²­ì„ ìˆ˜í–‰í•˜ë©° 200ì—ì„œ 399 ì‚¬ì´ì˜ ì„±ê³µì ì¸ HTTP ì‘ë‹µ ì½”ë“œë¥¼ ê¸°ëŒ€</li><li>TCP Socket probe: TCP ì—°ê²°ì´ ì„±ê³µí–ˆë‹¤ê³  ê°€ì •</li><li>Exec probe: ì»¨í…Œì´ë„ˆ ì»¤ë„ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì—ì„œ ì„ì˜ì˜ ëª…ë ¹ì„ ì‹¤í–‰í•˜ê³  ì„±ê³µì ì¸ ì¢…ë£Œ ì½”ë“œ(0)ë¥¼ ê¸°ëŒ€</li><li>gRPC probe: ìƒíƒœ í™•ì¸ì„ ìœ„í•´ gRPCì˜ ìì²´ ê¸°ëŠ¥ í™œìš©</li></ul><p>í”„ë¡œë¸Œ ë™ì‘ ì™¸ì—ë„ ë‹¤ìŒ ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒíƒœ í™•ì¸ ë™ì‘ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆë‹¤.</p><ul><li><code>initialDelaySeconds</code>: ì²« ë²ˆì§¸ liveness probeê°€ í™•ì¸ë  ë•Œê¹Œì§€ ëŒ€ê¸°í•  ì‹œê°„(ì´ˆ)ì„ ì§€ì •</li><li><code>periodSeconds</code>: liveness probe ê²€ì‚¬ ê°„ê²©(ì´ˆ)</li><li><code>timeoutSeconds</code>:í”„ë¡œë¸Œ ê²€ì‚¬ê°€ ì‹¤íŒ¨ë¡œ ê°„ì£¼ë˜ê¸° ì „ì— ë°˜í™˜ë  ë•Œê¹Œì§€ í—ˆìš©ë˜ëŠ” ìµœëŒ€ ì‹œê°„</li><li><code>failureThreshold</code>: ì»¨í…Œì´ë„ˆê°€ ì •ìƒì´ ì•„ë‹Œ ê²ƒìœ¼ë¡œ ê°„ì£¼ë˜ì–´ ë‹¤ì‹œ ì‹œì‘í•´ì•¼ í•  ë•Œê¹Œì§€ í”„ë¡œë¸Œ ê²€ì‚¬ê°€ ì—°ì†ìœ¼ë¡œ ì‹¤íŒ¨í•´ì•¼ í•˜ëŠ” ë¹ˆë„ë¥¼ ì§€ì •</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="readiness-í”„ë¡œë¸Œ">Readiness í”„ë¡œë¸Œ<a class="hash-link" href="#readiness-í”„ë¡œë¸Œ" title="Direct link to heading">â€‹</a></h3><p>Readiness í”„ë¡œë¸ŒëŠ” ì •ìƒì´ ì•„ë‹Œ ì»¨í…Œì´ë„ˆë¥¼ ì‚­ì œí•˜ê³  ìƒˆ ì»¨í…Œì´ë„ˆë¡œ êµì²´í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê±´ê°•í•˜ê²Œ ìœ ì§€í•˜ëŠ” ë° ë„ì›€ì´  ë  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜ ë•Œë¡œ ì»¨í…Œì´ë„ˆê°€ ë¹„ì •ìƒì ì¸ ê²½ìš° ë‹¤ì‹œ ì‹œì‘í•´ë„ ë¬¸ì œê°€ í•´ê²°ë˜ì§€ ì•ŠëŠ” ê²½ìš°ê°€ ìˆë‹¤. ëŒ€í‘œì ì¸ ì˜ˆë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë°ì´í„°ë² ì´ìŠ¤ì™€ ê°™ì€ ì¢…ì†ì„±ì„ ì‚¬ìš©í•  ìˆ˜ ìˆê¸°ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ê²½ìš°ì´ë‹¤. ì»¨í…Œì´ë„ˆì— ê³¼ë¶€í•˜ê°€ ê±¸ë ¤ latencyê°€ ì¦ê°€í•˜ëŠ” ê²½ìš° ì ì‹œ ë™ì•ˆ ì¶”ê°€ ë¶€í•˜ë¡œë¶€í„° ìŠ¤ìŠ¤ë¡œë¥¼ ë³´í˜¸í•˜ê³  ë¶€í•˜ê°€ ê°ì†Œí•  ë•Œê¹Œì§€ ì¤€ë¹„ê°€ ë˜ì§€ ì•Šì•˜ë‹¤ëŠ” ê²ƒì„ í‘œì‹œí•´ì•¼ í•œë‹¤.</p><p><a href="https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/</a> ì—ì„œ readinessGates ë¥¼ í†µí•´ ì¶”ê°€ì ì¸ AWS ALB ìƒíƒœë¥¼ ì²´í¬í•˜ê³  ì •ìƒì¼ë•Œ Readiness Probe ì²´í¬ê°€ ë˜ë„ë¡ ì•„ë˜ì™€ ê°™ì´ ì¶”ê°€ í”¼ë“œë°±ì´ë‚˜ ì‹ í˜¸ë¥¼ íŒŒë“œ ìƒíƒœì— ì£¼ì…í•  ìˆ˜ ìˆë‹¤.</p><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="custom-pod-readiness-gates-for-aws-load-balancer-controller">Custom Pod Readiness Gates for AWS Load Balancer controller<a class="hash-link" href="#custom-pod-readiness-gates-for-aws-load-balancer-controller" title="Direct link to heading">â€‹</a></h4><p><a href="https://kubernetes-sigs.github.io/aws-load-balancer-controller/v2.8/deploy/pod_readiness_gate/" target="_blank" rel="noopener noreferrer">https://kubernetes-sigs.github.io/aws-load-balancer-controller/v2.8/deploy/pod_readiness_gate/</a></p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="startup-í”„ë¡œë¸Œ">Startup í”„ë¡œë¸Œ<a class="hash-link" href="#startup-í”„ë¡œë¸Œ" title="Direct link to heading">â€‹</a></h3><p>ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹œì‘í•˜ëŠ” ë° ì˜¤ëœì‹œê°„(ëª‡ ë¶„ì´ìƒ)ì´ ê±¸ë¦¬ëŠ” ìƒí™©ì—ì„œ KubernetesëŠ” Startup í”„ë¡œë¸Œë¥¼ ì œê³µí•œë‹¤. Liveness í”„ë¡œë¸Œì™€ ë™ì¼í•œ í˜•ì‹ìœ¼ë¡œ êµ¬ì„±ë˜ì§€ë§Œ í”„ë¡œë¸Œ ë™ì‘ê³¼ íƒ€ì´ë° íŒŒë¼ë¯¸í„°ì— ëŒ€í•´ ë‹¤ë¥¸ ê°’ì„ í—ˆìš©í•œë‹¤. <code>periodSeconds</code> ë° <code>failureThreshold</code> ì„¤ì •ì„ í†µí•´ ì˜¤ë˜ ê±¸ë¦¬ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ì„ ê³ ë ¤í•˜ê¸° ìœ„í•´ í•´ë‹¹ Liveness í”„ë¡œë¸Œì— ë¹„í•´ í›¨ì”¬ ë” í° ê°’ìœ¼ë¡œ êµ¬ì„±ëœë‹¤. <code>startupProbe</code>ê°€ ì„±ê³µí•œ ì´í›„ì—ë§Œ <code>livenessProbe</code>ì™€ <code>readinessProbe</code>ë¥¼ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: pod-startup-check</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - image: quay.io/wildfly/wildfly </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name: wildfly</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    startupProbe:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      exec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        command: [ "stat", "/opt/jboss/wildfly/standalone/tmp/startup-marker" ]  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        initialDelaySeconds: 60    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        periodSeconds: 60</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        failureThreshold: 15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    livenessProbe:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      httpGet:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        path: /health</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        port: 9990</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        periodSeconds: 10          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        failureThreshold: 3</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ul><li><code>exec</code>: <code>/opt/jboss/wildfly/standalone/tmp/startup-marker</code> íŒŒì¼ì˜ ì¡´ì¬ ì—¬ë¶€ë¥¼ í™•ì¸í•œë‹¤. ì´ íŒŒì¼ì´ ì¡´ì¬í•˜ë©´ ì»¨í…Œì´ë„ˆê°€ ì‹œì‘ëœ ê²ƒìœ¼ë¡œ ê°„ì£¼</li><li><code>initialDelaySeconds</code>: ì»¨í…Œì´ë„ˆê°€ 15ë¶„ í›„(60ì´ˆ x 15íšŒ, ìµœì´ˆ ë”œë ˆì´ 60ì´ˆ) ì—ë„ startupProbeë¥¼ í†µê³¼í•˜ì§€ ëª»í–ˆì„ ë•Œ ì»¨í…Œì´ë„ˆë¥¼ ë‹¤ì‹œ ì‹œì‘í•˜ë„ë¡ ì§€ì •í•˜ëŠ” ë§¤ê°œë³€ìˆ˜</li><li><code>periodSeconds</code>: í”„ë¡œë¸Œê°€ ì‹¤í–‰ë˜ëŠ” ì£¼ê¸°ë¡œ, 60ì´ˆë§ˆë‹¤ í”„ë¡œë¸Œê°€ ì‹¤í–‰</li><li><code>failureThreshold</code>: ì‹¤íŒ¨ í—ˆìš© íšŸìˆ˜ë¡œ, 15ë²ˆ ì‹¤íŒ¨í•˜ë©´ ì»¨í…Œì´ë„ˆê°€ ë¹„ì •ìƒìœ¼ë¡œ ê°„ì£¼</li></ul><p>ìœ„ ì˜ˆì‹œëŠ” startupProbeê°€ ë¯¸ë“¤ì›¨ì–´ì¸ Wildfly ì»¨í…Œì´ë„ˆê°€ ì‹œì‘ë˜ì—ˆëŠ”ì§€ í™•ì¸í•œë‹¤. ì»¨í…Œì´ë„ˆê°€ ì‹œì‘ë˜ê¸° ì „ê¹Œì§€ ë‹¤ë¥¸ í”„ë¡œë¸Œ(liveness, readiness)ëŠ” ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤. ì˜ˆì‹œì™€ ê°™ì´ ì»¨í…Œì´ë„ˆë¥¼ ì‹œì‘í•˜ëŠ” ë° ëª‡ ë¶„ì´ ê±¸ë¦¬ì§€ë§Œ ì‹œì‘ í›„ ì»¨í…Œì´ë„ˆê°€ ìƒíƒœê°€ ì¢‹ì§€ ì•Šìœ¼ë©´ ë¹ ë¥´ê²Œ ì¢…ë£Œí•˜ëŠ” ì¼€ì´ìŠ¤ë¡œ ì£¼ë¡œ ì‚¬ìš©í•œë‹¤. ì´í›„ì— livenessProbeëŠ” ì»¨í…Œì´ë„ˆì˜ ì§€ì†ì ì¸ ì‹¤í–‰ ìƒíƒœë¥¼ í™•ì¸í•œë‹¤. /health ì—”ë“œí¬ì¸íŠ¸ì— ëŒ€í•œ HTTP ìš”ì²­ì„ í†µí•´ Wildfly ì„œë²„ê°€ ì •ìƒì ìœ¼ë¡œ ì‘ë™ ì¤‘ì¸ì§€ í™•ì¸í•œë‹¤.</p><p>ì•„ë˜ ì˜ˆì‹œëŠ” Golang ì›¹ ì„œë²„ì—ëŠ” 8080 í¬íŠ¸ì—ì„œ /healthz ê²½ë¡œë¡œ HTTP GETì„ ìˆ˜í–‰í•˜ëŠ” livenessProbe í”„ë¡œë¸Œê°€ ìˆê³ , readinessProbe í”„ë¡œë¸ŒëŠ” ë™ì¼í•œ í¬íŠ¸ì—ì„œ /ë¥¼ ì²´í¬í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: go-web</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    test: liveness</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - name: go-web</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image: go-web:v0.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - containerPort: 8080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    livenessProbe:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      httpGet:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        path: /healthz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        port: 8080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      initialDelaySeconds: 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      periodSeconds: 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    readinessProbe:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      httpGet:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        path: /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        port: 8080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      initialDelaySeconds: 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      periodSeconds: 5</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="readiness-gates">readiness gates<a class="hash-link" href="#readiness-gates" title="Direct link to heading">â€‹</a></h3><p>Readiness gatesë¥¼ ì‚¬ìš©í•˜ë©´ íŒŒë“œ ë‚´ë¶€ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì–¸ì œ ì¤€ë¹„ë˜ì—ˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤. Kubernetes 1.14ë¶€í„° ì‚¬ìš© ê°€ëŠ¥í–ˆê³ , Readiness gatesë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ Kubeletì´ íŒŒë“œ Readinessë¥¼ í‰ê°€í•˜ëŠ” ì¶”ê°€ ì¡°ê±´ìœ¼ë¡œ íŒŒë“œì˜ ìŠ¤í™ì— <code>readinessGates</code>ë¥¼ ì¶”ê°€í•œë‹¤.Readiness ê²Œì´íŠ¸ëŠ” íŒŒë“œì˜ <code>status.condition</code> í•„ë“œì˜ í˜„ì¬ ìƒíƒœì— ì˜í•´ ì œì–´ë˜ë©°, Kubeletì´ íŒŒë“œì˜ <code>status.conditions</code> í•„ë“œì—ì„œ í•´ë‹¹ ì¡°ê±´ì„ ì°¾ì„ ìˆ˜ ì—†ëŠ” ê²½ìš° ì¡°ê±´ì˜ ìƒíƒœëŠ” ê¸°ë³¸ê°’ì´ Falseë¡œ ì„¤ì •ëœë‹¤.</p><p>ì•„ë˜ ì˜ˆì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´, <code>feature-1</code> Readiness gatesëŠ” <code>False</code>ì´ê³  <code>feature-2</code>ëŠ” <code>True</code>ì´ë¯€ë¡œ íŒŒë“œì˜ ìƒíƒœëŠ” <code>False</code>ê°€ ëœë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kind: Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  readinessGates:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - conditionType: www.example.com/feature-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - conditionType: www.example.com/feature-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">status:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  conditions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - lastProbeTime: null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      lastTransitionTime: 2024-08-25T00:00:00Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status: "False"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      type: Ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - lastProbeTime: null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      lastTransitionTime: 2024-08-25T00:00:00Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status: "False"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      type: www.example.com/feature-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - lastProbeTime: null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      lastTransitionTime: 2024-08-25T00:00:00Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status: "True"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      type: www.example.com/feature-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  containerStatuses:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - containerID: docker://xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ready: true</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì‚¬ìš©ì ì •ì˜ ì¡°ê±´ì„ ì‚¬ìš©í•˜ëŠ” íŒŒë“œì˜ ê²½ìš°, í•´ë‹¹ íŒŒë“œëŠ” ë‹¤ìŒ ë¬¸ì´ ëª¨ë‘ ì ìš©ë˜ëŠ” ê²½ìš°ì—ë§Œ ì¤€ë¹„ëœ ê²ƒìœ¼ë¡œ í‰ê°€ëœë‹¤.</p><ul><li>íŒŒë“œì˜ ëª¨ë“  ì»¨í…Œì´ë„ˆê°€ ì¤€ë¹„ ìƒíƒœ</li><li><code>readinessGates</code>ì— ì§€ì •ëœ ëª¨ë“  ì¡°ê±´ì´ <code>True</code></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="íŒŒë“œ-network-readiness">íŒŒë“œ Network Readiness<a class="hash-link" href="#íŒŒë“œ-network-readiness" title="Direct link to heading">â€‹</a></h3><p>íŒŒë“œ Network ReadinessëŠ” Kubernetes v1.29ì—ì„œ betaê°€ ëœ readinessë¡œ Kubernetesì—ì„œ íŒŒë“œê°€ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ ì²˜ë¦¬í•  ì¤€ë¹„ê°€ ë˜ì—ˆëŠ”ì§€ë¥¼ í™•ì¸í•˜ëŠ” ì¤‘ìš”í•œ ì¡°ê±´ì´ë‹¤. íŒŒë“œê°€ í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ íŠ¸ë˜í”½ì„ ìˆ˜ì‹ í•  ìˆ˜ ìˆëŠ” ìƒíƒœì¸ì§€ íŒë‹¨í•˜ëŠ” ë° ì‚¬ìš©ë˜ê³  íŒŒë“œê°€ ë„¤íŠ¸ì›Œí¬ ì¤€ë¹„ ìƒíƒœê°€ ë˜ë©´, í•´ë‹¹ íŒŒë“œëŠ” ì„œë¹„ìŠ¤ì˜ ë¡œë“œ ë°¸ëŸ°ì‹± í’€ì— ì¶”ê°€ë˜ì–´ íŠ¸ë˜í”½ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ ëœë‹¤. </p><p><code>PodReadyToStartContainersCondition</code>ëŠ” <a href="https://kubernetes.io/docs/reference/command-line-tools-reference/feature-gates/" target="_blank" rel="noopener noreferrer">feature gate</a>ê°€ í™œì„±í™”ë˜ë©´(1.31 ë²„ì „ ë¶€í„°ëŠ” ê¸°ë³¸ìœ¼ë¡œ íƒ‘ì¬ë  ì˜ˆì •) íŒŒë“œì˜ <code>status.conditions</code>ì— <code>PodReadyToStartContainers</code> ì¡°ê±´ì´ ì¶”ê°€ëœë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: example-pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - name: example-container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image: example-image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">status:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  conditions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - type: PodReadyToStartContainers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    status: "True"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ ì˜ˆì‹œì—ì„œ <code>PodReadyToStartContainers</code> ì¡°ê±´ì´ Trueë¡œ ë˜ì–´ ìˆìœ¼ë©´, kubeletì€ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ í’€ë§í•˜ê³  ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±í•  ì¤€ë¹„ê°€ ë˜ì—ˆìŒì„ ì˜ë¯¸í•œë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ê²°ë¡ ">ê²°ë¡ <a class="hash-link" href="#ê²°ë¡ " title="Direct link to heading">â€‹</a></h2><p>Kubernetesì˜ Readiness ë° í”„ë¡œë¸ŒëŠ” íŒŒë“œì˜ ìƒíƒœë¥¼ ëª¨ë‹ˆí„°ë§í•˜ê³  íŠ¸ë˜í”½ì„ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ” ë° í•„ìˆ˜ì ì´ë‹¤. ì ì ˆí•œ í”„ë¡œë¸Œ ì„¤ì •ì„ í†µí•´ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ê°€ìš©ì„±ê³¼ ì•ˆì •ì„±ì„ ë†’ì¼ ìˆ˜ ìˆë‹¤. í”„ë¡œë¸Œë¥¼ ì„¤ì •í•  ë•ŒëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ íŠ¹ì„±ê³¼ ìš”êµ¬ ì‚¬í•­ì— ë§ê²Œ êµ¬ì„±í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.</p>]]></content>
        <author>
            <name>Jinwoong Kim</name>
            <uri>https://www.linkedin.com/in/ddiiwoong/</uri>
        </author>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="Probe" term="Probe"/>
        <category label="livenessProbe" term="livenessProbe"/>
        <category label="readinessProbe" term="readinessProbe"/>
        <category label="startupProbe" term="startupProbe"/>
        <category label="NetworkReadiness" term="NetworkReadiness"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[ì»¤ë„ ê°•í™” ë„êµ¬ ì‚¬ìš©í•˜ê¸°]]></title>
        <id>kubernetes/kernelhardening/</id>
        <link href="https://ddii.dev/kubernetes/kernelhardening/"/>
        <updated>2024-08-31T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[AppArmorì™€ seccompë¥¼ ì‚¬ìš©í•œ ì»¤ë„ ê°•í™”]]></summary>
        <content type="html"><![CDATA[<p>ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë‚˜ í”„ë¡œì„¸ìŠ¤ëŠ” ì‹œìŠ¤í…œ í˜¸ì¶œ(system call)ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤. ëŒ€í‘œì ì¸ ì˜ˆë¡œ HTTP ìš”ì²­ì„ ìˆ˜í–‰í•˜ëŠ” curl ëª…ë ¹ì„ ë“¤ ìˆ˜ ìˆë‹¤. ì‹œìŠ¤í…œ í˜¸ì¶œì€ ì»¤ë„ì— ì„œë¹„ìŠ¤ë¥¼ ìš”ì²­í•˜ê¸° ìœ„í•´ ì‚¬ìš©ì ê³µê°„ì—ì„œ ì‹¤í–‰ë˜ëŠ” ì¶”ìƒí™”ëœ í”„ë¡œê·¸ë˜ë°ì¸ë°, ì»¤ë„ ê°•í™” ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ í—ˆìš©ë˜ëŠ” ì‹œìŠ¤í…œ í˜¸ì¶œì„ ì œí•œí•  ìˆ˜ ìˆìœ¼ë©°, CKS ì‹œí—˜ì—ì„œëŠ” AppArmorì™€ seccompë¼ëŠ” ë‘ ê°€ì§€ ë„êµ¬ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì–¸ê¸‰í•˜ê³  ìˆë‹¤. ì´ ë‘ ë„êµ¬ëŠ” ì»¨í…Œì´ë„ˆí™”ëœ í™˜ê²½ì—ì„œ ë³´ì•ˆì„ ê°•í™”í•˜ëŠ” ë° ì¤‘ìš”í•œ ì—­í• ì„ í•˜ë©°, Kubernetesì™€ì˜ í†µí•©ì„ í†µí•´ ë³´ë‹¤ ì•ˆì „í•œ í´ëŸ¬ìŠ¤í„° ìš´ì˜ì„ ì§€ì›í•œë‹¤. ì´ ë‘ ë„êµ¬ì™€ ì¿ ë²„ë„¤í‹°ìŠ¤ì™€ í†µí•©í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ì— ëŒ€í•´ ì„¤ëª…í•œë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="apparmor">AppArmor<a class="hash-link" href="#apparmor" title="Direct link to heading">â€‹</a></h2><p><a href="https://apparmor.net/" target="_blank" rel="noopener noreferrer">AppArmor</a>ëŠ” Linux ì‹œìŠ¤í…œì—ì„œ ì‹¤í–‰ë˜ëŠ” í”„ë¡œê·¸ë¨ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ ì œì–´ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤. AppArmorëŠ” ê²½ë¡œ ê¸°ë°˜ìœ¼ë¡œ ì‘ë™í•˜ë©°, í”„ë¡œí•„ì„ í†µí•´ íŠ¹ì • í”„ë¡œê·¸ë¨ì´ë‚˜ ì»¨í…Œì´ë„ˆê°€ í•„ìš”í•œ ì ‘ê·¼ë§Œ í—ˆìš©í•˜ë„ë¡ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. Kubernetesì—ì„œëŠ” AppArmor í”„ë¡œí•„ì„ Pod ë˜ëŠ” ì»¨í…Œì´ë„ˆ ìˆ˜ì¤€ì—ì„œ ì§€ì •í•  ìˆ˜ ìˆìœ¼ë©°, securityContextë¥¼ í†µí•´ ì ìš©í•œë‹¤. ì´ ë„êµ¬ëŠ” user spaceì—ì„œ í˜¸ì¶œë˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ê¸°ë³¸ ì‹œìŠ¤í…œ ê¸°ëŠ¥ ì‚¬ì´ì— ì¶”ê°€ì ì¸ ë³´ì•ˆ ê³„ì¸µì„ êµ¬í˜„í•œë‹¤. ë„¤íŠ¸ì›Œí¬ í˜¸ì¶œ ë˜ëŠ” íŒŒì¼ ì‹œìŠ¤í…œ ìƒí˜¸ ì‘ìš©ì„ ì œí•œí•  ìˆ˜ ìˆë‹¤. ë§ì€ Linux ë°°í¬íŒ(ì˜ˆ: Debian, Ubuntu, openSUSE)ì´ AppArmorë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•œë‹¤. AppArmorë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ” Amazon Linuxì™€ ê°™ì€ ë°°í¬íŒì€ AppArmorì™€ ìœ ì‚¬í•œ ì ‘ê·¼ ë°©ì‹ì„ ì·¨í•˜ëŠ” <a href="https://en.wikipedia.org/wiki/Security-Enhanced_Linux" target="_blank" rel="noopener noreferrer">SELinux</a>ë¥¼ ëŒ€ì‹  ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.  </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="í”„ë¡œíŒŒì¼profile-ì´í•´">í”„ë¡œíŒŒì¼(profile) ì´í•´<a class="hash-link" href="#í”„ë¡œíŒŒì¼profile-ì´í•´" title="Direct link to heading">â€‹</a></h3><p>í”„ë¡œê·¸ë¨ì´ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ì‘ì—…ê³¼ ìˆ˜í–‰í•  ìˆ˜ ì—†ëŠ” ì‘ì—…ì„ ì •ì˜í•˜ëŠ” ê·œì¹™ì€ AppArmor í”„ë¡œí•„ì— ì •ì˜ëœë‹¤. ëª¨ë“  í”„ë¡œí•„ì„ ì ìš©í•˜ë ¤ë©´ ë¨¼ì € AppArmorì— ë¡œë“œí•´ì•¼ í•œë‹¤. AppArmorëŠ” ë¡œë“œëœ í”„ë¡œíŒŒì¼ì„ í™•ì¸í•  ìˆ˜ ìˆëŠ” ëª…ë ¹ì¤„ ë„êµ¬ë¥¼ ì œê³µí•œë‹¤. <code>aa-status</code> ëª…ë ¹ì„ ì‹¤í–‰í•˜ë©´ ë¡œë“œëœ ëª¨ë“  í”„ë¡œíŒŒì¼ì˜ ìš”ì•½ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. AppArmorì—ëŠ” Linux ì„œë¹„ìŠ¤ë¥¼ ë³´í˜¸í•˜ê¸° ìœ„í•œ ê¸°ë³¸ ì• í”Œë¦¬ì¼€ì´ì…˜ í”„ë¡œíŒŒì¼ ì„¸íŠ¸ê°€ ì´ë¯¸ í¬í•¨ë˜ì–´ ìˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo aa-status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apparmor module is loaded.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">43 profiles are loaded.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">41 profiles are in enforce mode.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   /snap/snapd/21759/usr/lib/snapd/snap-confine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2 profiles are in complain mode.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   snap.amazon-ssm-agent.amazon-ssm-agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   snap.amazon-ssm-agent.ssm-cli</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0 profiles are in kill mode.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0 profiles are in unconfined mode.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">9 processes have profiles defined.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2 processes are in enforce mode.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   /usr/sbin/chronyd (429)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   /usr/sbin/chronyd (434)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">7 processes are in complain mode.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   /snap/amazon-ssm-agent/7993/amazon-ssm-agent (104231) snap.amazon-ssm-agent.amazon-ssm-agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   /snap/amazon-ssm-agent/7993/ssm-agent-worker (104261) snap.amazon-ssm-agent.amazon-ssm-agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   /snap/amazon-ssm-agent/7993/ssm-session-worker (138449) snap.amazon-ssm-agent.amazon-ssm-agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   /usr/bin/dash (138466) snap.amazon-ssm-agent.amazon-ssm-agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   /usr/bin/sudo (138468) snap.amazon-ssm-agent.amazon-ssm-agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   /usr/bin/sudo (138469) snap.amazon-ssm-agent.amazon-ssm-agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   /usr/sbin/aa-status (138470) snap.amazon-ssm-agent.amazon-ssm-agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0 processes are unconfined but have a profile defined.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0 processes are in mixed mode.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0 processes are in kill mode.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í”„ë¡œíŒŒì¼ ëª¨ë“œëŠ” ì¼ì¹˜í•˜ëŠ” ì´ë²¤íŠ¸ê°€ ë°œìƒí•  ê²½ìš° ëŸ°íƒ€ì„ì— ê·œì¹™ì˜ ì²˜ë¦¬ë¥¼ ê²°ì •í•œë‹¤. AppArmorëŠ” ë‘ ê°€ì§€ ìœ í˜•ì˜ í”„ë¡œí•„ ëª¨ë“œë¥¼ êµ¬ë¶„í•œë‹¤.</p><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="enforce">Enforce<a class="hash-link" href="#enforce" title="Direct link to heading">â€‹</a></h4><p>ì‹œìŠ¤í…œì´ ê·œì¹™ì„ ì ìš©í•˜ê³  ìœ„ë°˜ì„ ë¦¬í¬íŠ¸í•˜ê³  ì‹œìŠ¤í…œ ë¡œê·¸ì— ê¸°ë¡í•œë‹¤. ì´ ëª¨ë“œë¥¼ ì‚¬ìš©í•˜ë©´ í”„ë¡œê·¸ë¨ì´ íŠ¹ì • í˜¸ì¶œì„ í•˜ì§€ ëª»í•˜ë„ë¡ ë°©ì§€í•  ìˆ˜ ìˆë‹¤.</p><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="complain">Complain<a class="hash-link" href="#complain" title="Direct link to heading">â€‹</a></h4><p>ì‹œìŠ¤í…œì—ì„œ ê·œì¹™ì„ ì ìš©í•˜ì§€ëŠ” ì•Šì§€ë§Œ ìœ„ë°˜ ì‚¬í•­ì„ ë¡œê·¸ì— ê¸°ë¡í•œë‹¤. ì´ ëª¨ë“œëŠ” í”„ë¡œê·¸ë¨ì˜ ì‹œìŠ¤í…œ í˜¸ì¶œì„ ë°œê²¬í•˜ë ¤ëŠ” ê²½ìš°ì— ìœ ìš©í•˜ë‹¤.</p><p>ì•„ë˜ í”„ë¡œíŒŒì¼ì€ íŒŒì¼ ì“°ê¸° ì•¡ì„¸ìŠ¤ë¥¼ ì œí•œí•˜ê¸° ìœ„í•´ k8s-deny-write íŒŒì¼ì— ì‚¬ìš©ì ì§€ì • í”„ë¡œí•„ì„ ì •ì˜í•˜ëŠ” ë¶€ë¶„ì´ë‹¤. í•´ë‹¹ íŒŒì¼ì€ ì›Œí¬ë¡œë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ëª¨ë“  ì›Œì»¤ ë…¸ë“œì˜ /etc/apparmor.d ë””ë ‰í„°ë¦¬ì— ë°°ì¹˜í•´ì•¼ í•œë‹¤. ìì„¸í•œ ë¬¸ë²•ì€ <a href="https://gitlab.com/apparmor/apparmor/-/wikis/QuickProfileLanguage" target="_blank" rel="noopener noreferrer">AppArmor</a> ìœ„í‚¤ë¥¼ ì°¸ì¡°í•˜ì.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#include &lt;tunables/global&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">profile k8s-deny-write flags=(attach_disconnected) { //profile í‚¤ì›Œë“œ ë’¤ì˜ ì‹ë³„ìëŠ” í”„ë¡œí•„ì˜ ì´ë¦„ì´ë‹¤.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #include &lt;abstractions/base&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  file, //íŒŒì¼ ì‘ì—…ì— ì ìš©í•œë‹¤.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  deny /** w, //ëª¨ë“  íŒŒì¼ ì“°ê¸°ë¥¼ ê±°ë¶€í•œë‹¤.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì‚¬ìš©ì-ì§€ì •-í”„ë¡œí•„-ì„¤ì •">ì‚¬ìš©ì ì§€ì • í”„ë¡œí•„ ì„¤ì •<a class="hash-link" href="#ì‚¬ìš©ì-ì§€ì •-í”„ë¡œí•„-ì„¤ì •" title="Direct link to heading">â€‹</a></h3><p>AppArmorì— í”„ë¡œíŒŒì¼ì„ ë¡œë“œí•˜ë ¤ë©´ ì›Œì»¤ ë…¸ë“œì—ì„œ ë‹¤ìŒ ëª…ë ¹ì„ ì‹¤í–‰í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apparmor_parser /etc/apparmor.d/k8s-deny-write</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í•´ë‹¹ ëª…ë ¹ì€ ê¸°ë³¸ì ìœ¼ë¡œ <code>Enforce</code> ëª¨ë“œë¥¼ ì‚¬ìš©í•œë‹¤. <code>Complain</code> ëª¨ë“œì—ì„œ í”„ë¡œíŒŒì¼ì„ ë¡œë“œí•˜ë ¤ë©´ -C ì˜µì…˜ì„ ì‚¬ìš©í•œë‹¤. ë‹¤ì‹œ aa-status ëª…ë ¹ì„ ìˆ˜í–‰í•˜ë©´ ê¸°ë³¸ í”„ë¡œí•„ê³¼ í•¨ê»˜ í”„ë¡œí•„ì„ ë³´ì—¬ì¤€ë‹¤. <code>Enforce</code> ëª¨ë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo aa-status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apparmor module is loaded.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">49 profiles are loaded.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">45 profiles are in enforce mode.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   docker-default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   k8s-deny-write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>AppArmorëŠ” ìœ í‹¸ë¦¬í‹° íŒ¨í‚¤ì§€ì˜ ì¼ë¶€ë¡œ ì¶”ê°€ ëª…ë ¹ì„ ì§€ì›í•˜ëŠ” ë„êµ¬ë¥¼ ì„¤ì¹˜ í•  ìˆ˜ ìˆë‹¤. ì„¤ì¹˜ê°€ ì™„ë£Œë˜ë©´ aa-enforce ëª…ë ¹ì„ ì‚¬ìš©í•˜ì—¬ <code>Enforce</code> ëª¨ë“œì—ì„œ í”„ë¡œí•„ì„ ë¡œë“œí•˜ê³  aa-complain ëª…ë ¹ì„ ì‚¬ìš©í•˜ì—¬ <code>Complain</code> ëª¨ë“œì—ì„œ í”„ë¡œí•„ì„ ë¡œë“œí•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt-get update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt-get install apparmor-utils</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì»¨í…Œì´ë„ˆì—-í”„ë¡œíŒŒì¼-ì ìš©í•˜ê¸°">ì»¨í…Œì´ë„ˆì— í”„ë¡œíŒŒì¼ ì ìš©í•˜ê¸°<a class="hash-link" href="#ì»¨í…Œì´ë„ˆì—-í”„ë¡œíŒŒì¼-ì ìš©í•˜ê¸°" title="Direct link to heading">â€‹</a></h3><p>íŒŒë“œì— AppArmor ê·œì¹™ì„ ì ìš©í•˜ê¸° ì „ì— ë‹¤ìŒê³¼ ê°™ì€ ì „ì œì¡°ê±´ì„ í™•ì¸í•´ì•¼ í•œë‹¤. </p><ul><li>ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ ì§€ì›: AppArmor ê·œì¹™ì„ ì ìš©í•˜ë ¤ë©´ ì‚¬ìš© ì¤‘ì¸ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ì´ AppArmorë¥¼ ì§€ì›í•´ì•¼ í•œë‹¤. Dockerì™€ ê°™ì€ ëŒ€ë¶€ë¶„ì˜ í˜„ëŒ€ì ì¸ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ì€ AppArmorë¥¼ ì§€ì›í•œë‹¤.</li><li>ì›Œì»¤ ë…¸ë“œì— AppArmor ì„¤ì¹˜: AppArmorê°€ ì œëŒ€ë¡œ ì‘ë™í•˜ë ¤ë©´ íŒŒë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ëª¨ë“  ì›Œì»¤ ë…¸ë“œì— AppArmorê°€ ì„¤ì¹˜ë˜ì–´ ìˆì–´ì•¼ í•œë‹¤.</li><li>í”„ë¡œíŒŒì¼ ë¡œë“œ í™•ì¸: AppArmor í”„ë¡œíŒŒì¼ì´ ì‹œìŠ¤í…œì— ë¡œë“œë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•´ì•¼ í•œë‹¤. </li></ul><p>ì»¨í…Œì´ë„ˆì— í”„ë¡œíŒŒì¼ì„ ì ìš©í•˜ë ¤ë©´ ì•„ë˜ ì˜ˆì‹œ yaml íŒŒì¼ê³¼ ê°™ì´ íŠ¹ì • ì–´ë…¸í…Œì´ì…˜ì„ ì„¤ì •í•´ì•¼ í•œë‹¤. ì–´ë…¸í…Œì´ì…˜ í‚¤ëŠ” <code>container.apparmor.security.beta. kubernetes.io/&lt;ì»¨í…Œì´ë„ˆ ì´ë¦„&gt;</code> í˜•ì‹ì˜ í‚¤ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ì´ ê²½ìš° ì»¨í…Œì´ë„ˆ ì´ë¦„ì€ <code>test</code>ì´ë‹¤. ì „ì²´ í‚¤ëŠ” <code>container.apparmor.security.beta.kubernetes.io/test</code>ì´ë‹¤. ì–´ë…¸í…Œì´ì…˜ì˜ ê°’ì€ localhost/&lt;í”„ë¡œí•„ ì´ë¦„&gt; íŒ¨í„´ì„ ë”°ë¥¸ë‹¤. ì—¬ê¸°ì„œ ì‚¬ìš©í•˜ë ¤ëŠ” ì‚¬ìš©ì ì •ì˜ í”„ë¡œíŒŒì¼ì€ k8s-deny-writeì´ë‹¤. êµ¬ì„± ì˜µì…˜ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ <a href="https://kubernetes.io/docs/tutorials/security/apparmor/" target="_blank" rel="noopener noreferrer">ì¿ ë²„ë„¤í‹°ìŠ¤ ë¬¸ì„œ</a>ë¥¼ ì°¸ì¡°í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: test-apparmor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  annotations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    container.apparmor.security.beta.kubernetes.io/test: localhost/k8s-deny-write </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - name: test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image: busybox:1.28</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    command: ["sh", "-c", "echo 'Test AppArmor!' &amp;&amp; sleep 100h"]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>kubectl apply</code> ëª…ë ¹ì„ ì‹¤í–‰í•˜ê³  íŒŒë“œê°€ â€œ<code>Running</code>â€ ìƒíƒœë¡œ ì „í™˜ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦°ë‹¤:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl apply -f apparmor.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/test-apparmor created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod test-apparmor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME             READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-apparmor   1/1     Running   0          4s</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´ì œ ì»¨í…Œì´ë„ˆì— ì…¸ì„ ë„£ê³  íŒŒì¼ ì“°ê¸° ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl exec -it test-apparmor -- /bin/sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/ # touch test.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">touch: test.txt: Permission denied</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>AppArmorëŠ” ì»¨í…Œì´ë„ˆì˜ íŒŒì¼ì‹œìŠ¤í…œì— íŒŒì¼ì„ ì“°ì§€ ëª»í•˜ê²Œ í•œë‹¤. ì‘ì—…ì„ ìˆ˜í–‰í•˜ë ¤ê³  í•˜ë©´ â€œPermission deniedâ€ë¼ëŠ” ë©”ì‹œì§€ê°€ í‘œì‹œëœë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="seccomp-ì‚¬ìš©">Seccomp ì‚¬ìš©<a class="hash-link" href="#seccomp-ì‚¬ìš©" title="Direct link to heading">â€‹</a></h2><p>SeccompëŠ” Linux ì»¤ë„ì˜ ë³´ì•ˆ ê¸°ëŠ¥ìœ¼ë¡œ, "Secure Computing Mode"ì˜ ì¤„ì„ë§ì´ë‹¤. seccompëŠ” user spaceì—ì„œ ì»¤ë„ë¡œì˜ í˜¸ì¶œì„ ì œí•œí•  ìˆ˜ ìˆëŠ” ë˜ ë‹¤ë¥¸ Linux ì»¤ë„ ê¸°ëŠ¥ì´ë‹¤. seccomp í”„ë¡œíŒŒì¼ì— ì‹œìŠ¤í…œ í˜¸ì¶œê³¼ ê·¸ ì¸ìˆ˜ë¥¼ ì œí•œí•˜ëŠ” ê·œì¹™ì„ ì •ì˜í•˜ê²Œ ëœë‹¤. seccompë¥¼ ì‚¬ìš©í•˜ë©´ Linux ì»¤ë„ ì·¨ì•½ì ì„ ì•…ìš©í•  ìœ„í—˜ì„ ì¤„ì¼ ìˆ˜ ìˆë‹¤. Kubernetesì—ì„œëŠ” seccomp í”„ë¡œí•„ì„ Podì˜ securityContextë¥¼ í†µí•´ ì ìš©í•  ìˆ˜ ìˆê³ , ê¸°ë³¸ì ìœ¼ë¡œ RuntimeDefault í”„ë¡œí•„ì„ ì‚¬ìš©í•˜ì—¬ ë³´ì•ˆ ë¯¼ê°ë„ê°€ ë†’ì€ ì‹œìŠ¤í…œ í˜¸ì¶œì„ ì°¨ë‹¨í•  ìˆ˜ ìˆë‹¤. ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ seccompì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ <a href="https://kubernetes.io/docs/tutorials/security/seccomp/" target="_blank" rel="noopener noreferrer">ì¿ ë²„ë„¤í‹°ìŠ¤ ë¬¸ì„œ</a>ë¥¼ ì°¸ì¡°í•œë‹¤.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì»¨í…Œì´ë„ˆì—-ê¸°ë³¸-ì»¨í…Œì´ë„ˆ-ëŸ°íƒ€ì„-í”„ë¡œíŒŒì¼-ì ìš©í•˜ê¸°">ì»¨í…Œì´ë„ˆì— ê¸°ë³¸ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ í”„ë¡œíŒŒì¼ ì ìš©í•˜ê¸°<a class="hash-link" href="#ì»¨í…Œì´ë„ˆì—-ê¸°ë³¸-ì»¨í…Œì´ë„ˆ-ëŸ°íƒ€ì„-í”„ë¡œíŒŒì¼-ì ìš©í•˜ê¸°" title="Direct link to heading">â€‹</a></h3><p>ë„ì»¤ ì—”ì§„ì´ë‚˜ ì»¨í…Œì´ë„ˆì™€ ê°™ì€ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ì€ ê¸°ë³¸ seccomp í”„ë¡œíŒŒì¼ê³¼ í•¨ê»˜ ì œê³µëœë‹¤. ê¸°ë³¸ seccomp í”„ë¡œíŒŒì¼ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ê°€ì¥ ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” <code>syscalls</code>ì„ í—ˆìš©í•˜ëŠ” ë™ì‹œì— ìœ„í—˜í•˜ë‹¤ê³  ê°„ì£¼ë˜ëŠ” <code>syscalls</code>ì˜ ì‚¬ìš©ì„ ê¸ˆì§€í•œë‹¤. ì¿ ë²„ë„¤í‹°ìŠ¤ëŠ” íŒŒë“œë¥¼ ìƒì„±í•  ë•Œ ê¸°ë³¸ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ í”„ë¡œíŒŒì¼ì„ ì»¨í…Œì´ë„ˆì— ì ìš©í•˜ì§€ ì•Šì§€ë§Œ, SeccompDefault <a href="https://kubernetes.io/docs/reference/command-line-tools-reference/feature-gates/" target="_blank" rel="noopener noreferrer">feature gate</a>ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ë¥¼ í™œì„±í™”í•  ìˆ˜ ìˆë‹¤. ë˜ëŠ” <code>spec.securityContext.seccompProfile</code>ì„ ì‚¬ìš©í•˜ì—¬ seccomp í”„ë¡œíŒŒì¼ ìœ í˜•ì„ <code>RuntimeDefault</code>ë¡œ ì„¤ì •í•˜ì—¬ íŒŒë“œ ë‹¨ìœ„ë¡œ ì´ ê¸°ëŠ¥ì„ ì„ íƒí•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Pod </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: test-seccomp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  securityContext: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    seccompProfile:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      type: RuntimeDefault </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - name: test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image: busybox:1.28</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    command: ["sh", "-c", "echo 'Test seccomp!' &amp;&amp; sleep 100h"]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê¸°ë³¸ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ í”„ë¡œíŒŒì¼ì„ ì ìš©í•œë‹¤. <code>kubectl apply</code> ëª…ë ¹ì„ ì‚¬ìš©í•˜ì—¬ íŒŒë“œë¥¼ ì‹œì‘í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl apply -f seccomp.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/test-seccomp created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod test-seccomp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME            READY   STATUS      RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello-seccomp   1/1     Running     0          4s</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì»¨í…Œì´ë„ˆì—ì„œ ì‹¤í–‰ë˜ëŠ” <code>echo</code> ëª…ë ¹ì€ ê¸°ë³¸ seccomp í”„ë¡œíŒŒì¼ì— ì˜í•´ ë³´ì•ˆ ê´€ì ì—ì„œ ë¬¸ì œê°€ ì—†ëŠ” ê²ƒìœ¼ë¡œ ë³¸ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl logs hello-seccomp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test seccomp!</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>RuntimeDefault</code>ë¡œ <code>syscalls</code>ì´ í—ˆìš©ë˜ì—ˆê³  ê·¸ ê²°ê³¼ í‘œì¤€ ì¶œë ¥ì— "Test seccomp!â€ë¼ëŠ” ë©”ì‹œì§€ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì‚¬ìš©ì-ì§€ì •-í”„ë¡œí•„-ì„¤ì •-1">ì‚¬ìš©ì ì§€ì • í”„ë¡œí•„ ì„¤ì •<a class="hash-link" href="#ì‚¬ìš©ì-ì§€ì •-í”„ë¡œí•„-ì„¤ì •-1" title="Direct link to heading">â€‹</a></h3><p>ê¸°ë³¸ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ í”„ë¡œíŒŒì¼ ì™¸ì— ì‚¬ìš©ì ì •ì˜ í”„ë¡œíŒŒì¼ì„ ìƒì„±í•˜ê³  ì„¤ì •í•  ìˆ˜ ìˆë‹¤. ì´ëŸ¬í•œ íŒŒì¼ì˜ í‘œì¤€ ë””ë ‰í„°ë¦¬ëŠ” <code>/var/lib/kubelet/seccomp</code>ì´ë‹¤. ì‚¬ìš©ì ì •ì˜ í”„ë¡œíŒŒì¼ì€ í•˜ìœ„ ë””ë ‰í„°ë¦¬ í”„ë¡œíŒŒì¼ì— êµ¬ì„±í•œë‹¤. ë””ë ‰í„°ë¦¬ê°€ ì—†ëŠ” ê²½ìš° ë””ë ‰í„°ë¦¬ë¥¼ ìƒì„±í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    sudo mkdir -p /var/lib/kubelet/seccomp/profiles</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í”„ë¡œí•„ ë””ë ‰í„°ë¦¬ì— ìˆëŠ” violation.json íŒŒì¼ì— ì‚¬ìš©ì ì •ì˜ í”„ë¡œí•„ì„ ìƒì„±í•œë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "defaultAction": "SCMP_ACT_ALLOW",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "architectures": [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "SCMP_ARCH_X86_64",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "SCMP_ARCH_X86",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "SCMP_ARCH_X32"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "syscalls": [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "names": [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "mkdir"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "action": "SCMP_ACT_ERRNO"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê°„ë‹¨íˆ ë§í•´ì„œ, ì´ ê·œì¹™ ì„¸íŠ¸ëŠ” mkdirì˜ ì‚¬ìš©ì„ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. ì•„ë˜ ê·œì¹™ì€ ëª¨ë“  <code>syscalls</code>ì„ í—ˆìš©í•˜ê³ , <code>syscalls</code> ë¦¬ìŠ¤íŠ¸ì— íŠ¹ë³„íˆ ì •ì˜ëœ ê²ƒë§Œ ê±°ë¶€í•˜ëŠ” ë¸”ë™ë¦¬ìŠ¤íŠ¸ ë°©ì‹ì´ë‹¤. ë°˜ëŒ€ë¡œ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ë°©ì‹ì€ <code>syscalls</code>ì— <code>SCMP_ACT_ALLOW</code>, <code>SCMP_ACT_ERRNO</code> ìœ„ì¹˜ë¥¼ ë°”ê¿”ì„œ ì‚¬ìš©í•˜ë©´ ëœë‹¤. </p><p>ê¸°ë³¸ ì¡°ì¹˜ëŠ” ëª¨ë“  ì‹œìŠ¤í…œ í˜¸ì¶œì— ì ìš©ëœë‹¤. ì—¬ê¸°ì„œëŠ” ë¸”ë™ë¦¬ìŠ¤íŠ¸ ë°©ì‹ìœ¼ë¡œ <code>SCMP_ACT_ALLOW</code>ë¥¼ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ì‹œìŠ¤í…œ í˜¸ì¶œì„ í—ˆìš©í•˜ê³ , <code>SCMP_ACT_ERRNO</code> ì•¡ì…˜ì€ mkdir syscallì˜ ì‹¤í–‰ì„ ë°©ì§€í•˜ë„ë¡ ê·œì¹™ì„ ì‘ì„±í–ˆë‹¤. </p><p>ì‚¬ìš©ì ì •ì˜ í”„ë¡œíŒŒì¼ì„ /var/lib/kubelet/seccomp ë””ë ‰í„°ë¦¬ì— ë°°ì¹˜í•´ë„ ìë™ìœ¼ë¡œ ê·œì¹™ì´ íŒŒë“œì— ì ìš©ë˜ì§€ëŠ” ì•Šê¸° ë•Œë¬¸ì— íŒŒë“œì— í”„ë¡œíŒŒì¼ì„ ì ìš©í•´ì•¼ í•œë‹¤.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì»¨í…Œì´ë„ˆì—-ì‚¬ìš©ì-ì •ì˜-í”„ë¡œíŒŒì¼-ì ìš©í•˜ê¸°">ì»¨í…Œì´ë„ˆì— ì‚¬ìš©ì ì •ì˜ í”„ë¡œíŒŒì¼ ì ìš©í•˜ê¸°<a class="hash-link" href="#ì»¨í…Œì´ë„ˆì—-ì‚¬ìš©ì-ì •ì˜-í”„ë¡œíŒŒì¼-ì ìš©í•˜ê¸°" title="Direct link to heading">â€‹</a></h3><p>ì‚¬ìš©ì ì •ì˜ í”„ë¡œíŒŒì¼ì„ ì ìš©í•˜ëŠ” ê²ƒì€ ê¸°ë³¸ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ í”„ë¡œíŒŒì¼ì„ ì ìš©í•˜ëŠ” ê²ƒê³¼ ë¹„ìŠ·í•œ íŒ¨í„´ì„ ë”°ë¥´ì§€ë§Œ ì•½ê°„ì˜ ì°¨ì´ê°€ ìˆë‹¤. ë³´ì•ˆ í”„ë¡œíŒŒì¼ì˜ seccompProfile ì†ì„±ì„ violation.json íŒŒì¼ì„ ê°€ë¦¬í‚¤ê³  ìœ í˜•ì„ Localhostë¡œ ì„¤ì •í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Pod </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: test-seccomp2 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  securityContext: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    seccompProfile:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      type: Localhost // ë…¸ë“œì˜ í”„ë¡œí•„ì„ ì°¸ì¡°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      localhostProfile: profiles/violation.json  //í•˜ìœ„ ë””ë ‰í„°ë¦¬ í”„ë¡œí•„ì— violation.jsonì´ë¼ëŠ” ì´ë¦„ì˜ í”„ë¡œí•„ì„ ì ìš©</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - name: test2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image: busybox:1.28</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    command: ["sh", "-c", "echo 'Test seccomp!' &amp;&amp; sleep 100h"] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    securityContext:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      allowPrivilegeEscalation: false</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì»¤ìŠ¤í…€ í”„ë¡œíŒŒì¼ì„ ì ìš©í•œë‹¤. <code>kubectl apply</code> ëª…ë ¹ì„ ì‚¬ìš©í•˜ì—¬ íŒŒë“œë¥¼ ì‹œì‘í•œë‹¤. íŒŒë“œê°€ "Running" ìƒíƒœë¡œ ì „í™˜ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦°ë‹¤:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl apply -f seccomp.yaml </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/test-seccomp2 created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod test-seccomp2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME            READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-seccomp2   1/1     Running   0          40s</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì»¨í…Œì´ë„ˆì— ì…¸ì„ ì‹¤í–‰í•˜ì—¬ seccompê°€ ì ìš©ëœ ê·œì¹™ì„ ì œëŒ€ë¡œ ì ìš©í–ˆëŠ”ì§€ í™•ì¸í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl exec -it test-seccomp2 -- /bin/sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/ # mkdir test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir: can't create directory 'test': Operation not permitted</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì¶œë ¥ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´, ì´ ì‘ì—…ì€ mkdir ëª…ë ¹ì„ ì‹¤í–‰í•˜ë ¤ê³  í•  ë•Œ ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ ë Œë”ë§í•œë‹¤. ì‚¬ìš©ì ì§€ì • í”„ë¡œí•„ì˜ ê·œì¹™ì„ ìœ„ë°˜í–ˆë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ìš”ì•½">ìš”ì•½<a class="hash-link" href="#ìš”ì•½" title="Direct link to heading">â€‹</a></h2><p>ì»¨í…Œì´ë„ˆì—ì„œ ì‹¤í–‰ë˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ í”„ë¡œì„¸ìŠ¤ê°€ ì‹œìŠ¤í…œ í˜¸ì¶œì„ í•˜ëŠ” ê²ƒì€ ë§¤ìš° ì¼ë°˜ì ì´ë‹¤. ë³´ì•ˆ ì¸¡ë©´ì„ ë‹¤ë£¨ëŠ” ê²ƒì€ í˜¸ìŠ¤íŠ¸ ì‹œìŠ¤í…œ ìˆ˜ì¤€ì—ì„œ í™•ì¸í•´ì•¼ í•  ê²Œ ë§ê¸° ë•Œë¬¸ì— AppArmor ë° seccompì™€ ê°™ì€ Linux ì»¤ë„ ê°•í™” ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ëŸ¬í•œ ì‹œìŠ¤í…œ í˜¸ì¶œì„ ì œí•œí•  ìˆ˜ ìˆë‹¤. ì´ëŸ° ë„êµ¬ë“¤ì„ ì˜ í™œìš©í•˜ë©´ Kubernetesì™€ í†µí•©í•˜ì—¬ ë³´ë‹¤ ì•ˆì „í•œ í´ëŸ¬ìŠ¤í„° ìš´ì˜ì„ í•  ìˆ˜ ìˆë‹¤.</p>]]></content>
        <author>
            <name>Jinwoong Kim</name>
            <uri>https://www.linkedin.com/in/ddiiwoong/</uri>
        </author>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="AppArmor" term="AppArmor"/>
        <category label="seccomp" term="seccomp"/>
        <category label="security" term="security"/>
        <category label="CKS" term="CKS"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[prometheus grafana ìŠ¤íƒìœ¼ë¡œ k6 í…ŒìŠ¤íŠ¸ ê²°ê³¼ í™•ì¸í•˜ê¸°]]></title>
        <id>kubernetes/k6-prometheus/</id>
        <link href="https://ddii.dev/kubernetes/k6-prometheus/"/>
        <updated>2023-04-08T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[k6ìœ¼ë¡œ ì§„í–‰í•œ ë¶€í•˜ í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ remote write í˜•íƒœë¡œ prometheusì— ì „ë‹¬í•˜ê³  grafana ëŒ€ì‹œë³´ë“œë¡œ í™•ì¸í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³¸ë‹¤.]]></summary>
        <content type="html"><![CDATA[<p>ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë¶€í•˜ í…ŒìŠ¤íŠ¸ë¥¼ k6ë¥¼ ì´ìš©í•˜ì—¬ ì§„í–‰í•˜ê³  ê²°ê³¼ë¥¼ prometheus ë° grafanaë¡œ ì „ë‹¬í•˜ì—¬ í™•ì¸í•˜ëŠ” ë°©ë²•ì„ ì‘ì„±í•œë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="k6">k6<a class="hash-link" href="#k6" title="Direct link to heading">â€‹</a></h2><p><a href="https://github.com/grafana/k6" target="_blank" rel="noopener noreferrer">https://github.com/grafana/k6</a></p><p>k6ëŠ” ì˜¤í”ˆì†ŒìŠ¤ ë¶€í•˜í…ŒìŠ¤íŠ¸ ë„êµ¬ë¡œ, Goì™€ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì´ìš©í•´ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ë¥¼ í•  ìˆ˜ ìˆëŠ” ë„êµ¬ì´ë‹¤. k6ì€ ë‹¤ì–‘í•œ í”„ë¡œí† ì½œ(HTTP, WebSocket ë“±)ì„ ì§€ì›í•˜ë©°, ì„¤ì¹˜ì™€ ì‚¬ìš©ì´ ë§¤ìš° ê°„í¸í•˜ë‹¤. ì´ì „ì— k6 í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•´ ë³¸ ì ì´ ì—†ë‹¤ë©´ <a href="https://k6.io/docs/getting-started/running-k6" target="_blank" rel="noopener noreferrer">Running k6</a>ë¥¼ í™•ì¸í•˜ê³  ì‘ë™ ë°©ì‹ì„ íŒŒì•…í•˜ëŠ” ê²ƒë¶€í„° ì‹œì‘í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. ë˜í•œ, ì¹œì² í•˜ê²Œ í•œê¸€ë¡œ ì„¤ëª…ë˜ì–´ ìˆëŠ” tutorial ë§í¬ë„ ì°¸ì¡°í•œë‹¤.</p><p><a href="https://github.com/schooldevops/k6-tutorials/blob/main/GettingStarts/01_intro_install.md" target="_blank" rel="noopener noreferrer">https://github.com/schooldevops/k6-tutorials/blob/main/GettingStarts/01_intro_install.md</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="prometheus-stack">Prometheus Stack<a class="hash-link" href="#prometheus-stack" title="Direct link to heading">â€‹</a></h2><p>ì§€ë‚œë²ˆ êµ¬ì„±í–ˆë˜ ê²ƒë„ ë™ì¼í•˜ê²Œ kube-prometheus-stackì„ ì„¤ì¹˜í•œë‹¤. </p><p><a href="https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack" target="_blank" rel="noopener noreferrer">kube-prometheus-stack</a>ì€ Kubernetes í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ Prometheusì™€ Grafanaë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë‹ˆí„°ë§ì„ êµ¬ì„±í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” í¸ë¦¬í•œ ì°¨íŠ¸ì´ë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ helm repo add prometheus-community https://prometheus-community.github.io/helm-charts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ helm install -n monitoring kube-prometheus-stack prometheus-community/kube-prometheus-stack</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Prometheus remote write ì¶œë ¥ì„ í†µí•´ k6ëŠ” í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë©”íŠ¸ë¦­ì„ Prometheus remote write ì—”ë“œí¬ì¸íŠ¸ë¡œ ì „ì†¡í•  ìˆ˜ ìˆë‹¤. ë’¤ì— ì§„í–‰í•  k6ì—ì„œ Prometheus ìª½ìœ¼ë¡œ ë©”íŠ¸ë¦­ì„ ì „ë‹¬í•˜ê¸° ìœ„í•´ì„œëŠ” ë‘ê°€ì§€ ê¸°ëŠ¥(flag)ì¸ <a href="https://prometheus.io/docs/prometheus/latest/feature_flags/#remote-write-receiver" target="_blank" rel="noopener noreferrer">Remote Write Receiver</a>ì™€ <a href="https://prometheus.io/docs/prometheus/latest/feature_flags/#native-histograms" target="_blank" rel="noopener noreferrer">Native Histograms</a>ì„ í™œì„±í™” í•´ì•¼í•œë‹¤.</p><ul><li><a href="https://prometheus.io/docs/prometheus/latest/feature_flags/#remote-write-receiver" target="_blank" rel="noopener noreferrer">Remote Write Receiver</a>: remote write í™œì„±í™”</li><li><a href="https://prometheus.io/docs/prometheus/latest/feature_flags/#native-histograms" target="_blank" rel="noopener noreferrer">Native Histograms</a>: ê³ í•´ìƒë„ íˆìŠ¤í† ê·¸ë¨ì„ ìœ„í•œ ê¸°ëŠ¥ í™œì„±í™” (experimental)</li></ul><p>ë‘ê°€ì§€ flagë¥¼ í™œì„±í™” í•˜ê¸° ìœ„í•´ ìœ„ì— ì„¤ì¹˜í•œ <code>kube-prometheus-stack</code> ì°¨íŠ¸ì— ìœ„ ë‘ê°€ì§€ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ì—¬ ë‹¤ì‹œ ë°°í¬í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">prometheus</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">serviceMonitor</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enableFeatures</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> remote</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">receiver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> native</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">histograms</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ helm upgrade -n monitoring kube-prometheus-stack prometheus-community/kube-prometheus-stack -f value.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="k6-operator-ì„¤ì¹˜-ë°-êµ¬ì„±">k6-operator ì„¤ì¹˜ ë° êµ¬ì„±<a class="hash-link" href="#k6-operator-ì„¤ì¹˜-ë°-êµ¬ì„±" title="Direct link to heading">â€‹</a></h2><p>ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œ k6ë¥¼ êµ¬ì„±í•˜ëŠ” ë°©ë²•ì€ ì§ì ‘ k6 ë°”ì´ë„ˆë¦¬ë¥¼ ì»¨í…Œì´ë„ˆë¡œ ë¹Œë“œí•´ì„œ ì‚¬ìš©í•  ìˆ˜ë„ ìˆê³  ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ì‹¤í–‰í•˜ëŠ” ë°©ë²•ë„ ìˆì§€ë§Œ ì¿ ë²„ë„¤í‹°ìŠ¤ ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•˜ê³  ì—¬ëŸ¬ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ë™ì‹œì— ë¶€í•˜ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ë ¤ëŠ” ìš”êµ¬ì‚¬í•­ì´ ìˆì„ ê²½ìš°ì—ëŠ” k6-operator ë¡œ êµ¬ì„±í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•œë‹¤.</p><p><a href="https://github.com/grafana/k6-operator" target="_blank" rel="noopener noreferrer">https://github.com/grafana/k6-operator</a></p><p>ê¸°ë³¸ì ìœ¼ë¡œ ë°”ì´ë„ˆë¦¬ ë° í”ŒëŸ¬ê·¸ì¸ ë¹Œë“œë¥¼ í•˜ê³  ë°°í¬í•˜ëŠ” í˜•íƒœë¥¼ ì·¨í•˜ë‹¤ ë³´ë‹ˆ <a href="https://golang.org/doc/install" target="_blank" rel="noopener noreferrer"><code>Go</code></a>, <a href="https://github.com/kubernetes-sigs/kustomize/" target="_blank" rel="noopener noreferrer"><code>Kustomize</code></a>, <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/" target="_blank" rel="noopener noreferrer"><code>Kubectl</code></a>, <code>Make</code> ë“±ì´ ì„¤ì¹˜ë˜ì–´ ìˆì–´ì•¼ í•œë‹¤. </p><p>ì„¤ì¹˜ ëª…ë ¹ì€ <code>MacOs</code> ê¸°ì¤€ìœ¼ë¡œ ì„¤ëª…í•œë‹¤. ì¼ë‹¨ ë ˆí¬ì§€í† ë¦¬ë¥¼ ë¡œì»¬ë¡œ ê°€ì ¸ì˜¤ê³  ë‚˜ì„œ <code>make deploy</code> ëª…ë ¹ì„ ìˆ˜í–‰í•˜ë©´ operator êµ¬ì„±ì´ ì™„ë£Œëœë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ git clone https://github.com/grafana/k6-operator &amp;&amp; cd k6-operator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ make deploy</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="k6-ìŠ¤í¬ë¦½íŠ¸-ì‘ì„±">k6 ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±<a class="hash-link" href="#k6-ìŠ¤í¬ë¦½íŠ¸-ì‘ì„±" title="Direct link to heading">â€‹</a></h2><p>ì•„ì§ í…ŒìŠ¤íŠ¸ ì¸ìŠ¤í„´ìŠ¤ êµ¬ì„±ì´ ë˜ì–´ ìˆì§€ ì•Šê¸° ë•Œë¬¸ì— í…ŒìŠ¤íŠ¸ë¥¼ ì²« ë‹¨ê³„ ì§„í–‰í•  ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports">http</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'k6/http'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> check </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'k6'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> options </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">stages</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">target</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">200</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">duration</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'30s'</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">target</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">duration</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'30s'</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">default</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'https://test-api.k6.io/public/crocodiles/'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">check</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">'http response status code is 200'</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">status</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">200</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚´í´ë³´ë©´ì„œ ê°ê° 30ì´ˆ ë™ì•ˆ ì‹¤í–‰ë˜ëŠ” ë‘ ë‹¨ê³„ë¥¼ ì„¤ì •í–ˆë‹¤. ì²« ë²ˆì§¸ ë‹¨ê³„ëŠ” 30ì´ˆ ë™ì•ˆ 200 virtual users(ì´í•˜ VUs)ê¹Œì§€ ì„ í˜•ì ìœ¼ë¡œ ì¦ê°€ì‹œí‚¨ë‹¤. ë‘ ë²ˆì§¸ ë‹¨ê³„ì—ì„œëŠ” 30ì´ˆì— ê±¸ì³ ë‹¤ì‹œ VUsë¥¼ 0ìœ¼ë¡œ ê°ì†Œì‹œí‚¨ë‹¤. function() ì—ì„œëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•  URLì— ëŒ€í•´ HTTP GET ìš”ì²­ì„ ì‹¤í–‰í•˜ê³  HTTP ìƒíƒœ 200ìœ¼ë¡œ ì‘ë‹µí•˜ëŠ”ì§€ í™•ì¸í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">k6 run scripts.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          /\      |â€¾â€¾| /â€¾â€¾/   /â€¾â€¾/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     /\  /  \     |  |/  /   /  /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /  \/    \    |     (   /   â€¾â€¾\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   /          \   |  |\  \ |  (â€¾)  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  / __________ \  |__| \__\ \_____/ .io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  execution: local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     script: scripts.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     output: -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scenarios: (100.00%) 1 scenario, 200 max VUs, 1m30s max duration (incl. graceful stop):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           * default: Up to 200 looping VUs for 1m0s over 2 stages (gracefulRampDown: 30s, gracefulStop: 30s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     âœ“ http response status code is 200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     checks.........................: 100.00% âœ“ 2893      âœ— 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     data_received..................: 3.5 MB  58 kB/s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     data_sent......................: 416 kB  6.9 kB/s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     http_req_blocked...............: avg=49.33ms min=1Âµs      med=3Âµs   max=3.45s    p(90)=16Âµs    p(95)=377.18ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     http_req_connecting............: avg=13.09ms min=0s       med=0s    max=199.77ms p(90)=0s      p(95)=186.36ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     http_req_duration..............: avg=2.14s   min=190.5ms  med=1.32s max=5.79s    p(90)=5.39s   p(95)=5.57s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       { expected_response:true }...: avg=2.14s   min=190.5ms  med=1.32s max=5.79s    p(90)=5.39s   p(95)=5.57s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     http_req_failed................: 0.00%   âœ“ 0         âœ— 2893</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     http_req_receiving.............: avg=81.97Âµs min=19Âµs     med=61Âµs  max=2.43ms   p(90)=141.8Âµs p(95)=205.4Âµs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     http_req_sending...............: avg=22.37Âµs min=5Âµs      med=16Âµs  max=687Âµs    p(90)=38Âµs    p(95)=57Âµs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     http_req_tls_handshaking.......: avg=36.2ms  min=0s       med=0s    max=3.2s     p(90)=0s      p(95)=190.18ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     http_req_waiting...............: avg=2.14s   min=190.38ms med=1.32s max=5.79s    p(90)=5.39s   p(95)=5.57s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     http_reqs......................: 2893    48.176768/s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     iteration_duration.............: avg=2.19s   min=190.7ms  med=1.39s max=6.05s    p(90)=5.4s    p(95)=5.58s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     iterations.....................: 2893    48.176768/s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     vus............................: 1       min=1       max=200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     vus_max........................: 200     min=200     max=200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">running (1m00.0s), 000/200 VUs, 2893 complete and 0 interrupted iterations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default âœ“ [======================================] 000/200 VUs  1m0s</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="k6-ìŠ¤í¬ë¦½íŠ¸-ì»¨í”¼ê·¸ë§µ-ìƒì„±">k6 ìŠ¤í¬ë¦½íŠ¸ ì»¨í”¼ê·¸ë§µ ìƒì„±<a class="hash-link" href="#k6-ìŠ¤í¬ë¦½íŠ¸-ì»¨í”¼ê·¸ë§µ-ìƒì„±" title="Direct link to heading">â€‹</a></h2><p>í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ê°€ ì •ìƒì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆëŠ” í™•ì¸í•œ ë’¤ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ë¨¼ì € ì»¨í”¼ê·¸ë§µì„ ìƒì„±í•œë‹¤. ì´ë¦„ì€ ì´í›„ k6 runner íŒŒë“œì—ì„œ ì‚¬ìš©í•˜ëŠ” ì»¨í”¼ê·¸ë§µì„ ì°¸ì¡°í•˜ë„ë¡ ì‹ë³„í•  ìˆ˜ ìˆëŠ” ê°’(ì˜ˆì‹œì—ì„œëŠ” <code>test-script</code>)ìœ¼ë¡œ ì§€ì •í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create configmap test-script --from-file /home/ec2-user/environment/k6/scritps.js </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">configmap/test-script created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="k6-prometheus-ì´ë¯¸ì§€-ë¹Œë“œ">k6 prometheus ì´ë¯¸ì§€ ë¹Œë“œ<a class="hash-link" href="#k6-prometheus-ì´ë¯¸ì§€-ë¹Œë“œ" title="Direct link to heading">â€‹</a></h3><p>ê¸°ë³¸ì ìœ¼ë¡œ k6-operatorëŠ” í…ŒìŠ¤íŠ¸ ì‘ì—…ì˜ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¡œ <code>grafana/k6:latest</code>ë¥¼ ì‚¬ìš©í•œë‹¤. xk6ë¡œ ë¹Œë“œëœ í™•ì¥ì„ ì‚¬ìš©í•˜ë ¤ë©´ ìì²´ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ê³  k6 ì¿ ë²„ë„¤í‹°ìŠ¤ ë°°í¬ ë¦¬ì†ŒìŠ¤ì—ì„œ ì´ë¯¸ì§€ ì†ì„±ì„ ë°”ê¿”ì„œ ë°°í¬í•´ì•¼ í•œë‹¤. ë‹¤ìŒ Dockerfileì„ ì‚¬ìš©í•˜ì—¬ <a href="https://github.com/grafana/xk6-output-prometheus-remote" target="_blank" rel="noopener noreferrer">https://github.com/grafana/xk6-output-prometheus-remote</a> ë¡œ ë¹Œë“œí•œ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-dockerfile theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain"># Build the k6 binary with the extension</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM golang:1.18.1 as builder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN go install go.k6.io/xk6/cmd/xk6@latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN xk6 build --output /k6 --with github.com/grafana/xk6-output-prometheus-remote@latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Use the operator's base image and override the k6 binary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM grafana/k6:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY --from=builder /k6 /usr/bin/k6</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ docker build -t k6-prometheus:v1 .</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë¹Œë“œí•œ ì´ë¯¸ì§€ë¥¼ ì›í•˜ëŠ” ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— pushí•˜ê³  image ê²½ë¡œë¥¼ ê¸°ë¡í•´ ë†“ëŠ”ë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="k6-ë¦¬ì†ŒìŠ¤-ìƒì„±">k6 ë¦¬ì†ŒìŠ¤ ìƒì„±<a class="hash-link" href="#k6-ë¦¬ì†ŒìŠ¤-ìƒì„±" title="Direct link to heading">â€‹</a></h2><p>ìƒì„±ì´ ë˜ê³  ë‚˜ë©´ <code>k6</code> ì»¤ìŠ¤í…€ ë¦¬ì†ŒìŠ¤(CRD)ë¥¼ ë™ì¼í•œ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ë§Œë“ ë‹¤. ë¶€í•˜ í…ŒìŠ¤íŠ¸ì— í•„ìš”í•œ ë‚´ìš©ë“¤ì„ í¬í•¨í•˜ê³  ìˆë‹¤.</p><ul><li><code>arguments: -o xk6-prometheus-rw --tag testid=alb</code><ul><li>Prometheusì˜ ì‹¤í–‰ì¸ìë¡œ ìœ„ì—ì„œ ë¹Œë“œí•œ ì´ë¯¸ì§€ì˜ ì˜µì…˜ ê°’, <code>tag</code>ì˜ ê²½ìš° ê·¸ë¼íŒŒë‚˜ ëŒ€ì‹œë³´ë“œì— êµ¬ë¶„ìë¡œ ì‚¬ìš©í•  ê°’</li></ul></li><li><code>K6_PROMETHEUS_RW_SERVER_URL</code><ul><li>remote write endpointë¡œ ìœ„ì— êµ¬ì„±í•œ prometheus endpointë¥¼ ê¸°ì¬</li></ul></li><li><code>K6_PROMETHEUS_RW_TREND_AS_NATIVE_HISTOGRAM</code><ul><li>ê³ í•´ìƒë„ íˆìŠ¤í† ê·¸ë¨ í˜•íƒœì˜ ë°ì´í„°ë¥¼ ë³´ë‚´ê¸° ìœ„í•œ í™˜ê²½ ë³€ìˆ˜ ê°’ (ê¸°ë³¸ê°’: false)</li></ul></li><li><code>image: k6-prometheus:v1</code><ul><li>ìœ„ì—ì„œ ë¹Œë“œí•œ Prometheus remote write ê¸°ëŠ¥ì´ í¬í•¨ëœ ì´ë¯¸ì§€ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ê²½ë¡œë¥¼ ì…ë ¥</li></ul></li><li><code>configMap</code><ul><li>ì»¨í”¼ê·¸ë§µìœ¼ë¡œ ë“±ë¡í•œ ë¶€í•˜ ìŠ¤í¬ë¦½íŠ¸</li></ul></li></ul><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> k6.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> K6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> k6</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">sample</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">arguments</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">o xk6</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">prometheus</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">rw </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">tag testid=test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">parallelism</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">runner</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> K6_PROMETHEUS_RW_SERVER_URL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//kube</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">prometheus</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">stack</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">prometheus.monitoring</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">9090/api/v1/write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> K6_PROMETHEUS_RW_TREND_AS_NATIVE_HISTOGRAM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"true"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> k6</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">prometheus</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">script</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">configMap</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">file</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> scritps.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> test</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">script</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í´ëŸ¬ìŠ¤í„°ì—ì„œ ë‘ ê°œ ì´ìƒì˜ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ê° ìŠ¤í¬ë¦½íŠ¸ì— ëŒ€í•´ ì´ í”„ë¡œì„¸ìŠ¤ë¥¼ ë°˜ë³µí•˜ì—¬ ë§µì— ë‹¤ë¥¸ ì´ë¦„ì„ ì§€ì •í•˜ë©´ ëœë‹¤. k6 ë¦¬ì†ŒìŠ¤ë¥¼ ë°°í¬í•˜ê²Œ ë˜ë©´ ì´ì œë¶€í„° ë°°í¬ í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë©”íŠ¸ë¦­ ê°’ì´ í”„ë¡œë©”í…Œìš°ìŠ¤ë¡œ ë°”ë¡œ ì „ë‹¬ì´ ëœë‹¤.  </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="grafana-ëŒ€ì‹œë³´ë“œ-ë“±ë¡">Grafana ëŒ€ì‹œë³´ë“œ ë“±ë¡<a class="hash-link" href="#grafana-ëŒ€ì‹œë³´ë“œ-ë“±ë¡" title="Direct link to heading">â€‹</a></h2><p><a href="https://grafana.com/grafana/dashboards/18030-test-result/" target="_blank" rel="noopener noreferrer"><code>18030</code> grafana ëŒ€ì‹œë³´ë“œ</a>ë¥¼ import í•˜ë©´ ë‹¤ìŒ ê·¸ë¦¼ê³¼ ê°™ì€ ëŒ€ì‹œë³´ë“œë¥¼ í†µí•´ í˜„ì¬ ë¦¬í€˜ìŠ¤íŠ¸ í˜„í™©(ì„±ê³µ, ì‹¤íŒ¨), ì§€ì—°ì‹œê°„, ë°ì´í„° ì „ì†¡ëŸ‰, VUs ë“±ì„ ìµœëŒ€ í”„ë¡œë©”í…Œìš°ìŠ¤ê°€ ìˆ˜ì§‘ ìµœëŒ€ ì£¼ê¸° ê¸°ì¤€ì˜ ì¤€ ì‹¤ì‹œê°„ ìˆ˜ì¤€ìœ¼ë¡œ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤.</p><p><img loading="lazy" alt="dashboard" src="/assets/images/k6-dashboard-31d848ca448fdfe6bb2f6e37338ebce1.png" width="850" height="646" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ì´ë²ˆ 4ì£¼ì°¨ ìŠ¤í„°ë””ì—ëŠ” Grafanaê°€ í¬í•¨ëœ Prometheus Stackì— k6 í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë©”íŠ¸ë¦­ì„ ì „ë‹¬í•˜ê³ , ëŒ€ì‹œë³´ë“œë¡œ í™•ì¸í•˜ëŠ” ë°©ë²•ì„ ì •ë¦¬í–ˆë‹¤. ì´ë²ˆ ê¸€ì—ì„œëŠ” ë‹¤ë£¨ì§€ ì•Šì•˜ì§€ë§Œ k6ëŠ” ë¸Œë¼ìš°ì €ì— ë…¹í™”ëœ ìŠ¤í¬ë¦½íŠ¸ ê¸°ë°˜ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ê°€ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— ë‹¤ì–‘í•œ ì‹œë‚˜ë¦¬ì˜¤ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ë§Œì¡±ìŠ¤ëŸ½ê²Œ ì§„í–‰í•  ìˆ˜ ìˆì—ˆë‹¤. locustë¼ëŠ” ê°•ë ¥í•œ ì˜¤í”ˆì†ŒìŠ¤ ê¸°ë°˜ ë¶€í•˜ í…ŒìŠ¤íŠ¸ ë„êµ¬ë„ ìˆì§€ë§Œ ì´ë²ˆ ê¸€ê³¼ ê°™ì´ ë‹¤ì–‘í•œ í”ŒëŸ¬ê·¸ì¸ì„ ì§ì ‘ ë¹Œë“œí•˜ê³  ì—°ë™í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì´ ì¡°ê¸ˆ ë” ë§¤ë ¥ì ìœ¼ë¡œ ë‹¤ê°€ì™”ë‹¤. </p><blockquote><p>í•´ë‹¹ í¬ìŠ¤íŒ…ì€ í˜„ì¬ ì¬ì§ì¤‘ì¸ íšŒì‚¬ì— ê´€ë ¨ì´ ì—†ê³ , ê°œì¸ ì—­ëŸ‰ ê°œë°œì„ ìœ„í•œ ìë£Œë¡œ í™œìš©í•  ì˜ˆì •ì…ë‹ˆë‹¤.</p></blockquote>]]></content>
        <author>
            <name>Jinwoong Kim</name>
            <uri>https://www.linkedin.com/in/ddiiwoong/</uri>
        </author>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="grafana" term="grafana"/>
        <category label="loadtest" term="loadtest"/>
        <category label="prometheus" term="prometheus"/>
        <category label="performance test" term="performance test"/>
        <category label="k6" term="k6"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[kyvernoë¥¼ í™œìš©í•œ Kubernetes ì •ì±… ì—”ì§„ ì ìš©]]></title>
        <id>kubernetes/kyverno/</id>
        <link href="https://ddii.dev/kubernetes/kyverno/"/>
        <updated>2023-04-08T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[kyvernoë¥¼ í™œìš©í•œ Kubernetes ì •ì±… ì—”ì§„ ì ìš©]]></summary>
        <content type="html"><![CDATA[<p>kyverno ë„êµ¬ë¥¼ ì´ìš©í•´ì„œ ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ ì •ì±… ì—”ì§„ìœ¼ë¡œ í™œìš©í•˜ì—¬ ë³´ì•ˆì„ í¬í•¨í•œ ë‹¤ì–‘í•œ ì •ì±…ì„ ì ìš©í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³¸ë‹¤.  </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kyverno">kyverno<a class="hash-link" href="#kyverno" title="Direct link to heading">â€‹</a></h2><p>KyvernoëŠ” ê·¸ë¦¬ìŠ¤ì–´ë¡œ "ì§€ë°°í•˜ë‹¤, ë‹¤ìŠ¤ë¦¬ë‹¤"ì˜ ëœ»ìœ¼ë¡œ ì¿ ë²„ë„¤í‹°ìŠ¤ ë„¤ì´í‹°ë¸Œë¡œ ì„¤ê³„ëœ ì •ì±… ì—”ì§„(policy engine)ì´ë‹¤. Kyverno ì •ì±…ì„ í™œìš©í•˜ì—¬ ì¿ ë²„ë„¤í‹°ìŠ¤ ë¦¬ì†ŒìŠ¤ê°€ ì •ì±…ì— ë¶€í•©í•˜ëŠ”ì§€ ê²€ì‚¬í•˜ê³ , í•„ìš”í•˜ë©´ ë¦¬ì†ŒìŠ¤ë¥¼ ë³€ê²½í•˜ê±°ë‚˜ ìƒì„±í•  ìˆ˜ ìˆë‹¤. Kyverno êµ¬ì¡° ë° ë™ì‘ ë°©ì‹ì„ ê°„ë‹¨íˆ ì •ë¦¬í•œë‹¤.</p><p><a href="https://github.com/open-policy-agent/gatekeeper" target="_blank" rel="noopener noreferrer">OPA Gatekeeper</a>ëŠ” ë…ìì ì¸ policy ì–¸ì–´ì¸ Regoë¥¼ ì‚¬ìš©í•˜ì—¬ policyë¥¼ ì •ì˜í•˜ë§Œ
kyvernoëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ ë¦¬ì†ŒìŠ¤ë¡œ ê´€ë¦¬ë˜ë©° ì •ì±…ì„ ì‘ì„±í•˜ëŠ” ë° ìƒˆë¡œìš´ ì–¸ì–´ê°€ í•„ìš”í•˜ì§€ ì•Šë‹¤.  OPA Gatekeeperì™€ ìœ ì‚¬í•˜ê²Œ&nbsp;<a href="https://kyverno.io/policies" target="_blank" rel="noopener noreferrer">pre-defined policy library</a>&nbsp;ë¥¼ ì œê³µí•œë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kyverno-êµ¬ì¡°-ë°-ë™ì‘-ë°©ì‹">kyverno êµ¬ì¡° ë° ë™ì‘ ë°©ì‹<a class="hash-link" href="#kyverno-êµ¬ì¡°-ë°-ë™ì‘-ë°©ì‹" title="Direct link to heading">â€‹</a></h2><p>KyvernoëŠ” í´ëŸ¬ìŠ¤í„°ì—ì„œ <a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/" target="_blank" rel="noopener noreferrer">dynamic admission controller</a>ë¡œ ë™ì‘í•œë‹¤. KyvernoëŠ” kube-apiserverë¡œë¶€í„° admission HTTP callbackë“¤ì˜ í™•ì¸ ë˜ëŠ” ë³€ê²½ì„ ìˆ˜ì‹ í•˜ê³ , ì •ì±… ìˆ˜ìš©ê³¼ ìš”ì²­ ê±°ì ˆì„ ë°˜í™˜í•˜ê¸° ìœ„í•œ ì •ì±…ì„ ì ìš©í•œë‹¤. ë”°ë¼ì„œ kubectl, git, kustomizeì™€ ê°™ì€ ìµìˆ™í•œ ë„êµ¬ë“¤ì„ ì‚¬ìš©í•˜ì—¬ ì •ì±…ì„ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤.  </p><p>ì •ì±…ì„ í†µí•´ ì¿ ë²„ë„¤í‹°ìŠ¤ ë¦¬ì†ŒìŠ¤ì˜ ìœ íš¨ì„± ê²€ì‚¬, ë³€ê²½, ìƒì„±, ì •ë¦¬ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆì„ ë¿ë§Œ ì•„ë‹ˆë¼ OCI ì´ë¯¸ì§€ ê³µê¸‰ë§(supply chain) ë³´ì•ˆì„ ë³´ì¥í•œë‹¤.</p><p>Kyverno CLIëŠ” CI/CD íŒŒì´í”„ë¼ì¸ì˜ ì¼ë¶€ë¡œ ì •ì±…ì„ í…ŒìŠ¤íŠ¸í•˜ê³  ë¦¬ì†ŒìŠ¤ë¥¼ ê²€ì¦í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p><p><img loading="lazy" src="https://kyverno.io/images/kyverno-architecture.png" alt="Pasted image 20230408005656.png" class="img_E7b_"></p><p>ê³ ê°€ìš©ì„± Kyverno ì„¤ì¹˜ëŠ” ì—¬ëŸ¬ ê°œì˜ replicaë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìœ¼ë©°, ê° ë³µì œë³¸ì—ëŠ” ì„œë¡œ ë‹¤ë¥¸ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ëŠ” ì—¬ëŸ¬ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ìˆë‹¤.  </p><ul><li>Webhook : kube-apiserverì˜ AdmissionReview ìš”ì²­ì„ ì²˜ë¦¬</li><li>Monitor : webhookì— í•„ìš”í•œ ì„¤ì •ì„ ìƒì„±í•˜ê³  ê´€ë¦¬</li><li>PolicyController : policy ë¦¬ì†ŒìŠ¤ë¥¼ ê°ì‹œí•˜ë©°, ì„¤ì •ëœ ìŠ¤ìº” ê°„ê²©ì— ë”°ë¼ì„œ ë°±ê·¸ë¼ìš´ë“œ ìŠ¤ìº”ì„ ì‹œì‘</li><li>GenerateController : ìƒì„±ëœ ë¦¬ì†ŒìŠ¤ë“¤ì˜ ìƒëª…ì£¼ê¸°ë¥¼ ê´€ë¦¬</li></ul><p>KyvernoëŠ” ìµœì‹  ë²„ì „ì˜ manifest ë˜ëŠ” Helmì„ ì‚¬ìš©í•˜ì—¬ ì„¤ì¹˜í•  ìˆ˜ ìˆë‹¤. KyvernoëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í”„ë¡œì íŠ¸ì™€ ë™ì¼í•œ ì§€ì› ì •ì±…ì¸ N-2 ì •ì±…ì„ ë”°ë¥´ë©°, ì„¸ ê°€ì§€ ìµœì‹  ë§ˆì´ë„ˆ ë¦´ë¦¬ìŠ¤ê°€ ìœ ì§€ëœë‹¤.  </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="yamlì„-ì‚¬ìš©í•˜ì—¬-kyverno-ì„¤ì¹˜">YAMLì„ ì‚¬ìš©í•˜ì—¬ Kyverno ì„¤ì¹˜<a class="hash-link" href="#yamlì„-ì‚¬ìš©í•˜ì—¬-kyverno-ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h3><p>ë‹¨ì¼ ì„¤ì¹˜ ë§¤ë‹ˆí˜ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ Kyvernoë¥¼ ì„¤ì¹˜í•  ìˆ˜ë„ ìˆì§€ë§Œ í”„ë¡œë•ì…˜ ì„¤ì¹˜ë¡œ ê³ ê°€ìš©ì„±ìœ¼ë¡œ êµ¬ì„±í•  ê²½ìš° í—¬ë¦„ ì°¨íŠ¸ë¡œ í•´ì•¼ í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create -f https://github.com/kyverno/kyverno/releases/download/v1.9.0/install.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="helmì„-ì‚¬ìš©í•˜ì—¬-kyverno-ì„¤ì¹˜"><a href="https://kyverno.io/docs/installation/#install-kyverno-using-helm" target="_blank" rel="noopener noreferrer">Helmì„ ì‚¬ìš©í•˜ì—¬ Kyverno ì„¤ì¹˜</a><a class="hash-link" href="#helmì„-ì‚¬ìš©í•˜ì—¬-kyverno-ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h3><p>í—¬ë¦„ì„ ì‚¬ìš©í•˜ì—¬ Kyvernoë¥¼ ì„¤ì¹˜í•˜ë ¤ë©´ ë¨¼ì € Kyverno í—¬ë¦„ ë¦¬í¬ì§€í† ë¦¬ë¥¼ ì¶”ê°€í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">helm repo add kyverno https://kyverno.github.io/kyverno/</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë¦¬í¬ì§€í† ë¦¬ë¥¼ ì—…ë°ì´íŠ¸ í•˜ê³  ì°¨íŠ¸ë¥¼ ê²€ìƒ‰í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">helm repo update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm search repo kyverno -l</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê³ ê°€ìš©ì„±ì„ ìœ„í•´ replicaë¥¼ 3ìœ¼ë¡œ ì„¤ì¹˜í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">helm install kyverno kyverno/kyverno -n kyverno --create-namespace --set replicaCount=3</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Kyverno íŒŒë“œ ë³´ì•ˆ í‘œì¤€ ì •ì±…ì„ ì„¤ì¹˜í•˜ë ¤ë©´ Kyvernoë¥¼ ì„¤ì¹˜í•œ í›„ ì•„ë˜ í—¬ë¦„ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">helm install kyverno-policies kyverno/kyverno-policies -n kyverno</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><img loading="lazy" src="https://kyverno.io/images/Kyverno-Policy-Structure.png" alt="Pasted image 20230408020119.png" class="img_E7b_"></p><p>ì •ì±…ì— ëŒ€í•´ì„œ ì¡°ê¸ˆ ìì„¸íˆ ì‚´í´ë³´ë©´, PolicyëŠ” Ruleë“¤ì˜ ì§‘í•©ì´ê³ , ê° ruleì€ í•˜ë‚˜ì˜&nbsp;<a href="https://kyverno.io/docs/writing-policies/match-exclude/" target="_blank" rel="noopener noreferrer">match</a>ì™€&nbsp;<a href="https://kyverno.io/docs/writing-policies/mutate/" target="_blank" rel="noopener noreferrer">mutate</a>,&nbsp;<a href="https://kyverno.io/docs/writing-policies/validate/" target="_blank" rel="noopener noreferrer">validate</a>,&nbsp;<a href="https://kyverno.io/docs/writing-policies/generate" target="_blank" rel="noopener noreferrer">generate</a>&nbsp;resource ë˜ëŠ”&nbsp;<a href="https://kyverno.io/docs/writing-policies/verify-images" target="_blank" rel="noopener noreferrer">verifyImages</a>&nbsp;ì¤‘ í•˜ë‚˜ë¡œ êµ¬ì„±ëœë‹¤. Policyì˜ ì¢…ë¥˜(kind)ëŠ” í´ëŸ¬ìŠ¤í„° ì „ì²´ì— ì ìš©ë˜ëŠ” ClusterPolicyì™€ namespaceì— ì ìš©ë˜ëŠ” Policyê°€ ìˆë‹¤.</p><p>ì •ì±…ì€ ì •ì˜ëœ ìˆœì„œëŒ€ë¡œ ì ìš©ëœë‹¤. admission controlì—ì„œ mutation ê·œì¹™ì€ validation ê·œì¹™ ì „ì— ì ìš©ë˜ê¸° ë•Œë¬¸ì— mutationì— ì˜í•œ ê²°ê³¼ë¥¼ validationí•  ìˆ˜ ìˆë‹¤.&nbsp;ëª¨ë“  mutation ê·œì¹™ì€ ëª¨ë“  ì •ì±…ì—ì„œ validation ê·œì¹™ì´ ì ìš©ë˜ê¸° ì „ì— ì ìš©ëœë‹¤.</p><p>ì—¬ëŸ¬ê°€ì§€ ì •ì±…ë“¤ì´ ìˆì§€ë§Œ ê°„ë‹¨í•˜ê²Œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ëŠ” ì¡°ê±´ìœ¼ë¡œ <code>latest</code> íƒœê·¸ê°€ ë‹¬ë¦° ì´ë¯¸ì§€ëŠ” ë°°í¬ë˜ì§€ ì•Šê²Œ í•˜ëŠ” ê²ƒì„ ì§„í–‰í•´ ë³¸ë‹¤. </p><p><a href="https://kyverno.io/policies/best-practices/disallow_latest_tag/disallow_latest_tag/" target="_blank" rel="noopener noreferrer">https://kyverno.io/policies/best-practices/disallow_latest_tag/disallow_latest_tag/</a></p><p><code>latest</code> íƒœê·¸ëŠ” ë³€ê²½ ê°€ëŠ¥í•˜ë©° ì´ë¯¸ì§€ê°€ ë³€ê²½ë˜ë©´ ì˜ˆê¸°ì¹˜ ì•Šì€ ì˜¤ë¥˜ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ íŒŒë“œì˜ íŠ¹ì • ë²„ì „ì— ë§¤í•‘ë˜ëŠ” ë³€ê²½ ë¶ˆê°€ëŠ¥í•œ íƒœê·¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. ì´ ì •ì±…ì€ ì´ë¯¸ì§€ê°€ íƒœê·¸ë¥¼ ì§€ì •í•˜ê³  í•´ë‹¹ íƒœê·¸ê°€ <code>latest</code>ë¡œ í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ì§€ í™•ì¸í•œë‹¤. </p><p>ì•„ë˜ ClusterPolicy ì—ì„œ <code>spec.validationFailureAction</code>ëŠ” ìœ íš¨ì„± ê²€ì‚¬ ì •ì±… ê·œì¹™ ì‹¤íŒ¨ ì‹œ ì–´ë–¤ ì•¡ì…˜ì„ ìˆ˜í–‰í• ì§€ ì •í•˜ëŠ” ë¶€ë¶„ì´ë‹¤. <code>enforce</code> ëŠ” ì •ì±…ë‚´ì˜ ê·œì¹™(latest íƒœê·¸ê°€ ìˆëŠ” íŒŒë“œê°€ ë°°í¬ë  ê²½ìš°)ì— í•´ë‹¹í•˜ëŠ” ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ê²Œ ë˜ë©´ ê°•ì œì ìš©ë˜ê³ , ê¸°ë³¸ê°’ì¸ <code>audit</code>ì˜ ê²½ìš°ì—ëŠ” ê°ì‚¬ë¡œê·¸ë§Œ ìƒì„±ì´ ëœë‹¤. </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kyverno.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ClusterPolicy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> disallow</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">latest</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">tag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">annotations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">policies.kyverno.io/title</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Disallow Latest Tag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">policies.kyverno.io/category</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Best Practices</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">policies.kyverno.io/minversion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 1.6.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">policies.kyverno.io/severity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> medium</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">policies.kyverno.io/subject</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">policies.kyverno.io/description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      The '</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest' tag is mutable and can lead to unexpected errors if the</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      image changes. A best practice is to use an immutable tag that maps to</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      a specific version of an application Pod. This policy validates that the image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      specifies a tag and that it is not called `latest`.      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">validationFailureAction</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> enforce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">background</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">rules</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> require</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">image</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">tag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">match</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">any</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">kinds</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">validate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">message</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"An image tag is required."</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">pattern</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"*:*"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> validate</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">image</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">tag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">match</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">any</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">kinds</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">validate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">message</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Using a mutable image tag e.g. 'latest' is not allowed."</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">pattern</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"!*:latest"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í…ŒìŠ¤íŠ¸ë¡œ nginx:latest ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ë©´ admission webhook ë‹¨ê³„ì—ì„œ ìš”ì²­ì„ ê±°ì ˆí•˜ì—¬ deployment ë°°í¬ê°€ ì‹¤íŒ¨í•œ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create deployment nginx --image=nginx:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">error: failed to create deployment: admission webhook "validate.kyverno.svc-fail" denied the request: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">policy Deployment/default/nginx for resource violation: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">disallow-latest-tag:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  autogen-validate-image-tag: 'validation error: Using a mutable image tag e.g. ''latest''</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    is not allowed. rule autogen-validate-image-tag failed at path /spec/template/spec/containers/0/image/'</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>eventë¥¼ í™•ì¸í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ nginx íŒŒë“œ ì˜¤ë¸Œì íŠ¸ê°€ Killing ë˜ëŠ”ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get events -A --sort-by=.metadata.creationTimestamp --field-selector type!=Warning</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAMESPACE   LAST SEEN   TYPE     REASON    OBJECT                       MESSAGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default     1m         Normal   Killing   pod/nginx-7597c656c9-rlvnr   Stopping container nginx</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´ë²ˆì—ëŠ” ì •ì±… ìœ„ë°˜ ì‹œ <code>audit</code> ì˜µì…˜ìœ¼ë¡œ ë°”ê¾¸ê³  ë˜‘ê°™ì´ ë°°í¬ë¥¼ ì§„í–‰í•´ë³´ë©´ ì •ìƒì ìœ¼ë¡œ ë°°í¬ëŠ” ì§„í–‰ë˜ì§€ë§Œ, eventë‚˜ describeë¡œ í™•ì¸í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì •ì±… ìœ„ë°˜ Warning ë©”ì„¸ì§€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Events:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Type     Reason           Age    From               Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ----     ------           ----   ----               -------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal   Scheduled        2m29s  default-scheduler  Successfully assigned default/nginx-7597c656c9-w897t to i-00b3ebc1b78f19739</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal   Pulling          2m28s  kubelet            Pulling image "nginx:latest"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal   Pulled           2m21s  kubelet            Successfully pulled image "nginx:latest" in 6.218701714s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal   Created          2m21s  kubelet            Created container nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal   Started          2m21s  kubelet            Started container nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Warning  PolicyViolation  118s   kyverno-scan       policy disallow-latest-tag/validate-image-tag fail: validation error: Using a mutable image tag e.g. 'latest' is not allowed. rule validate-image-tag failed at path /spec/containers/0/image/</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì˜ˆì‹œë¡œ ì´ë¯¸ì§€ íƒœê·¸ë¥¼ ì œì–´í•˜ëŠ” ì •ì±…ì„ ê°€ì§€ê³  í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ì˜€ì§€ë§Œ, ì´ì™¸ì—ë„ ë§ì€ ì •ì±…ë“¤ì„ ì ìš©í•´ë³¼ ìˆ˜ ìˆë‹¤.</p><ul><li><a href="https://kyverno.io/docs/writing-policies/validate/" target="_blank" rel="noopener noreferrer">Validate</a>&nbsp;: Kubernetes API Serverë¡œ ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ ì¤‘ í•„ìˆ˜ ì„¤ì •(ì˜ˆ, íŠ¹ì • ë¼ë²¨ì´ ëˆ„ë½ë˜ê±°ë‚˜, ì¸ê·¸ë ˆìŠ¤ ìƒì„±ì‹œ ì¸ì¦ì„œê°€ ëˆ„ë½ëœ ê²½ìš°)ì´ ëˆ„ë½ëœ ê²½ìš° ì°¨ë‹¨</li><li><a href="https://kyverno.io/docs/writing-policies/mutate/" target="_blank" rel="noopener noreferrer">Mutate</a>&nbsp;: ìš´ì˜í™˜ê²½ì—ì„œ ì¼ë¶€ ì„¤ì • ì˜¤ë¥˜ë¡œ ì¸í•œ ì¥ì• ê°€ ë°œìƒí•˜ì§€ ì•Šë„ë¡ ì˜ˆë°©</li><li><a href="https://kyverno.io/policies/pod-security/baseline/disallow-capabilities/disallow-capabilities/" target="_blank" rel="noopener noreferrer">Disallow Capabilities</a>:  ì •ì±…ì— ë‚˜ì—´ëœ Linux Capability ì´ì™¸ì˜ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ëŠ” ê²ƒì€ í—ˆìš©í•˜ì§€ ì•ŠìŒ</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h3><p>1.25ë²„ì „ ë¶€í„° Pod Security Policies(PSPs)ê°€ deprecated ë˜ë©´ì„œ admission controllerì™€ ì •ì±… ì—”ì§„ ì˜ì—­ì—ì„œ í™œìš©ì´ ê°€ëŠ¥í•œ ì†”ë£¨ì…˜ì´ í•„ìš”í•˜ê²Œ ë˜ì—ˆëŠ”ë°, ìŠ¤í„°ë””ì—ì„œ ì†Œê°œí•´ì¤€ polarisëŠ” ê¹”ë”í•œ ëŒ€ì‹œë³´ë“œì™€ ì •ì±… ì—”ì§„ìœ¼ë¡œì„œ ë‹¤ì–‘í•œ ê¸°ëŠ¥ë“¤ì„ í™œìš©í•  ìˆ˜ ìˆë‹¤. polarisëŠ” ì˜¤í”ˆì†ŒìŠ¤ ê¸°ì¤€ì—ì„œë„ ë³´ì•ˆì— ëŒ€í•œ ì·¨ì•½ì ê³¼ ì„¤ì •ì„ ì‰½ê²Œ ì•Œì•„ë‚´ê³  ë¦¬í¬íŠ¸ë¥¼ ë½‘ì•„ë‚´ëŠ” ì¸¡ë©´ì´ ê°•í•˜ë‹¤ë©´, kyvernoëŠ” ì •ì±…ì„ Kubernetes ë¦¬ì†ŒìŠ¤ë¡œ nativeí•˜ê²Œ ê´€ë¦¬í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— kubectl, git, kustomizeì™€ ê°™ì€ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì •ì±…ì„ ì¡°ê¸ˆë” ì ê·¹ì ìœ¼ë¡œ ê°ì‚¬í•˜ê±°ë‚˜ ì°¨ë‹¨í•˜ëŠ” í˜•íƒœì˜ ê´€ë¦¬ê°€ ê°€ëŠ¥í•˜ë‹¤.</p><blockquote><p>í•´ë‹¹ í¬ìŠ¤íŒ…ì€ í˜„ì¬ ì¬ì§ì¤‘ì¸ íšŒì‚¬ì— ê´€ë ¨ì´ ì—†ê³ , ê°œì¸ ì—­ëŸ‰ ê°œë°œì„ ìœ„í•œ ìë£Œë¡œ í™œìš©í•  ì˜ˆì •ì…ë‹ˆë‹¤.</p></blockquote>]]></content>
        <author>
            <name>Jinwoong Kim</name>
            <uri>https://www.linkedin.com/in/ddiiwoong/</uri>
        </author>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="kyverno" term="kyverno"/>
        <category label="policy" term="policy"/>
        <category label="security" term="security"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Advanced Argo Rollout]]></title>
        <id>kubernetes/argo-rollout-advanced/</id>
        <link href="https://ddii.dev/kubernetes/argo-rollout-advanced/"/>
        <updated>2023-03-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[argo-rolloutì˜ ì„¸ë¶€ì ì¸ ì „ëµì„ ì•Œì•„ë³´ê³  ë‹¤ì–‘í•œ notificationì„ ì„¤ì •í•œë‹¤.]]></summary>
        <content type="html"><![CDATA[<p>kOps í™˜ê²½ì— êµ¬ì¶•í•œ ArgoCDì™€ Argo Rolloutë¥¼ ì¢€ë” ì˜ ì“°ê¸° ìœ„í•œ ëª‡ê°€ì§€ ë‚´ìš©ë“¤ì„ ê°„ë‹¨í•˜ê²Œ ê¸°ë¡ìš©ìœ¼ë¡œ ì‘ì„±í•˜ì˜€ë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="gitops">GitOps<a class="hash-link" href="#gitops" title="Direct link to heading">â€‹</a></h2><p>ê°„ë‹¨í•˜ê²Œë§Œ ì •ë¦¬í•˜ë©´, GitOpsëŠ” Git ë¦¬í¬ì§€í† ë¦¬ë¥¼ ë‹¨ì¼ ì •ë³´ ì†ŒìŠ¤(SSOT,Single Source Of Truth)ë¡œ ì‚¬ìš©í•˜ì—¬ ì¸í”„ë¼ë¥¼ ì½”ë“œë¡œ ì œê³µí•˜ëŠ” ê²ƒì´ë‹¤. GitOpsëŠ” ì¸í”„ë¼ êµ¬ì„±ì„ ìœ„í•´ Gitì„ ë²„ì „ ì œì–´ ì‹œìŠ¤í…œìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ì½”ë“œí˜• ì¸í”„ë¼ (IaC) ê°€ ì§„í™”í•œ ê²ƒì´ë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤. IaCëŠ” ì›í•˜ëŠ” ì‹œìŠ¤í…œ ìƒíƒœë¥¼ ì •ì˜í•˜ê³  ì‹œìŠ¤í…œì˜ ì‹¤ì œ ìƒíƒœë¥¼ ì¶”ì í•˜ì—¬ ì¸í”„ë¼ ê´€ë¦¬ì— ëŒ€í•œ ì„ ì–¸ì  ì ‘ê·¼ ë°©ì‹ì„ ë”°ë¥´ëŠ” ê²½ìš°ê°€ ë§ë‹¤. ê·¸ë˜ì„œ ë°°í¬ì— ê´€ë ¨ëœ ëª¨ë“  ê²ƒì„ ì„ ì–¸í˜• ê¸°ìˆ ì„œë¡œ ì‘ì„±í•œë‹¤ìŒ Config ë ˆí¬ì§€í† ë¦¬ì—ì„œ ì €ì¥ì„ í•˜ê³ , í•´ë‹¹ ì •ë³´ì™€ ì‹¤ì œ ë°°í¬ëœ í™˜ê²½ê°„ì˜ ìƒíƒœ ì°¨ì´ê°€ ë°œìƒí•˜ì§€ ì•Šë„ë¡ ìœ ì§€í•˜ëŠ” ê²ƒì„ GitOps ì—…ë¬´ íŒ¨í„´ì´ë¼ê³  í•  ìˆ˜ ìˆë‹¤. </p><p>ë˜í•œ ê°œë°œìì—ê²Œ ìµìˆ™í•œ Git ê¸°ë°˜ ì›Œí¬í”Œë¡œìš°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œì—ì„œ ë°°í¬, ì• í”Œë¦¬ì¼€ì´ì…˜ ë¼ì´í”„ì‚¬ì´í´ ê´€ë¦¬, ì¸í”„ë¼ êµ¬ì„±ì— ì´ë¥´ëŠ” ê¸°ì¡´ í”„ë¡œì„¸ìŠ¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í™•ì¥ì„ í•  ìˆ˜ ìˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ ë¼ì´í”„ì‚¬ì´í´ ì „ë°˜ì— ê±¸ì³ ëª¨ë“  ë³€ê²½ ì‚¬í•­ì´ Git ë¦¬í¬ì§€í† ë¦¬ì—ì„œ ì¶”ì ë˜ê³ , GitOpsëŠ” ì´ëŸ¬í•œ ë³€ê²½ ì‚¬í•­ì„ ìë™ìœ¼ë¡œ ì¸í”„ë¼ì— ì ìš©í•˜ëŠ” ê²ƒì„ ë§í•œë‹¤. </p><p>ì´ì²˜ëŸ¼ GitOpsì˜ ì¥ì ì¤‘ì— ê°€ì¥ ì¤‘ìš”í•œ ë¶€ë¶„ì€ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì •ë³´ê°€ ê³µìœ ë˜ê³ , ì¸í”„ë¼ êµ¬ì„±í•˜ëŠ” ëª¨ë“  ë³€ê²½ ì‚¬í•­ì— ëŒ€í•œ ì¶”ì ê³¼ ê´€ë¦¬ê°€ ê°€ëŠ¥í•´ì§„ë‹¤ëŠ” ì ì¼ ê²ƒì´ë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="argocd-argo-rollouts">ArgoCD, Argo Rollouts<a class="hash-link" href="#argocd-argo-rollouts" title="Direct link to heading">â€‹</a></h2><p>ArgoCDëŠ” ìœ„ì—ì„œ ì´ì•¼ê¸°í•œ ê²ƒì²˜ëŸ¼ ì¿ ë²„ë„¤í‹°ìŠ¤ ë¦¬ì†ŒìŠ¤ì™€ Gitì— ì €ì¥ëœ ì„ ì–¸í˜• ê¸°ìˆ ì„œ(manifest)ë¥¼ ë™ì¼í•˜ê²Œ ìœ ì§€ì‹œì¼œ ì£¼ê³  CDí™˜ê²½ì„ êµ¬ì„±í•  ìˆ˜ ìˆëŠ” GitOps êµ¬í˜„ì²´ ì˜¤í”ˆì†ŒìŠ¤ì´ë‹¤. ì¦‰, GitOps íŒ¨í„´ì„ ë”°ë¼ Git ì €ì¥ì†Œë¥¼ ì‚¬ìš©í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ë„êµ¬ì´ë‹¤.</p><p>ë¡¤ì•„ì›ƒì€ ì¿ ë²„ë„¤í‹°ìŠ¤ í™˜ê²½ì—ì„œ ìƒˆë¡œìš´ ë²„ì „ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•  ë•Œ ì´ì „ ë²„ì „ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ìƒˆë¡œìš´ ë²„ì „ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì¡°ì ˆí•˜ê³  ì‚¬ìš©ìì—ê²Œ ë¬´ì¤‘ë‹¨ìœ¼ë¡œ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê²ƒì„ ë§í•œë‹¤.</p><p>Argo RolloutsëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œ ë¡¤ì•„ì›ƒ ê´€ë¦¬ë¥¼ ìœ„í•œ ì˜¤í”ˆì†ŒìŠ¤ ë„êµ¬ ì¤‘ í•˜ë‚˜ì´ë‹¤. ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ ì„œë¹„ìŠ¤ ë©”ì‹œ ë° ì¸ê·¸ë ˆìŠ¤ ì»¨íŠ¸ë¡¤ëŸ¬ì™€ í†µí•©í•˜ì—¬ íŠ¸ë˜í”½ì„ ìƒˆ ë²„ì „ìœ¼ë¡œ ì ì§„ì ìœ¼ë¡œ ì´ë™ì‹œí‚¤ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤. ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ ì»¤ìŠ¤í…€ ë¦¬ì†ŒìŠ¤ ì •ì˜(CRD)ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¸”ë£¨-ê·¸ë¦° ë°°í¬, ì¹´ë‚˜ë¦¬ ë°°í¬, ì¹´ë‚˜ë¦¬ ë¶„ì„ ë“±ì˜ í˜•íƒœë¡œ ì •ì˜í•˜ê³ , ê±°ì˜(?) ë¬´ì¤‘ë‹¨ìœ¼ë¡œ ìƒˆë¡œìš´ ë²„ì „ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•  ìˆ˜ ìˆê²Œ í•œë‹¤. ìƒˆë¡œìš´ ë²„ì „ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì œëŒ€ë¡œ ì‘ë™í•˜ì§€ ì•Šì„ ê²½ìš°, ë¡¤ë°±ì„ ìˆ˜í–‰í•˜ì—¬ ì´ì „ ë²„ì „ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œ ë¹ ë¥¸ ì‹œê°„ë‚´ì— ë˜ëŒë¦´ ìˆ˜ ìˆë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="argo-rollout-specification">Argo Rollout Specification<a class="hash-link" href="#argo-rollout-specification" title="Direct link to heading">â€‹</a></h2><p>Argo Rollout Specificationì€ Argo Rollouts ë„êµ¬ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë¡¤ì•„ì›ƒ ì „ëµì„ ì •ì˜í•˜ëŠ” YAML íŒŒì¼ì„ ë§í•œë‹¤. ê°ê°ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë§ê²Œ ì‘ì„±ë˜ì–´ì•¼ í•˜ê³  Kubernetes APIë¥¼ ê¸°ë°˜ìœ¼ë¡œ êµ¬ì„±ë˜ë©°, ë¡¤ì•„ì›ƒ ì „ëµì˜ ëª¨ë“  ë‚´ìš©ì„ í¬í•¨í•˜ì—¬ ì‘ì„±í•˜ê²Œ ëœë‹¤. </p><p>Argo Rollout Specification íŒŒì¼ì€ ë‹¤ìŒê³¼ ê°™ì€ ë‚´ìš©ì„ í¬í•¨í•œë‹¤.</p><ol><li>ë¡¤ì•„ì›ƒ ì „ëµ: Canary, Blue-Green, AB Testing ë“± ë‹¤ì–‘í•œ ë¡¤ì•„ì›ƒ ì „ëµ</li><li>ë°°í¬ ì „ëµ: ë¡¤ì•„ì›ƒ ì†ë„, ë°°í¬ ì‹œê°„ ë“±ì˜ ìƒˆë¡œìš´ ë²„ì „ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•˜ëŠ” ë°©ë²•ì„ ì •ì˜</li><li>ì„œë¹„ìŠ¤ ì„¤ì •: ë¡¤ì•„ì›ƒ ì¤‘ì— ì‚¬ìš©í•  ì„œë¹„ìŠ¤ë¥¼ ì •ì˜</li><li>ë¡¤ì•„ì›ƒ ì´ë ¥: ì´ì „ ë¡¤ì•„ì›ƒ ì´ë ¥ì„ ì¶”ì í•˜ê³  ê²€ìƒ‰</li></ol><p>Blue-Green ì „ëµì€ ë‘ ê°œì˜ ë²„ì „ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë™ì‹œì— ìœ ì§€í•˜ë©´ì„œ, ì‚¬ìš©ì íŠ¸ë˜í”½ì„ ìƒˆë¡œìš´ ë²„ì „ìœ¼ë¡œ ì „í™˜í•˜ëŠ” ì „ëµìœ¼ë¡œ ì´ì „ ë²„ì „ì€ Blue í™˜ê²½ì´ë¼ê³  í•˜ê³ , ìƒˆë¡œìš´ ë²„ì „ì€ Green í™˜ê²½ì´ë¼ê³  ë§í•œë‹¤. Blue-Green ë°°í¬ ì „ëµì€ ë¡¤ë°±ì´ ë§¤ìš° ì‰¬ìš°ë©°, ì‚¬ìš©ì íŠ¸ë˜í”½ì˜ ì „í™˜ë„ ë§¤ìš° ë¹ ë¥´ê²Œ ìˆ˜í–‰ëœë‹¤. ë”°ë¼ì„œ, ë§ì€ ê¸°ì—…ì—ì„œ Blue-Green ë°°í¬ ì „ëµì„ ì‚¬ìš©í•˜ì—¬ ìƒˆë¡œìš´ ë²„ì „ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë¡¤ì•„ì›ƒí•˜ê³  ìˆê³  ì¼ë°˜ì ì¸ ë°©ì‹ì´ë¼ ë³´ë©´ ëœë‹¤.</p><p>ë‹¤ìŒì€ Argo Rolloutì—ì„œ Blue-Green ë°°í¬ ì „ëµì„ ì •ì˜í•˜ëŠ” YAML íŒŒì¼ì˜ ì˜ˆì‹œì´ë‹¤.  </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> argoproj.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Rollout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">strategy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">blueGreen</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">activeService</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">green</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">previewService</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">blue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">autoPromotionEnabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># autoPromotionSeconds: *int32  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">template</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">matchLabels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ul><li><code>activeService</code>: Green í™˜ê²½ì— ë°°í¬ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëŒ€í•œ ì„œë¹„ìŠ¤ ì´ë¦„ìœ¼ë¡œ Blue-Green ì „ëµì—ì„œëŠ” í•„ìˆ˜ í•„ë“œ</li><li><code>previewService</code>: Blue í™˜ê²½ì— ë°°í¬ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëŒ€í•œ ì„œë¹„ìŠ¤ ì´ë¦„ìœ¼ë¡œ Blue-Green ì „ëµì—ì„œëŠ” optional í•„ë“œ</li><li><code>autoPromotionEnabled</code>: ë¡¤ì•„ì›ƒì´ ì™„ë£Œëœ í›„, ìë™ìœ¼ë¡œ Green í™˜ê²½ìœ¼ë¡œ ì „í™˜í• ì§€ ì—¬ë¶€</li><li><code>template</code>: ìƒˆë¡œìš´ ë²„ì „ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì •ì˜</li><li><code>selector</code>: ë¡¤ì•„ì›ƒ ì¤‘ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì„ íƒí•˜ê¸° ìœ„í•œ ë ˆì´ë¸” ì…€ë ‰í„°</li><li><code>autoPromotionSeconds</code>: Rollout ì´ ì¼ì‹œ ì •ì§€ ìƒíƒœì— ë“¤ì–´ê°„ ì´í›„ í•´ë‹¹ í•„ë“œ ì„¤ì • ì‹œê°„ì´ ì§€ë‚œí›„ ìë™ìœ¼ë¡œ ìƒˆë¡œìš´ ReplicaSetì„ í™œì„± ì„œë¹„ìŠ¤ë¡œ ìë™ìœ¼ë¡œ promote í•˜ëŠ” ì˜µì…˜ì´ë‹¤.AutoPromotionEnabled í•„ë“œê°€ Trueë¡œ ì„¤ì •ë˜ë©´ì´ í•„ë“œëŠ” ë¬´ì‹œëœë‹¤.</li></ul><p>anti-affinityëŠ” ë‹¤ë¥¸ ë…¸ë“œ ê°„ì˜ Pod ë¶„ì‚°ì„ ìœ„í•´ ì‚¬ìš©ë˜ê³ , pod anti-affinityëŠ” ë™ì¼í•œ ë¬¼ë¦¬ì  í˜¸ìŠ¤íŠ¸ì—ì„œ ì‹¤í–‰ë˜ëŠ” ì—¬ëŸ¬ Pod ê°„ì˜ ë¶„ì‚°ì„ ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ë°©ë²•ì´ë‹¤. </p><p>anti-affinity structë¥¼ Blue-Green ë˜ëŠ” Canary ì „ëµì— ì¶”ê°€í•  ìˆ˜ ìˆë‹¤. ì—¬ëŸ¬ ë…¸ë“œì— ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•  ë•Œ, ë™ì¼í•œ íŒŒë“œë“¤ì´ í•˜ë‚˜ì˜ ë…¸ë“œì— ëª¨ì´ì§€ ì•Šë„ë¡ í•˜ëŠ” ì „ëµì´ë‹¤. ì´ë¥¼ í†µí•´ ë‹¨ì¼ ë…¸ë“œ ì¥ì• ë¡œë¶€í„° ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë³´í˜¸í•  ìˆ˜ ìˆë‹¤. ì•„ë˜ì˜ ì˜ˆì‹œëŠ” ìƒˆ ë²„ì „ì€ ë…ë¦½ëœ scaled ë…¸ë“œë¡œ ë°°ì¹˜í•˜ëŠ” í•˜ê³  íŠ¹ì • zoneì—ë§Œ ë°°ì¹˜í•˜ëŠ” ì „ëµì´ë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">strategy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">blueGreen</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">antiAffinity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">requiredDuringSchedulingIgnoredDuringExecution</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">nodeSelectorTerms</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">matchExpressions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> topology.kubernetes.io/zone  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">operator</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> In  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">values</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ap</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">northeast</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">2a</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì•„ë˜ ì˜ˆì‹œëŠ” podAntiAffinity í•„ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ anti-affinity ì „ëµì„ ì„¤ì •í•˜ëŠ”ë° <code>requiredDuringSchedulingIgnoredDuringExecution</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ ë…¸ë“œ ìŠ¤ì¼€ì¤„ë§ ì¤‘ì— ì´ì „ íŒŒë“œì™€ ë™ì¼í•œ ë…¸ë“œì— ë°°ì¹˜í•˜ì§€ ì•Šë„ë¡ í•„ìš”í•œ ì„¤ì •ì„ ì§€ì •í•˜ëŠ” ì „ëµì´ë‹¤. </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">affinity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">podAntiAffinity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">requiredDuringSchedulingIgnoredDuringExecution</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">labelSelector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">matchExpressions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">operator</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> In</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">values</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">topologyKey</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"kubernetes.io/hostname"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="argo-rollouts-notification">Argo Rollouts Notification<a class="hash-link" href="#argo-rollouts-notification" title="Direct link to heading">â€‹</a></h2><p><a href="https://argoproj.github.io/argo-rollouts/features/notifications/" target="_blank" rel="noopener noreferrer">https://argoproj.github.io/argo-rollouts/features/notifications/</a></p><p>Argo Rollouts Notificationì€ ë¡¤ì•„ì›ƒ ì´ë²¤íŠ¸ì— ëŒ€í•œ ì•Œë¦¼ ë©”ì‹œì§€ë¥¼ Slack, Email, Webhook ë“± ë‹¤ì–‘í•œ ë°©ë²•ìœ¼ë¡œ ì „ì†¡í•  ìˆ˜ ìˆë‹¤. ì´ë¥¼ í†µí•´ ë¡¤ì•„ì›ƒ ì´ë²¤íŠ¸ì— ëŒ€í•œ ëª¨ë‹ˆí„°ë§ ë° ëŒ€ì‘ì´ ê°€ëŠ¥í•´ì§„ë‹¤.  </p><p>í•´ë‹¹ ê¸°ëŠ¥ì€ 1.1.0 ì´ìƒ ë²„ì „ì˜ Rolloutì„ êµ¬ì„±í•´ì•¼ë§Œ Notification ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.&nbsp;&nbsp;</p><p>êµ¬ì„±ëœ í™˜ê²½ì— ì¶”ê°€ì ìœ¼ë¡œ Argo Rollouts Notification ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•˜ê³ , í•´ë‹¹ ë¦¬ì†ŒìŠ¤ì—ì„œ ê° í†µí•© ì„œë¹„ìŠ¤ì— ëŒ€í•œ ì„¤ì •ì„ ì‘ì„±í•œë‹¤. ì´ë ‡ê²Œ ì‘ì„±ëœ ì„¤ì •ì„ í†µí•´ ë¡¤ì•„ì›ƒ ì´ë²¤íŠ¸ê°€ ë°œìƒí•  ë•Œ ë§ˆë‹¤, í•´ë‹¹ ì„¤ì •ì— ë”°ë¼ ì•Œë¦¼ ë©”ì‹œì§€ê°€ ì „ì†¡ë˜ëŠ” êµ¬ì¡°ì´ë‹¤.  </p><p>ì•Œë¦¼ ì²˜ë¦¬ë¥¼ ë‹´ë‹¹í•˜ëŠ” Argo CD Notification ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì„¤ì¹˜í•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -n argo-rollouts -f https://github.com/argoproj/argo-rollouts/releases/latest/download/install.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê°™ì€ ë„¤ì„ìŠ¤í˜ì´ìŠ¤, ê¸°ë³¸ êµ¬ì„±ë˜ëŠ” argo-rollouts ë‚´ì˜ ConfigMapì„ ì°¸ì¡°í•˜ê²Œ ëœë‹¤. ë‹¤ìŒ ëª…ë ¹ì„ ì‹¤í–‰í•˜ë©´&nbsp;<code>argo-rollouts</code>&nbsp;ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì—&nbsp;<code>argo-rollouts-notification-configmap</code>ë¼ëŠ” ì´ë¦„ì˜ ConfigMapì´ ë§Œë“¤ì–´ì§€ê²Œ ë˜ê³ , ì´ ConfigMapì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ íŠ¸ë¦¬ê±°ì™€ í…œí”Œë¦¿ì„ ë‹´ê²¨ ìˆìœ¼ë©° í•„ìš”ì‹œ Custom íŠ¸ë¦¬ê±°ì™€ í…œí”Œë¦¿ì„ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤. argo-rollouts podëŠ” ì •ì˜ëœ íŠ¸ë¦¬ê±°ë¥¼ ê°ì§€í•˜ë©´ íŠ¸ë¦¬ê±°ì™€ ë§í¬ë˜ì–´ ìˆëŠ” í…œí”Œë¦¿ìœ¼ë¡œ ë©”ì‹œì§€ë¥¼ êµ¬ì„±í•˜ì—¬ ì•Œë¦¼ì„ ë°œì†¡í•˜ê²Œ ëœë‹¤.  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -n argo-rollouts -f https://raw.githubusercontent.com/argoproj/argo-rollouts/master/manifests/notifications-install.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="slack-ì—°ë™">Slack ì—°ë™<a class="hash-link" href="#slack-ì—°ë™" title="Direct link to heading">â€‹</a></h2><p>Slackì—ì„œ ë‹¤ìŒê³¼ ê°™ì€ ê¶Œí•œìœ¼ë¡œ Oauth ì„¤ì •ì„ í•˜ê³  ìƒì„±ëœ access tokenì„ Secretìœ¼ë¡œ ì €ì¥í•œë‹¤.  </p><p><img loading="lazy" alt="argo-secret" src="/assets/images/argo-secret-3d2dc8d37ade51f0203fdd05a9289cd6.png" width="653" height="397" class="img_E7b_"></p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> argo</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">rollouts</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">notification</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">stringData</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">slack-token</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> &lt;Oauth</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">access</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">token</span><span class="token punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ì—ì„œ ì„¤ì •í•œ Oauth Secretì„ ìœ„ì—ì„œ êµ¬ì„±í•œ  ConfigMapì— ì¶”ê°€í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ConfigMap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> argo</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">rollouts</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">notification</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">configmap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">service.slack</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    token: $slack-token</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="templates">Templates<a class="hash-link" href="#templates" title="Direct link to heading">â€‹</a></h3><p>ì•Œë¦¼ í…œí”Œë¦¿ì€ ì•Œë¦¼ ì½˜í…ì¸ ë¥¼ ìƒì„±í•˜ëŠ” ìƒíƒœ ë¹„ì €ì¥ í•¨ìˆ˜ì´ë‹¤. ì´ í…œí”Œë¦¿ì€ html/template golang íŒ¨í‚¤ì§€ë¥¼ í™œìš©í•œë‹¤. í…œí”Œë¦¿ì€ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©° ì—¬ëŸ¬ íŠ¸ë¦¬ê±°ì—ì„œ ì°¸ì¡°í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">template.rollout-completed</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    message: Rollout {{.rollout.metadata.name}} has been completed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    email:</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">      subject: Rollout {{.rollout.metadata.name}} has been completed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    slack:</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">      attachments: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          [{</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            "title": "{{ .rollout.metadata.name}}",</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            "color": "#18be52",</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            "fields": [</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">              "title": "Strategy",</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">              "value": "{{if .rollout.spec.strategy.blueGreen}}BlueGreen{{end}}{{if .rollout.spec.strategy.canary}}Canary{{end}}",</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">              "short": true</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            {{range $index, $c := .rollout.spec.template.spec.containers}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">              {{if not $index}},{{end}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">              {{if $index}},{{end}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">              {</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                "title": "{{$c.name}}",</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                "value": "{{$c.image}}",</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                "short": true</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">              }</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            {{end}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          }]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´ì™¸ì˜ ë‹¤ë¥¸ ì—¬ëŸ¬ê°€ì§€ í…œí”Œë¦¿ êµ¬ì„±ì€ <a href="https://github.com/argoproj/argo-rollouts/tree/master/manifests/notifications" target="_blank" rel="noopener noreferrer">https://github.com/argoproj/argo-rollouts/tree/master/manifests/notifications</a> ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="triggers">Triggers<a class="hash-link" href="#triggers" title="Direct link to heading">â€‹</a></h3><p>íŠ¸ë¦¬ê±° ë˜ëŠ” ê²½ìš°ì— ì–´ë–¤ templateìœ¼ë¡œ ë³´ë‚¼ì§€ ì§€ì •í•˜ëŠ” êµ¬ë¬¸ì´ë‹¤. ì•„ë˜ ì˜ˆì‹œëŠ” ìœ„ì—ì„œ ì •í•œ template ì´ë¦„ì¸ <code>rollout-completed</code>ë¥¼ ë³´ë‚¸ë‹¤ëŠ” ì„¤ì •ì´ë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">trigger.on-rollout-completed</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    - send: [rollout-completed]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="rollout-templateì—-notification-annotation-ì¶”ê°€">Rollout templateì— notification annotation ì¶”ê°€<a class="hash-link" href="#rollout-templateì—-notification-annotation-ì¶”ê°€" title="Direct link to heading">â€‹</a></h2><p>ì‹ ê·œë¡œ ìƒì„±í•˜ê±°ë‚˜ ê¸°ì¡´ì˜ Rollout ë¦¬ì†ŒìŠ¤ì— notification annotationë¥¼ ì¶”ê°€í•´ì•¼ ê´€ë ¨ëœ rollout ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ë©´ ìœ„ì— ì„¤ì •í•œ ìŠ¬ë™ì˜ <code>my_channel</code>ë¡œ alertë¥¼ ë³´ë‚´ê²Œ ëœë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> argoproj.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Rollout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">annotations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">notifications.argoproj.io/subscribe.on-scaling-replica-set.slack</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> my_channel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">strategy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">blueGreen</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">activeService</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">green</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">previewService</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">blue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">autoPromotionEnabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">template</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">matchLabels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="grafanaë¡œ-rollout-notification-ë°›ê¸°">Grafanaë¡œ Rollout notification ë°›ê¸°<a class="hash-link" href="#grafanaë¡œ-rollout-notification-ë°›ê¸°" title="Direct link to heading">â€‹</a></h2><p>ì¶”ê°€ì ìœ¼ë¡œ Grafana annotation api(<a href="https://grafana.com/docs/grafana/latest/http_api/annotations/" target="_blank" rel="noopener noreferrer">https://grafana.com/docs/grafana/latest/http_api/annotations/</a>)ë¥¼ í™œìš©í•˜ì—¬ rollout ê´€ë ¨ ì´ë²¤íŠ¸ ë°œìƒì‹œ í•´ë‹¹ ì‹œì ì˜ ì´ë²¤íŠ¸ ì •ë³´ë¥¼ Grafana ì‹œê³„ì—´ ì°¨íŠ¸ì— ìë™ìœ¼ë¡œ ë“±ë¡ì„ í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë©”íŠ¸ë¦­ ê¸°ë°˜ìœ¼ë¡œ ë°°í¬ ì „í›„ ìƒíƒœë¥¼ ê´€ì¸¡í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±í•˜ëŠ”ê²ƒì´ ëª©ì ì´ë‹¤.</p><p>Slackê³¼ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ grafanaì—ì„œ ë°œê¸‰í•œ API Keyë¥¼ Secretì— ë“±ë¡í•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Secret  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> argo</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">rollouts</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">notification</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">secret  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">stringData</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">grafana-api-key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">grafana</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Opaque</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê¸°ì¡´ ConfigMapì— grafana API ì—”ë“œí¬ì¸íŠ¸ì™€ ìœ„ì—ì„œ ì„¤ì •í•œ apiKeyë¥¼ ì„¤ì •í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ConfigMap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> argo</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">rollouts</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">notification</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">configmap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">service.grafana</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c">                                                </span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    apiUrl: http://prometheus-grafana.prometheus.svc.cluster.local/api</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    apiKey: $grafana-api-key</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">service.slack</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    token: $slack-token</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê¸°ì¡´ rollout ì— ìœ„ì— ì„ ì–¸í•œ grafanaì— ì•Œë¦¼ ì „ë‹¬ì„ ìœ„í•œ annotatinosì„ ì¶”ê°€í•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> argoproj.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Rollout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">annotations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">notifications.argoproj.io/subscribe.on-analysis-run-running.grafana</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> analysis</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">run  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">notifications.argoproj.io/subscribe.on-app-sync-status.grafana</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> appsync  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">notifications.argoproj.io/subscribe.on-rollout-completed.grafana</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rollout  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">notifications.argoproj.io/subscribe.on-scaling-replica-set.grafana</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> scalling</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Grafana ì„¤ì •ìœ¼ë¡œ ì´ë™í•´ì„œ ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ Settings - Annotation ë©”ë‰´ë¡œ ì´ë™í•˜ì—¬ Query - Filter by í•­ëª©ì„ Tagë¡œ ë³€ê²½í•˜ê³  ì„¤ì •ì„ ì €ì¥í•œë‹¤&nbsp; </p><p><img loading="lazy" alt="rollout" src="/assets/images/grafana-annotation-af1b39ed8972be1106e7773d78584d34.png" width="1053" height="1070" class="img_E7b_"></p><p>ì´í›„ Rolloutì— ë³€ê²½ ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ë©´ ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ í•´ë‹¹ ì‹œì ì— annotationì´ í‘œê¸°ë˜ëŠ”ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ë¥¼ í†µí•´ íŠ¹ì • ë°°í¬ ë²„ì „ì— ëŒ€í•œ ì „,í›„ ë¹„êµê°€ ê°€ëŠ¥í•´ì§„ë‹¤.  </p><p><img loading="lazy" alt="grafana" src="/assets/images/rollout-annotation-d70189af2a3efdbfa71bc6631942b237.png" width="1180" height="637" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ì´ë²ˆ 3ì£¼ì°¨ ìŠ¤í„°ë””ì—ëŠ” êµ¬ì„±ëœ í™˜ê²½ì— Argo CD, Argo Rolloutì„ êµ¬ì„±í•˜ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í–ˆê³ , ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” Argo Rollout Notificationì„ í†µí•´ ìš´ì˜ìê°€ Rollout ì´ë²¤íŠ¸ê°€ ë‹¤ì–‘í•œ ì´ë²¤íŠ¸ê°€ ë°œìƒí–ˆì„ë•Œ Slackìœ¼ë¡œ ì•Œë¦¼ì„ ë°›ì•„ë³´ê±°ë‚˜ ìë™ìœ¼ë¡œ Grafana ëŒ€ì‹œë³´ë“œ ìƒì— annotationì„ í‘œê¸°í•˜ëŠ” ì‹¤ìŠµì„ ì§„í–‰í–ˆë‹¤.</p><blockquote><p>í•´ë‹¹ í¬ìŠ¤íŒ…ì€ í˜„ì¬ ì¬ì§ì¤‘ì¸ íšŒì‚¬ì— ê´€ë ¨ì´ ì—†ê³ , ê°œì¸ ì—­ëŸ‰ ê°œë°œì„ ìœ„í•œ ìë£Œë¡œ í™œìš©í•  ì˜ˆì •ì…ë‹ˆë‹¤.</p></blockquote>]]></content>
        <author>
            <name>Jinwoong Kim</name>
            <uri>https://www.linkedin.com/in/ddiiwoong/</uri>
        </author>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="kOps" term="kOps"/>
        <category label="argo" term="argo"/>
        <category label="argo-rollout" term="argo-rollout"/>
        <category label="notification" term="notification"/>
        <category label="grafana" term="grafana"/>
        <category label="slack" term="slack"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[kOps with Cilium]]></title>
        <id>kubernetes/kops-cilium/</id>
        <link href="https://ddii.dev/kubernetes/kops-cilium/"/>
        <updated>2023-03-18T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Cilium CNI ê¸°ë°˜ kOps êµ¬ì„±]]></summary>
        <content type="html"><![CDATA[<p>Ciliumì„ ê¸°ë°˜ìœ¼ë¡œ í•˜ëŠ” kOps í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•˜ê³  ë„¤íŠ¸ì›Œí¬ êµ¬ì„±ì´ ì–´ë–»ê²Œ ë˜ëŠ”ì§€ í™•ì¸í•´ë³´ê³ ì í•œë‹¤. CiliumëŠ” Linux ì»¤ë„ ë‚´ì— ê°•ë ¥í•œ ë³´ì•ˆ ê°€ì‹œì„± ë° ì œì–´ ë¡œì§ì„ ë™ì ìœ¼ë¡œ ì‚½ì…í•  ìˆ˜ ìˆëŠ” BPFë¼ëŠ” Linux ì»¤ë„ ê¸°ìˆ ì„ ì‚¬ìš©í•˜ëŠ” CNIì´ë‹¤. </p><p><a href="https://cilium.io/" target="_blank" rel="noopener noreferrer">https://cilium.io/</a>
<a href="https://kops.sigs.k8s.io/networking/cilium/" target="_blank" rel="noopener noreferrer">https://kops.sigs.k8s.io/networking/cilium/</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kops-with-cloud9">kOps with Cloud9<a class="hash-link" href="#kops-with-cloud9" title="Direct link to heading">â€‹</a></h2><p>ê¸€ì„ ì‘ì„±í•˜ëŠ” ë‚ ì§œ ê¸°ì¤€(23ë…„ 3ì›” 18ì¼), ë²„ì „ì€ 1.25.11 ìœ¼ë¡œ ì§„í–‰ì„ í•œë‹¤. ì§€ë‚œë²ˆ êµ¬ì„±ê³¼ ë™ì¼í•˜ê²Œ Bastionì€ Cloud9ì—ì„œ êµ¬ì„±ì„ ì§„í–‰í•˜ì˜€ë‹¤. ì§€ë‚œë²ˆ ì‘ì„±í•œ Cloud9 ê¸°ë°˜ ì¸ìŠ¤í„´ìŠ¤ëŠ” ì•„ë˜ ë§í¬ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><p><a href="https://github.com/jinwoongk/aws-cloud9-bootstrapping-example/blob/main/example_instancestack.yaml" target="_blank" rel="noopener noreferrer">https://github.com/jinwoongk/aws-cloud9-bootstrapping-example/blob/main/example_instancestack.yaml</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="cilium-cni-ê¸°ë°˜-kops-ë°°í¬">Cilium CNI ê¸°ë°˜ kOps ë°°í¬<a class="hash-link" href="#cilium-cni-ê¸°ë°˜-kops-ë°°í¬" title="Direct link to heading">â€‹</a></h2><p>Cloud9ì´ êµ¬ì„±ë˜ê³  ë‚˜ë©´ í•´ë‹¹ í™˜ê²½ì—ì„œ ê¸°ë³¸ êµ¬ì„±í•  Cluster yamlì„ ì‘ì„±í•œë‹¤. yamlì˜ í¬ê¸° ë•Œë¬¸ì— ë¶€ë¶„ì„ ë‚˜ëˆ ì„œ ì„¤ëª…í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kops.k8s.io/v1alpha2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">creationTimestamp</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token null important">null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prosv.kr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">kubeProxy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">metricsBindAddress</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 0.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">networking</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">cilium</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">enableNodePort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">ipam</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">hubble</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>kOpsë¥¼ êµ¬ì„±í•  ë•ŒëŠ” Cluster CRDë¥¼ ì‘ì„±í•˜ëŠ”ê²ƒì´ ê¸°ë³¸ì¸ë° í´ëŸ¬ìŠ¤í„° ì´ë¦„ì€ í˜„ì¬ ì‚¬ìš©ì¤‘ì¸ í…ŒìŠ¤íŠ¸ ë„ë©”ì¸ì„ ì…ë ¥í•œë‹¤.<br>
<!-- -->ê·¸ë¦¬ê³  Cilium ì„ ê¸°ë³¸ CNIìœ¼ë¡œ êµ¬ì„±í•  ì˜ˆì •ì´ê¸° ë•Œë¬¸ì— Kube-ProxyëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë¹„í™œì„±í™” í•œë‹¤. Ciliumì´ AWSì—ì„œ í• ë‹¹ëœ managed IP ì£¼ì†Œë¥¼ í”„ë¡œë¹„ì €ë‹í•˜ê³  AWS VPCì™€ ë§ˆì°¬ê°€ì§€ë¡œ ê° íŒŒë“œì— ì§ì ‘ ì—°ê²°í•˜ë„ë¡ <code>networking.cilium.ipam=eni</code> ì„¤ì •ì„ ì¶”ê°€í•˜ê³ , hubbleì„ í™œì„±í™”í•˜ê¸° ìœ„í•œ <code>networking.cilium.hubble.enabled: true</code> ì„¤ì •ë„ ì¶”ê°€í•œë‹¤.<br>
<a href="https://docs.cilium.io/en/stable/network/concepts/ipam/eni/" target="_blank" rel="noopener noreferrer">https://docs.cilium.io/en/stable/network/concepts/ipam/eni/</a></p><p>cilium ì„¤ì •ì—ì„œì˜ ë‹¤ì–‘í•œ ì˜µì…˜ì€ ë‹¤ìŒì„ ì°¸ì¡°í•  ìˆ˜ ìˆë‹¤.<br>
<a href="https://kops.sigs.k8s.io/networking/cilium/" target="_blank" rel="noopener noreferrer">https://kops.sigs.k8s.io/networking/cilium/</a></p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">api</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">dns</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">authorization</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">rbac</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">channel</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> stable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">cloudProvider</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> aws</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">certManager</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">awsLoadBalancerController</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">externalDns</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">provider</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> external</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">metricsServer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">kubeDNS</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">provider</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> CoreDNS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">nodeLocalDNS</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">memoryRequest</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 5Mi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">cpuRequest</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 25m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">configBase</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> s3</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//jinwoong</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">k8s</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">s3/prosv.kr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ì—ì„œ ì¶”ê°€í•œ ì„¤ì •ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p><ul><li><a href="https://kops.sigs.k8s.io/addons/#cert-manager" target="_blank" rel="noopener noreferrer">certManager í™œì„±í™”</a></li><li><a href="https://kops.sigs.k8s.io/addons/#aws-load-balancer-controller" target="_blank" rel="noopener noreferrer">awsLoadBalancerController í™œì„±í™”</a> ë° <a href="https://kops.sigs.k8s.io/cluster_spec/#externaldns" target="_blank" rel="noopener noreferrer">externalDns êµ¬ì„±</a></li><li><a href="https://kops.sigs.k8s.io/addons/#metrics-server" target="_blank" rel="noopener noreferrer">metricsServer í™œì„±í™”</a></li><li><a href="https://kops.sigs.k8s.io/cluster_spec/#kubedns" target="_blank" rel="noopener noreferrer">kubeDNS êµ¬ì„±</a></li><li><a href="https://kops.sigs.k8s.io/state/#s3-state-store" target="_blank" rel="noopener noreferrer">ê¸°ë³¸ config ì €ì¥ì†Œ s3 ì§€ì •</a></li></ul><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">etcdClusters</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">cpuRequest</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 200m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">etcdMembers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">encryptedVolume</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">instanceGroup</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> control</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">plane</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">ap</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">northeast</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">2a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">memoryRequest</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 100Mi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">cpuRequest</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 100m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">etcdMembers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">encryptedVolume</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">instanceGroup</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> control</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">plane</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">ap</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">northeast</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">2a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">memoryRequest</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 100Mi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">iam</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">allowContainerRegistry</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">legacy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">kubelet</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">anonymousAuth</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">maxPods</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ì—ì„œ ì¶”ê°€í•œ ì„¤ì •ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p><ul><li><a href="https://kops.sigs.k8s.io/cluster_spec/#etcdclusters" target="_blank" rel="noopener noreferrer">etcd í´ëŸ¬ìŠ¤í„° êµ¬ì„±</a><ul><li>instancGroup CRDì—ì„œ ì›í•˜ëŠ” ë¨¸ì‹ íƒ€ì…, ê¸°ë³¸ ë…¸ë“œ ì´ë¯¸ì§€, ë…¸ë“œ ê°œìˆ˜ ë“±ì„ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤.</li></ul></li><li><a href="https://kops.sigs.k8s.io/iam_roles/#access-to-aws-ec2-container-registry-ecr" target="_blank" rel="noopener noreferrer">ECR ì ‘ê·¼ì„ ìœ„í•œ IAM êµ¬ì„±</a></li><li><a href="https://kops.sigs.k8s.io/cluster_spec/#kubelet" target="_blank" rel="noopener noreferrer">kubelet êµ¬ì„±</a></li></ul><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">kubernetesApiAccess</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 0.0.0.0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">kubernetesVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 1.24.11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">masterPublicName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> api.prosv.kr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">networkCIDR</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 172.30.0.0/16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">nonMasqueradeCIDR</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 100.64.0.0/10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">sshAccess</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 0.0.0.0/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">subnets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">cidr</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 172.30.32.0/19</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ap</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">northeast</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">2a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Public</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">zone</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ap</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">northeast</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">2a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">cidr</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 172.30.64.0/19</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ap</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">northeast</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">2c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Public</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">zone</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ap</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">northeast</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">2c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">topology</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">dns</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Public</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">masters</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> public</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">nodes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> public</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ì—ì„œ ì¶”ê°€í•œ ì„¤ì •ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p><ul><li><a href="https://kops.sigs.k8s.io/cluster_spec/#kubernetesapiaccess" target="_blank" rel="noopener noreferrer">kube-API ì ‘ê·¼ì œì–´ ì„¤ì •</a></li><li><a href="https://kops.sigs.k8s.io/run_in_existing_vpc/" target="_blank" rel="noopener noreferrer">ê¸°ì¡´ VPCë‚´ CIDR ì‚¬ìš©ì„ ìœ„í•œ êµ¬ì„±</a></li><li><a href="https://kops.sigs.k8s.io/topology/" target="_blank" rel="noopener noreferrer">ë„¤íŠ¸ì›Œí¬ í† í´ë¡œì§€ êµ¬ì„±</a></li></ul><p>InstanceGroup ê³¼ SSHCredential ë¥¼ ì‘ì„±í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kops.k8s.io/v1alpha2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> InstanceGroup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">creationTimestamp</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token null important">null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">kops.k8s.io/cluster</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prosv.kr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> control</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">plane</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">ap</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">northeast</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">2a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 099720109477/ubuntu/images/hvm</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">ssd/ubuntu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">focal</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">20.04</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">amd64</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230302</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">instanceMetadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">httpPutResponseHopLimit</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">httpTokens</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> required</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">machineType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> t3.medium</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">maxSize</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">minSize</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">role</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">subnets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ap</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">northeast</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">2a</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kops.k8s.io/v1alpha2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> InstanceGroup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">creationTimestamp</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token null important">null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">kops.k8s.io/cluster</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prosv.kr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nodes</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">ap</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">northeast</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">2a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 099720109477/ubuntu/images/hvm</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">ssd/ubuntu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">focal</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">20.04</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">amd64</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230302</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">instanceMetadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">httpPutResponseHopLimit</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">httpTokens</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> required</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">machineType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> t3.medium</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">maxSize</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">minSize</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">role</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">subnets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ap</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">northeast</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">2a</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kops.k8s.io/v1alpha2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> InstanceGroup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">creationTimestamp</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token null important">null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">kops.k8s.io/cluster</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prosv.kr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nodes</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">ap</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">northeast</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">2c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 099720109477/ubuntu/images/hvm</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">ssd/ubuntu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">focal</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">20.04</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">amd64</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230302</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">instanceMetadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">httpPutResponseHopLimit</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">httpTokens</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> required</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">machineType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> t3.medium</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">maxSize</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">minSize</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">role</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">subnets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ap</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">northeast</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">2c</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kops.k8s.io/v1alpha2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> SSHCredential</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">creationTimestamp</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token null important">null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">kops.k8s.io/cluster</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prosv.kr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">publicKey</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ssh</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">rsa AAAA</span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    root@ip</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">172</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">31</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">50</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">160</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì‘ì„±í•œ ëª¨ë“  íŒŒì¼ì„ í•˜ë‚˜ì˜ íŒŒì¼ë¡œ ì €ì¥í•œ í›„ ë‹¤ìŒê³¼ ê°™ì´ kops CLIë¡œ ë°°í¬ë¥¼ ì§„í–‰í•œë‹¤. ì „ì²´ íŒŒì¼ì€ ë‹¤ìŒ ë§í¬ ì˜ˆì‹œë¥¼ ì°¸ì¡°í•œë‹¤.<br>
<a href="https://raw.githubusercontent.com/ddiiwoong/kops-config/main/kops.yaml" target="_blank" rel="noopener noreferrer">https://raw.githubusercontent.com/ddiiwoong/kops-config/main/kops.yaml</a></p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kops create -f kops.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kops update cluster --name prosv.kr --ssh-public-key ~/.ssh/id_rsa.pub --yes</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë°°í¬ê³¼ ì™„ë£Œëœ ì´í›„ì— êµ¬ì„±ëœ íŒŒë“œë¥¼ í™•ì¸í•´ë³´ë©´ ëŒ€ë¶€ë¶„ì€ ê¸°ì¡´ VPC CNI êµ¬ì„±ìš”ì†Œì™€ ë™ì¼í•˜ì§€ë§Œ ëª‡ê°€ì§€ ì°¨ì´ì ì€ ë…¸ë“œë§ˆë‹¤ êµ¬ì„±ë˜ì–´ ìˆë˜ kube-proxy ëŒ€ì‹  cilium ë°ëª¬ì…‹ íŒŒë“œì™€ cilium ì˜¤í¼ë ˆì´í„° íŒŒë“œê°€ êµ¬ì„±ëœê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod -n kube-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                            READY   STATUS    RESTARTS      AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cilium-l6j9d                                    1/1     Running   0             24h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cilium-operator-697c58f5d5-8kk8m                1/1     Running   0             24h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cilium-q9j27                                    1/1     Running   0             24h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cilium-rx8zx                                    1/1     Running   0             24h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">external-dns-598d5f5c76-pqp6r                   1/1     Running   0             24h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hubble-relay-85df7fbcbf-79n52                   1/1     Running   0             24h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hubble-relay-85df7fbcbf-rfchd                   1/1     Running   0             24h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hubble-ui-5986c56d45-wn95w                      3/3     Running   0             23h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="cni-í…ŒìŠ¤íŠ¸">CNI í…ŒìŠ¤íŠ¸<a class="hash-link" href="#cni-í…ŒìŠ¤íŠ¸" title="Direct link to heading">â€‹</a></h2><p>í…ŒìŠ¤íŠ¸ìš© netshoot íŒŒë“œë¥¼ ìƒì„±í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF </span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain"> kubectl create </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">f </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apps/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> netshoot</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">replicas</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">matchLabels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> netshoot</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">template</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> netshoot</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> netshoot</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nicolaka/netshoot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">"tail"</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">args</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">"-f"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"/dev/null"</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">terminationGracePeriodSeconds</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë°°í¬í•œ netshoot íŒŒë“œì˜ IPë¥¼ í™•ì¸í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain"># kubectl get pod -o=custom-columns=NAME:.metadata.name,IP:.status.podIP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                            IP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-9mb7s   172.30.47.42</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-df68s   172.30.68.92</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>hubble ì ‘ê·¼ì„ ìœ„í•´ <a href="https://docs.cilium.io/en/stable/gettingstarted/hubble_setup/" target="_blank" rel="noopener noreferrer">https://docs.cilium.io/en/stable/gettingstarted/hubble_setup/</a> ì„ ì°¸ì¡°í•´ì„œ hubble, cilium CLIë¥¼ Cloud9ì— ì„¤ì¹˜í•œë‹¤. Hubble APIì— ì•¡ì„¸ìŠ¤í•˜ë ¤ë©´ ë¡œì»¬ ë¨¸ì‹ ì—ì„œ Hubble ì„œë¹„ìŠ¤ì— ëŒ€í•œ í¬íŠ¸ í¬ì›Œë“œë¥¼ ìƒì„±í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ cilium hubble port-forward&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Forwarding from 0.0.0.0:4245 -&gt; 4245</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Forwarding from [::]:4245 -&gt; 4245</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ hubble status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Healthcheck (via localhost:4245): Ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Current/Max Flows: 12,285/12,285 (100.00%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Flows/s: 12.41</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connected Nodes: 3/3</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì™¸ë¶€ë¡œ í†µì‹ í•˜ëŠ” íŠ¸ë˜í”½ì„ ë°œìƒì‹œí‚¤ê³  <code>hubble observe</code> ëª…ë ¹ì„ í†µí•´ flowë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl exec -it netshoot-pod-7757d5dd99-k4pf7 -- curl -s wttr.in/seoul                                              </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ hubble observe --pod netshoot-pod-7757d5dd99-k4pf7                                                                   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mar 18 17:24:57.786: default/netshoot-pod-7757d5dd99-k4pf7:35019 (ID:22269) -&gt; 169.254.20.10:53 (world) to-stack FORWARDED (UDP)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mar 18 17:24:57.788: default/netshoot-pod-7757d5dd99-k4pf7:35019 (ID:22269) &lt;- 169.254.20.10:53 (world) to-endpoint FORWARDED (UDP)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mar 18 17:24:57.788: default/netshoot-pod-7757d5dd99-k4pf7:51562 (ID:22269) -&gt; 169.254.20.10:53 (world) to-stack FORWARDED (UDP)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mar 18 17:24:57.789: default/netshoot-pod-7757d5dd99-k4pf7:51562 (ID:22269) &lt;- 169.254.20.10:53 (world) to-endpoint FORWARDED (UDP)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mar 18 17:24:57.789: default/netshoot-pod-7757d5dd99-k4pf7:57074 (ID:22269) -&gt; 169.254.20.10:53 (world) to-stack FORWARDED (UDP)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mar 18 17:24:57.790: default/netshoot-pod-7757d5dd99-k4pf7:57074 (ID:22269) &lt;- 169.254.20.10:53 (world) to-endpoint FORWARDED (UDP)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mar 18 17:24:57.790: default/netshoot-pod-7757d5dd99-k4pf7:49895 (ID:22269) -&gt; 169.254.20.10:53 (world) to-stack FORWARDED (UDP)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mar 18 17:24:57.791: default/netshoot-pod-7757d5dd99-k4pf7:49895 (ID:22269) &lt;- 169.254.20.10:53 (world) to-endpoint FORWARDED (UDP)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mar 18 17:24:57.792: default/netshoot-pod-7757d5dd99-k4pf7:42920 (ID:22269) -&gt; 169.254.20.10:53 (world) to-stack FORWARDED (UDP)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mar 18 17:24:57.794: default/netshoot-pod-7757d5dd99-k4pf7:42920 (ID:22269) &lt;- 169.254.20.10:53 (world) to-endpoint FORWARDED (UDP)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mar 18 17:24:58.050: default/netshoot-pod-7757d5dd99-k4pf7:40550 (ID:22269) -&gt; 5.9.243.187:80 (world) to-stack FORWARDED (TCP Flags: SYN)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mar 18 17:24:58.528: default/netshoot-pod-7757d5dd99-k4pf7:40550 (ID:22269) -&gt; 5.9.243.187:80 (world) to-stack FORWARDED (TCP Flags: ACK, FIN)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mar 18 17:24:58.766: default/netshoot-pod-7757d5dd99-k4pf7:40550 (ID:22269) &lt;- 5.9.243.187:80 (world) to-endpoint FORWARDED (TCP Flags: ACK, FIN)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mar 18 17:24:58.766: default/netshoot-pod-7757d5dd99-k4pf7:40550 (ID:22269) -&gt; 5.9.243.187:80 (world) to-stack FORWARDED (TCP Flags: ACK)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´ë²ˆì—ëŠ” ìµœëŒ€ íŒŒë“œ ê°œìˆ˜ë¥¼ ì²´í¬í•˜ê¸° ìœ„í•´ replicaë¥¼ 20ê°œë¡œ ì¦ê°€ì‹œí‚¨ë‹¤. í•˜ì§€ë§Œ ì•„ë˜ì™€ ê°™ì´ ëª‡ê°œì˜ íŒŒë“œê°€ <code>ContainerCreating</code> ìƒíƒœì¸ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl scale deployment/netshoot-pod --replicas=20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment.apps/netshoot-pod scaled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                            READY   STATUS              RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-2x29s   0/1     c   0          9s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-5j9qc   1/1     Running             0          34m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-9996z   1/1     Running             0          26m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-9dnkg   1/1     Running             0          34m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-9k92w   0/1     ContainerCreating   0          23s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-9mb7s   1/1     Running             0          43m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-c2292   1/1     Running             0          35m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-cf7dv   1/1     Running             0          34m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-df68s   1/1     Running             0          43m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-h9fjm   0/1     ContainerCreating   0          23s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-hrkcs   0/1     ContainerCreating   0          23s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-jkc6v   1/1     Running             0          34m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-jkx7j   1/1     Running             0          23s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-k4pf7   1/1     Running             0          26m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-lbzvs   1/1     Running             0          35m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-nb4pf   1/1     Running             0          34m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-r4bhf   1/1     Running             0          26m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-t8rt6   1/1     Running             0          26m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-x2d62   1/1     Running             0          26m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">netshoot-pod-7757d5dd99-zm7vc   1/1     Running             0          35m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>íŒŒë“œì˜ ìƒíƒœë¥¼ <code>describe</code> ëª…ë ¹ìœ¼ë¡œ ì‚´í´ë³´ë©´ cilium agentê°€ AWS IPAM ê³¼ ì—°ë™ë˜ì–´ IP ë¶€ì¡±ìœ¼ë¡œ ì¸í•´ í• ë‹¹ì´ ë˜ì§€ ì•ŠìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl describe pod netshoot-pod-7757d5dd99-9k92w</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Warning  FailedCreatePodSandBox  3m43s (x85 over 21m)  kubelet            (combined from similar events): Failed to create pod sandbox: rpc error: code = Unknown desc = failed to setup network for sandbox "eaced767b8747e09656744a3249a5e1c092fea7ba45302abdbf8086e3297c07d": plugin type="cilium-cni" name="cilium" failed (add): unable to allocate IP via local cilium agent: [POST /ipam][502] postIpamFailure  No more IPs availabl</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>AWS VPC CNI í™˜ê²½ì—ì„œ ìµœëŒ€ íŒŒë“œ ì‚¬ìš© ê°€ëŠ¥ ê³„ì‚°ì‹ì€ ENI ìì²´ IPë¥¼ ì œì™¸í•˜ê³  <code>aws-node</code> ì™€ <code>kube-proxy</code> íŒŒë“œë¥¼ ê³ ë ¤í•˜ì—¬ ë‹¤ìŒê³¼ ê°™ì€ ê³µì‹ìœ¼ë¡œ ê³„ì‚°ì„ í•˜ê²Œ ëœë‹¤.<br>
<a href="https://github.com/awslabs/amazon-eks-ami/blob/master/files/eni-max-pods.txt" target="_blank" rel="noopener noreferrer">https://github.com/awslabs/amazon-eks-ami/blob/master/files/eni-max-pods.txt</a></p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">((MaxENI * (IPv4addr - 1)) + 2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">t3.medium ê²½ìš° : ((3 * (6 - 1) + 2 ) = 17ê°œ &gt;&gt; aws-node ì™€ kube-proxy 2ê°œ ì œì™¸í•˜ë©´ 15ê°œ</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>IPAMì„ ì„¤ì •í•œ Ciliumì€ <a href="https://docs.cilium.io/en/stable/network/concepts/ipam/eni/" target="_blank" rel="noopener noreferrer">AWS ENI</a> ê¸°ì¤€ì„ ë”°ë¼ê°„ë‹¤. ê³µì‹ ë¬¸ì„œì—ì„œëŠ” ì•„ì§ í™•ì¸í•  ìˆ˜ ì—†ì§€ë§Œ <a href="https://github.com/cilium/cilium/issues/10426" target="_blank" rel="noopener noreferrer">GitHub issue</a>ë¡œ ì¶”ì •í•´ë³´ë©´ <code>health</code>, <code>router</code> <code>CiliumInternalIP</code> 3ê°œì˜ IPë¥¼ ì œì™¸í•˜ê¸° ë•Œë¬¸ì— t3.mediumì˜ ê²½ìš°ë¼ë©´ 3ê°œì˜ ENI ë‹¹ 6ê°œì˜ ì•„ì´í”¼ë¥¼ í• ë‹¹í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì‹¤ì œ êµ¬ì„± ê°€ëŠ¥í•œ ê°œìˆ˜ëŠ” 12ê°œ ìƒì„±ì´ ê°€ëŠ¥í•˜ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">(MaxENI * (IPv4addr - 1))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">t3.medium ê²½ìš° : ((3 * (6 - 1)) = 15ê°œ &gt;&gt; health, router, CiliumInternalIP 3ê°œ ì œì™¸í•˜ë©´ 12ê°œ íŒŒë“œê°€ ìƒì„±ì´ ê°€ëŠ¥í•˜ë‹¤. </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´ë¥¼ ciliumnode CRDë¥¼ í†µí•´ì„œë„ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤. </p><p>ì²«ë²ˆì§¸ ì¸í„°í˜ì´ìŠ¤ì— í• ë‹¹ëœ <code>InternalIP</code>, <code>ExternalIP</code> ì™€ ë‚´ë¶€ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” <code>CiliumInternalIP</code> ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get ciliumnode i</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">00b3ebc1b78f19739 </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">o yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">items</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cilium.io/v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> CiliumNode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">addresses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">ip</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 172.30.60.14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> InternalIP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">ip</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 13.124.209.231</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ExternalIP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">ip</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 172.30.44.153</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> CiliumInternalIP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>spec.ipam</code>ì—ì„œëŠ” ìœ„ì—ì„œ ì–¸ê¸‰í•œ ëŒ€ë¡œ 15ê°œì˜ í• ë‹¹ê°€ëŠ¥í•œ IPë¥¼ ë³´ì—¬ì¤€ë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ipam</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">podCIDRs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 100.96.2.0/24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">pool</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.32.43</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0717341e6470f76ce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.32.217</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0483a896a7c0b49f3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.36.179</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0717341e6470f76ce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.38.188</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0483a896a7c0b49f3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.38.221</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0483a896a7c0b49f3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.42.57</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">03b280d75b6d6cb09</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.44.103</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0717341e6470f76ce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.44.153</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">03b280d75b6d6cb09</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.44.201</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0717341e6470f76ce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.47.42</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0483a896a7c0b49f3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.47.95</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">03b280d75b6d6cb09</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.53.208</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">03b280d75b6d6cb09</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.55.231</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0717341e6470f76ce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.61.93</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0483a896a7c0b49f3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.63.46</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">03b280d75b6d6cb09</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">pre-allocate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>status.ipam</code>ì—ì„œëŠ” í˜„ì¬ í• ë‹¹ë˜ì–´ ìˆëŠ” 12ê°œì˜ IPí˜„í™©ì„ ë³¼ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ipam</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">operator-status</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">used</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.32.43</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">owner</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default/netshoot</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">7757d5dd99</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">x2d62</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0717341e6470f76ce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.32.217</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">owner</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kube</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">system/metrics</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">5f65d889cd</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">kg8sb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0483a896a7c0b49f3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.36.179</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">owner</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default/netshoot</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">7757d5dd99</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">9996z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0717341e6470f76ce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.38.188</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">owner</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default/netshoot</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">7757d5dd99</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">9dnkg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0483a896a7c0b49f3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.38.221</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">owner</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kube</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">system/coredns</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">68cd66b8cc</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">2bmzj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0483a896a7c0b49f3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.42.57</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">owner</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kube</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">system/ebs</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">csi</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">node</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">t9dk5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">03b280d75b6d6cb09</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.44.103</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">owner</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default/netshoot</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">7757d5dd99</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">5j9qc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0717341e6470f76ce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.44.153</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">owner</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> router</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">03b280d75b6d6cb09</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.44.201</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">owner</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default/netshoot</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">7757d5dd99</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">c2292</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0717341e6470f76ce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.47.42</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">owner</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default/netshoot</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">7757d5dd99</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">9mb7s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0483a896a7c0b49f3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.53.208</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">owner</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default/netshoot</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">7757d5dd99</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">zm7vc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">03b280d75b6d6cb09</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.55.231</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">owner</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kube</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">system/hubble</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">relay</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">85df7fbcbf</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">79n52</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0717341e6470f76ce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.61.93</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">owner</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default/netshoot</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">7757d5dd99</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">jkc6v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">0483a896a7c0b49f3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">172.30.63.46</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">owner</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> health</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eni</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">03b280d75b6d6cb09</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ì´ë²ˆì—ëŠ” kOps êµ¬ì„±ì„ Cilium CNI ê¸°ë°˜ìœ¼ë¡œ êµ¬ì„±í•˜ê³  hubbleì„ í†µí•´ flowë¥¼ í™•ì¸í•˜ê³  AWS IPAM API ì—°ë™ì„ í†µí•œ íŒŒë“œ IPí• ë‹¹ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ë´¤ë‹¤.</p><blockquote><p>í•´ë‹¹ í¬ìŠ¤íŒ…ì€ í˜„ì¬ ì¬ì§ì¤‘ì¸ íšŒì‚¬ì— ê´€ë ¨ì´ ì—†ê³ , ê°œì¸ ì—­ëŸ‰ ê°œë°œì„ ìœ„í•œ ìë£Œë¡œ í™œìš©í•  ì˜ˆì •ì…ë‹ˆë‹¤.</p></blockquote>]]></content>
        <author>
            <name>Jinwoong Kim</name>
            <uri>https://www.linkedin.com/in/ddiiwoong/</uri>
        </author>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="kOps" term="kOps"/>
        <category label="Cloud9" term="Cloud9"/>
        <category label="CloudFormation" term="CloudFormation"/>
        <category label="CNI" term="CNI"/>
        <category label="Networking" term="Networking"/>
        <category label="Cilium" term="Cilium"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[kOps with Cloud9]]></title>
        <id>kubernetes/kops-cloud9/</id>
        <link href="https://ddii.dev/kubernetes/kops-cloud9/"/>
        <updated>2023-03-08T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Cloud9 ê¸°ë°˜ kOps í™˜ê²½ êµ¬ì„±]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kops">kOps<a class="hash-link" href="#kops" title="Direct link to heading">â€‹</a></h2><ul><li><strong>K</strong>ubernetes <strong>Op</strong>eration<strong>s</strong> (kOps) - Production Grade k8s Installation, Upgrades and Management</li></ul><p><a href="https://kops.sigs.k8s.io/" target="_blank" rel="noopener noreferrer">https://kops.sigs.k8s.io/</a>
<a href="https://github.com/kubernetes/kops" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes/kops</a></p><p>kOpsëŠ” í´ë¼ìš°ë“œ í”Œë«í¼(aws, gcp, azure ë“±)ì—ì„œ ì‰½ê²Œ k8s ë¥¼ ì„¤ì¹˜í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ë„êµ¬ë¡œ ì„œë²„ ì¸ìŠ¤í„´ìŠ¤ì™€ ë„¤íŠ¸ì›Œí¬ ë¦¬ì†ŒìŠ¤ ë“±ì„ í´ë¼ìš°ë“œì—ì„œ ìë™ìœ¼ë¡œ ìƒì„±í•´ k8s ë¥¼ ì„¤ì¹˜í•˜ëŠ” ë„êµ¬ì´ê³  kOpsëŠ” AWS ì˜ ë‹¤ì–‘í•œ ì„œë¹„ìŠ¤ì™€ ìœ ì—°í•˜ê²Œ ì—°ë™ë˜ì–´ ì‚¬ìš© ê°€ëŠ¥í•œê²Œ ì¥ì ì´ë‹¤. </p><p>ê¸€ì„ ì‘ì„±í•˜ëŠ” ë‚ ì§œ ê¸°ì¤€(23ë…„ 3ì›” 5ì¼), ë²„ì „ì€ 1.25.3 ìœ¼ë¡œ ì§„í–‰ì„ í•œë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="bastion-í™˜ê²½-êµ¬ì„±">Bastion í™˜ê²½ êµ¬ì„±<a class="hash-link" href="#bastion-í™˜ê²½-êµ¬ì„±" title="Direct link to heading">â€‹</a></h2><p>Basitionì€ Cloud9ìœ¼ë¡œ êµ¬ì„±ì„ í–ˆë‹¤. <a href="https://github.com/aws-samples/aws-cloud9-bootstrapping-example" target="_blank" rel="noopener noreferrer">https://github.com/aws-samples/aws-cloud9-bootstrapping-example</a> ë¥¼ ì°¸ê³ í•˜ì—¬ êµ¬ì„±í–ˆê³  ì—¬ëŸ¬ íˆ´ì„ bootstrap í˜•íƒœë¡œ êµ¬ì„±í•˜ê¸° ìœ„í•´ ì¶”ê°€ì ìœ¼ë¡œ ì—¬ëŸ¬ ë„êµ¬ë“¤ì„ ì„¤ì¹˜í•œë‹¤.</p><ul><li>kubectl</li><li>kops</li><li>awscli v2</li><li>k9s</li><li>helm</li><li>jq, git, htop, tree, gettext, bash-completion ë“±</li></ul><p>ìì„¸í•œ ë‚´ìš©ì€ <a href="https://github.com/jinwoongk/aws-cloud9-bootstrapping-example/blob/main/example_instancestack.yaml" target="_blank" rel="noopener noreferrer">https://github.com/jinwoongk/aws-cloud9-bootstrapping-example/blob/main/example_instancestack.yaml</a> ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤. í•´ë‹¹ yaml ì—ì„œ ë³¸ì¸ì´ ì£¼ë¡œ ì ‘ì†í•˜ëŠ” Console ì ‘ì† ì •ë³´(ARN)ì„ ì•„ë˜ <code>OwnerArn</code> êµ¬ë¬¸ê³¼ ê°™ì´ ì—…ë°ì´íŠ¸ë¥¼ ì§„í–‰í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">################## INSTANCE #####################</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">ExampleC9InstanceProfile</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">Type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> AWS</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">IAM</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">InstanceProfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">Properties</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">Path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"/"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">Roles</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">Ref</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ExampleC9Role</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">ExampleC9Instance</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">Description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"-"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">DependsOn</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ExampleC9BootstrapAssociation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">Type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> AWS</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">Cloud9</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">EnvironmentEC2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">Properties</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">Description</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> AWS Cloud9 instance for Examples</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">AutomaticStopTimeMinutes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3600</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">InstanceType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">Ref</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ExampleC9InstanceType</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">Name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">Ref</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> AWS</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">StackName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># OwnerArn: !If [Create3rdPartyResources, !Ref ExampleOwnerArn, !Ref "AWS::NoValue" ]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">OwnerArn</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"arn:aws:sts::265664683898:assumed-role/AWSReservedSSO_AWSAdministratorAccess_574b6756fcc31821/jinwoong"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í•´ë‹¹ yaml ì„ ê°€ì§€ê³  ì•„ë˜ ëª…ë ¹ìœ¼ë¡œ Cloudformationì„ ì‹¤í–‰í•˜ê²Œ ë˜ë©´ ì—¬ëŸ¬ê°€ì§€ ìœ í‹¸ì´ ì„¤ì¹˜ëœ ìƒíƒœì˜ Cloud9 ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë˜ê²Œ ëœë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">aws cloudformation deploy  --stack-name kops-test --template ./example_instancestack.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Cloud9ì„ ìœ„í•´ ìƒì„±ëœ ê¶Œí•œì„ í™œìš©í•˜ê¸° ìœ„í•´ Cloud9 ì„¤ì •ì—ì„œ AWS managed temporary credentials ê¸°ëŠ¥ì„ ë¹„í™œì„±í™” í•˜ì.</p><p><img loading="lazy" alt="cloud9" src="/assets/images/cloud9_credential-0a221243d5537b39c35d0b070bde7ef8.png" width="3246" height="1028" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kops-ë°°í¬">kOps ë°°í¬<a class="hash-link" href="#kops-ë°°í¬" title="Direct link to heading">â€‹</a></h2><p>AWS í™˜ê²½ì— kOpsë¥¼ ë°°í¬í•˜ê¸° ìœ„í•´ì„œëŠ” ì•„ë˜ì™€ ê°™ì€ IAM ê¶Œí•œì´ í•„ìš”í•˜ë‹¤. </p><ul><li>AmazonEC2FullAccess</li><li>AmazonRoute53FullAccess </li><li>AmazonS3FullAccess </li><li>IAMFullAccess </li><li>AmazonVPCFullAccess </li><li>AmazonSQSFullAccess </li><li>AmazonEventBridgeFullAccess</li></ul><p>kOpsëŠ” Cluster State ì €ì¥ì„ ìœ„í•œ S3 ë²„í‚·ê³¼ DNS ë ˆì½”ë“œë¥¼ í™œìš©í•´ì„œ í´ëŸ¬ìŠ¤í„° ìƒì„±ì„ í•˜ê²Œ ë˜ëŠ”ë° í¸ì˜ë¥¼ ìœ„í•´ ê°œì¸ ì‚¬ìš©ì¤‘ì¸ ë„ë©”ì¸ì˜ NSì„œë²„ë¥¼ Route53ì— ì—°ê²°í•˜ê³  ì´ë¯¸ ìƒì„±í•´ë†“ì€ ë²„í‚·ì„ ê°€ì§€ê³  ë°°í¬ë¥¼ ì§„í–‰í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain"># ë°°í¬ ì‹œ ì°¸ê³ í•  ì •ë³´ë¥¼ í™˜ê²½ ë³€ìˆ˜ì— ì €ì¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## export NAME=&lt;ìì‹ ì˜ í¼ë¸”ë¦­ í˜¸ìŠ¤íŒ… ë©”ì¸ ì£¼ì†Œ&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## export KOPS_STATE_STORE=s3://(ë²„í‚· ì´ë¦„)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export KOPS_CLUSTER_NAME=prosv.kr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export KOPS_STATE_STORE=s3://jinwoong-k8s-s3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export AWS_PAGER=""</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export REGION=ap-northeast-2</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Cloud9 í™˜ê²½ì—ì„œ <code>kops</code> ëª…ë ¹ì„ í†µí•´ í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•˜ê²Œ ë˜ëŠ”ë° <code>VPC CNI</code>ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ <code>amazonvpc</code>ë¡œ êµ¬ì„±í•˜ê³  <code>1.24</code> ë²„ì „ì˜ master ë…¸ë“œ 1ëŒ€, work ë…¸ë“œ 3ëŒ€ë¥¼ ìƒì„±í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kops create cluster --zones="$REGION"a,"$REGION"c \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--networking amazonvpc --cloud aws \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--master-size t3.medium --node-size t3.medium --node-count=3 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--network-cidr 172.30.0.0/16 --ssh-public-key ~/.ssh/id_rsa.pub \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--name=$KOPS_CLUSTER_NAME --discovery-store=s3://jinwoong-k8s-s3 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--kubernetes-version "1.24.10" -y</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í´ëŸ¬ìŠ¤í„°ê°€ ìƒì„±ë˜ëŠ” ë™ì•ˆ ìœ íš¨ì„±ì„ ì²´í¬í•˜ê¸° ìœ„í•´ 10ë¶„ê°„ ëŒ€ê¸°í•˜ê³  êµ¬ì„±ì´ ì™„ë£Œë˜ë©´ ì•„ë˜ì™€ ê°™ì´ ì´ˆê¸° êµ¬ì„±í•œ í´ëŸ¬ìŠ¤í„°ê°€ ready ìƒíƒœì¸ì§€ ì•Œ ìˆ˜ ìˆë‹¤. <code>kops get</code> ëª…ë ¹ì„ í†µí•´ ë‹¤ë¥¸ ì •ë³´ë“¤ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kops validate cluster --wait 10m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Validating cluster prosv.kr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INSTANCE GROUPS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                    ROLE    MACHINETYPE     MIN     MAX     SUBNETS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">master-ap-northeast-2a  Master  t3.medium       1       1       ap-northeast-2a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nodes-ap-northeast-2a   Node    t3.medium       2       2       ap-northeast-2a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nodes-ap-northeast-2c   Node    t3.medium       1       1       ap-northeast-2c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NODE STATUS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                    ROLE    READY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">i-053ca67a20cd7bf7f     node    True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">i-0a7dfc0939b58c2fc     node    True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">i-0aa3db1bfe96bf280     master  True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">i-0b665798ce9dd857f     node    True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Your cluster prosv.kr is ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kops get cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME            CLOUD   ZONES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prosv.kr        aws     ap-northeast-2a,ap-northeast-2c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kops get instances</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ID                      NODE-NAME               STATUS          ROLES   STATE   INTERNAL-IP     INSTANCE-GROUP                          MACHINE-TYPE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">i-053ca67a20cd7bf7f     i-053ca67a20cd7bf7f     UpToDate        node            172.30.49.113   nodes-ap-northeast-2a.prosv.kr          t3.medium</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">i-0a7dfc0939b58c2fc     i-0a7dfc0939b58c2fc     UpToDate        node            172.30.77.157   nodes-ap-northeast-2c.prosv.kr          t3.medium</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">i-0aa3db1bfe96bf280     i-0aa3db1bfe96bf280     UpToDate        master          172.30.63.194   master-ap-northeast-2a.masters.prosv.kr t3.medium</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">i-0b665798ce9dd857f     i-0b665798ce9dd857f     UpToDate        node            172.30.54.137   nodes-ap-northeast-2a.prosv.kr          t3.medium</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê¸°ë³¸ CRI ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ì´ containerd ì¸ ê²ƒë„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ê° ë…¸ë“œê°€ External-IPë¥¼ í• ë‹¹ë°›ì€ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get nodes -o wide</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                  STATUS   ROLES           AGE   VERSION    INTERNAL-IP     EXTERNAL-IP      OS-IMAGE             KERNEL-VERSION    CONTAINER-RUNTIME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">i-053ca67a20cd7bf7f   Ready    node            42m   v1.24.10   172.30.49.113   43.201.14.97     Ubuntu 20.04.5 LTS   5.15.0-1028-aws   containerd://1.6.10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">i-0a7dfc0939b58c2fc   Ready    node            42m   v1.24.10   172.30.77.157   43.201.77.155    Ubuntu 20.04.5 LTS   5.15.0-1028-aws   containerd://1.6.10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">i-0aa3db1bfe96bf280   Ready    control-plane   44m   v1.24.10   172.30.63.194   43.200.6.4       Ubuntu 20.04.5 LTS   5.15.0-1028-aws   containerd://1.6.10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">i-0b665798ce9dd857f   Ready    node            42m   v1.24.10   172.30.54.137   13.125.115.198   Ubuntu 20.04.5 LTS   5.15.0-1028-aws   containerd://1.6.10</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>kubectl cli í”ŒëŸ¬ê·¸ì¸ ë§¤ë‹ˆì €ì¸ ì¿ ë²„ë„¤í‹°ìŠ¤ <code>krew</code>ë¥¼ ì„¤ì¹˜í•˜ê³  ì—¬ëŸ¬ê°€ì§€ ë„êµ¬ë¥¼ ì„¤ì¹˜í•œë‹¤. ì„¤ì¹˜ë˜ëŠ” í”ŒëŸ¬ê·¸ì¸ ë§ê³ ë„ ë‹¤ì–‘í•œ í”ŒëŸ¬ê·¸ì¸ë“¤ì€ ì•„ë˜ ë§í¬ì—ì„œ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤.</p><ul><li><a href="https://krew.sigs.k8s.io/plugins/" target="_blank" rel="noopener noreferrer">https://krew.sigs.k8s.io/plugins/</a></li></ul><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl krew install ctx ns df-pv get-all ktop neat oomd view-secret</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="add-on-êµ¬ì„±">Add-on êµ¬ì„±<a class="hash-link" href="#add-on-êµ¬ì„±" title="Direct link to heading">â€‹</a></h2><p>ExternalDNSì™€ ê°™ì€ add-onì„ êµ¬ì„±í•˜ê³  Kubernetes ì„œë¹„ìŠ¤ ë˜ëŠ” ì¸ê·¸ë ˆìŠ¤ ìƒì„± ì‹œ ë„ë©”ì¸ì„ ì„¤ì •í•˜ë©´, AWS(Route 53)ì™€ ê°™ì€ í´ë¼ìš°ë“œ DNS ì„œë¹„ìŠ¤ì—ì„œ A ë ˆì½”ë“œ(TXT ë ˆì½”ë“œ)ë¥¼ ìë™ ìƒì„±/ì‚­ì œí•  ìˆ˜ ìˆë‹¤. Route53ì—ì„œ ë™ì‘ì„ ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ IAM Policyê°€ í•„ìš”í•˜ë‹¤.  </p><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"Version"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"2012-10-17"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"Statement"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"Effect"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Allow"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"Action"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">"route53:ChangeResourceRecordSets"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"Resource"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">"arn:aws:route53:::hostedzone/*"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"Effect"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Allow"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"Action"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">"route53:ListHostedZones"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">"route53:ListResourceRecordSets"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"Resource"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">"*"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í•´ë‹¹ jsonìœ¼ë¡œ IAM Policyë¥¼ ìƒì„±í•˜ê³  master, worker ë…¸ë“œ instance profileì— ì¶”ê°€í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">aws iam create-policy --policy-name AllowExternalDNSUpdates --policy-document file://externaldns-aws-r53-policy.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export ACCOUNT_ID=$(aws sts get-caller-identity --query 'Account' --output text)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws iam attach-role-policy --policy-arn arn:aws:iam::$ACCOUNT_ID:policy/AllowExternalDNSUpdates --role-name masters.$KOPS_CLUSTER_NAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws iam attach-role-policy --policy-arn arn:aws:iam::$ACCOUNT_ID:policy/AllowExternalDNSUpdates --role-name nodes.$KOPS_CLUSTER_NAME</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´ ìƒíƒœì—ì„œ <code>externalDNS</code>ë¥¼ êµ¬ì„±í•œë‹¤.  <code>externalDNS</code> ì™€ ê°™ì€ ì—¬ëŸ¬ ì• ë“œì˜¨ë“¤ì€ kOpsì™€ ì¿ ë²„ë„¤í‹°ìŠ¤ ë¼ì´í”„ì‚¬ì´í´ì— ë”°ë¼ êµ¬ì„±, ê´€ë¦¬ëœë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ API ì„œë²„ëŠ” ë©”íŠ¸ë¦­ ì„œë²„ TLS ì¸ì¦ì„œë¥¼ í™•ì¸í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— TLSë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ í´ëŸ¬ìŠ¤í„° specì—ì„œ <code>certManager</code>ë„ ê°™ì´ ì¶”ê°€í•œë‹¤. ë˜í•œ HPA êµ¬ì„±ì„ ìœ„í•´ <code>metricServer</code> ë„ êµ¬ì„±ì„ ì§„í–‰í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kops edit cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">certManager</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">externalDns</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">provider</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> external</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">metricsServer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">insecure</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kops update cluster </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">yes </span><span class="token important">&amp;&amp;</span><span class="token plain"> echo </span><span class="token important">&amp;&amp;</span><span class="token plain"> sleep 3 </span><span class="token important">&amp;&amp;</span><span class="token plain"> kops rolling</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">update cluster </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">yes</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì¼ë‹¨ php-apache deploymentë¥¼ ì‹œì‘í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apps/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> php</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">apache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">matchLabels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> php</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">apache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">replicas</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">template</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> php</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">apache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> php</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">apache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> registry.k8s.io/hpa</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">containerPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">limits</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">cpu</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 500m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">requests</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">cpu</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 200m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> php</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">apache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> php</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">apache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> php</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">apache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> LoadBalancer</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë°”ë¡œ HPA í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ê°„ë‹¨í•˜ê²Œ ì‚¬ìš©ë¥ ì„ ê¸°ë°˜ìœ¼ë¡œ ìŠ¤ì¼€ì¼ë§ì´ ë™ì‘í•˜ë„ë¡ êµ¬ì„±í•˜ê³  CPU ë¡œë“œë¥¼ ì£¼ì…í•œë‹¤. <code>load-generator</code>ì—ì„œëŠ” 0.01ì´ˆ ë‹¨ìœ„ë¡œ ë¦¬í€˜ìŠ¤íŠ¸ë¥¼ ë³´ë‚´ê²Œ ëœë‹¤. </p><p><a href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale-walkthrough/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale-walkthrough/</a></p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl autoscale deployment php-apache --cpu-percent=10 --min=1 --max=4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl run -i --tty load-generator --rm --image=busybox:1.28 --restart=Never -- /bin/sh -c "while sleep 0.01; do wget -q -O- http://php-apache; done"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If you don't see a command prompt, try pressing enter.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!OK!</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë‹¤ìŒìœ¼ë¡œ, HPAê°€ ë¶€í•˜ ì¦ê°€ì— ì–´ë–»ê²Œ ë°˜ì‘í•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get hpa php-apache --watch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME         REFERENCE               TARGETS   MINPODS   MAXPODS   REPLICAS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">php-apache   Deployment/php-apache   93%/10%   1         4         4          1m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë§ˆì§€ë§‰ìœ¼ë¡œ CLBì— ExternalDNSë¡œ ë„ë©”ì¸ ì—°ê²°ì„ í•˜ê¸° ìœ„í•´ì„œëŠ” exposeë¥¼ ì›í•˜ëŠ” Serviceì— ë‹¤ìŒê³¼ ê°™ì´ annotationì„ ì¶”ê°€í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ì™¸ë¶€ ë„ë©”ì¸ì„ ì‰½ê²Œ ì—°ê²°í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl annotate service nginx "external-dns.alpha.kubernetes.io/hostname=nginx.$KOPS_CLUSTER_NAME"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>í•­ìƒ EKSë§Œ í™œìš©í•˜ëŠ” í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë‹¤ë³´ë‹ˆ ìŠ¤í„°ë”” í›„ì— ì˜¤ëœë§Œì— ì§ì ‘ êµ¬ì„±í•˜ëŠ” ê²½í—˜ì„ í•´ë³´ë‹ˆ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…í•˜ëŠ” ì¬ë¯¸ê°€ ìˆì–´ì„œ ì¢‹ì€ê²ƒ ê°™ë‹¤. ì´ëŸ°ì €ëŸ° add-onì„ ì¶”ê°€ì ìœ¼ë¡œ êµ¬ì„±í•´ì„œ ë” í•´ë³´ê³  ì‹¶ì§€ë§Œ ì—­ì‹œë‚˜ ì‹œê°„ì´ ì—†ëŠ” ê´€ê³„ë¡œ ì¼ë‹¨ ì—¬ê¸° ê¹Œì§€ êµ¬ì„±ì„ í•˜ê³  ì´ë²ˆì— ì„¤ì¹˜í•œ Cloud9ìœ¼ë¡œ ë°°í¬ë˜ëŠ” í´ëŸ¬ìŠ¤í„° êµ¬ì„±ì€ CKSë¥¼ ì¤€ë¹„í•˜ê³  íŒ€ ë‚´ë¶€ ì„¸ì…˜ì„ ì§„í–‰í•˜ëŠ” ë„êµ¬ë¡œ í™œìš©ì„ í•´ë³¼ ì˜ˆì •ì´ë‹¤.</p><blockquote><p>í•´ë‹¹ í¬ìŠ¤íŒ…ì€ í˜„ì¬ ì¬ì§ì¤‘ì¸ íšŒì‚¬ì— ê´€ë ¨ì´ ì—†ê³ , ê°œì¸ ì—­ëŸ‰ ê°œë°œì„ ìœ„í•œ ìë£Œë¡œ í™œìš©í•  ì˜ˆì •ì…ë‹ˆë‹¤.</p></blockquote>]]></content>
        <author>
            <name>Jinwoong Kim</name>
            <uri>https://www.linkedin.com/in/ddiiwoong/</uri>
        </author>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="kOps" term="kOps"/>
        <category label="Cloud9" term="Cloud9"/>
        <category label="CloudFormation" term="CloudFormation"/>
        <category label="HPA" term="HPA"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[EKS CNI Custom Networking]]></title>
        <id>kubernetes/eks-cni-custom/</id>
        <link href="https://ddii.dev/kubernetes/eks-cni-custom/"/>
        <updated>2022-12-16T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Terraform null_resourceë¥¼ í™œìš©í•˜ì—¬ EKS CNI networkë¥¼ êµ¬ì„±í•˜ëŠ” ë°©ë²•]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="eks-cni-networking-ì œì•½ì‚¬í•­">EKS CNI Networking ì œì•½ì‚¬í•­<a class="hash-link" href="#eks-cni-networking-ì œì•½ì‚¬í•­" title="Direct link to heading">â€‹</a></h2><p><a href="https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/cni-custom-network.html#custom-networking-automatically-apply-eniconfig" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/cni-custom-network.html#custom-networking-automatically-apply-eniconfig</a>  </p><p>AWSì—ëŠ” ê¸°ë³¸ ENIê°€ í¬í•¨ëœ ì„œë¸Œë„·ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” IPê°œìˆ˜ëŠ” ì œí•œë˜ì–´ ìˆë‹¤. íŒŒë“œì˜ ìˆ˜ ì œí•œì´ ë°œìƒí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— secondary ENIì— ë‹¤ë¥¸ ì„œë¸Œë„·ì„ ì‚¬ìš©í•˜ì—¬ ê°€ìš© IPê°œìˆ˜ë¥¼ ëŠ˜ë¦´ìˆ˜ ìˆë‹¤. ë˜í•œ ë³´ì•ˆìƒì˜ ì´ìœ ë¡œ íŒŒë“œëŠ” ë…¸ë“œì˜ ê¸°ë³¸ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ì™€ ë‹¤ë¥¸ ì„œë¸Œë„· ë˜ëŠ” ë³´ì•ˆ ê·¸ë£¹ì„ ì‚¬ìš©í•´ì•¼ í•  ìˆ˜ ìˆë‹¤.   </p><p>CNI Custom Networkingì´ í™œì„±í™”ê°€ ë˜ë©´ íŒŒë“œëŠ” ë‹¤ë¥¸ ì„œë¸Œë„·ì— ìƒì„±ì´ ë˜ê³ , ë…¸ë“œ ì„œë¸Œë„·ì˜ ì•„ì´í”¼ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.</p><p>EKSì—ì„œ íŒŒë“œ ëŒ€ì—­ì„ ë¶„ë¦¬ í•˜ê¸° ìœ„í•´ì„œ CNI Custom Networking ì„¤ì •ì„ ì§„í–‰í•œë‹¤. í•´ë‹¹ env ê°’ì„ ë³€ê²½í•˜ë©´ ì¦‰ì‹œ aws-node ê°€ êµì²´ëœë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl set env daemonset aws-node -n kube-system AWS_VPC_K8S_CNI_CUSTOM_NETWORK_CFG=true</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>íŒŒë“œë¥¼ ë°°í¬í•˜ë ¤ëŠ” ê° ì„œë¸Œë„·ì— ëŒ€í•´ì„œ ì•„ë˜ì™€ ê°™ì€ í˜•ì‹ìœ¼ë¡œ ENIConfig ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•´ì•¼ í•œë‹¤. ì‚¬ìš©í•˜ë ¤ëŠ” ì„œë¸Œë„·ê³¼ SGì„ ì„ ì–¸í•´ì•¼ ê¸°ë³¸ì ì¸ êµ¬ì„±ì´ ê°€ëŠ¥í•˜ë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: crd.k8s.amazonaws.com/v1alpha1  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: ENIConfig  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name: "ap-northeast-2a"  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subnet: "${subnet_a}"  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">securityGroups:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- ${NODE_SG}  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: crd.k8s.amazonaws.com/v1alpha1  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: ENIConfig  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name: "ap-northeast-2b"  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subnet: "${subnet_c}"  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">securityGroups:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- ${NODE_SG}  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: crd.k8s.amazonaws.com/v1alpha1  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: ENIConfig  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name: "ap-northeast-2c"  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subnet: "${subnet_d}"  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">securityGroups:  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- ${NODE_SG}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>aws-node</code> <code>DaemonSet</code>ë¥¼ ì—…ë°ì´íŠ¸í•˜ì—¬ í´ëŸ¬ìŠ¤í„°ì— ìƒì„±ëœ ëª¨ë“  ë…¸ë“œì— ê°€ìš© ì˜ì—­ì˜ <code>ENIConfig</code>ë¥¼ ìë™ìœ¼ë¡œ ì ìš©í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl set env daemonset aws-node -n kube-system ENI_CONFIG_LABEL_DEF=topology.kubernetes.io/zone</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´ë•Œ ëª‡ê°€ì§€ ì œì•½ì‚¬í•­ì´ ìƒê¸°ê²Œ ëœë‹¤.</p><ul><li><p>í•´ë‹¹ ì„¤ì •ì„ ë°°í¬í•˜ê³  ë‚œ ì´í›„ ì¶”ê°€ëœ ë…¸ë“œì— ëŒ€í•´ì„œë§Œ ìƒˆë¡œìš´ ì„œë¸Œë„· IPë¡œ í• ë‹¹ì´ ë˜ê¸° ë•Œë¬¸ì—, ê¸°ì¡´ ë…¸ë“œë¥¼ ì¬ì‹œì‘í•˜ê±°ë‚˜ ì‚­ì œë¥¼ í•´ì•¼ íŒŒë“œì— ìƒˆë¡œìš´ IPê°€ í• ë‹¹ì´ ëœë‹¤.</p></li><li><p>CNI Custom Networking ì„¤ì •ì—ì„œëŠ” ë‹¤ì¤‘ ì„œë¸Œë„·ì„ í• ë‹¹í•  ìˆ˜ ì—†ê³  ì„œë¸Œë„· ë³„ë¡œ custom nameìœ¼ë¡œ ì„¤ì •í•˜ê³  ëª¨ë“  node ê°ê°ì— ì…ë ¥í•œ ë³„ë„ì˜ annotationì„ ì¶”ê°€í•´ì•¼í•œë‹¤. (<a href="https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/cni-custom-network.html#custom-networking-deploy-nodes" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/cni-custom-network.html#custom-networking-deploy-nodes</a>)</p></li><li><p>AWSì˜ ì¸ìŠ¤í„´ìŠ¤ íƒ€ì…ë³„ ENI ê°œìˆ˜ ì œí•œìœ¼ë¡œ Pod ìƒì„±ì´ ë¶ˆê°€ëŠ¥í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ Kubelet BootstrapArguments íŒŒë¼ë¯¸í„°ë¥¼ launch template ì—ì„œ ì‚¬ì „ì— ì •ì˜ëœ ê°’ìœ¼ë¡œ ë³€ê²½í•˜ì—¬ ë…¸ë“œê°€ ìƒì„±ë˜ë„ë¡ í•œë‹¤.</p></li><li><p>MAX PODS = (Number of network interfaces Ã— <!-- -->[the number of IP addresses per network interface â€“ 1]<!-- -->) + 2</p></li><li><p><a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-eni.html#AvailableIpPerENI" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-eni.html#AvailableIpPerENI</a></p></li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">MIME-Version: 1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: multipart/mixed; boundary="==MYBOUNDARY=="</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--==MYBOUNDARY==</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: text/x-shellscript; charset="us-ascii"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/eks/bootstrap.sh {Cluster Name} --use-max-pods false --kubelet-extra-args '--max-pods=110'--==MYBOUNDARY==--\</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´ëŸ¬í•œ ì œì•½ì‚¬í•­ë“¤ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ì„œ CNI Custom Networking êµ¬í˜„ì„ Terraform Pipelineìœ¼ë¡œ êµ¬í˜„ì„ ì§„í–‰í•œë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="terraform-ìœ¼ë¡œ-cni-êµ¬ì„±í•˜ëŠ”-ìŠ¤í¬ë¦½íŠ¸-ì‹¤í–‰">Terraform ìœ¼ë¡œ CNI êµ¬ì„±í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰<a class="hash-link" href="#terraform-ìœ¼ë¡œ-cni-êµ¬ì„±í•˜ëŠ”-ìŠ¤í¬ë¦½íŠ¸-ì‹¤í–‰" title="Direct link to heading">â€‹</a></h2><p>EKSë¥¼ í”„ë¡œë¹„ì €ë‹ í•˜ëŠ” Terraform ì½”ë“œëŠ” ë§ì´ ê³µê°œë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ” ìƒëµí•˜ê¸°ë¡œ í•˜ê³  VPC Custom CNIë¥¼ êµ¬ì„±í•˜ëŠ” ë¶€ë¶„ë§Œ ì‚´í´ë³´ì.</p><p>ê¸°ë³¸ì ìœ¼ë¡œ VPC CNIë¥¼ ë°°í¬í•˜ê²Œ ë˜ë©´ aws-node ì¬ì‹œì‘ì´ ë˜ê¸° ë•Œë¬¸ì— Workload NodeGroupì´ êµ¬ì„±ë˜ê¸° ì´ì „ì— ì•„ë˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ <code>null_resource</code> ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ìŒê³¼ ê°™ì€ ìˆœì„œë¡œ Batchë¥¼ ì‹¤í–‰í•˜ë„ë¡ í–ˆë‹¤.</p><ul><li><p>kubectl ì„¤ì¹˜</p></li><li><p>AWS Authentication (Assume role)</p></li><li><p>kubeconfig update</p></li><li><p>VPC CNI Custom manifest (ë²„ì „ v1.11.2) ì ìš© - <a href="https://github.com/aws/amazon-vpc-cni-k8s" target="_blank" rel="noopener noreferrer">https://github.com/aws/amazon-vpc-cni-k8s</a></p></li><li><p>ê¸°ë³¸ í…œí”Œë¦¿ : <a href="https://raw.githubusercontent.com/aws/amazon-vpc-cni-k8s/v1.11.2/config/master/aws-k8s-cni.yaml" target="_blank" rel="noopener noreferrer">https://raw.githubusercontent.com/aws/amazon-vpc-cni-k8s/v1.11.2/config/master/aws-k8s-cni.yaml</a></p></li><li><p><code>ENABLE_POD_ENI=true</code> : Security Group for Podsë¥¼ ìœ„í•œ êµ¬ì„±ìœ¼ë¡œ Nodeì— trunk ENI ì¶”ê°€ë¥¼ í•˜ê¸° ìœ„í•œ <code>vpc.amazonaws.com/has-trunk-attached</code> ë¥¼ ì¶”ê°€í•œë‹¤. </p><ul><li>Pod ENIë¥¼ í™œì„±í™”í•œ ê²½ìš° Branch ENIë¥¼ ìƒì„±í•˜ëŠ” ë¶€ë¶„ì—ì„œ ENI ìƒì„± <a href="https://github.com/aws/amazon-vpc-resource-controller-k8s/blob/master/pkg/aws/vpc/limits.go" target="_blank" rel="noopener noreferrer">ì œì•½ì‚¬í•­</a>ì´ ë°œìƒí• ìˆ˜ ìˆë‹¤.</li></ul></li><li><p><code>DISABLE_TCP_EARLY_DEMUX=true</code> : <code>ENABLE_POD_ENI</code>ê°€ trueë¡œ ì„¤ì •ëœ ê²½ìš° kubeletì´ TCPë¥¼ í†µí•´ í¬ë“œ ë³´ì•ˆ ê·¸ë£¹ì„ ì‚¬ìš©í•˜ëŠ” í¬ë“œì— ì—°ê²°í•˜ë ¤ë©´ <code>DISABLE_TCP_EARLY_DEMUX</code>ë¥¼ initcontainers ì»¨í…Œì´ë„ˆ(amazon-k8s-cni-init)ë¥¼ í†µí•´ trueë¡œ ì„¤ì •í•´ì•¼ í•œë‹¤.</p></li><li><p><code>AWS_VPC_K8S_CNI_CUSTOM_NETWORK_CFG=true</code> : worker ë…¸ë“œì—ì„œ íŒŒë“œê°€ ë³„ë„ì˜ ì„œë¸Œë„· ë° ë³´ì•ˆ ê·¸ë£¹ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ê³  ì§€ì •í•œë‹¤. IPAMDê°€ ENI í• ë‹¹ì„ ìœ„í•´ worker ë…¸ë“œì˜ <code>ENIConfig</code>ì—ì„œ ì§€ì •í•œ ë³´ì•ˆ ê·¸ë£¹ê³¼ VPC ì„œë¸Œë„·ì„ ì‚¬ìš©í•˜ê²Œ ëœë‹¤. </p></li><li><p><code>ENI_CONFIG_LABEL_DEF=topology.kubernetes.io/zone</code> - <code>ENIConfig</code>ì™€ ë§¤ì¹­ë˜ë„ë¡ ë…¸ë“œì—ì„œ ì‚¬ìš©í•  ê°€ìš©ì˜ì—­ì„ zone ë³„ë¡œ êµ¬ì„±í•˜ëŠ” labelì„ ì¶”ê°€í•œë‹¤.</p><ul><li><code>ENIConfig</code> ë¼ëŠ” ì»¤ìŠ¤í…€ ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•œë‹¤. í•´ë‹¹ ì„¤ì •ì€ íŒŒë“œìš© IPëŒ€ì—­ì„ ìœ„í•œ secondary ENIì— ì ìš©ë  ê°’ìœ¼ë¡œ subnet idì™€ sg ê°’ì„ specì— ì§€ì •í•´ì•¼ í•œë‹¤. ì•„ë˜ subnetê³¼ sg idëŠ” terraformì—ì„œ EKSí´ëŸ¬ìŠ¤í„°ê°€ í”„ë¡œë¹„ì €ë‹ ë ë•Œ ê²°ê³¼ë¥¼ envë¡œ ì €ì¥ëœ ê°’ì„ ê°€ì ¸ì˜¤ëŠ” ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬ í• ìˆ˜ ìˆë„ë¡ í•˜ì˜€ë‹¤.</li><li><code>ENIConfig</code>ë¥¼ ì‚¬ìš©í•  ê°€ìš© ì˜ì—­ê³¼ ë™ì¼í•˜ê²Œ <code>ENIConfig</code>ì˜ nameì„ ì§€ì •í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. ë§Œì•½ custom nameìœ¼ë¡œ ì„¤ì •í•˜ê²Œ ë˜ë©´ ëª¨ë“  node ê°ê°ì— ì…ë ¥í•œ ë³„ë„ì˜ annotationì„ ì¶”ê°€í•´ì•¼ í•œë‹¤. (<a href="https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/cni-custom-network.html#custom-networking-deploy-nodes" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/cni-custom-network.html#custom-networking-deploy-nodes</a>)</li></ul></li><li><p><code>ENABLE_PREFIX_DELEGATION=true</code> íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ì— ì ‘ë‘ì‚¬ë¥¼ í• ë‹¹í•˜ë„ë¡ VPC CNI í”ŒëŸ¬ê·¸ì¸ì„ êµ¬ì„±í•œë‹¤. </p></li><li><p><code>WARM_IP_TARGET=1</code>, <code>MINIMUM_IP_TARGET=30</code></p><ul><li>AWS VPC CNIì—ëŠ” ë‘ ê°€ì§€ êµ¬ì„± ìš”ì†Œê°€ ìˆë‹¤. CNI í”ŒëŸ¬ê·¸ì¸ ë°”ì´ë„ˆë¦¬ (/opt/cni/bin/aws-cni)ë° ë¡œì»¬IP ì£¼ì†Œë¥¼ ê´€ë¦¬í•˜ëŠ” <code>ipamd</code>ëŠ” aws-nodeë¼ëŠ” kubernetes daemonset ìœ¼ë¡œ ì‹¤í–‰ë˜ë©° ì¸ìŠ¤í„´ìŠ¤ì— ì—°ê²°ëœ ëª¨ë“  ENI ë° IPë¥¼ ì¶”ì í•˜ëŠ” ëª¨ë“  ë…¸ë“œì— íŒŒë“œë¥¼ ì¶”ê°€í•œë‹¤.</li><li>CNI í”ŒëŸ¬ê·¸ì¸ì€ í˜¸ìŠ¤íŠ¸ ë„¤íŠ¸ì›Œí¬ ì—°ê²°ê³¼ ì˜¬ë°”ë¥¸ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ íŒŒë“œì˜ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ì¶”ê°€í•˜ëŠ” ì—­í• ì„ í•œë‹¤. CNI í”ŒëŸ¬ê·¸ì¸ì€ ì›ê²© í”„ë¡œì‹œì € í˜¸ì¶œ(gRPC)ì„ í†µí•´ <code>IPAMD</code>ì™€ í†µì‹ í•œë‹¤.</li><li><code>WARM_IP_TARGET</code>ì€ ENI ì „ì²´ë¥¼ Warm Poolë¡œ ê°€ì ¸ê°€ì§€ ì•Šê³  íŠ¹ì • IP ê°œìˆ˜ë§Œí¼ë§Œ Warm Poolì„ í™•ë³´í•˜ê² ë‹¤ë¼ëŠ” ì„¤ì •ì´ë‹¤. <code>WARM_IP_TARGET=1</code>ë¡œ ì„¤ì •ë˜ë©´ Podì´ ìƒì„±ë  ë•Œë§ˆë‹¤ Secondary IPë¥¼ 1ê°œì”© ì¶”ê°€ë¡œ í• ë‹¹í•œë‹¤.</li><li>Podì˜ ìƒì„±ê³¼ ì¢…ë£Œê°€ ë¹ˆë²ˆí•œ ê²½ìš°, ì¸ìŠ¤í„´ìŠ¤ì— IPë¥¼ Attach/Detach í•˜ëŠ” API callì˜ ìˆ˜ê°€ ëŠ˜ì–´ë‚˜ ENIë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ IPë¥¼ ì¶”ê°€í•˜ëŠ” throttlingì„ ë°©ì§€í•˜ê¸° ìœ„í•´ <code>MINIMUM_IP_TARGET</code>ì„ í•¨ê»˜ ì„¤ì •í•œë‹¤. ë…¸ë“œì— ì¼ë°˜ì ìœ¼ë¡œ ìœ ì§€ë˜ëŠ” Podì˜ ìˆ˜ë¥¼ <code>MINIMUM_IP_TARGET</code>ìœ¼ë¡œ ì§€ì •í•´ ë†“ìœ¼ë©´ í•´ë‹¹ ìˆ˜ë§Œí¼ ENIì— ë¯¸ë¦¬ IPê°€ í• ë‹¹ëœë‹¤. </li><li><code>WARM_PREFIX_TARGET=1</code> ëŠ” ìœ„ ì„¤ì •ì„ ì ìš©í•˜ë©´ ì¬ì •ì˜ ëœë‹¤.</li></ul></li><li><p><code>AWS_VPC_K8S_CNI_EXTERNALSNAT=true</code> : íŒŒë“œë³„ ENIì— í• ë‹¹ëœ IPì£¼ì†Œë¥¼ ì œì–´í• ìˆ˜ ìˆë„ë¡ Node IPë¡œ SNAT ë˜ì§€ì•Šë„ë¡ ì„¤ì •í•˜ëŠ” êµ¬ì„±ì´ë‹¤.</p></li><li><p><code>ENIConfig</code> êµ¬ì„±ì„ ìœ„í•´ Podê°€ ì‚¬ìš©í•  ëŒ€ì—­ì„ ë³€ìˆ˜(<code>subnet_a</code>,<code>subnet_b</code>,<code>subnet_c</code>)ë¡œ ë°›ì•„ kubectlë¡œ ì„¤ì •í•œë‹¤.</p></li></ul><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KUBE_CONFIG="$(mktemp)"  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws eks update-kubeconfig --name "${CLUSTER_NAME}" --kubeconfig "${KUBE_CONFIG}"  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Apply VPC CNI manifests (origin: https://raw.githubusercontent.com/aws/amazon-vpc-cni-k8s/v1.11.2/config/master/aws-k8s-cni.yaml)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Security group for pod env configurations ; ENABLE_POD_ENI=true  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># https://github.com/aws/amazon-vpc-cni-k8s#disable_tcp_early_demux-v173 ; DISABLE_TCP_EARLY_DEMUX=true  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom networking ; AWS_VPC_K8S_CNI_CUSTOM_NETWORK_CFG=true  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom networking ; ENI_CONFIG_LABEL_DEF=topology.kubernetes.io/zone  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom networking ; WARM_IP_TARGET=1  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom networking ; MINIMUM_IP_TARGET=30  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom networking ; WARM_PREFIX_TARGET=1  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Fewer API calls required to EC2 control plane ; ENABLE_PREFIX_DELEGATION=true  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Source NAT disabled ; AWS_VPC_K8S_CNI_EXTERNALSNAT=true  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KUBE_CONFIG="$(mktemp)"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws eks update-kubeconfig --name "${CLUSTER_NAME}" --kubeconfig "${KUBE_CONFIG}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Apply VPC CNI manifests (origin: https://raw.githubusercontent.com/aws/amazon-vpc-cni-k8s/v1.11.2/config/master/aws-k8s-cni.yaml)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Security group for pod env configurations ; ENABLE_POD_ENI=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># https://github.com/aws/amazon-vpc-cni-k8s#disable_tcp_early_demux-v173 ; DISABLE_TCP_EARLY_DEMUX=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom networking ; AWS_VPC_K8S_CNI_CUSTOM_NETWORK_CFG=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom networking ; ENI_CONFIG_LABEL_DEF=topology.kubernetes.io/zone</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom networking ; WARM_IP_TARGET=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom networking ; MINIMUM_IP_TARGET=30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom networking ; WARM_PREFIX_TARGET=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Fewer API calls required to EC2 control plane ; ENABLE_PREFIX_DELEGATION=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Source NAT disabled ; AWS_VPC_K8S_CNI_EXTERNALSNAT=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl --kubeconfig "${KUBE_CONFIG}" apply -f ./scripts/aws-k8s-cni.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># set up ENIConfig </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subnet_a=$(echo ${SUBNETS} |awk -F"," '{print $1}')</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subnet_b=$(echo ${SUBNETS} |awk -F"," '{print $2}')</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subnet_c=$(echo ${SUBNETS} |awk -F"," '{print $3}')</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl --kubeconfig "${KUBE_CONFIG}" apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: crd.k8s.amazonaws.com/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: ENIConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: "ap-northeast-2a"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  subnet: "${subnet_a}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  securityGroups:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - ${CLUSTER_SG}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl --kubeconfig "${KUBE_CONFIG}" apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: crd.k8s.amazonaws.com/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: ENIConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: "ap-northeast-2b"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  subnet: "${subnet_b}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  securityGroups:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - ${CLUSTER_SG}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl --kubeconfig "${KUBE_CONFIG}" apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: crd.k8s.amazonaws.com/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: ENIConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: "ap-northeast-2c"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  subnet: "${subnet_c}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  securityGroups:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - ${CLUSTER_SG}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># remobe creds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rm "${KUBE_CONFIG}"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë‹¤ìŒì€ ìœ„ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ëŠ” í…Œë¼í¼ ì½”ë“œì˜ ì˜ˆì‹œì´ë‹¤.</p><ul><li>ê¸°ë³¸ì ìœ¼ë¡œ null_resourceë¥¼ ì‚¬ìš©í•œë‹¤. <ul><li><a href="https://registry.terraform.io/providers/hashicorp/null/latest/docs/resources/resource" target="_blank" rel="noopener noreferrer">https://registry.terraform.io/providers/hashicorp/null/latest/docs/resources/resource</a></li></ul></li><li>ìœ„ì—ì„œ ì‘ì„±í•œ ìŠ¤í¬ë¦½íŠ¸ë¥¼ network.sh ì—ì„œ í™˜ê²½ë³€ìˆ˜ë¥¼ ë°›ì•„ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±í•œë‹¤. </li><li>eks ëª¨ë“ˆì˜ ì˜ì¡´ì„±ì„ ê±¸ì–´ eks í´ëŸ¬ìŠ¤í„° ë°°í¬ê°€ ì™„ë£Œëœ ì´í›„ì— í•´ë‹¹ ìŠ¤í¬ë¦½íŠ¸ê°€ ë™ì‘í•˜ë„ë¡ í•œë‹¤. </li></ul><div class="codeBlockContainer_I0IT language-terraform theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-terraform codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain"># Configure CNI custom network</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">resource "null_resource" "cni_patch" {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  triggers = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cluster_name  = local.cluster_name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cluster_sg    = module.eks.cluster_primary_security_group_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    intra_subnets = join(",", module.vpc.intra_subnets)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    content       = file("${path.module}/scripts/network.sh")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  provisioner "local-exec" {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    environment = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      CLUSTER_NAME = self.triggers.cluster_name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      CLUSTER_SG   = self.triggers.cluster_sg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      SUBNETS      = self.triggers.intra_subnets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    command     = "${path.cwd}/scripts/network.sh"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    interpreter = ["bash"]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  depends_on = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    module.eks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ì´ˆë°˜ì— ì–¸ê¸‰í•œ EKS CNI Custom Networking ì œì•½ì‚¬í•­ì„ ì²˜ë¦¬í•˜ê³  null_resourceë¡œ EKS CNIë¥¼ ë°°í¬í•  ë•Œ ì›í•˜ëŠ” í˜•íƒœë¡œ ìˆ˜ì •í•˜ì—¬ <code>aws_node</code> ì¬ê¸°ë™ ì—†ì´ ë°°í¬í•˜ëŠ” ë°©ë²•ì„ ì‘ì„±í•´ë´¤ë‹¤. </p><p>ìƒ˜í”Œ ì½”ë“œëŠ” ì•„ë˜ ì €ì¥ì†Œì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
<a href="https://github.com/jinwoongk/eks-cni-custom" target="_blank" rel="noopener noreferrer">https://github.com/jinwoongk/eks-cni-custom</a></p><blockquote><p>í•´ë‹¹ í¬ìŠ¤íŒ…ì€ í˜„ì¬ ì¬ì§ì¤‘ì¸ íšŒì‚¬ì— ê´€ë ¨ì´ ì—†ê³ , ê°œì¸ ì—­ëŸ‰ ê°œë°œì„ ìœ„í•œ ìë£Œë¡œ í™œìš©í•  ì˜ˆì •ì…ë‹ˆë‹¤.</p></blockquote>]]></content>
        <author>
            <name>Jinwoong Kim</name>
            <uri>https://www.linkedin.com/in/ddiiwoong/</uri>
        </author>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="EKS" term="EKS"/>
        <category label="CNI" term="CNI"/>
        <category label="Terraform" term="Terraform"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[EKS Anywhere Advanced Usages]]></title>
        <id>kubernetes/eks-anywhere-adv/</id>
        <link href="https://ddii.dev/kubernetes/eks-anywhere-adv/"/>
        <updated>2022-03-18T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[EKS Anywhere ë¡œ êµ¬ì„±ëœ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° í™œìš© ]]></summary>
        <content type="html"><![CDATA[<p>ì§€ë‚œê¸€ì— ì´ì–´ ì´ë²ˆì—ëŠ” í™ˆë©ìœ¼ë¡œ êµ¬ì„±í•œ EKS Anywhere í´ëŸ¬ìŠ¤í„°ì—ì„œ ìš´ì˜, ê°œë°œí™˜ê²½ êµ¬ì„±ì„ ìœ„í•œ ì—¬ëŸ¬ê°€ì§€ ë„êµ¬ë¥¼ ì„¤ì¹˜í•´ë³´ëŠ” ê³¼ì •ì„ ì •ë¦¬í•˜ê³ ì í•œë‹¤. </p><p>ì§€ë‚œ í¬ìŠ¤íŒ…ì€ ë‹¤ìŒ ë§í¬ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><blockquote><p>ì´ì „ê¸€ - <a href="https://ddii.dev/kubernetes/eks-anywhere/" target="_blank" rel="noopener noreferrer">vSphere homelab í™˜ê²½ì—ì„œ EKS Anywhere êµ¬ì„±í•˜ê¸°</a></p></blockquote><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="eks-connector">EKS Connector<a class="hash-link" href="#eks-connector" title="Direct link to heading">â€‹</a></h2><p>EKS Connectorë¥¼ í†µí•´ EKS Anywhereë¥¼ í¬í•¨í•œ ì™¸ë¶€ì˜ ëª¨ë“  í´ëŸ¬ìŠ¤í„°ë¥¼ AWS ì½˜ì†”ì— ì—°ê²°í•  ìˆ˜ ìˆë‹¤. eks connector ì»¨í…Œì´ë„ˆë¥¼ í†µí•´ proxy í˜•íƒœë¡œ ì™¸ë¶€ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì˜ APIì„œë²„ì—ì„œ ì •ë³´ë¥¼ ê°€ì ¸ì™€ AWS System Managerë¡œ ì „ë‹¬í•˜ëŠ” ë¹„ë™ê¸° ë°©ì‹ìœ¼ë¡œ ì›Œí¬ë¡œë“œ ê´€ë¦¬ë¥¼ ì§„í–‰í•œë‹¤.</p><ul><li>ìœ ì €ê°€ì´ë“œ - <a href="https://docs.aws.amazon.com/eks/latest/userguide/eks-connector.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/eks/latest/userguide/eks-connector.html</a>  </li><li>AWS ë¸”ë¡œê·¸ - <a href="https://aws.amazon.com/blogs/containers/connect-any-kubernetes-cluster-to-amazon-eks/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/blogs/containers/connect-any-kubernetes-cluster-to-amazon-eks/</a></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="í´ëŸ¬ìŠ¤í„°-ë“±ë¡">í´ëŸ¬ìŠ¤í„° ë“±ë¡<a class="hash-link" href="#í´ëŸ¬ìŠ¤í„°-ë“±ë¡" title="Direct link to heading">â€‹</a></h3><p><img loading="lazy" src="https://d2908q01vomqb2.cloudfront.net/fe2ef495a1152561572949784c16bf23abb28057/2021/09/15/Screen-Shot-2021-09-03-at-4.28.27-PM.png" alt="overview" class="img_E7b_"></p><p>EKS Anywhereë¥¼ í¬í•¨í•œ ì™¸ë¶€ K8s í´ëŸ¬ìŠ¤í„°ëŠ” AWS CLI, eksctl, ì½˜ì†”ì„ ì‚¬ìš©í•´ì„œ ë“±ë¡(register)ì´ ê°€ëŠ¥í•˜ë‹¤. eksctlë¡œ ë“±ë¡ì„ ì§„í–‰í•˜ë©´ ë¨¼ì € ê´€ë ¨ëœ Roleì„ ìƒì„±í•´ì£¼ê³  ë˜í•œ ClusterRole, ClusterRoleBinding ë° Connector StatefulSetì„ ë°°í¬í•  ìˆ˜ ìˆë„ë¡ ìë™ìœ¼ë¡œ manifestë¥¼ ìƒì„±í•´ì£¼ê¸° ë•Œë¬¸ì— eksctlë¡œ í´ëŸ¬ìŠ¤í„° ë“±ë¡ì„ ì§„í–‰í•˜ëŠ” ê²ƒì´ í¸í•˜ë‹¤. AWS Managed IAM ì—­í• ì¸ <code>AWSServiceRoleForAmazonEKSConnector</code>ì„ ìƒì„±í•˜ëŠ” ê³¼ì •ì„ ì§„í–‰í•˜ê¸° ë•Œë¬¸ì— ì—ëŸ¬ê°€ ë°œìƒì„ í•œë‹¤. ì—ëŸ¬ê°€ ë‚œ ì´í›„ì— AWS ì½˜ì†”ì´ë‚˜ CLIë¥¼ í†µí•´ í™•ì¸í•˜ë©´ ìƒˆë¡­ê²Œ ìƒì„±ëœ <code>AWSServiceRoleForAmazonEKSConnector</code> IAM ì—­í• ê³¼ í•´ë‹¹ ì—­í• ì— ì—°ê²°ëœ Policyì¸ <code>AmazonEKSConnectorServiceRolePolicy</code>ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; eksctl register cluster --name homelab --provider eks_anywhere --profile jinwoong</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-03-09 18:50:44 [â„¹]  creating IAM role "eksctl-20220309185044427640"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-03-09 18:50:49 [â„¹]  deleting IAM role "eksctl-20220309185044427640"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Error: error registering cluster: error calling RegisterCluster: ResourcePropagationDelayException: Service linked role 'arn:aws:iam::492935017096:role/aws-service-role/eks-connector.amazonaws.com/AWSServiceRoleForAmazonEKSConnector' is propagating, please retry later.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì‹¤íŒ¨ë¥¼ ì§„í–‰í•œ í›„ì— ë‹¤ì‹œ ë“±ë¡ ì‹œë„ë¥¼ í•˜ë©´ ì•„ë˜ ì¶œë ¥ë¡œê·¸ì™€ ê°™ì´ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•œ ë””ë ‰í† ë¦¬ì— EKS Connector ê´€ë ¨ ë¦¬ì†ŒìŠ¤ manifests(eks-connector.yaml,eks-connector-clusterrole.yaml,eks-connector-console-dashboard-full-access-group.yaml)ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; eksctl register cluster --name homelab --provider eks_anywhere --profile jinwoong</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-03-08 22:59:15 [â„¹ï¸]  creating IAM role "eksctl-20220308225915739385"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-03-08 22:59:29 [â„¹ï¸]  registered cluster "homelab" successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-03-08 22:59:29 [â„¹ï¸]  wrote file eks-connector.yaml to /Users/jinwoong/study/eks-anywhere-homelab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-03-08 22:59:29 [â„¹ï¸]  wrote file eks-connector-clusterrole.yaml to /Users/jinwoong/study/eks-anywhere-homelab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-03-08 22:59:29 [â„¹ï¸]  wrote file eks-connector-console-dashboard-full-access-group.yaml to /Users/jinwoong/study/eks-anywhere-homelab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-03-08 22:59:29 [!]  note: "eks-connector-clusterrole.yaml" and "eks-connector-console-dashboard-full-access-group.yaml" give full EKS Console access to IAM identity "arn:aws:iam::492935017096:user/jinwoong", edit if required; read https://docs.aws.amazon.com/eks/latest/userguide/connector-grant-access.html for more info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-03-08 22:59:29 [â„¹ï¸]  run kubectl apply -f eks-connector.yaml,eks-connector-clusterrole.yaml,eks-connector-console-dashboard-full-access-group.yaml before 11 Mar 22 13:59 UTC to connect the cluster</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>eks-connector.yaml ì—ëŠ” <code>Namespace</code>, <code>Secret</code>, <code>Role</code>, <code>ServiceAccount</code>, <code>RoleBinding</code>, <code>ConfigMap</code>ê³¼ ë°°í¬ë  <code>StatefulSet</code> ì´ ë‹´ê²¨ìˆì–´ í•´ë‹¹ íŒŒì¼ì€ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´ ëœë‹¤.</p><p>í•˜ì§€ë§Œ ì‹¤ì œ ì½˜ì†”ì—ì„œ ë…¸ë“œì™€ ì›Œí¬ë¡œë“œ ì •ë³´ë¥¼ ë³´ê¸° ìœ„í•´ì„œ eks-connector-console-dashboard-full-access-group.yamlì— ì½˜ì†” ì ‘ì†ì´ í•„ìš”í•œ IAM ì‚¬ìš©ìì™€ ì ‘ê·¼ì„ ìœ„í•œ íŠ¹ì • ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì •ë³´ë¥¼ <code>ClusterRole</code> ë° <code>ClusterRoleBinding</code>ì— ì¶”ê°€í•´ì•¼ í•œë‹¤. </p><p>ìì„¸í•œ ë‚´ìš©ì€ <a href="https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/connector-grant-access.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/connector-grant-access.html</a>ì—ì„œ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤. </p><p>ìœ„ì—ì„œ ìƒì„±ëœ manifestsê°€ EKS Anywhere í´ëŸ¬ìŠ¤í„°ì— ì ìš©ë˜ë©´ StatefulSet í˜•íƒœë¡œ ë°°í¬ëœ EKS Connect ì—ì´ì „íŠ¸ëŠ” Amazon EventBridgeë¥¼ í†µí•´ EKSì— ì•Œë¦¼ì„ ë³´ë‚´ëŠ” System Manager ì„œë¹„ìŠ¤ì— ì—°ê²°í•œë‹¤. ì´í›„ EKS ConnectëŠ” ì—°ê²°ëœ í´ëŸ¬ìŠ¤í„°ì˜ kubernetes API ì„œë²„ì— EKS ì½˜ì†” ìš”ì²­ì„ ì „ë‹¬í•˜ë¯€ë¡œ ìƒì„±í•œ ì„œë¹„ìŠ¤ ì–´ì¹´ìš´íŠ¸ë¥¼ EKS Connect ì—­í• ê³¼ ì—°ê²°í•˜ì—¬ AWS IAM ì—”í‹°í‹°ë¥¼ ê°€ì¥(impersonate) í•  ìˆ˜ìˆëŠ” ê¶Œí•œì„ ë¶€ì—¬í•˜ê²Œ ëœë‹¤. </p><p>statefulsetì„ ì¢€ë” ì‚´í´ë³´ë©´ ìœ„ì—ì„œ ì´ì•¼ê¸°í•˜ëŠ” ì—ì´ì „íŠ¸ ì—­í• ì„ í•˜ëŠ” <code>connector-agent</code> ì™€ í”„ë¡ì‹œ ì—­í• ì„ í•˜ëŠ” <code>connector-proxy</code> ì»¨í…Œì´ë„ˆ ë‘ê°œê°€ ë– ìˆëŠ”ê±¸ ë³¼ ìˆ˜ ìˆë‹¤. ì‚¬ìš©ìê°€ ì½˜ì†”ì—ì„œ í•´ë‹¹ í´ëŸ¬ìŠ¤í„°ì˜ ë…¸ë“œë‚˜ ì›Œí¬ë¡œë“œ ì •ë³´ë¥¼ ì¡°íšŒí•˜ê²Œ ë˜ë©´ EKSëŠ” System Manager ì„œë¹„ìŠ¤ì—ê²Œ ì„¸ì…˜ì„ ìš”ì²­í•˜ê³  ì´í›„ System Managerê°€ ë¹„ë™ê¸° ë°©ì‹ìœ¼ë¡œ <code>connector-agent</code> ì»¨í…Œì´ë„ˆë¥¼ invokeí•˜ë©´ <code>connector-proxy</code> ì»¨í…Œì´ë„ˆ ìœ„ì—ì„œ ë§ˆìš´íŠ¸ëœ ì„œë¹„ìŠ¤ ì–´ì¹´ìš´íŠ¸ë¡œ ì¸ì¦ì„ í•˜ê³  ê°€ì¥(impersonation)í•œ ìƒíƒœë¡œ EKS Anywhere í´ëŸ¬ìŠ¤íŠ¸ì˜ APIë¥¼ í˜¸ì¶œí•´ì„œ ê´€ë ¨ëœ ë‚´ìš©ì„ ê°€ì ¸ì™€ì„œ ë³´ì—¬ì£¼ê²Œ ëœë‹¤.</p><p><img loading="lazy" src="https://d2908q01vomqb2.cloudfront.net/fe2ef495a1152561572949784c16bf23abb28057/2021/09/15/Screen-Shot-2021-09-05-at-7.51.33-AM.png" alt="connector" class="img_E7b_"></p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl describe statefulset eks-connector -n eks-connector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name:               eks-connector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Namespace:          eks-connector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CreationTimestamp:  Wed, 09 Mar 2022 22:53:23 +0900</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Selector:           app=eks-connector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Labels:             app=eks-connector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Annotations:        &lt;none&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Replicas:           2 desired | 2 total</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Update Strategy:    RollingUpdate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Partition:        0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Pods Status:        2 Running / 0 Waiting / 0 Succeeded / 0 Failed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Pod Template:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   connector-agent:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Image:      public.ecr.aws/amazon-ssm-agent/amazon-ssm-agent:3.1.90.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Port:       &lt;none&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Host Port:  &lt;none&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      AWS_EC2_METADATA_DISABLED:  true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Mounts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      /etc/amazon/ssm/amazon-ssm-agent.json from eks-agent-config (rw,path="amazon-ssm-agent.json")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      /etc/amazon/ssm/seelog.xml from eks-agent-config (rw,path="seelog.xml")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      /var/eks/shared from eks-connector-shared (rw)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      /var/lib/amazon/ssm/Vault from eks-agent-vault (rw)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   connector-proxy:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Image:      public.ecr.aws/eks-connector/eks-connector:0.0.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Port:       &lt;none&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Host Port:  &lt;none&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Args:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      POD_NAME:   (v1:metadata.name)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Mounts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      /var/eks/shared from eks-connector-shared (rw)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      /var/lib/amazon/ssm/Vault from eks-agent-vault (rw)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      /var/run/secrets/kubernetes.io/serviceaccount from service-account-token (rw)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="istio-í™˜ê²½-êµ¬ì„±">Istio í™˜ê²½ êµ¬ì„±<a class="hash-link" href="#istio-í™˜ê²½-êµ¬ì„±" title="Direct link to heading">â€‹</a></h2><p>Istio í™˜ê²½ì—ì„œ ì•±ì„ ë°°í¬í•˜ê³  Tracing ê°€ì‹œì„± í™•ë³´ë¥¼ í•˜ëŠ” ì‹¤ìŠµì„ ì§„í–‰í•˜ê¸° ìœ„í•´ ê°„ë‹¨í•˜ê²Œ êµ¬ì„±ì— ëŒ€í•œ ê·¸ë¦¼ì„ ê·¸ë ¤ë´¤ë‹¤. </p><p><img loading="lazy" alt="istio" src="/assets/images/istio_o11y-120b56627de7c677da542503b0d01b49.png" width="1148" height="388" class="img_E7b_"></p><p>Istio í™˜ê²½ì—ì„œ sidecar í˜•íƒœë¡œ envoy proxyê°€ ê° Observability êµ¬ì„±ìš”ì†Œë¡œ ë°ì´í„°ê°€ ì „ë‹¬ë˜ë„ë¡ êµ¬ì„±í•œë‹¤. ì´ë•Œ ì‚¬ìš©ë˜ëŠ” ì˜¤í”ˆì†ŒìŠ¤ ìŠ¤íƒì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p><ul><li><p>Tracing </p><ul><li>Collect : <a href="https://github.com/open-telemetry/opentelemetry-collector" target="_blank" rel="noopener noreferrer">OpenTelemetry Collector</a></li><li>Backend : <a href="https://github.com/grafana/tempo" target="_blank" rel="noopener noreferrer">Tempo</a></li></ul></li><li><p>Logging</p><ul><li>Collect : <a href="https://github.com/fluent/fluent-bit" target="_blank" rel="noopener noreferrer">Fluentbit</a></li><li>Backend : <a href="https://github.com/grafana/loki" target="_blank" rel="noopener noreferrer">Loki</a></li></ul></li><li><p>Metrics</p><ul><li>Collect : <a href="https://istio.io/latest/docs/ops/integrations/prometheus/" target="_blank" rel="noopener noreferrer">Exporters</a></li><li>Backend : <a href="https://github.com/prometheus" target="_blank" rel="noopener noreferrer">Prometheus</a></li></ul></li><li><p>Visualization</p><ul><li><a href="https://github.com/grafana/grafana" target="_blank" rel="noopener noreferrer">Grafana</a></li></ul></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="istio-ì„¤ì¹˜">Istio ì„¤ì¹˜<a class="hash-link" href="#istio-ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h3><p>IstioOperatorë¥¼ í†µí•´ Istioë¥¼ ì„¤ì¹˜í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; istioctl operator init</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>IstioOperatorê°€ ì„¤ì¹˜ë˜ë©´ ë¦¬ì†ŒìŠ¤ë¥¼ ë°°í¬í•˜ì—¬ istio ì„œë¹„ìŠ¤ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤. envoy proxyì—ëŠ” ë‹¤ì–‘í•œ í—¤ë”ë“¤ì„ í†µí•´ trace ì •ë³´ë¥¼ propagate í•  ìˆ˜ ìˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ <code>x-b3-traceid</code>ë¥¼ traceidë¡œ ë¡œê·¸ í¬ë§·ì„ êµ¬ì„±í•˜ë„ë¡ í•˜ê³  trace í™œì„±í™”ë¥¼ ìœ„í•´ <code>enableTracing: true</code> ë¥¼ ì„¤ì •í•˜ê³  Prometheusì—ì„œ ìŠ¤í¬ë©ì„ í•  ìˆ˜ ìˆë„ë¡ <code>enablePrometheusMerge: true</code>ë¡œ ì„¤ì •í•œë‹¤.</p><p>ë§ˆì§€ë§‰ìœ¼ë¡œ zipkin í”„ë¡œí† ì½œë¡œ OpenTelemetry Collectorë¡œ ì „ë‹¬í• ê²ƒì´ê¸° ì—”ë“œí¬ì¸ë“œ ì •ë³´ë„ ë¯¸ë¦¬ ì‘ì„±í–ˆë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> install.istio.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> IstioOperator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> istio</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">operator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> istio</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">profile</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">meshConfig</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">accessLogFile</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /dev/stdout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">accessLogFormat</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">      [%START_TIME%] "%REQ(:METHOD)% %REQ(X-ENVOY-ORIGINAL-PATH?:PATH)% %PROTOCOL%" %RESPONSE_CODE% %RESPONSE_FLAGS% %RESPONSE_CODE_DETAILS% %CONNECTION_TERMINATION_DETAILS% "%UPSTREAM_TRANSPORT_FAILURE_REASON%" %BYTES_RECEIVED% %BYTES_SENT% %DURATION% %RESP(X-ENVOY-UPSTREAM-SERVICE-TIME)% "%REQ(X-FORWARDED-FOR)%" "%REQ(USER-AGENT)%" "%REQ(X-REQUEST-ID)%" "%REQ(:AUTHORITY)%" "%UPSTREAM_HOST%" %UPSTREAM_CLUSTER% %UPSTREAM_LOCAL_ADDRESS% %DOWNSTREAM_LOCAL_ADDRESS% %DOWNSTREAM_REMOTE_ADDRESS% %REQUESTED_SERVER_NAME% %ROUTE_NAME% traceID=%REQ(x-b3-traceid)%</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enableTracing</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enablePrometheusMerge</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">defaultConfig</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">tracing</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">sampling</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">max_path_tag_length</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">99999</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">zipkin</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">address</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> otel</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">collector.tracing.svc</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">9411</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Istioì˜ ëŒ€í‘œì ì¸ ìƒ˜í”Œì•±ì¸ <a href="https://istio.io/latest/docs/examples/bookinfo/" target="_blank" rel="noopener noreferrer">bookinfo</a>ë¥¼ <code>bookinfo</code> ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ì„¤ì¹˜í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl create ns bookinfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl label namespace bookinfo istio-injection=enabled --overwrite</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl apply -n bookinfo -f https://raw.githubusercontent.com/istio/istio/release-1.10/samples/bookinfo/platform/kube/bookinfo.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì„œë¹„ìŠ¤ ì ‘ê·¼ì„ ìœ„í•œ <code>Gateway</code>ì™€ <code>VirtualService</code> ë„ êµ¬ì„±í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> networking.istio.io/v1alpha3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Gateway</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> bookinfo</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">gateway</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> bookinfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">istio</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ingressgateway </span><span class="token comment" style="color:#999988;font-style:italic"># use istio default controller</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">servers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">number</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> http</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">protocol</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> HTTP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">hosts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"*"</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Mind the hosts. This matches all</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> networking.istio.io/v1alpha3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> VirtualService</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> bookinfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> bookinfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">hosts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"*"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">gateways</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> tracing/bookinfo</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">gateway</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> bookinfo</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">gateway</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">match</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">uri</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">prefix</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"/"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">route</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">destination</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">host</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> productpage.bookinfo.svc.cluster.local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">number</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9080</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì„œë¹„ìŠ¤ í™•ì¸ì„ ìœ„í•´ <code>LoadBalancer</code>ë¡œ êµ¬ì„±ëœ istio-ingressgateway EXTERNAL-IPì¸ <a href="http://192.168.31.10/productpage" target="_blank" rel="noopener noreferrer">http://192.168.31.10/productpage</a>ë¡œ ì ‘ì†ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">â¯ kubectl get svc -n istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                   TYPE           CLUSTER-IP       EXTERNAL-IP     PORT(S)                                      AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-ingressgateway   LoadBalancer   10.97.92.31      192.168.31.10   15021:30184/TCP,80:32738/TCP,443:31058/TCP   2d23h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istiod                 ClusterIP      10.107.186.201   &lt;none&gt;          15010/TCP,15012/TCP,443/TCP,15014/TCP        2d23h</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="metric-server-ì„¤ì¹˜">metric-server ì„¤ì¹˜<a class="hash-link" href="#metric-server-ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h2><p><a href="https://github.com/kubernetes-sigs/metrics-server" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes-sigs/metrics-server</a></p><p>HPA ë‚˜ Kubernetes ëŒ€ì‹œë³´ë“œë¥¼ í™œìš©í•˜ê¸° ìœ„í•´ì„œ metric-serverë¥¼ ì„¤ì¹˜í•œë‹¤. kubelet tls ì¸ì¦ì„œ ì—ëŸ¬ê°€ ë‚  ê²½ìš° ì„¤ì¹˜ íŒŒì¼ì„ ë°›ì•„ì„œ ARGì— <code>--kubelet-insecure-tls</code> í”Œë˜ê·¸ë¥¼ ì¶”ê°€í•´ì„œ ì„¤ì¹˜í•˜ë©´ ëœë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl apply -f https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">serviceaccount/metrics-server created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusterrole.rbac.authorization.k8s.io/system:aggregated-metrics-reader created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusterrole.rbac.authorization.k8s.io/system:metrics-server created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rolebinding.rbac.authorization.k8s.io/metrics-server-auth-reader created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusterrolebinding.rbac.authorization.k8s.io/metrics-server:system:auth-delegator created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusterrolebinding.rbac.authorization.k8s.io/system:metrics-server created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service/metrics-server created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment.apps/metrics-server created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiservice.apiregistration.k8s.io/v1beta1.metrics.k8s.io created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl top nodes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME             CPU(cores)   CPU%   MEMORY(bytes)   MEMORY%   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.31.186   175m         9%     2228Mi          29%       </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.31.187   82m          4%     893Mi           11%       </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.31.188   64m          3%     795Mi           10%       </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.31.189   134m         6%     1817Mi          23%       </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.31.190   43m          2%     636Mi           8% </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="observability-stack-ì„¤ì¹˜">Observability Stack ì„¤ì¹˜<a class="hash-link" href="#observability-stack-ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h2><p>ì°¨íŠ¸ë¡œ ì¼ê´„ë°°í¬ë¥¼ ìœ„í•´ <a href="https://github.com/grafana/helm-charts/tree/main/charts/loki-stack" target="_blank" rel="noopener noreferrer">Loki-stack</a>ë¥¼ ì‚¬ìš©í–ˆê³ , í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ êµ¬ì„±ìœ¼ë¡œ êµ¬ì„± ë³€ê²½ì„ í•œ chart valuesëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. </p><ul><li><a href="https://github.com/prometheus" target="_blank" rel="noopener noreferrer">Prometheus</a> - ì‹œê³„ì—´ ë°ì´í„°(ë©”íŠ¸ë¦­)ì„ ìˆ˜ì§‘í•˜ê³  ì €ì¥í•˜ëŠ” í”„ë¡œì íŠ¸ì´ë©°, í‚¤-ë°¸ë¥˜ í˜•íƒœë¡œ ì¿¼ë¦¬ì™€ ì—°ì‚°ì´ ê°€ëŠ¥í•œ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œì´ë‹¤. node-exporter, alertmanager, pushgateway ë„ ì°¨íŠ¸ë¡œ ê°™ì´ ì„¤ì¹˜í•œë‹¤. </li><li><a href="https://github.com/grafana/grafana" target="_blank" rel="noopener noreferrer">Grafana</a> - ë°ì´í„°ë¥¼ ì‹œê°í™”í•˜ëŠ” í”Œë«í¼ìœ¼ë¡œ ë‹¤ì–‘í•œ ë¡œê·¸, ë©”íŠ¸ë¦­, íŠ¸ë ˆì´ìŠ¤ ë°ì´í„°ë¥¼ ì‹œì‘í™”í•˜ê³  ì•Œë¦¼ ê´€ë¦¬ë¥¼ í•  ìˆ˜ ìˆë‹¤.</li><li><a href="https://github.com/grafana/loki" target="_blank" rel="noopener noreferrer">Loki</a> - ë‹¤ë¥¸ ë¡œê¹… ì‹œìŠ¤í…œê³¼ ë‹¬ë¦¬ ë¡œê·¸ë¥¼ ì œì™¸í•œ ë©”íƒ€ë°ì´í„° ì¸ë±ì‹±ë§Œ í•˜ê¸° ë•Œë¬¸ì— Prometheusì²˜ëŸ¼ ë ˆì´ë¸”ì„ ì—¼ë‘ì— ë‘ê³  ì„¤ê³„ëœ ë¡œê¹… ë°ì´í„°ìŠ¤í† ì–´ ì‹œìŠ¤í…œì´ë‹¤.</li><li><a href="https://github.com/fluent/fluent-bit" target="_blank" rel="noopener noreferrer">Fluent Bit</a> - ë¡œê¹… ì»¬ë ‰í„°(Collector)ë¡œ fluentd ë³´ë‹¤ ê²½ëŸ‰í™”ë˜ê³  ë¹ ë¥¸ ë¡œê·¸ í”„ë¡œì„¸ìŠ¤ì´ì ì „ë‹¬ì(Forwarder)ë¡œ ë‹¤ë¥¸ ë¡œê¹… ì»¬ë ‰í„°ì¸ promtail, filebeat, logstashëŠ” falseë¡œ ì„¤ì •í•œë‹¤. </li><li><a href="https://github.com/grafana/tempo" target="_blank" rel="noopener noreferrer">Tempo</a> - TempoëŠ” ë¶„ì‚° ì¶”ì (Tracing)ì„ ìœ„í•œ ë¹„ìš© íš¨ìœ¨ì ì¸ ë°±ì—”ë“œ ë°ì´í„°ìŠ¤í† ì–´ í”„ë¡œì íŠ¸ë¡œ ìœ„ì—ì„œ êµ¬ì„±í•œ Prometheus, Grafana, Loki ë“±ê³¼ ê°™ì€ ë‹¤ë¥¸ Observability í”„ë¡œì íŠ¸ì™€ í†µí•©ì´ ì‰¬ìš´ê²ƒì´ íŠ¹ì§•ì´ë‹¤.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="prometheus-loki-ì„¤ì¹˜">Prometheus, Loki ì„¤ì¹˜<a class="hash-link" href="#prometheus-loki-ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h3><p><code>Prometheus</code>ì™€ <code>Loki</code>ëŠ” Loki-Stackìœ¼ë¡œ êµ¬ì„±í•œë‹¤. fluent-bitëŠ” ë³„ë„ êµ¬ì„± íŒŒì¼ì„ í•„ìš”ë¡œ í•˜ê¸° ë•Œë¬¸ì— ë‚˜ì¤‘ì— ì„¤ì¹˜í•  ì˜ˆì •ì´ë‹¤. PrometheusëŠ” Persistent Volumeì€ ë³„ë„ë¡œ êµ¬ì„±í•˜ì§€ ì•Šì€ ìƒíƒœë¡œ <code>persistentVolume</code>ì„ <code>false</code>ë¡œ ì„¤ì •í•˜ì—¬ ë°°í¬í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl create ns tracing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; helm repo add grafana https://grafana.github.io/helm-charts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; helm repo update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; helm install loki grafana/loki-stack --version 2.4.1 -n tracing -f - &lt;&lt; 'EOF'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fluent-bit:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  enabled: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">promtail:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  enabled: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prometheus:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  enabled: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  server:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    persistentVolume:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      enabled: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alertmanager:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    persistentVolume:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      enabled: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>Tempo</code>ëŠ” ë¡œê·¸ ì •ë³´ì™€ tracingì„ ìˆ˜ì‹ í•  ë¦¬ì‹œë²„ í”„ë¡œí† ì½œ ë“¤(zipkin, otlp)ì„ ì •ì˜í•œ ì±„ë¡œ Chartë¡œ ë°°í¬í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">helm install tempo grafana/tempo --version 0.7.4 -n tracing -f - &lt;&lt; 'EOF'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tempo:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  extraArgs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "distributor.log-received-traces": true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  receivers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    zipkin:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    otlp:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      protocols:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        http:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        grpc:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="opentelemetry-collector-êµ¬ì„±">OpenTelemetry Collector êµ¬ì„±<a class="hash-link" href="#opentelemetry-collector-êµ¬ì„±" title="Direct link to heading">â€‹</a></h3><p>ì´ì œê¹Œì§€ observability ê´€ë ¨ ë°ì´í„° ì €ì¥ì†Œë“¤ì„ êµ¬ì„±í–ˆìœ¼ë‹ˆ ë§ˆì§€ë§‰ìœ¼ë¡œ íŠ¸ë ˆì´ì‹±ì„ ìœ„í•œ ë„êµ¬ì¸ <a href="https://opentelemetry.io/docs/collector/getting-started/" target="_blank" rel="noopener noreferrer">OpenTelemetry Collector</a>ë¥¼ ì„¤ì¹˜í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ConfigMap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> otel</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">collector</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> opentelemetry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">component</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> otel</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">collector</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">otel-collector-config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">   receivers:   </span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">     zipkin:</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        endpoint: 0.0.0.0:9411</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">   exporters:</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">     otlp:</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">       endpoint: tempo.tracing.svc.cluster.local:55680</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">       insecure: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">   service:</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">     pipelines:</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">       traces:</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">         receivers: [zipkin]</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">         exporters: [otlp]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´ˆê¸° Collect êµ¬ì„± ì»¨í”¼ê·¸ëŠ” ë‹¤ë¦„ê³¼ ê°™ì´ ì„¤ì •í–ˆë‹¤. ìì„¸í•œ ì„¤ì • ë°©ë²•ì€ <a href="https://opentelemetry.io/docs/collector/configuration/" target="_blank" rel="noopener noreferrer">https://opentelemetry.io/docs/collector/configuration/</a>ì—ì„œ í™•ì¸ê°€ëŠ¥í•˜ë‹¤.</p><ul><li><code>spec.config.receivers.zipkin.endpoint</code>ëŠ” traceì •ë³´ë¥¼ ë°›ì„ ì—”ë“œí¬ì¸íŠ¸ êµ¬ì„±ìœ¼ë¡œ zipkin í¬ë§·ìœ¼ë¡œ ìˆ˜ì‹ í•œë‹¤. </li><li><code>spec.config.exporters[]</code>ì—ì„œëŠ” Tempoë¡œ ë³´ë‚´ê¸° ìœ„í•œ endpoint ì„¤ì •ì„ í•œë‹¤.</li><li><code>spec.config.service</code>ì—ì„œëŠ” ì´í›„ collectorì—ì„œ ì‚¬ìš©í•  protocolì´ë‚˜ backend datasource ì— ëŒ€í•œ ì„¤ì •ì´ë©° ë°˜ë“œì‹œ í™œì„±í™”ê°€ ë˜ì–´ì•¼ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.  </li></ul><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> otel</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">collector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> opentelemetry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">component</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> otel</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">collector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> otlp </span><span class="token comment" style="color:#999988;font-style:italic"># Default endpoint for OpenTelemetry receiver.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">55680</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">protocol</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">targetPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">55680</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> jaeger</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">grpc </span><span class="token comment" style="color:#999988;font-style:italic"># Default endpoint for Jaeger gRPC receiver</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14250</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> jaeger</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">thrift</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">http </span><span class="token comment" style="color:#999988;font-style:italic"># Default endpoint for Jaeger HTTP receiver.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14268</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> zipkin </span><span class="token comment" style="color:#999988;font-style:italic"># Default endpoint for Zipkin receiver.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9411</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> metrics </span><span class="token comment" style="color:#999988;font-style:italic"># Default endpoint for querying metrics.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8888</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prometheus </span><span class="token comment" style="color:#999988;font-style:italic"># prometheus exporter</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8889</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">component</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> otel</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">collector</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Serviceì—ì„œ ì£¼ë£Œ ì‚¬ìš©í•˜ê²Œë  í¬íŠ¸ëŠ” <code>zipkin</code>ì˜ <code>9411</code>ì´ë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apps/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> otel</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">collector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> opentelemetry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">component</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> otel</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">collector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">matchLabels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> opentelemetry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">component</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> otel</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">collector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">template</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> opentelemetry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">component</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> otel</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">collector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"/otelcontribcol"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"--config=/conf/otel-collector-config.yaml"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"--mem-ballast-size-mib=683"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"--log-level=DEBUG"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> otel/opentelemetry</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">collector</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">contrib</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">0.29.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> otel</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">collector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">containerPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">55679</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Default endpoint for ZPages.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">containerPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">55680</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Default endpoint for OpenTelemetry receiver.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">containerPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14250</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Default endpoint for Jaeger HTTP receiver.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">containerPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14268</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Default endpoint for Jaeger HTTP receiver.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">containerPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9411</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Default endpoint for Zipkin receiver.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">containerPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8888</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Default endpoint for querying metrics.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">containerPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8889</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># prometheus exporter       </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">volumeMounts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> otel</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">collector</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">vol</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">configMap</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> otel</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">collector</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">items</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> otel</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">collector</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> otel</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">collector</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">config.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> otel</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">collector</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">vol</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="fluentbit-êµ¬ì„±">Fluentbit êµ¬ì„±<a class="hash-link" href="#fluentbit-êµ¬ì„±" title="Direct link to heading">â€‹</a></h3><p>í´ëŸ¬ìŠ¤í„° dataplaneê³¼ controlplaneì˜ logging ë°ì´í„°ë¥¼ <code>Loki</code> ì—”ë“œí¬ì¸íŠ¸ë¡œ ì „ë‹¬í•˜ê¸° ìœ„í•œ configë¡œ í™•ì¸í•˜ê³  Chartë¥¼ ë°°í¬í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; helm repo add fluent https://fluent.github.io/helm-charts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; helm repo update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; helm install fluent-bit fluent/fluent-bit --version 0.16.1 -n tracing -f - &lt;&lt; 'EOF'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logLevel: trace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">config:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  service: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [SERVICE]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Flush 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Daemon Off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Log_Level trace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Parsers_File custom_parsers.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HTTP_Server On</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HTTP_Listen 0.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        HTTP_Port {{ .Values.service.port }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  inputs: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [INPUT]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Name tail</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Path /var/log/containers/*.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Parser cri</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Tag kube.*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Mem_Buf_Limit 5MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  outputs: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [OUTPUT]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        name loki</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        match *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        host loki.tracing.svc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        port 3100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tenant_id ""</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        labels job=fluentbit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        label_keys $trace_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        auto_kubernetes_labels on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  customParsers: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [PARSER]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Name cri</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Format regex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Regex ^(?&lt;time&gt;[^ ]+) (?&lt;stream&gt;stdout|stderr) (?&lt;logtag&gt;[^ ]*) (?&lt;message&gt;.*)$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Time_Key    time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Time_Format %Y-%m-%dT%H:%M:%S.%L%z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë§ˆì§€ë§‰ìœ¼ë¡œ ìœ„ 3ê°€ì§€ ë°ì´í„°ì†ŒìŠ¤(Prometheus, Loki, Tempo)ê°€ ë“±ë¡ëœ ìƒíƒœì˜ <code>Grafana</code> Chartë¥¼ ë°°í¬í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; helm install grafana grafana/grafana -n tracing --version 6.13.5&nbsp; -f - &lt;&lt; 'EOF'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">datasources:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  datasources.yaml:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    apiVersion: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    datasources:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Tempo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        type: tempo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        access: browser</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        orgId: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uid: tempo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        url: http://tempo.tracing.svc:3100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        isDefault: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        editable: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Prometehus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        type: prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        access: browser</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        orgId: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uid: prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        url: http://loki-prometheus-server.tracing.svc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        isDefault: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        editable: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Loki</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        type: loki</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        access: browser</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        orgId: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uid: loki</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        url: http://loki.tracing.svc:3100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        isDefault: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        editable: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        jsonData:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          derivedFields:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - datasourceName: Tempo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              matcherRegex: "traceID=(\\w+)"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              name: TraceID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              url: "$${__value.raw}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              datasourceUid: tempo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  JAEGER_AGENT_PORT: 6831</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adminUser: admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adminPassword: password</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type: LoadBalancer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="bookinfo-productpage-ì ‘ì†-ë°-trace-í™•ì¸">bookinfo productpage ì ‘ì† ë° trace í™•ì¸<a class="hash-link" href="#bookinfo-productpage-ì ‘ì†-ë°-trace-í™•ì¸" title="Direct link to heading">â€‹</a></h3><p><code>LoadBalancer</code>ë¡œ êµ¬ì„±ëœ istio-ingressgateway EXTERNAL-IPì¸ <a href="http://192.168.31.10/productpage" target="_blank" rel="noopener noreferrer">http://192.168.31.10/productpage</a>ë¡œ ì ‘ì†í•˜ëŠ” ìƒíƒœì—ì„œ traceë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; ISTIOINGRESSGW=$(kubectl get pod -n istio-system -l app=istio-ingressgateway -o jsonpath='{.items[0].status.hostIP}')</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo -e "PRODUCTPAGE UI URL = http://$ISTIOINGRESSGW/productpage"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PRODUCTPAGE UI URL = http://192.168.31.187/productpage</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; for i in {1..100};  do curl -s $ISTIOINGRESSGW/productpage | grep -o "&lt;title&gt;.*&lt;/title&gt;" ; done</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Grafana Explorer ë©”ë‰´ì—ì„œ <code>Loki</code> ë°ì´í„°ì†ŒìŠ¤ë¥¼ ì„ íƒí•˜ê³  Log browserì— <code>{app="productpage"}</code>ë¥¼ ì…ë ¥í•˜ê²Œ ë˜ë©´ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ì— ëŒ€í•œ íŠ¸ë ˆì´ìŠ¤ ì •ë³´ë¥¼ ë¡œê·¸ë‚´ì—ì„œ í™•ì¸í•˜ê³  í•´ë‹¹ traceid ë²„íŠ¼ì„ í´ë¦­í•˜ê±°ë‚˜ <code>Tempo</code> ë©”ë‰´ì—ì„œ íƒìƒ‰ì„ í•˜ë©´ ê´€ë ¨ëœ trace ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><p><img loading="lazy" alt="tempo" src="/assets/images/tempo-grafana-efca4b49fa3a35fde86bb842172288e4.png" width="1920" height="1091" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” eks-anywhere í´ëŸ¬ìŠ¤í„°ì— ì—¬ëŸ¬ê°€ì§€ 3rd party êµ¬ì„±ìš”ì†Œë“¤ì„ ì„¤ì¹˜í•˜ê³  ì‹¤ì œ ìš´ì˜í™˜ê²½ê³¼ ìœ ì‚¬í•˜ê²Œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ë´¤ë‹¤. EKSë¥¼ ì‚¬ìš©í•˜ëŠ” ê´€ì ì—ì„œ ìœ ì‚¬í•œ ê²½í—˜ì„ ë°”íƒ•ìœ¼ë¡œ ê°œë°œí™˜ê²½ì„ ê°€ì ¸ê°ˆìˆ˜ ìˆê¸°ì— vSphereë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‚¬ë‚´ ì„œë¹„ìŠ¤ë¥¼ ê°œë°œí•˜ëŠ” íŒ€ì—ê²ŒëŠ” ì¢‹ì€ í•˜ë‚˜ì˜ ì„ íƒì§€ê°€ ì¶”ê°€ë˜ì—ˆë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤. Direct Connectë‚˜ VPNê³¼ ê°™ì´ ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„±ë§Œ í™•ë³´ëœë‹¤ë©´ ì‹¤ì œ ê¸°ì—…í™˜ê²½ì—ì„œëŠ” AWS ë„¤ì´í‹°ë¸Œ ì„œë¹„ìŠ¤ì™€ì˜ ì—°ê³„ê°€ ë” ìš©ì´í•´ì§€ê¸° ë•Œë¬¸ì— ì¢‹ì€ ê°œë°œ, í…ŒìŠ¤íŠ¸ í™˜ê²½ìœ¼ë¡œ ë‹¤ê°€ê°ˆ ìˆ˜ ìˆì„ê±°ë¼ ìƒê°í•œë‹¤.  </p><p>ì¬ë¯¸ìˆëŠ” ê²½í—˜ì´ì—ˆê³  ë‹¹ë¶„ê°„ì€ ê°œì¸í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ëŠ” í™ˆë© í™˜ê²½ì€ EKS Anywhereë¡œ ì •ì°©í•´ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ê³„ì† ì§„í–‰í•˜ë ¤ê³  í•œë‹¤. </p><blockquote><p>í•´ë‹¹ í¬ìŠ¤íŒ…ì€ í˜„ì¬ ì¬ì§ì¤‘ì¸ íšŒì‚¬ì— ê´€ë ¨ì´ ì—†ê³ , ê°œì¸ ì—­ëŸ‰ ê°œë°œì„ ìœ„í•œ ìë£Œë¡œ í™œìš©í•  ì˜ˆì •ì…ë‹ˆë‹¤.</p></blockquote>]]></content>
        <author>
            <name>Jinwoong Kim</name>
            <uri>https://www.linkedin.com/in/ddiiwoong/</uri>
        </author>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="vsphere" term="vsphere"/>
        <category label="eks anywhere" term="eks anywhere"/>
        <category label="eks connector" term="eks connector"/>
        <category label="eks" term="eks"/>
        <category label="opentelemetry" term="opentelemetry"/>
        <category label="cilium" term="cilium"/>
        <category label="observability" term="observability"/>
        <category label="prometheus" term="prometheus"/>
        <category label="grafana" term="grafana"/>
        <category label="loki" term="loki"/>
        <category label="microservice" term="microservice"/>
        <category label="istio" term="istio"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[EKS Anywhere on vSphere Homelab]]></title>
        <id>kubernetes/eks-anywhere/</id>
        <link href="https://ddii.dev/kubernetes/eks-anywhere/"/>
        <updated>2022-03-06T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[vSphere homelab í™˜ê²½ì—ì„œ EKS Anywhere êµ¬ì„±í•˜ê¸°]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="eks-anywhere">EKS Anywhere<a class="hash-link" href="#eks-anywhere" title="Direct link to heading">â€‹</a></h2><p><code>EKS Anywhere</code>ëŠ” eksctlë¥¼ ì‚¬ìš©í•˜ëŠ” í™˜ê²½ì—ì„œ <a href="https://github.com/kubernetes-sigs/cluster-api-provider-vsphere" target="_blank" rel="noopener noreferrer">Kubernetes Cluster API Provider vSphere</a> ì¸ CAPVë¥¼ í†µí•´ vSphere ê¸°ë°˜ìœ¼ë¡œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•´ì£¼ëŠ” ì˜¤í”ˆì†ŒìŠ¤ì´ë‹¤. CAPV Specì€ <a href="https://cluster-api.sigs.k8s.io/" target="_blank" rel="noopener noreferrer">Kubernetes Cluster API</a> ê¸°ë°˜ìœ¼ë¡œ ì¿ ë²„ë„¤í‹°ìŠ¤ ìŠ¤íƒ€ì¼ APIí˜•íƒœì˜ ì„ ì–¸ì (Declarative) ë°©ì‹ìœ¼ë¡œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì˜ Lifecycleì„ ê´€ë¦¬í•˜ëŠ” í”„ë¡œì íŠ¸ì´ë‹¤. </p><p>Ubuntu ë˜ëŠ” Mac admin í™˜ê²½ì—ì„œ eksctl ëª…ë ¹ì–´ë¡œ ë¡œì»¬ í´ëŸ¬ìŠ¤í„°ë“¤ì„ ê´€ë¦¬í•˜ê³  í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±, ì‚­ì œí•  ìˆ˜ ìˆë‹¤. ì¼ë‹¨ ê¸°ë³¸ì ìœ¼ë¡œ í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ëŠ” ë°©ì‹ì´ eksctlê³¼ ê±°ì˜ ìœ ì‚¬í•˜ë‹¤. ë˜í•œ EKS ì„œë¹„ìŠ¤ì˜ ë°°í¬ ë²„ì „ê³¼ ë™ì¼í•œ ë²„ì „ì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ (í¬ìŠ¤íŒ… ë‹¹ì‹œ ë²„ì „ 1.21) vSphere ê¸°ë°˜ í•˜ì´ë¸Œë¦¬ë“œ í™˜ê²½ì—ì„œì˜ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë° ì›Œí¬ë¡œë“œ ê´€ë¦¬ë¥¼ í¸í•˜ê²Œ í•  ìˆ˜ ìˆë‹¤.</p><p>í¬ê²Œ EKS native ì„œë¹„ìŠ¤ì™€ í¬ê²Œ ë‹¤ë¥¸ì  ëª‡ê°€ì§€ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. </p><ul><li>ì»´í“¨íŒ… í™˜ê²½ : vSphere, Docker(ê°œë°œí™˜ê²½ êµ¬ì„±ì‹œ)</li><li>ë…¸ë“œ ì§€ì› OS :  BottleRocket, Ubuntu</li><li>CNI : Cilium</li></ul><p>ìì„¸í•œ ë‚´ìš©ì€ <a href="https://anywhere.eks.amazonaws.com/docs/concepts/eksafeatures/" target="_blank" rel="noopener noreferrer">ë¹„êµí‘œ</a>ë¥¼ ì°¸ê³ í•˜ì.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì‚¬ì „-ì¤€ë¹„ì‚¬í•­">ì‚¬ì „ ì¤€ë¹„ì‚¬í•­<a class="hash-link" href="#ì‚¬ì „-ì¤€ë¹„ì‚¬í•­" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ë¡œì»¬-ê´€ë¦¬-í™˜ê²½">ë¡œì»¬ ê´€ë¦¬ í™˜ê²½<a class="hash-link" href="#ë¡œì»¬-ê´€ë¦¬-í™˜ê²½" title="Direct link to heading">â€‹</a></h3><ul><li>Docker 20.x ì´ìƒ ë²„ì „  </li><li>Mac OS(10.15) / Ubuntu(20.04.2 LTS)</li><li>CPU 4ì½”ì–´</li><li>ë©”ëª¨ë¦¬ 16GB</li><li>ë””ìŠ¤í¬ 30GB</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="vsphere">vSphere<a class="hash-link" href="#vsphere" title="Direct link to heading">â€‹</a></h3><p><a href="https://anywhere.eks.amazonaws.com/docs/reference/vsphere/vsphere-prereq/" target="_blank" rel="noopener noreferrer">https://anywhere.eks.amazonaws.com/docs/reference/vsphere/vsphere-prereq/</a></p><ul><li>vCenter í™˜ê²½ì˜ vSphere 7.0 ì´ìƒ</li><li>ìµœì†Œ VM 4ëŒ€ (ê° 2 vCPU, 8GB ë©”ëª¨ë¦¬, 25GB ë””ìŠ¤í¬ ì´ìƒ ê¶Œì¥)<ul><li>Control Plane 1ëŒ€</li><li>etcd ë…¸ë“œ 1ëŒ€</li><li>worker ë…¸ë“œ 2ëŒ€</li></ul></li><li>DHCP í™˜ê²½</li><li>API ì„œë²„ ìš© Static IP 1ê°œ</li><li>ì™¸ë¶€ ë°”ì´ë„ˆë¦¬, ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œë¥¼ ìœ„í•œ ë„¤íŠ¸ì›Œí¬ í™˜ê²½<ul><li>í´ëŸ¬ìŠ¤í„° ìì²´ì—ì„œ ë°©í™”ë²½ ë“±ìœ¼ë¡œ ì¸í•œ ì¸í„°ë„·ì´ ì•ˆë˜ëŠ” ê²½ìš° <a href="https://anywhere.eks.amazonaws.com/docs/reference/clusterspec/proxy/" target="_blank" rel="noopener noreferrer">í”„ë¡ì‹œ êµ¬ì„±</a>ì„ í†µí•´ ê°€ëŠ¥í•¨</li></ul></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="homelab-êµ¬ì„±í™˜ê²½">Homelab êµ¬ì„±í™˜ê²½<a class="hash-link" href="#homelab-êµ¬ì„±í™˜ê²½" title="Direct link to heading">â€‹</a></h2><p>ê¸°ì¡´ì— ìš´ì˜í•˜ë˜ ESXi í™˜ê²½ì„ ê·¸ëŒ€ë¡œ í™œìš©í•˜ë„ë¡ í–ˆë‹¤. ì¶”ê°€ì ìœ¼ë¡œ í•˜ë“œì›¨ì–´ë¥¼ êµ¬ë¹„í•˜ê¸° ìœ„í•´ ë¹„ìš©ì´ ë°œìƒí•œë¶€ë¶„ì€ ì—†ë‹¤.   </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="hardware">Hardware<a class="hash-link" href="#hardware" title="Direct link to heading">â€‹</a></h3><ul><li>Dell Precision Tower 3620<ul><li>Intel(R) Xeon(R) CPU E3-1240L v5</li><li>TeamGroup DDR4-2666 16GB * 4ea</li><li>(VM ìš©) SAMSUNG NVMe SSD PM981 - 1TB</li><li>(ESXi ìš©) Sandisk SSD Z410- 240GB</li></ul></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="software">Software<a class="hash-link" href="#software" title="Direct link to heading">â€‹</a></h3><ul><li>vSphere 7.0 Update 3</li><li>vCenter 7.0.3 (VSCA)</li><li>Docker Desktop <a href="https://docs.docker.com/desktop/mac/release-notes/#docker-desktop-420" target="_blank" rel="noopener noreferrer">4.2.0</a>ë²„ì „ì„ ì‚¬ìš© <ul><li>4.3.0 ë²„ì „ í•˜ìœ„ í˜¸í™˜ ë¬¸ì œê°€ìˆì–´ ê¸ˆë²ˆ í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œëŠ” 4.2.0 ì‚¬ìš©</li><li>ë„ì»¤ ë¦¬ì†ŒìŠ¤ë¥¼ ìµœì†Œ <code>8vCPU</code>, <code>16GB</code>ë¡œ ì„¤ì •</li></ul></li><li><a href="https://kubernetes.io/ko/docs/tasks/tools/" target="_blank" rel="noopener noreferrer">kubectl</a> v1.23.4</li><li><a href="https://eksctl.io/introduction/#installation" target="_blank" rel="noopener noreferrer">eksctl</a> v0.85.0</li><li><a href="https://anywhere.eks.amazonaws.com/docs/getting-started/install/" target="_blank" rel="noopener noreferrer">eksctl-anywhere</a> v0.7.0</li><li><a href="https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/install-aws-iam-authenticator.html" target="_blank" rel="noopener noreferrer">aws-iam-authenticator</a> v0.5.5</li><li><a href="https://anywhere.eks.amazonaws.com/docs/reference/artifacts/" target="_blank" rel="noopener noreferrer">bottlerocket OVA</a> v1.21 (ìë™ ìƒì„±ë˜ëŠ” OVAë¡œ ë³„ë„ êµ¬ì„±ì´ í•„ìš”ì—†ë‹¤)  </li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="í´ëŸ¬ìŠ¤í„°-í™˜ê²½êµ¬ì„±">í´ëŸ¬ìŠ¤í„° í™˜ê²½êµ¬ì„±<a class="hash-link" href="#í´ëŸ¬ìŠ¤í„°-í™˜ê²½êµ¬ì„±" title="Direct link to heading">â€‹</a></h2><p><a href="https://anywhere.eks.amazonaws.com/docs/concepts/clusterworkflow/" target="_blank" rel="noopener noreferrer">ê³µì‹ í™ˆí˜ì´ì§€ì˜ í´ëŸ¬ìŠ¤í„° ìƒì„±, ì‚­ì œ ì›Œí¬í”Œë¡œìš°</a>ë¥¼ ì°¸ê³ í•˜ì—¬ ì‚¬ì „ êµ¬ì„±ëœ Homelabì— ì ìš©í•œë‹¤. </p><p><img loading="lazy" src="https://anywhere.eks.amazonaws.com/images/eks-a_create_cluster.png" alt="workflow" class="img_E7b_"></p><p>ì²˜ìŒì—ëŠ” eksctl ëª…ë ¹ìœ¼ë¡œ í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•˜ëŠ” ê³¼ì •ìœ¼ë¡œ ì‚¬ì „ì— ìƒì„±í•œ cluster config yamlì„ í†µí•´ ë¡œì»¬ ë„ì»¤ ì—”ì§„ì— bootstrapì„ í•˜ëŠ” ëª…ë ¹ì„ ë‚´ë¦°ë‹¤. ì´ë•Œ ë¡œì»¬ ë„ì»¤ ì—”ì§„ì—ì„œëŠ” Docker in Docker ì—”ì§„ì¸ <a href="https://kind.sigs.k8s.io/" target="_blank" rel="noopener noreferrer">kind</a>ë¥¼ í†µí•´ í´ëŸ¬ìŠ¤í„° ë²ˆë“¤ ì»¨í”¼ê·¸ë¥¼ ìƒì„±í•œë‹¤. </p><p><a href="https://github.com/kubernetes-sigs/cluster-api/tree/main/cmd/clusterctl" target="_blank" rel="noopener noreferrer">clusterctl</a>ë¥¼ í†µí•´ <a href="https://github.com/kubernetes-sigs/cluster-api/tree/main/test/infrastructure/docker" target="_blank" rel="noopener noreferrer">Cluster API Provider Docker</a>í˜•íƒœë¡œ ë¶€ëª¨(bootstrap) í´ëŸ¬ìŠ¤í„°ë¥¼ ë§Œë“œëŠ” ê³¼ì •ì´ <code>eksctl anywhere</code> ëª…ë ¹ìœ¼ë¡œ ì¶”ìƒí™” ë˜ëŠ”ê²ƒì´ë¼ ë³¼ ìˆ˜ ìˆë‹¤. </p><p>í•´ë‹¹ ë‹¨ê³„ì—ì„œ ë¨¼ì € Bastion Hostë‚˜ ê´€ë¦¬ ë¨¸ì‹ ì— <code>kubectl</code>, <code>eksctl</code>, <code>eksctl-anywhere</code>, <code>aws-iam-authenticator</code> ë“±ì´ ì„¤ì¹˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•œë‹¤.</p><p><a href="https://anywhere.eks.amazonaws.com/docs/getting-started/install/" target="_blank" rel="noopener noreferrer">https://anywhere.eks.amazonaws.com/docs/getting-started/install/</a></p><p><code>homelab</code> ì´ë¦„ìœ¼ë¡œ í´ëŸ¬ìŠ¤í„° ì»¨í”¼ê·¸ë¥¼ ìƒì„±í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">CLUSTER_NAME=homelab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eksctl anywhere generate clusterconfig $CLUSTER_NAME \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   --provider vsphere &gt; $CLUSTER_NAME.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ëª¨ë“  ì»¨í”¼ê·¸ì— ëŒ€í•œ ìƒì„¸ ì„¤ì •ì€ <a href="https://anywhere.eks.amazonaws.com/docs/reference/clusterspec/vsphere/" target="_blank" rel="noopener noreferrer">vSphere configuration</a> ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><p>ìƒì„±ëœ ì»¨í”¼ê·¸ë¥¼ í•˜ë‚˜ì”© ì‚´í´ë³´ì. </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> anywhere.eks.amazonaws.com/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> homelab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">clusterNetwork</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">cni</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cilium</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">pods</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">cidrBlocks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 192.168.0.0/20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">cidrBlocks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 10.96.0.0/12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">controlPlaneConfiguration</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">count</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">host</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 192.168.31.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">machineGroupRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> VSphereMachineConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> homelab</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">datacenterRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> VSphereDatacenterConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> homelab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">externalEtcdConfiguration</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">count</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">machineGroupRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> VSphereMachineConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> homelab</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">etcd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">gitOpsRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> GitOpsConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cluster</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">gitops</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">kubernetesVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"1.21"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">managementCluster</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> homelab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">workerNodeGroupConfigurations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">count</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">machineGroupRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> VSphereMachineConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> homelab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> md</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì²«ë²ˆì§¸ëŠ” <code>Cluster</code> ë¦¬ì†ŒìŠ¤ë¡œ Clusterì˜ ì´ë¦„ê³¼ í´ëŸ¬ìŠ¤í„° ì „ë°˜ ì„¤ì •ê³¼ Control Plane, Data Plane, etcd VMì˜ ë²„ì „, ê°œìˆ˜ ë“±ì„ ì •í•  ìˆ˜ ìˆë‹¤. </p><p>í´ëŸ¬ìŠ¤í„° ì´ë¦„ì€ <code>homelab</code>ìœ¼ë¡œ ì„¤ì •í•œë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ CNIëŠ” Ciliumì„ ì‚¬ìš©í•˜ëŠ” êµ¬ì¡°ì´ê¸° ë•Œë¬¸ì— í•„ìˆ˜ì ìœ¼ë¡œ <code>cilium</code>ë¡œ ì„¤ì •í•´ì•¼ í•œë‹¤. ê·¸ë¦¬ê³  kubeadm êµ¬ì„±ì‹œ í•„ìš”í•œ <code>pods.cidrBlocks</code>ê³¼ <code>services.cidrBlocks</code>ì—ì„œ íŒŒë“œì™€ ì„œë¹„ìŠ¤ê°€ ì‚¬ìš©í•  ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­ì„ ì„¤ì •í•œë‹¤. ë‘˜ë‹¤ CNIì—ì„œ í†µì‹ ë˜ëŠ” ê°€ìƒ ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­ì´ê¸° ë•Œë¬¸ì— í˜„ì¬ ì‚¬ìš©ì¤‘ì¸ ìƒ¤ì˜¤ë¯¸ ê³µìœ ê¸° ëŒ€ì—­(192.168.31.x)ê³¼ ì¶©ëŒí•˜ì§€ ì•Šìœ¼ë©´ì„œ ë¼ìš°íŒ…ì— ë¬¸ì œë˜ì§€ ì•Šê³  í˜„ì¬ ë„¤íŠ¸ì›Œí¬ì— ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ëŒ€ì—­(192.168.0.0/20, 10.96.0.0/12) ìœ¼ë¡œ ì„¤ì •í–ˆë‹¤.  </p><blockquote><p>DHCP ìœ ì˜ì‚¬í•­: ë³¸ì¸ì˜ ê²½ìš° Xiaomi ê³µìœ ê¸°ë¥¼ ì‚¬ìš©ì¤‘ì¸ë° ë³„ë„ì˜ DHCPì„œë²„ë¥¼ êµ¬ì„±í•˜ì§€ ì•Šê³  ì‚¬ìš©ì„ í•˜ê³  ìˆì–´ì„œì¸ì§€, ì‹ ê·œ ë…¸ë“œë¥¼ ìœ„í•œ VMì´ ìƒì„±ë˜ê³  <code>bottlerocket</code> OSê°€ ê¸°ë™ë ë•Œ í˜¸ìŠ¤íŠ¸ëª…ì´ <code>MiWifi-R3600-SRV</code> ì´ëŸ°ì‹ìœ¼ë¡œ ëŒ€ì†Œë¬¸ìë¥¼ í¬í•¨í•œ í˜•íƒœë¡œ ìë™ ìƒì„±ë˜ë‹¤ ë³´ë‹ˆ ë¶€íŒ…ì´ ë˜ì§€ ì•ŠëŠ” í˜„ìƒì´ ë°œìƒí–ˆë‹¤. ì´ì— <a href="https://anywhere.eks.amazonaws.com/docs/reference/vsphere/vsphere-dhcp/" target="_blank" rel="noopener noreferrer">ë³„ë„ì˜ DHCP êµ¬ì„±</a>ì„ í†µí•´ ì§„í–‰ì„ í•˜ë©´ í•´ë‹¹ ì´ìŠˆë¥¼ í”¼í• ìˆ˜ ìˆë‹¤. </p></blockquote><p><code>controlPlaneConfiguration</code> í•„ë“œì—ì„œëŠ” controlPlane ë…¸ë“œì˜ <code>count</code>ì™€ <code>endpoint</code>ë¥¼ ì„¤ì •í•´ì•¼ í•œë‹¤. <code>count</code> ì´ˆê¸° ê°’ì€ <code>2</code>ë¡œ ë˜ì–´ ìˆì§€ë§Œ í™ˆë©ì˜ ìì›ì´ ë¶€ì¡±í•˜ê¸° ë•Œë¬¸ì— <code>1</code>ë¡œ ì„¤ì •í–ˆë‹¤. ì‹¤ì œ í”„ë¡œë•ì…˜ì—ì„œëŠ” 2ì´ìƒì„ ê¶Œê³ í•œë‹¤. ê·¸ë¦¬ê³  <code>endpoint.host</code>ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ APIì„œë²„ ì—”ë“œí¬ì¸íŠ¸ë¡œ ì‹¤ì œ kubectl ëª…ë ¹ ë° ì‚¬ìš©ìì™€ ì¸í„°í˜ì´ìŠ¤ë¥¼ ìœ„í•œ ì ‘ê·¼ ê°€ëŠ¥í•œ DHCP í• ë‹¹ìœ¼ë¡œ ì¶©ëŒë˜ì§€ ì•ŠëŠ” ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­ì˜ ê³ ì • IPë¡œ ì„¤ì •í•œë‹¤. <code>machineGroupRef</code>ëŠ” ì´í›„ ìƒì„±í•  VM specì— ë§¤ì¹­ì‹œí‚¬ label ê°’ìœ¼ë¡œ ìë™ ìƒì„±ëœë‹¤. </p><p><code>externalEtcdConfiguration</code>ëŠ” etcd êµ¬ì„±ì„ ìœ„í•œ í•„ë“œë¡œ <code>count</code>ëŠ” ê¸°ë³¸ì„¤ì • ê°’ì´ <code>3</code>ì´ì§€ë§Œ í™ˆë© í™˜ê²½ì—ì„œëŠ” <code>1</code>ë¡œ êµ¬ì„±í•˜ì˜€ë‹¤. ì‹¤ì œ í”„ë¡œë•ì…˜ì—ì„œëŠ” Raft ì•Œê³ ë¦¬ì¦˜ ê¸°ë°˜ Redundancy êµ¬ì„±ì„ ìœ„í•´ <code>3</code>ì´ìƒì„ ê¶Œê³ í•œë‹¤.</p><p><code>gitOpsRef</code>ëŠ” GitOps í˜•íƒœë¡œ í´ëŸ¬ìŠ¤í„°ë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•´ ì°¸ì¡°í•˜ëŠ” ê°’ìœ¼ë¡œ ì•„ë˜ <code>GitOpsConfig</code> ì—ì„œ ì‚¬ìš©í•  ì´ë¦„ <code>cluster-gitops</code> ë¥¼ ëª…ì‹œí•œë‹¤. </p><p><code>kubernetesVersion</code>ì€ EKS ë°°í¬ ë²„ì „ì™€ ë™ì¼í•œ <code>1.21</code>ë¡œ ì„¤ì •í•œë‹¤. </p><p><code>workerNodeGroupConfigurations</code>ì€ ì›Œì»¤ë…¸ë“œ êµ¬ì„±ìœ¼ë¡œ <code>count</code>ë¥¼ <code>2</code>ë¡œ ì„¤ì •í•˜ì˜€ë‹¤. </p><p>ë‹¤ìŒì€ ë°°í¬ë˜ëŠ” vSphere specì„ ì •ì˜í•˜ëŠ” ë¦¬ì†ŒìŠ¤ë¡œ <code>VSphereDatacenterConfig</code>ì´ë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> anywhere.eks.amazonaws.com/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> VSphereDatacenterConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> homelab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">datacenter</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Datacenter"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">insecure</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">network</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"VM Network"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"192.168.31.2"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">thumbprint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"**:89:91:5B:02:50:F6:41:D0:DE:6B:A0:B8:43:41:A4:81:03:**"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>spec</code>ì—ì„œëŠ” ì‹¤ì œ vCenterì˜ ì—”ë“œí¬ì¸íŠ¸, datacenter, network ì •ë³´ ë“±ì„ ì…ë ¥í•œë‹¤. </p><blockquote><p>ìœ ì˜ì‚¬í•­ : <code>insecure</code> ì˜µì…˜ì˜ ê²½ìš° ê¸°ë³¸ê°’ì´ falseë¡œ ë˜ì–´ ìˆë‹¤. í•´ë‹¹ ê°’ì´ <code>false</code>ì˜ ê²½ìš° ì•„ë˜ ê·¸ë¦¼ì— ìˆëŠ” ê²ƒ ì²˜ëŸ¼ ë³´í†µ vCenter ë©”ë‰´ì—ì„œ <code>thumbprint</code> ê°’ì„ í™•ì¸í•  ìˆ˜ ìˆê³  í•´ë‹¹ ê°’ì„ <code>**:89:91:5B:02:50:F6:41:D0:DE:6B:A0:B8:43:41:A4:81:03:**</code> í˜•íƒœë¡œ ë³€ê²½í•˜ì—¬ ì‚¬ìš©í•˜ê±°ë‚˜ <a href="https://github.com/vmware/govmomi/tree/master/govc" target="_blank" rel="noopener noreferrer">govc</a>ë¥¼ ì‚¬ìš©í•˜ì—¬ <code>govc about.cert -thumbprint -k</code> ëª…ë ¹ì–´ë¡œ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤.</p></blockquote><p><img loading="lazy" alt="cert" src="/assets/images/vsphere_cert-46b8ff831c6ea16844e8182f910d0650.png" width="1762" height="1214" class="img_E7b_"></p><p>ë§ˆì§€ë§‰ì€ ê° ë…¸ë“œ ì—­í• (control plane, etcd, worker)ë³„ë¡œ ì‚¬ìš©í•  OS ë° ë¦¬ì†ŒìŠ¤ specì„ ì •ì˜í•˜ëŠ” ì»¨í”¼ê·¸ì´ë‹¤. ìœ„ <code>Cluster</code> ë¦¬ì†ŒìŠ¤ì—ì„œ ì„¤ì •ëœ <code>machineGroupRef.name</code>ìœ¼ë¡œ ë§¤ì¹­ë˜ëŠ” ê°’ì„ metadataë¡œ ìë™ ìƒì„± í•´ì£¼ê³  ëª¨ë‘ ìœ ì‚¬í•˜ê¸° ë•Œë¬¸ì— ì´ì¤‘ <code>VSphereMachineConfig</code>ë§Œ ì‚´í´ë³¸ë‹¤. </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> anywhere.eks.amazonaws.com/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> VSphereMachineConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> homelab</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">datastore</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"datastore2"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">diskGiB</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">25</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">folder</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"cp"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">memoryMiB</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8192</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">numCPUs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">osFamily</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> bottlerocket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">resourcePool</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"*/Resources"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">users</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ec2</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">sshAuthorizedKeys</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ssh</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">rsa AAAAB3</span><span class="token important">******U=</span><span class="token plain"> vsphere</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Datacenterì— êµ¬ì„±í•œ <code>datastore</code>ì¤‘ ì„¤ì¹˜ë˜ëŠ” VM ì˜ì—­ì´ ì‚¬ìš©í•  ëŒ€ìƒ datastoreë¥¼ ì…ë ¥í•œë‹¤. VMë””ìŠ¤í¬ <code>diskGiB</code>, Datacenter <code>folder</code>, VMë©”ëª¨ë¦¬ <code>memoryMiB</code>, vCPU <code>numCPUs</code>ë¥¼ ì…ë ¥í•˜ê³ , <code>resourcePool</code>ì€ ì§€ì • ë¦¬ì†ŒìŠ¤ ê·¸ë£¹ì„ ë³„ë„ë¡œ ì„¤ì •í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— <code>"*/Resources"</code>ë¡œ ì„¤ì •í•œë‹¤. ê·¸ë¦¬ê³  <code>osFamily</code>ëŠ” ubuntu, bottlerocketë‘ê°€ì§€ë¡œ ì œê³µì´ ë˜ëŠ”ë° ê¸°ë³¸ê°’ì€ bottlerocketì´ê³ , í•´ë‹¹ ì´ë¯¸ì§€ì˜ ê¸°ë³¸ userëŠ” <code>ec2-user</code>ë¡œ ì„¤ì •í•˜ê³  í•´ë‹¹ VMì— SSHì ‘ê·¼ì„ ìœ„í•´ì„œ ë³„ë„ë¡œ ìƒì„±í•œ <code>sshAuthorizedKeys</code>ë¥¼ ì…ë ¥í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> anywhere.eks.amazonaws.com/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> GitOpsConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cluster</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">gitops</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">flux</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">github</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">branch</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">clusterConfigPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> clusters/homelab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">fluxSystemNamespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> flux</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">owner</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ddiiwoong</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">personal</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">repository</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eks</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">anywhere</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">homelab</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë§ˆì§€ë§‰ì€ í´ëŸ¬ìŠ¤í„°ë¥¼ GitOps ìŠ¤íƒ€ì¼ë¡œ ê´€ë¦¬í•˜ê¸° ìœ„í•´ <code>GitOpsConfig</code>ë¥¼ ì¶”ê°€í•œë‹¤. spec ì—ì„œ ì‚¬ìš©í•  githubì˜ <code>branch</code>, github ë ˆí¬ ì•„ë˜ ì»¨í”¼ê·¸ê°€ ì €ì¥ë  ê²½ë¡œì¸ <code>clusterConfigPath</code>, gitops ì˜¤í”ˆì†ŒìŠ¤ì¸ <a href="https://fluxcd.io/docs/get-started/" target="_blank" rel="noopener noreferrer">Flux</a>ê°€ êµ¬ì„±ë  ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì¸ <code>fluxSystemNamespace</code>, github accountì¸ <code>owner</code>, repo ì´ë¦„ì´ ë˜ëŠ” <code>repository</code> ê¹Œì§€ ì„¤ì •í•œë‹¤. í•´ë‹¹ êµ¬ì„±ì„ í¬í•¨í•œ ì±„ë¡œ í´ëŸ¬ìŠ¤í„°ë¥¼ ë°°í¬í•˜ê²Œ ë˜ë©´ í´ëŸ¬ìŠ¤í„°ê°€ ìƒì„±ë˜ëŠ” ì¤‘ì— ì„ ì–¸í•œ <code>repository</code>ë¡œ ì´í›„ ê´€ë¦¬ë  í´ëŸ¬ìŠ¤í„° ì»¨í”¼ê·¸ ë° kustomize íŒŒì¼ ë“±ì„ <code>commit</code>í•˜ê²Œ ëœë‹¤. </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="í´ëŸ¬ìŠ¤í„°-ìƒì„±">í´ëŸ¬ìŠ¤í„° ìƒì„±<a class="hash-link" href="#í´ëŸ¬ìŠ¤í„°-ìƒì„±" title="Direct link to heading">â€‹</a></h2><p>ë‚˜ë¨¸ì§€ etcd, worker node ë„ <code>VSphereMachineConfig</code>ë¥¼ ë™ì¼í•œ í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•˜ê³ , vSphere ê´€ë ¨ ì¸ì¦ì •ë³´ì™€ gitopsë¡œ í™œìš©í•  ë ˆí¬ì˜ github tokenì„ í™˜ê²½ë³€ìˆ˜ë¡œ ì…ë ¥í•˜ì—¬ í´ëŸ¬ìŠ¤í„° ìƒì„±ì„ ì§„í–‰í•œë‹¤. í™ˆë©ìœ¼ë¡œ êµ¬ì„±í•œ ìƒ˜í”Œ ì»¨í”¼ê·¸ëŠ” <a href="https://raw.githubusercontent.com/ddiiwoong/eks-anywhere-homelab/main/clusters/homelab/homelab/eksa-system/eksa-cluster.yaml" target="_blank" rel="noopener noreferrer">ë§í¬</a>ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; export EKSA_VSPHERE_USERNAME='administrator@ddii.local'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; export EKSA_VSPHERE_PASSWORD='***********'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; export EKSA_GITHUB_TOKEN=ghp_************************</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; eksctl anywhere create cluster -f homelab.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Warning: The recommended size of an external etcd cluster is 3 or 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Checking Github Access Token permissions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">âœ… Github personal access token has the required repo permissions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Performing setup and validations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">âœ… Connected to server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">âœ… Authenticated to vSphere</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">âœ… Datacenter validated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">âœ… Network validated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">âœ… Datastore validated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">âœ… Folder validated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">âœ… Resource pool validated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">âœ… Datastore validated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">âœ… Folder validated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">âœ… Resource pool validated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">âœ… Datastore validated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">âœ… Folder validated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">âœ… Resource pool validated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">âœ… Control plane and Workload templates validated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">âœ… Vsphere Provider setup is valid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">âœ… Flux path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">âœ… Create preflight validations pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Creating new bootstrap cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Installing cluster-api providers on bootstrap cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Provider specific setup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Creating new workload cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Installing networking on workload cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Installing storage class on workload cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Installing cluster-api providers on workload cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Installing EKS-A secrets on workload cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Moving cluster management from bootstrap to workload cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Installing EKS-A custom components (CRD and controller) on workload cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Creating EKS-A CRDs instances on workload cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Installing AddonManager and GitOps Toolkit on workload cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Adding cluster configuration files to Git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enumerating objects: 20, done.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Counting objects: 100% (20/20), done.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Compressing objects: 100% (12/12), done.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Total 20 (delta 1), reused 19 (delta 0), pack-reused 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Finalized commit and committed to local repository  {"hash": "ea4293c849725e593704c2a8ff71a708ad8cf8f2"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Writing cluster config file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Deleting bootstrap cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ğŸ‰ Cluster created!</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê° ë‹¨ê³„ë¥¼ ìˆœì„œëŒ€ë¡œ ê°„ë‹¨íˆ ì‚´í´ë³´ë©´ ì²˜ìŒ bootstrap cluster êµ¬ì„± ë‹¨ê³„ì—ì„œëŠ” ì•„ë˜ì™€ ê°™ì€ ì¼ì„ ìˆ˜í–‰í•œë‹¤.</p><ul><li>Github Access Token ê¶Œí•œ í™•ì¸</li><li>vSphere ì¸ì¦</li><li>vSphere ë¦¬ì†ŒìŠ¤(Datacenter, Network, Datastore, Folder ë“±) ê²€ì¦</li><li>Control Plane, Workload Plane í…œí”Œë¦¿ ê²€ì¦</li><li>kindë¡œ bootstrap cluster ìƒì„±</li><li>cluster-api provider ì—­í• ì„ í•˜ëŠ” CAPI(Cluster API) ì„¤ì¹˜</li></ul><p>ë‹¤ìŒì€ ìƒì„±ëœ bootstrap clusterì˜ CAPI ê´€ë¦¬ë„êµ¬ê°€ vSphere í´ëŸ¬ìŠ¤í„°ì— ì—°ê²°í›„ì— ì§„í–‰í•œë‹¤.</p><ul><li><a href="https://github.com/vmware/govmomi/tree/master/govc" target="_blank" rel="noopener noreferrer">govc</a>ë¥¼ ì‚¬ìš©í•´ì„œ ì—°ê²°ëœ vSphere í´ëŸ¬ìŠ¤í„°ì— ìƒˆë¡œìš´ etcdë¥¼ í¬í•¨í•œ Control, Workload ë…¸ë“œ ìƒì„±</li><li><a href="https://cilium.io/" target="_blank" rel="noopener noreferrer">Cilium</a> CNI ì¶”ê°€</li><li>Storage Class ì¶”ê°€</li><li>êµ¬ì„±ëœ Workload Clusterì— CAPI ì¶”ê°€<ul><li>provider ì…‹ì—…</li><li>ì¶”ê°€ì ì¸ CRD ë° GitOps ì»´í¬ë„ŒíŠ¸ ì¶”ê°€</li></ul></li><li>GitOpsë¥¼ ìœ„í•´ ìµœì´ˆ ìƒì„±ëœ cluster configë¥¼ ì§€ì •í•œ repoì— Commit </li><li>ë§ˆì§€ë§‰ìœ¼ë¡œ ë¡œì»¬ ê´€ë¦¬ ë¨¸ì‹ ì— cluster configë¥¼ ì €ì¥</li></ul><p>ê°ê°ì˜ ë‹¨ê³„ì— ëŒ€í•œ ì„¤ëª…ì€ <a href="https://anywhere.eks.amazonaws.com/docs/concepts/clusterworkflow/#4-authenticate-and-create-bootstrap-cluster" target="_blank" rel="noopener noreferrer">ë‹¤ìŒ ë§í¬</a>ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><p>ì²˜ìŒ ëª‡ë²ˆ ì‹œë„ë¥¼ í•˜ë‹¤ë³´ë©´ ì—¬ëŸ¬ê°€ì§€ ì—ëŸ¬ì‚¬í•­ì„ ë§Œë‚˜ê²Œ ëœë‹¤. í•´ë‹¹ ë‹¨ê³„ì˜ ë””ë²„ê·¸ ë ˆë²¨ ì¶œë ¥ì„ ë³´ê¸° ìœ„í•´ì„œëŠ” <code>-v 9</code> í”Œë˜ê·¸ë¥¼ ì¶”ê°€í•´ì„œ ì„¤ì¹˜ë¥¼ ì§„í–‰í•˜ë©´ ìƒì„¸ ë‚´ì—­ì„ í™•ì¸í•  ìˆ˜ ìˆëŠ”ë° debug ë ˆë²¨ë¡œ ë§ˆì§€ë§‰ ëª‡ì¤„ ë¡œê·¸ë¥¼  ì‚´í´ë³´ë©´ ë„ì»¤ì—ì„œ kindë¡œ ë„ì»¤ë‚´ì— í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•œ ì´í›„ì— dockerë‚´ kind í´ëŸ¬ìŠ¤í„°ë¥¼ ì‚­ì œí•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">2022-03-04T15:23:33.638+0900    V4      Deleting kind cluster   {"name": "homelab-eks-a-cluster"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-03-04T15:23:33.638+0900    V6      Executing command       {"cmd": "/usr/local/bin/docker exec -i eksa_1646374542969789000 kind delete cluster --name homelab-eks-a-cluster"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Deleting cluster "homelab-eks-a-cluster" ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-03-04T15:23:36.244+0900    V0      ğŸ‰ Cluster upgraded!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-03-04T15:23:36.244+0900    V4      Task finished   {"task_name": "delete-kind-cluster", "duration": "4.560798797s"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-03-04T15:23:36.244+0900    V4      ----------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-03-04T15:23:36.244+0900    V4      Tasks completed {"duration": "7m50.030420843s"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-03-04T15:23:37.227+0900    V3      Cleaning up long running container      {"name": "eksa_1646374542969789000"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-03-04T15:23:37.228+0900    V6      Executing command       {"cmd": "/usr/local/bin/docker rm -f -v eksa_1646374542969789000"}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ëª‡ê°€ì§€ ê²½í—˜í•œ ì—ëŸ¬ ì‚¬í•­ì„ ë‚˜ì—´í•´ ë³´ë©´ ìœ„ì—ì„œë„ ì–¸ê¸‰í•œ ë‚´ìš©ê³¼ ê°™ì´ Cluster ì»¨í”¼ê·¸ ë‚´ <code>vSphere thumbprint</code>ë¥¼ ë°˜ë“œì‹œ ë„£ì–´ì£¼ëŠ”ê²ƒì´ ì¢‹ë‹¤. ê³µì‹ ê°€ì´ë“œì—ëŠ” <code>insecure</code> í•„ë“œë¥¼ trueë¡œ ì„¤ì •í•˜ê³  <code>thumbprint</code>ë¥¼ nullë¡œ ì§„í–‰í•  ê²½ìš° ì•„ë˜ì™€ ê°™ì´ kubeconfg secretì„ êµ¬ì„±ë‹¨ê³„ì—ì„œ ì‹¤íŒ¨í•˜ê±°ë‚˜ Workload ë…¸ë“œê°€ joiní•  ë•Œ ì—ëŸ¬ê°€ ë°œìƒí•˜ê²Œ ëœë‹¤.  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ eksctl anywhere create cluster -f eksa-mgmt-cluster.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">collecting management cluster diagnostics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â³ Collecting support bundle from cluster, this can take a while {"cluster": "bootstrap-cluster", "bundle": "mgmt/generated/bootstrap-cluster-2022-03-02T23:25:32+09:00-bundle.yaml", "since": 1646227532274217000, "kubeconfig": "mgmt/generated/mgmt.kind.kubeconfig"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Support bundle archive created  {"path": "support-bundle-2022-03-02T14_25_34.tar.gz"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Analyzing support bundle    {"bundle": "mgmt/generated/bootstrap-cluster-2022-03-02T23:25:32+09:00-bundle.yaml", "archive": "support-bundle-2022-03-02T14_25_34.tar.gz"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Analysis output generated   {"path": "mgmt/generated/bootstrap-cluster-2022-03-02T23:27:23+09:00-analysis.yaml"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">collecting workload cluster diagnostics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Error: failed to create cluster: error checking availability of kubeconfig secret: kubeconfig secret does not exist</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì •ìƒì ìœ¼ë¡œ í´ëŸ¬ìŠ¤í„° ë°°í¬ê°€ ë˜ì—ˆìœ¼ë©´ eksctl config yamlì´ í¬í•¨ëœ ë””ë ‰í† ë¦¬ í•˜ìœ„ì— í´ëŸ¬ìŠ¤í„° ì´ë¦„ìœ¼ë¡œ ìƒˆë¡œìš´ ë””ë ‰í† ë¦¬ì™€ <code>kubeconfig</code>ì™€ ì‹¤ì œ ë°°í¬ëœ cluster configë¥¼ í™•ì¸ í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; tree</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€â”€ homelab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚   â”œâ”€â”€ homelab-eks-a-cluster.kubeconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚   â””â”€â”€ homelab-eks-a-cluster.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€â”€ homelab.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê¸°ì¡´ kubeconfigì™€ mergeë¥¼ ìœ„í•´ <a href="https://github.com/kubernetes-sigs/krew" target="_blank" rel="noopener noreferrer">krew</a>ë¥¼ í†µí•´ ì„¤ì¹˜í•œ  <a href="https://github.com/corneliusweig/konfig" target="_blank" rel="noopener noreferrer">konfig</a> ë„êµ¬ë¥¼ ì‚¬ìš©í•´ì„œ ê¸°ì¡´ ì»¨í”¼ê·¸ì™€ ë³‘í•©í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl konfig merge ~/.kube/config ./homelab/homelab-eks-a-cluster.kubeconfig &gt; merged-and-flattened-config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; mv merged-and-flattened-config ~/.kube/config</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìƒì„±ëœ ë¦¬ì†ŒìŠ¤ë¥¼ í™•ì¸í•´ë³´ë©´ <code>Bottlerocket</code> OS ì´ë¯¸ì§€ì™€ <code>containerd://1.5.8+bottlerocket</code> CRIë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ë…¸ë“œ ì´ë¦„ì´ IPë¡œ ë³´ì´ëŠ” ì´ìœ ëŠ” DHCPì„œë²„ë¥¼ ë³„ë„ë¡œ ë‘ì§€ ì•Šì•„ Prefix í• ë‹¹ì´ ë˜ì§€ ì•ŠëŠ” ê°€ì •ìš© ê³µìœ ê¸° í™˜ê²½ì—ì„œ ë°œìƒí•˜ëŠ” í˜„ìƒì´ë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl get node -o wide</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME             STATUS   ROLES                  AGE     VERSION   INTERNAL-IP      EXTERNAL-IP      OS-IMAGE                                  KERNEL-VERSION   CONTAINER-RUNTIME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.31.186   Ready    control-plane,master   9m     v1.21.6   192.168.31.186   192.168.31.186   Bottlerocket OS 1.5.3 (vmware-k8s-1.21)   5.10.93          containerd://1.5.8+bottlerocket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.31.187   Ready    &lt;none&gt;                 8m     v1.21.6   192.168.31.187   192.168.31.187   Bottlerocket OS 1.5.3 (vmware-k8s-1.21)   5.10.93          containerd://1.5.8+bottlerocket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.31.188   Ready    &lt;none&gt;                 7m     v1.21.6   192.168.31.188   192.168.31.188   Bottlerocket OS 1.5.3 (vmware-k8s-1.21)   5.10.93          containerd://1.5.8+bottlerocket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.31.189   Ready    control-plane,master   7m     v1.21.6   192.168.31.189   192.168.31.189   Bottlerocket OS 1.5.3 (vmware-k8s-1.21)   5.10.93          containerd://1.5.8+bottlerocket</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>CRD ë¦¬ìŠ¤íŠ¸ë¥¼ í™•ì¸í•´ë³´ì. ë§ì€ CRDì¤‘ì— <code>x-k8s.io</code>ë¡œ í•„í„°ë¥¼ í•˜ë©´ <code>machine</code>, <code>vsphere</code>, <code>cluster</code> ê´€ë ¨ëœ ì •ë³´ë¥¼ í™•ì¸í• ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl get crd | grep "x-k8s.io"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusterclasses.cluster.x-k8s.io                              2022-03-04T14:30:28Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusterresourcesetbindings.addons.cluster.x-k8s.io           2022-03-04T14:30:28Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusterresourcesets.addons.cluster.x-k8s.io                  2022-03-04T14:30:28Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusters.cluster.x-k8s.io                                    2022-03-04T14:30:28Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">etcdadmclusters.etcdcluster.cluster.x-k8s.io                 2022-03-04T14:30:41Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">etcdadmconfigs.bootstrap.cluster.x-k8s.io                    2022-03-04T14:30:38Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubeadmconfigs.bootstrap.cluster.x-k8s.io                    2022-03-04T14:30:34Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubeadmconfigtemplates.bootstrap.cluster.x-k8s.io            2022-03-04T14:30:34Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubeadmcontrolplanes.controlplane.cluster.x-k8s.io           2022-03-04T14:30:45Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubeadmcontrolplanetemplates.controlplane.cluster.x-k8s.io   2022-03-04T14:30:47Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">machinedeployments.cluster.x-k8s.io                          2022-03-04T14:30:29Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">machinehealthchecks.cluster.x-k8s.io                         2022-03-04T14:30:29Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">machinepools.cluster.x-k8s.io                                2022-03-04T14:30:30Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">machines.cluster.x-k8s.io                                    2022-03-04T14:30:30Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">machinesets.cluster.x-k8s.io                                 2022-03-04T14:30:30Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">providers.clusterctl.cluster.x-k8s.io                        2022-03-04T14:27:56Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vsphereclusteridentities.infrastructure.cluster.x-k8s.io     2022-03-04T14:30:51Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vsphereclusters.infrastructure.cluster.x-k8s.io              2022-03-04T14:30:52Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vsphereclustertemplates.infrastructure.cluster.x-k8s.io      2022-03-04T14:30:52Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vspheredeploymentzones.infrastructure.cluster.x-k8s.io       2022-03-04T14:30:52Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vspherefailuredomains.infrastructure.cluster.x-k8s.io        2022-03-04T14:30:53Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vspheremachines.infrastructure.cluster.x-k8s.io              2022-03-04T14:30:53Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vspheremachinetemplates.infrastructure.cluster.x-k8s.io      2022-03-04T14:30:53Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vspherevms.infrastructure.cluster.x-k8s.io                   2022-03-04T14:30:54Z</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´ì¤‘ <code>machine</code> CRDë¥¼ í™•ì¸í•´ë³´ë©´ etcdë¥¼ ë³¼ ìˆ˜ ìˆëŠ”ë° ì´ëŠ” VMì¸ìŠ¤í„´ìŠ¤ í˜•íƒœì˜ ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ í˜•íƒœë¡œ ë°°í¬ë˜ê¸° ë•Œë¬¸ì— ì¿ ë²„ë„¤í‹°ìŠ¤ ë…¸ë“œ ì •ë³´ì—ì„œëŠ” í™•ì¸í• ìˆ˜ ì—†ë˜ <code>etcd</code> ë¨¸ì‹ ì„ í™•ì¸ì„ í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl get machine -A</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAMESPACE     NAME                            CLUSTER   NODENAME         PROVIDERID                                       PHASE     AGE     VERSION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eksa-system   homelab-etcd-jrhvt              homelab                    vsphere://421b44b1-6017-8469-734b-01bcf68cb459   Running   11m     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eksa-system   homelab-j5mql                   homelab   192.168.31.186   vsphere://421b4382-0727-3afc-5c47-b73455010d35   Running   11m     v1.21.5-eks-1-21-8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eksa-system   homelab-md-0-76478bb486-jszj4   homelab   192.168.31.187   vsphere://421b4dc9-b7c6-f0a2-0b50-e5379748b9a9   Running   11m     v1.21.5-eks-1-21-8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eksa-system   homelab-md-0-76478bb486-rpxlm   homelab   192.168.31.188   vsphere://421b20a4-9870-cd20-4cff-67bb4a9d8372   Running   11m     v1.21.5-eks-1-21-8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eksa-system   homelab-w6bq8                   homelab   192.168.31.189   vsphere://421befe9-e26a-3f18-9ccf-3fe32dd57fd2   Running   11m     v1.21.5-eks-1-21-8</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´ˆê¸° êµ¬ì„± íŒŒë“œë“¤ì„ ì‚´í´ë³´ë©´ CAPI ê´€ë ¨ ë¦¬ì†ŒìŠ¤, cert-manager, eks-anywhere, Cilium CNI, vSphere ê´€ë ¨ ì»¨íŠ¸ë¡¤ëŸ¬ ë“±ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl get pod -A</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAMESPACE                           NAME                                                             READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">capi-kubeadm-bootstrap-system       capi-kubeadm-bootstrap-controller-manager-694cc79bb7-2h29c       1/1     Running   0          3h42m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">capi-kubeadm-control-plane-system   capi-kubeadm-control-plane-controller-manager-5b6b48dd8c-g6md4   1/1     Running   0          3h42m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">capi-system                         capi-controller-manager-689cd9b4fd-vxpc8                         1/1     Running   0          3h42m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">capv-system                         capv-controller-manager-6b467446b9-n865b                         1/1     Running   0          3h42m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cert-manager                        cert-manager-7988d4fb6c-72fw7                                    1/1     Running   0          3h44m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cert-manager                        cert-manager-cainjector-6bc8dcdb64-7d7qg                         1/1     Running   0          3h44m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cert-manager                        cert-manager-webhook-68979bfb95-hjq8m                            1/1     Running   0          3h44m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eksa-system                         eksa-controller-manager-5c74596687-45v8t                         2/2     Running   0          3h41m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">etcdadm-bootstrap-provider-system   etcdadm-bootstrap-provider-controller-manager-74c86ffb56-cpw9k   1/1     Running   0          3h42m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">etcdadm-controller-system           etcdadm-controller-controller-manager-7894945688-js7z4           1/1     Running   0          3h42m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         cilium-bq5gq                                                     1/1     Running   0          3h44m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         cilium-fn2f7                                                     1/1     Running   0          3h44m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         cilium-lgptt                                                     1/1     Running   0          3h44m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         cilium-operator-86d59d5c88-76z2t                                 1/1     Running   1          3h44m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         cilium-operator-86d59d5c88-9p4s9                                 1/1     Running   0          3h44m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         cilium-w55nc                                                     1/1     Running   0          68m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         cilium-wk89j                                                     1/1     Running   0          68m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         coredns-745c7986c7-k729b                                         1/1     Running   0          3h46m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         coredns-745c7986c7-thtbm                                         1/1     Running   0          3h46m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         kube-apiserver-192.168.31.189                                    1/1     Running   0          3h46m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         kube-controller-manager-192.168.31.189                           1/1     Running   0          3h46m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         kube-proxy-6xcdk                                                 1/1     Running   0          3h44m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         kube-proxy-d4qbv                                                 1/1     Running   0          68m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         kube-proxy-mhzb4                                                 1/1     Running   0          3h46m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         kube-proxy-vrw2p                                                 1/1     Running   0          68m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         kube-proxy-xkfmh                                                 1/1     Running   0          3h44m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         kube-scheduler-192.168.31.189                                    1/1     Running   0          3h46m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         kube-vip-192.168.31.189                                          1/1     Running   0          3h46m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         vsphere-cloud-controller-manager-bxp4t                           1/1     Running   2          68m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         vsphere-cloud-controller-manager-jdncv                           1/1     Running   3          3h44m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         vsphere-cloud-controller-manager-jhbbp                           1/1     Running   2          3h44m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         vsphere-cloud-controller-manager-jpn89                           1/1     Running   2          68m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         vsphere-cloud-controller-manager-qblld                           1/1     Running   1          3h46m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         vsphere-csi-controller-576c9c8dc8-9k2lm                          5/5     Running   0          3h46m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         vsphere-csi-node-9fbs2                                           3/3     Running   0          68m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         vsphere-csi-node-ffjlv                                           3/3     Running   0          3h44m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         vsphere-csi-node-lrkqk                                           3/3     Running   0          68m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         vsphere-csi-node-s49x6                                           3/3     Running   0          3h46m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system                         vsphere-csi-node-z5hdz                                           3/3     Running   0          3h44m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ë¡œë“œë°¸ëŸ°ì„œ-êµ¬ì„±">ë¡œë“œë°¸ëŸ°ì„œ êµ¬ì„±<a class="hash-link" href="#ë¡œë“œë°¸ëŸ°ì„œ-êµ¬ì„±" title="Direct link to heading">â€‹</a></h2><p>ì¿ ë²„ë„¤í‹°ìŠ¤ v1.14.2 ì´í›„ ë²„ì „ë¶€í„°ëŠ” <code>IPVS</code>ëª¨ë“œì—ì„œ kube-proxy ì‚¬ìš©ì„ ìœ„í•´ MetalLB êµ¬ì„±ì „ì— <a href="https://metallb.universe.tf/installation/#preparation" target="_blank" rel="noopener noreferrer">strict ARP ëª¨ë“œë¥¼ í™œì„±í™”</a>í•´ì•¼í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl get configmap kube-proxy -n kube-system -o yaml | \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sed -e "s/strictARP: false/strictARP: true/" | \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f - -n kube-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl describe configmap -n kube-system kube-proxy | grep ARP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  strictARP: true</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë¯¸ë¦¬ ì„œë¹„ìŠ¤ì—ì„œ ì‚¬ìš©í•  IP ëŒ€ì—­ì„ ì§€ì •í•˜ê¸° ìœ„í•´ helm chart configmap valueë¥¼ ë¯¸ë¦¬ ìƒì„±í•œë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt; 'EOF' &gt;&gt; values.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">configInline:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  address-pools:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      protocol: layer2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      addresses:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - 192.168.31.10-192.168.31.19</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>metallbê°€ ì‚¬ìš©í•  ë„¤ì„ìŠ¤í˜ì´ìŠ¤ <code>metallb-system</code>ë¥¼ ë§Œë“¤ê³  ìœ„ configmap valueíŒŒì¼ë¡œ metalLBë¥¼ ì„¤ì¹˜í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; helm repo add metallb https://metallb.github.io/metallb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl create ns metallb-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; helm install metallb metallb/metallb -n metallb-system -f values.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl get all -n metallb-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                      READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/metallb-controller-69bbb4669c-2pdnk   1/1     Running   0          115s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/metallb-speaker-2km46                 1/1     Running   0          115s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/metallb-speaker-cm9xw                 1/1     Running   0          115s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/metallb-speaker-dptbx                 1/1     Running   0          115s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/metallb-speaker-jk7hn                 1/1     Running   0          115s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/metallb-speaker-kgfkl                 1/1     Running   0          115s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/metallb-speaker-t7qkw                 1/1     Running   0          115s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                             DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR            AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">daemonset.apps/metallb-speaker   6         6         6       6            6           kubernetes.io/os=linux   115s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                 READY   UP-TO-DATE   AVAILABLE   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment.apps/metallb-controller   1/1     1            1           115s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                            DESIRED   CURRENT   READY   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">replicaset.apps/metallb-controller-69bbb4669c   1         1         1       115s</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>metallb ë¦¬ì†ŒìŠ¤ê°€ ëª¨ë‘ ì •ìƒìœ¼ë¡œ ì˜¬ë¼ì˜¤ë©´ ì„œë¹„ìŠ¤ í•˜ë‚˜ë¥¼ LoadBalancer íƒ€ì…ìœ¼ë¡œ ë°°í¬í•˜ê³  í•´ë‹¹ ì„œë¹„ìŠ¤ë¡œ ì ‘ì†í•´ë³¸ë‹¤.  </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl apply -f https://anywhere.eks.amazonaws.com/manifests/hello-eks-a.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl expose deployment hello-eks-a --port=80 --type=LoadBalancer --name=hello-eks-a-lb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; SVC1EXIP=$(kubectl get svc hello-eks-a-lb -o jsonpath='{.status.loadBalancer.ingress[0].ip}')</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; curl $SVC1EXIP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Thank you for using</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—                                             </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â•â•â•â•â•                                             </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—                                             </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•— â•šâ•â•â•â•â–ˆâ–ˆâ•‘                                             </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘                                             </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•                                             </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                                     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘ â–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â•šâ–ˆâ–ˆâ•”â•  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â•šâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•â•   â•šâ•â•    â•šâ•â•â•â•šâ•â•â• â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                                     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">You have successfully deployed the hello-eks-a pod hello-eks-a-9644dd8dc-647bq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">For more information check out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https://anywhere.eks.amazonaws.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢â¬¡â¬¢</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì¸ê·¸ë ˆìŠ¤-ì»¨íŠ¸ë¡¤ëŸ¬-ì„¤ì¹˜">ì¸ê·¸ë ˆìŠ¤ ì»¨íŠ¸ë¡¤ëŸ¬ ì„¤ì¹˜<a class="hash-link" href="#ì¸ê·¸ë ˆìŠ¤-ì»¨íŠ¸ë¡¤ëŸ¬-ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h2><p>API Gateway ì˜¤í”ˆì†ŒìŠ¤ì¸ <a href="https://docs.solo.io/gloo-edge/latest/" target="_blank" rel="noopener noreferrer">Gloo Edge</a>ë¥¼ ì¸ê·¸ë ˆìŠ¤ ì»¨íŠ¸ë¡¤ëŸ¬ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. <code>Envoy</code> ê¸°ë°˜ì˜ ê²½ëŸ‰í™”ëœ ì˜¤í”ˆì†ŒìŠ¤ë¡œ ì¿ ë²„ë„¤í‹°ìŠ¤ ë„¤ì´í‹°ë¸Œí•œ ì˜µì…˜ë“¤ì„ ì œê³µí•˜ê¸° ë•Œë¬¸ì— ê°œì¸ì ìœ¼ë¡œ ì„ í˜¸í•˜ëŠ”í¸ì´ë‹¤. ê³µì‹ ì„¤ì¹˜ ë¬¸ì„œëŠ” ë‹¤ìŒ ë§í¬ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><p><a href="https://docs.solo.io/gloo-edge/latest/installation/ingress/" target="_blank" rel="noopener noreferrer">https://docs.solo.io/gloo-edge/latest/installation/ingress/</a></p><p>ê³µì‹ CLIì¸ <a href="https://docs.solo.io/gloo-edge/latest/installation/ingress/#installing-on-kubernetes-with-glooctl" target="_blank" rel="noopener noreferrer">glooctl</a>ë‚˜ <a href="https://docs.solo.io/gloo-edge/latest/installation/ingress/#installing-on-kubernetes-with-helm" target="_blank" rel="noopener noreferrer">Helm Chart</a>ë¡œ ì„¤ì¹˜ë¥¼ ì§„í–‰í•  ìˆ˜ ìˆë‹¤. ingressë¥¼ êµ¬ì„±í•˜ê¸° ìœ„í•´ <code>gateway.enabled</code> valueê°’ì„ <code>false</code>ë¡œ <code>ingress.enabled</code> valueë¥¼ <code>true</code>ë¡œ ë³€ê²½í•˜ì—¬ inline êµ¬ì„±ìœ¼ë¡œ ë°°í¬ë¥¼ ì§„í–‰í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">helm repo add gloo https://storage.googleapis.com/solo-public-helm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm repo update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create namespace gloo-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install gloo gloo/gloo --namespace gloo-system \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --set gateway.enabled=false,ingress.enabled=true</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl get all -n gloo-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                 READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/discovery-9694c78f6-zrf4l        1/1     Running   0          88s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/gloo-7cd566cb69-bfghh            1/1     Running   0          88s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/ingress-7fb5c9687d-qq98j         1/1     Running   0          88s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/ingress-proxy-5cc555c45b-9mj9n   1/1     Running   0          88s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                    TYPE           CLUSTER-IP      EXTERNAL-IP     PORT(S)                               AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service/gloo            ClusterIP      10.100.162.70   &lt;none&gt;          9977/TCP,9976/TCP,9988/TCP,9979/TCP   88s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service/ingress-proxy   LoadBalancer   10.107.107.38   192.168.31.11   80:32207/TCP,443:32228/TCP            88s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                            READY   UP-TO-DATE   AVAILABLE   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment.apps/discovery       1/1     1            1           88s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment.apps/gloo            1/1     1            1           88s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment.apps/ingress         1/1     1            1           88s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment.apps/ingress-proxy   1/1     1            1           88s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                       DESIRED   CURRENT   READY   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">replicaset.apps/discovery-9694c78f6        1         1         1       88s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">replicaset.apps/gloo-7cd566cb69            1         1         1       88s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">replicaset.apps/ingress-7fb5c9687d         1         1         1       88s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">replicaset.apps/ingress-proxy-5cc555c45b   1         1         1       88s</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìƒ˜í”Œ <code>petstore</code> ì„œë¹„ìŠ¤ë¥¼ ë°°í¬í•˜ê³ , ì¸ê·¸ë ˆìŠ¤ í´ë˜ìŠ¤ ì–´ë…¸í…Œì´ì…˜ì„ <code>kubernetes.io/ingress.class: gloo</code>ë¡œ ì„ ì–¸í•˜ê³  <code>ddiiwoong.com</code> í˜¸ìŠ¤íŠ¸ ì´ë¦„ìœ¼ë¡œ ë°°í¬í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  https://raw.githubusercontent.com/solo-io/gloo/v1.2.9/example/petstore/petstore.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt;EOF | kubectl apply -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: networking.k8s.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Ingress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> name: petstore-ingress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> annotations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # note: this annotation is only required if you've set </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # REQUIRE_INGRESS_CLASS=true in the environment for </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # the ingress deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kubernetes.io/ingress.class: gloo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  rules:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - host: ddiiwoong.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    http:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      paths:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - path: /.*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pathType: ImplementationSpecific</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        backend:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          service:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            name: petstore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            port:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              number: 8080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl get ingress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME               CLASS    HOSTS           ADDRESS         PORTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">petstore-ingress   &lt;none&gt;   ddiiwoong.com   192.168.31.11   80      7m41s</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í•´ë‹¹ í˜¸ìŠ¤íŠ¸ë¡œ ì •ìƒ ë¼ìš°íŒ…ë˜ì–´ ì ‘ì†ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; curl -H "Host: ddiiwoong.com" 192.168.31.11/api/pets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[{"id":1,"name":"Dog","status":"available"},{"id":2,"name":"Cat","status":"pending"}]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="gitops-ì»¨íŠ¸ë¡¤ëŸ¬ë¡œ-í´ëŸ¬ìŠ¤í„°-ê´€ë¦¬">GitOps ì»¨íŠ¸ë¡¤ëŸ¬ë¡œ í´ëŸ¬ìŠ¤í„° ê´€ë¦¬<a class="hash-link" href="#gitops-ì»¨íŠ¸ë¡¤ëŸ¬ë¡œ-í´ëŸ¬ìŠ¤í„°-ê´€ë¦¬" title="Direct link to heading">â€‹</a></h2><p>gitops ì˜¤í”ˆì†ŒìŠ¤ì¸ <a href="https://fluxcd.io/docs/get-started/" target="_blank" rel="noopener noreferrer">Flux</a>ë¥¼ ì‚¬ìš©í•´ì„œ ì—¬ëŸ¬ê°€ì§€ í´ëŸ¬ìŠ¤í„° ê´€ë¦¬ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤. ìœ„ì—ì„œ ìƒì„±í•œ <code>desired state</code>ì¸ í´ëŸ¬ìŠ¤í„° ì»¨í”¼ê·¸ë¥¼ github repoì—ì„œ Flux ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í†µí•´ í´ëŸ¬ìŠ¤í„° ìš´ì˜ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤. </p><p><a href="https://anywhere.eks.amazonaws.com/docs/tasks/cluster/cluster-flux/" target="_blank" rel="noopener noreferrer">https://anywhere.eks.amazonaws.com/docs/tasks/cluster/cluster-flux/</a></p><p>Worker ë…¸ë“œì™€ Control Plan, Etcdë“±ì˜ vSphereì—ì„œ ê´€ë¦¬í•˜ëŠ” datastore, ë””ìŠ¤í¬, ë©”ëª¨ë¦¬, CPU, resourcepool ë“±ì„ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤. ë‹¨, EKSì˜ ê´€ë¦¬í˜• ë…¸ë“œê·¸ë£¹ê³¼ ìœ ì‚¬í•œ ë°©ì‹ìœ¼ë¡œ ë…¸ë“œê·¸ë£¹ì˜ VMì˜ ìˆ«ìë¥¼ ëŠ˜ë¦¬ê±°ë‚˜ ì¤„ì¼ìˆ˜ ìˆì§€ë§Œ ì•„ì§ê¹Œì§€ ì‹ ê·œë¡œ worker ë…¸ë“œê·¸ë£¹ì„ ìƒì„±í•˜ê±°ë‚˜ ì‚­ì œí•˜ëŠ” ê¸°ëŠ¥ì€ ì œê³µí•˜ì§€ ì•ŠëŠ”ë‹¤.</p><p>ì´ˆê¸° í´ëŸ¬ìŠ¤í„° ì»¨í”¼ê·¸ì— ì•„ë˜ì™€ ê°™ì´ ê¸°ì¡´ ë…¸ë“œê·¸ë£¹ <code>md-0</code>ì— ì‹ ê·œ VM 1ëŒ€ë¥¼ ì¶”ê°€í•´ë³´ì. (2ëŒ€-&gt;3ëŒ€)</p><ul><li><code>clusters/$CLUSTER_NAME/eksa-system/eksa-cluster.yaml</code></li></ul><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> anywhere.eks.amazonaws.com/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> homelab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">workerNodeGroupConfigurations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">count</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">machineGroupRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> VSphereMachineConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> homelab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> md</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´ˆê¸° í™˜ê²½ì—ì„œ êµ¬ì„±ëœ gitops repoì— ìˆ˜ì •ëœ íŒŒì¼ì„ ì»¤ë°‹í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">git add clusters/homelab/eksa-system/eksa-cluster.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git commit -m 'Scale from 2 to 3 at WorkerNodeGroup md-0 '</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git push origin main</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>md-0</code> ë…¸ë“œê·¸ë£¹ì— VMì´ ìƒˆë¡­ê²Œ ì¶”ê°€ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl get machine -n eksa-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                            CLUSTER   NODENAME         PROVIDERID                                       PHASE     AGE   VERSION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">homelab-etcd-jrhvt              homelab                    vsphere://421b44b1-6017-8469-734b-01bcf68cb459   Running   75m   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">homelab-j5mql                   homelab   192.168.31.186   vsphere://421b4382-0727-3afc-5c47-b73455010d35   Running   75m   v1.21.5-eks-1-21-8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">homelab-md-0-76478bb486-j68fd   homelab   192.168.31.190   vsphere://421bc1ee-eac7-f1db-b351-5fac25b45fc0   Running   11m   v1.21.5-eks-1-21-8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">homelab-md-0-76478bb486-jszj4   homelab   192.168.31.187   vsphere://421b4dc9-b7c6-f0a2-0b50-e5379748b9a9   Running   75m   v1.21.5-eks-1-21-8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">homelab-md-0-76478bb486-rpxlm   homelab   192.168.31.188   vsphere://421b20a4-9870-cd20-4cff-67bb4a9d8372   Running   75m   v1.21.5-eks-1-21-8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">homelab-w6bq8                   homelab   192.168.31.189   vsphere://421befe9-e26a-3f18-9ccf-3fe32dd57fd2   Running   75m   v1.21.5-eks-1-21-8</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” eks-anywhere ì˜¤í”ˆì†ŒìŠ¤ë¥¼ vSphere í™ˆì„œë²„ì—ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•œ ê²½í—˜ì„ ì •ë¦¬í–ˆë‹¤. </p><p>ì„¤ì¹˜ë¥¼ ì§„í–‰í•˜ë©´ì„œ ì—ëŸ¬ê°€ ë‚˜ë©´ í•˜ë‚˜í•˜ë‚˜ ê³µì‹ ë¬¸ì„œë¥¼ í™•ì¸í•˜ê³ , íšŒì‚¬ ìŠ¬ë™ ì°¬ìŠ¤ë„ ì‚¬ìš©í•˜ë©´ì„œ í˜ë“¤ê²Œ ì„¤ì¹˜ë¥¼ ì™„ë£Œí–ˆë‹¤. ìƒê°ë³´ë‹¤ ë””ë²„ê¹…ì„ í•˜ëŠ”ë° ë§ì€ ì‹œê°„ì„ í—ˆë¹„í–ˆëŠ”ë° ì‹¤ì œë¡œ 2ì¼ ì´ìƒ ê³ ìƒì„ í–ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ë””ë²„ê·¸ ë ˆë²¨ì˜ ë¡œê·¸ë¥¼ ë³´ë©´ì„œ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…ì„ í†µí•´ ë¬¸ì œ í•´ê²°ì´ ê°€ëŠ¥í–ˆê³  ê·¸ ê³¼ì •ì—ì„œ EKS Anywhereì˜ ë‚´ë¶€ êµ¬ì„±ìš”ì†Œë“¤ê³¼ ì‹¤ì œ Cluster API ì›Œí¬í”Œë¡œìš°ë¥¼ ì´í•´í•  ìˆ˜ ìˆì—ˆë‹¤. </p><p>ë‹¤ë§Œ ì•„ì§ê¹Œì§€ ë¬¸ì„œí™”ë‚˜ ì»¤ë®¤ë‹ˆí‹°ì— ë§ì€ ìœ ìŠ¤ì¼€ì´ìŠ¤ê°€ ì—†ë‹¤ëŠ” ì ê³¼ Ciliumì„ ë©”ì¸ CNIë¡œ í™œìš©í•¨ì—ë„ ë¶ˆêµ¬í•˜ê³  <code>CiliumNetworkPolicy</code> APIë¥¼ ì‚¬ìš©í•˜ì§€ ëª»í•˜ëŠ” ì ì´ë‚˜ Cilium ìœ ì € ì¸í„°í˜ì´ìŠ¤ì¸ <a href="https://github.com/cilium/hubble-ui" target="_blank" rel="noopener noreferrer">Hubble UI</a>ë¥¼ í™œì„±í™”í•´ì„œ ì‚¬ìš©í•  ìˆ˜ê°€ ì—†ëŠ” <a href="https://anywhere.eks.amazonaws.com/docs/tasks/workload/networking-and-security/#additional-cilium-features" target="_blank" rel="noopener noreferrer">ì œì•½ì‚¬í•­</a>ë“±ì´ ìˆì—ˆê³ , ì¿ ë²„ë„¤í‹°ìŠ¤ ê´€ë ¨í•´ì„œëŠ” <code>Persistent Volume</code> ê´€ë ¨í•˜ì—¬ vSANì„ ì‚¬ìš©í•˜ì§€ ì•Šì€ í™˜ê²½ì—ì„œëŠ” VMDKë¥¼ ìˆ˜ë™ìœ¼ë¡œ ìƒì„±í•˜ê³  í•´ë‹¹ ë³¼ë¥¨ì„ ë§¤í•‘ì‹œì¼œì•¼ í™œìš©ì´ ê°€ëŠ¥í•œ ì œì•½ì‚¬í•­ì´ ì¡´ì¬í•˜ëŠ” ê²ƒì´ ì¡°ê¸ˆ ì•„ì‰¬ìš´ ë¶€ë¶„ì´ë‹¤.</p><p>ì‹¤ì œ í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ ì‚¬ìš©í•  ì •ë„ë¼ê¸° ë³´ë‹¨ EKSë¥¼ ì‚¬ìš©í•˜ëŠ” ê´€ì ì—ì„œ ìœ ì‚¬í•œ ê²½í—˜ì„ ë°”íƒ•ìœ¼ë¡œ ê°œë°œí™˜ê²½ì„ ê°€ì ¸ê°ˆìˆ˜ ìˆê³  tanzuë‚˜ ë‹¤ë¥¸ cluster-apië¥¼ í™œìš©í•œ ë„êµ¬ë“¤ ë³´ë‹¤ ì¢€ë” ìœ ì—°í•˜ê³  ì˜¤í”ˆì†ŒìŠ¤ì— ê°€ê¹Œìš´ ê²½í—˜ì„±ì„ ì œê³µí•œë‹¤ê³  ìƒê°í•œë‹¤. ê²Œë‹¤ê°€ Fluxì˜ <code>Server-side reconciliation</code> ê¸°ë°˜ <a href="https://kubernetes.io/docs/reference/using-api/server-side-apply/" target="_blank" rel="noopener noreferrer">ì¿ ë²„ë„¤í‹°ìŠ¤ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ ë°©ì‹</a>ìœ¼ë¡œ í´ëŸ¬ìŠ¤í„°ë¥¼ ë§¤ìš° ìœ ì—°í•˜ê²Œ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒë„ ì£¼ëª©í•´ë³¼ë§Œí•œ ë‚´ìš©ì´ë¼ ìƒê°í•œë‹¤. í´ëŸ¬ìŠ¤í„° ìì²´ë„ ì¸í”„ë¼ ë¦¬ì†ŒìŠ¤ë¼ ê°€ì •í•˜ê³  ìµœì´ˆì— ì›í•˜ëŠ” í˜•íƒœë¡œ ì„ ì–¸í•˜ê³  êµ¬ì„±ì´í›„ì—ë„ ì¿ ë²„ë„¤í‹°ìŠ¤ CRD í˜•ì‹ìœ¼ë¡œ ë…¸ë“œê·¸ë£¹ê³¼ ì¸ìŠ¤í„´ìŠ¤ ë“±ì˜ ì—¬ëŸ¬ ë¦¬ì†ŒìŠ¤ë¥¼ GitOps ë°©ì‹ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ” ë°©ì‹ì„ ì±„íƒí•˜ê³  ìˆê¸° ë•Œë¬¸ì— ì‹¤ì œ ì¸í”„ë¼ ê´€ë¦¬ë¥¼ í•˜ëŠ” ìš´ì˜ìë¥¼ ìœ„í•œ ê°€ì¥ íš¨ê³¼ì ì¸ ë°©ë²•ì„ ì±„íƒí–ˆë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤.</p><p>ê·¸ë¦¬ê³  í‘œì¤€ê·œê²©ì˜ Managed í•˜ë“œì›¨ì–´ë¥¼ ì‚¬ìš©í•˜ëŠ” Outpostì™€ ë¹„êµí•˜ëŠ” ìë£Œë“¤ì´ ìµœê·¼ ë§ì´ ì˜¬ë¼ì˜¤ê³  ìˆëŠ”ë° EKS Anywhereì˜ ê°€ì¥ í° ì¥ì ì€ ë‚´ê°€ ê°€ì§„ í•˜ë“œì›¨ì–´ë¥¼ EKS Distroê¸°ë°˜ì˜ ì˜¤í”ˆì†ŒìŠ¤ë¥¼ í†µí•´ ì‚¬ìš©í•  ìˆ˜ ìˆê³  AWS í™˜ê²½ê³¼ì˜ ì§ì ‘ì ì¸ í†µì‹ ì´ ì—†ì´ë„ ìì²´ì ì¸ ì›Œí¬ë¡œë“œ ìš´ì˜ì´ ê°€ëŠ¥í•œê²Œ ê°€ì¥ í° ì¥ì ì´ë¼ê³  ìƒê°í•œë‹¤. </p><p>í˜„ì¬ ì¬ì§ì¤‘ì¸ íšŒì‚¬ì˜ ì œí’ˆê³¼ ê´€ë ¨í•´ì„œ ë¡œë“œë§µì„ ìì„¸íˆ ì–¸ê¸‰í•˜ì§€ëŠ” ëª»í•˜ì§€ë§Œ ì—”í„°í”„ë¼ì´ì¦ˆ vSphere í™˜ê²½ê³¼ ë™ì‹œì— EKSë¥¼ ì‚¬ìš©í•˜ëŠ” ì¡°ì§ì—ì„œëŠ” ì¤‘ìš”í•œ í•˜ë‚˜ì˜ ì„ íƒì§€ê°€ ë  ìˆ˜ ìˆë‹¤ëŠ” ì ì—ì„œë„ ì§€ì¼œë³¼ë§Œí•˜ë‹¤ê³  ìƒê°í•œë‹¤. </p><p>ë‹¤ìŒ í¬ìŠ¤íŒ…ì—ì„œëŠ” í•´ë‹¹ í´ëŸ¬ìŠ¤í„°ì— OpenTelemetry collector, Loki, Prometheus êµ¬ì„±ì„ í†µí•œ observability í™˜ê²½ êµ¬ì„±ì„ ì§„í–‰í•´ë³¼ ì˜ˆì •ì´ë‹¤.</p><blockquote><p>í•´ë‹¹ í¬ìŠ¤íŒ…ì€ í˜„ì¬ ì¬ì§ì¤‘ì¸ íšŒì‚¬ì— ê´€ë ¨ì´ ì—†ê³ , ê°œì¸ ì—­ëŸ‰ ê°œë°œì„ ìœ„í•œ ìë£Œë¡œ í™œìš©í•  ì˜ˆì •ì…ë‹ˆë‹¤.</p></blockquote>]]></content>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="vsphere" term="vsphere"/>
        <category label="eks anywhere" term="eks anywhere"/>
        <category label="eks" term="eks"/>
        <category label="flux" term="flux"/>
        <category label="gitops" term="gitops"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[What is Tailscale?]]></title>
        <id>kubernetes/what-is-tailscale/</id>
        <link href="https://ddii.dev/kubernetes/what-is-tailscale/"/>
        <updated>2022-02-05T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[wireguardì™€ tailscaleì„ ë¹„êµí•˜ê³  kubernetes í™˜ê²½ì—ì„œ í™œìš©ë°©ì•ˆ ê²€í† ]]></summary>
        <content type="html"><![CDATA[<blockquote><p>í•´ë‹¹ í¬ìŠ¤íŒ…ì€ í˜„ì¬ ì¬ì§ì¤‘ì¸ íšŒì‚¬ì— ê´€ë ¨ì´ ì—†ê³ , ê°œì¸ ì—­ëŸ‰ ê°œë°œì„ ìœ„í•œ ìë£Œë¡œ í™œìš©í•  ì˜ˆì •ì…ë‹ˆë‹¤.</p></blockquote><p>ì´ì§ì„ í•˜ê³  ë¸”ë¡œê·¸ì— ì†ì„ ë†“ê³  ìˆë‹¤ê°€ í˜ì´ìŠ¤ë¶ <a href="https://ko-kr.facebook.com/groups/" target="_blank" rel="noopener noreferrer">Kubernetes Korea Group</a>ì— ì˜¬ë¼ì˜¨ <a href="https://gasidaseo.notion.site/c9cd413265ea4ea1b1ae38eb36dfda94" target="_blank" rel="noopener noreferrer">ì¿ ë²„ë„¤í‹°ìŠ¤ ë„¤íŠ¸ì›Œí‚¹ ìŠ¤í„°ë”” ëª¨ì§‘ ê³µê³ </a>ë¥¼ ë³´ê²Œë˜ì—ˆë‹¤. ì´ì§í›„ì— ëŒ€ë¶€ë¶„ì˜ í”„ë¡œì íŠ¸ê°€ ì¿ ë²„ë„¤í‹°ìŠ¤ ê¸°ë°˜ìœ¼ë¡œ ì§„í–‰ë˜ë‹¤ ë³´ë‹ˆ ë„¤íŠ¸ì›Œí¬ ì „ë¬¸ê°€ ì´ì‹  <a href="https://www.facebook.com/jongho.seo.5811" target="_blank" rel="noopener noreferrer">ê°€ì‹œë‹¤</a>ë‹˜ì˜ <a href="https://cloudneta.github.io/" target="_blank" rel="noopener noreferrer">íŒ€ ë¸”ë¡œê·¸</a>ë‚˜ ì´ë‚˜ ì—¬ëŸ¬ ì–‘ì§ˆì˜ ê²Œì‹œê¸€ë“¤ì„ ì°¸ê³ ë§Œ í•˜ë‹¤ê°€ ì¡°ê¸ˆë” ê¹Šì´ í•™ìŠµì„ í•˜ê³  ì‹¶ì–´ ìŠ¤í„°ë””ë¥¼ ì‹ ì²­í–ˆê³ , ê°„ë‹¨í•œ ë©´ì ‘(??)í›„ì— ì •ì‹ìœ¼ë¡œ ìŠ¤í„°ë””ì— ì°¸ì—¬í•˜ê²Œ ë˜ì—ˆë‹¤.  </p><p>ë³¸ë¡ ìœ¼ë¡œ ëŒì•„ê°€ì„œ calico ìŠ¤í„°ë””ë¥¼ ì§„í–‰í•˜ë‹¤ê°€ <a href="https://www.wireguard.com/" target="_blank" rel="noopener noreferrer">wireguard</a>ë¼ëŠ” opensource vpnì„ ì•Œê²Œ ë˜ì—ˆê³  í•´ë‹¹ íŒ¨í‚¤ì§€ë¥¼ ì´ê²ƒì €ê²ƒ í…ŒìŠ¤íŠ¸í•˜ë‹¤ê°€ ê¸°ì¡´ì— ì‚¬ìš©ì¤‘ì¸ <a href="https://tailscale.com/" target="_blank" rel="noopener noreferrer">tailscale</a> ê³¼ ìœ ì‚¬í•˜ë‹¤ëŠ” ê²ƒì„ ì¸ì§€í•˜ê³  ë‚´ë¶€ êµ¬ì„±ì„ ì¡°ê¸ˆ ì°¾ì•„ë³´ê¸°ë¡œ í–ˆë‹¤.  </p><p>í™•ì¸í•´ë³´ë‹ˆ tailscaleì€ wireguard ê¸°ë°˜ìœ¼ë¡œ í•˜ëŠ” ë™ì¼ ê¸°ìˆ ì˜ ìƒìš© ì†”ë£¨ì…˜ì´ì˜€ê³ , ì´ì— ëª‡ê°€ì§€ ê³µë¶€ì°¨ ì •ë¦¬ë¥¼ ìœ„í•´ í•´ë‹¹ í¬ìŠ¤íŠ¸ë¥¼ ì‘ì„±í•˜ê²Œ ë˜ì—ˆë‹¤. </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="wireguard">Wireguard<a class="hash-link" href="#wireguard" title="Direct link to heading">â€‹</a></h2><ul><li><a href="https://www.wireguard.com/" target="_blank" rel="noopener noreferrer">https://www.wireguard.com/</a></li></ul><p>ë¨¼ì € WireGuardë¥¼ ê°„ë‹¨í•˜ê²Œ ì •ì˜í•˜ë©´ ë³´ì•ˆì— ì´ˆì ì„ ë‘ê³  ë‹¨ìˆœí•¨ê³¼ ì‰¬ìš´ ì‚¬ìš©ì„ ëŒ€í‘œì ì¸ íŠ¹ì§•ìœ¼ë¡œ ë‚´ì„¸ìš°ëŠ” ì˜¤í”ˆì†ŒìŠ¤ ê¸°ë°˜ VPN ì†Œí”„íŠ¸ì›¨ì–´ë¡œ IPsecê³¼ OpenVPNë³´ë‹¤ ì‚¬ìš©í•˜ê¸° ìš©ì´í•˜ê³  ê°€ë²¼ìš´ ê²ƒì„ ê°•ì ìœ¼ë¡œ <a href="https://lore.kernel.org/wireguard/CAHmME9qOpDeraWo5rM31EWQW574KEduRBTL-+0A2ZyqBNDeYkg@mail.gmail.com/T/#u" target="_blank" rel="noopener noreferrer">Linux 5.6 ì»¤ë„ ì´í›„ë¶€í„° ê¸°ë³¸ íŒ¨í‚¤ì§€</a>ë¡œ íƒ‘ì¬ê°€ ë˜ì—ˆë‹¤. ì œì´ìŠ¨ ë„ë„¨í•„ë“œ(Jason Donenfeld, <a href="https://twitter.com/zx2c4" target="_blank" rel="noopener noreferrer">@zx2c4</a>)ê°€ ì„¤ê³„í•œ WireGuardëŠ” ì•”í˜¸í™” ë¯¼ì²©ì„±, ì¦‰ ë‹¤ì–‘í•œ ì•”í˜¸í™”, í‚¤ êµí™˜, í•´ì‹± ì•Œê³ ë¦¬ì¦˜ì— ëŒ€í•œ ì„ íƒê¶Œì„ ì œê³µí•œë‹¤ëŠ” ê°œë…ì„ ë²„ë¦¬ê³  ì•„ì£¼ ê°„ê²°í•œ ì½”ë“œ êµ¬ì¡°ë¥¼ í†µí•´ ì»¤ë„ì—ì„œ ì§ì ‘ ë™ì‘í•˜ê³  ì£¼ìš” ì•”í˜¸ ì•Œê³ ë¦¬ì¦˜ì— ëŒ€í•´ì„œ ë³‘ë ¬ì²˜ë¦¬í•˜ë¯€ë¡œ ë¹ ë¥¸ ì†ë„ë¥¼ ìë‘í•œë‹¤.  </p><p>í™ˆí˜ì´ì§€ì— ê²Œì‹œëœ ëª‡ê°€ì§€ íŠ¹ì§•ì„ ì •ë¦¬í•˜ë©´ </p><ul><li>Simple &amp; Easy-to-use : SSH ì²˜ëŸ¼ í‚¤êµí™˜ ë°©ì‹ìœ¼ë¡œ ì§„í–‰ë˜ê³  WireGuardì— ì˜í•´ ê´€ë¦¬ë˜ê¸° ë•Œë¬¸ì— ì‰½ê²Œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ê³ , IPê°€ ë³€ê²½ë˜ëŠ” ëª¨ë°”ì¼ ë¡œë°ì¤‘ì—ì„œ ì—°ê²°ì´ ë³´ì¥ë˜ëŠ” ê²ƒì´ íŠ¹ì§•ì´ë‹¤. </li><li>Cryptographically Sound : <a href="http://www.noiseprotocol.org/" target="_blank" rel="noopener noreferrer">Noise protocol framework</a>, <a href="http://cr.yp.to/ecdh.html" target="_blank" rel="noopener noreferrer">Curve25519</a>, <a href="http://cr.yp.to/chacha.html" target="_blank" rel="noopener noreferrer">ChaCha20</a>, <a href="http://cr.yp.to/mac.html" target="_blank" rel="noopener noreferrer">Poly1305</a>, <a href="https://blake2.net/" target="_blank" rel="noopener noreferrer">BLAKE2</a>, <a href="https://131002.net/siphash/" target="_blank" rel="noopener noreferrer">SipHash24</a>, <a href="https://eprint.iacr.org/2010/264" target="_blank" rel="noopener noreferrer">HKDF</a> ì™€ ê°™ì€ ê°€ì¥ ë¹ ë¥´ê³  ìµœì‹ ì˜ ì•”í˜¸, í•´ì‹œ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•œë‹¤.  </li><li>Minimal Attack Surface : WireGuardëŠ” êµ¬í˜„ ìš©ì´ì„±ê³¼ ë‹¨ìˆœì„±ì„ ì—¼ë‘ì— ë‘ê³  ì„¤ê³„ë˜ì—ˆë‹¤. ë§¤ìš° ì ì€ ì½”ë“œ ë¼ì¸ìœ¼ë¡œ êµ¬í˜„ë˜ì„œ ë³´ì•ˆ ì·¨ì•½ì ì— ëŒ€í•´ ì‰½ê²Œ ê°ì‚¬í•  ìˆ˜ ìˆë‹¤. ê·¸ë§Œí¼ ì² ì €íˆ ê²€ì¦ë  ê°€ëŠ¥ì„±ì´ ë†’ê³ , ì˜ˆìƒì¹˜ ëª»í•œ ê³³ì—ì„œì˜ ë²„ê·¸ë¡œ ì¸í•œ ì·¨ì•½ì ì´ ë°œìƒí•  ê°€ëŠ¥ì„±ì´ ìƒëŒ€ì ìœ¼ë¡œ ì ë‹¤ëŠ” ì–˜ê¸°ê°€ ëœë‹¤.  </li><li>High Performance : ëª¨ë“  ê²ƒì´ kernelì—ì„œ ë™ì‘í•˜ê³  ì•ˆì „í•œ ë„¤íŠ¸ì›Œí‚¹ì´ ë§¤ìš° ë¹ ë¥¸ ì†ë„ ë¡œ ë™ì‘í•˜ê¸° ë•Œë¬¸ì— ìŠ¤ë§ˆíŠ¸í°ê³¼ ë°±ë³¸ ë¼ìš°í„°ì™€ ê°™ì€ ì‘ì€ ì„ë² ë””ë“œ ì¥ì¹˜ ë“± ëª¨ë‘ì— ì í•©í•˜ë‹¤.  </li><li>Well Defined &amp; Thoroughly Considered : WireguardëŠ” <a href="https://www.wireguard.com/papers/wireguard.pdf" target="_blank" rel="noopener noreferrer">ë°±ì„œ</a>ê°€ ë°œí–‰ë  ì •ë„ë¡œ ê¸°ìˆ ì ìœ¼ë¡œ ì—¬ëŸ¬ê°€ì§€ ê³ ë ¤ì‚¬í•­ë“¤ì„ ëª…í™•í•˜ê²Œ ì •ì˜í•´ë†¨ë‹¤.</li></ul><p>ê´€ë ¨í•œ ìì„¸í•œ ë‚´ìš©ì€ <a href="https://www.wireguard.com/papers/wireguard.pdf" target="_blank" rel="noopener noreferrer">ë°±ì„œ</a> ë¥¼ ì°¸ê³ í•œë‹¤.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="wireguard-in-calico-cni">Wireguard in Calico CNI<a class="hash-link" href="#wireguard-in-calico-cni" title="Direct link to heading">â€‹</a></h3><p>ìŠ¤í„°ë””ë¥¼ ì§„í–‰í• ë•ŒëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ íŒŒë“œì™€ íŒŒë“œ ì‚¬ì´ì˜ íŒ¨í‚·ì„ ë„¤íŠ¸ì›Œí¬ ë ˆë²¨ë¡œ ì•”í˜¸í™” í•˜ëŠ” ë„êµ¬ë¡œ Calicoì— ë‚´ì¥ëœ WireGuard í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•´ì„œ íŒŒë“œê°„ í„°ë„ì„ ì„¤ì •í•˜ê³  íŠ¸ë˜í”½ì„ ì•”í˜¸í™” í•˜ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ê²Œ ë˜ì—ˆë‹¤. Calico CNIì—ì„œ êµ¬ì„±í•˜ëŠ” ë°©ë²•ì€ <code>calicoctl</code>ë¥¼ ì‚¬ìš©í•´ì„œ ì„¤ì •í•˜ê¸° ë•Œë¬¸ì— ê°„ë‹¨í•˜ë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ calicoctl patch felixconfiguration default --type='merge' -p '{"spec":{"wireguardEnabled":true}}'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ calicoctl get felixconfiguration default -o yaml | grep wireguardEnabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  wireguardEnabled: true</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>íŒŒë“œê°„ì˜ ping testë¥¼ ì§„í–‰í•˜ê³  ë‚œ ì´í›„ íŒŒë“œ ë ˆë²¨ì—ì„œ íŒ¨í‚· ë¤í”„í•œ ë‚´ìš©ì„ wiresharkë¡œ í™•ì¸í•œ ë‚´ìš©ì´ë‹¤. ê·¸ë¦¼ì—ì„œì²˜ëŸ¼ icmp íŒ¨í‚·ì€ í™•ì¸ì´ ì•ˆë˜ê³  udpì™€ wireguard í”„ë¡œí† ì½œì„ í†µí•´ ë°ì´í„°ê°€ ì•”í˜¸í™” ëœê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><p><img loading="lazy" alt="wg" src="/assets/images/wg-9118a771c7d571be3495eeef652b7e06.png" width="1002" height="575" class="img_E7b_"></p><p>ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” tailscale í™œìš©ë°©ì•ˆì„ ì†Œê°œí•˜ëŠ” ê²ƒìœ¼ë¡œ ê°„ë‹¨í•˜ê²Œ calicoë¥¼ í†µí•´ wireguard ì„¤ì •í•˜ëŠ” ê²ƒì€ ë„˜ì–´ê°„ë‹¤. ë‹¤ë¥¸ ì¢‹ì€ ë‚´ìš©ë“¤ì€ ë‹¤ìŒ ë§í¬ë“¤ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì°¸ê³ ìë£Œ">ì°¸ê³ ìë£Œ<a class="hash-link" href="#ì°¸ê³ ìë£Œ" title="Direct link to heading">â€‹</a></h3><ul><li><a href="https://tech.devsisters.com/posts/wireguard-vpn-1/" target="_blank" rel="noopener noreferrer">WireGuardë¡œ ë©‹ì§„ VPN ì„œë²„ êµ¬ì¶•í•˜ê¸° - devsisters</a></li><li><a href="https://slowbootkernelhacks.blogspot.com/2020/09/wireguard-vpn.html" target="_blank" rel="noopener noreferrer">WireGuard VPN í•´ë¶€ - Slowboot</a></li><li><a href="https://github.com/squat/kilo" target="_blank" rel="noopener noreferrer">Kilo - multi-cloud k8s network overlay built on WireGuard</a></li><li><a href="https://git.zx2c4.com/wireguard-go/about/" target="_blank" rel="noopener noreferrer">Go implementation of WireGuard</a></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="tailscale">Tailscale<a class="hash-link" href="#tailscale" title="Direct link to heading">â€‹</a></h2><ul><li><a href="https://tailscale.com/" target="_blank" rel="noopener noreferrer">https://tailscale.com/</a></li></ul><p>TailScaleì€ ì„œë²„, ì»´í“¨í„° ë° í´ë¼ìš°ë“œ ì¸ìŠ¤í„´ìŠ¤ê°„ì— ë³´ì•ˆ ë„¤íŠ¸ì›Œí¬ë¥¼ ë§Œë“œëŠ” VPNìœ¼ë¡œ Wireguard í”„ë¡œí† ì½œì„ ì‚¬ìš©í•´ì„œ ë§Œë“  í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ì´ë‹¤. Tailscaleì´ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ëŠ” <a href="https://tailscale.com/blog/how-tailscale-works/" target="_blank" rel="noopener noreferrer">ê³µì‹ ë¸”ë¡œê·¸</a>ì—ì„œ ê°„ë‹¨íˆ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><p>ê°„ë‹¨í•˜ê²Œ ë¸”ë¡œê·¸ ë‚´ìš©ì„ ì •ë¦¬í•´ë³´ë©´ ê¸°ì¡´ì˜ VPN ë°©ì‹ì€ Hub-and-spoke ë°©ì‹ìœ¼ë¡œ ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ Gateway ë°©ì‹ìœ¼ë¡œ ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ë¥¼ ì—°ê²°í•˜ëŠ”ê²Œ ê¸°ì¡´ì˜ ë°©ì‹ì´ë‹¤. ìƒˆë¡œìš´ í´ë¼ì´ì–¸íŠ¸ë‚˜ ì„œë²„ê°€ ì¶”ê°€ë  ê²½ìš° ìƒˆë¡œìš´ í‚¤ë¥¼ ëª¨ë“  ì‚¬ìš©ìì—ê²Œ ë°°í¬í•˜ê²Œ ë˜ê³  ì´ëŠ” ì¥ë¹„ê°€ ì¦ê°€í•¨ì— ë”°ë¼ ë§ì€ ì‘ì—…ì´ í•„ìš”ë¡œ í•˜ê²Œ ëœë‹¤.</p><p><img loading="lazy" src="https://tailscale.com/blog/how-tailscale-works/hub-and-spoke-single.svg" alt="hub" class="img_E7b_"></p><p>Wireguard í„°ë„ì„ ì´ìš©í•˜ë©´ ë…¸ë“œê°„ì˜ ì—°ê²°ì´ ì§ì ‘ ì´ë¤„ì§€ê²Œ ë˜ê³  ì´ëŠ” ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ ë©”ì‰¬ í˜•íƒœë¡œ êµ¬ì„±ë˜ê²Œ ëœë‹¤. </p><p><img loading="lazy" src="https://tailscale.com/blog/how-tailscale-works/mesh-network.svg" alt="mesh" class="img_E7b_"></p><p>ì´ëŸ° ë©”ì‰¬ë°©ì‹ì˜ ê°€ì¥ í° ë‹¨ì ì€ í”¼ì–´ë¼ë¦¬ ì—°ê²°í•˜ëŠ” ë…¸ë“œ ë„¤íŠ¸ì›Œí¬ì˜ ê²½ìš° ì—°ê²°ë˜ëŠ” ê²½ìš°ì˜ ìˆ˜ê°€ <code>n(n-1)</code>ìœ¼ë¡œ ê·¸ë¦¼ì˜ ì˜ˆì‹œì—ì„œë„ 10*9 = 90ê°œì˜ ì—°ê²° êµ¬ì„±ì´ í•„ìš”í•˜ê²Œ ëœë‹¤. ëª¨ë“  ë…¸ë“œê°€ í•´ë‹¹ ì‚¬í•­ìœ¼ë¡œ Wireguardì˜ keyë¥¼ ë¡œí…Œì´íŠ¸í•˜ê±°ë‚˜ ì‚¬ìš©ìë¥¼ ì¶”ê°€, ì œê±°í• ë•Œë§ˆë‹¤ ê° ë…¸ë“œì— ì—…ë°ì´íŠ¸ê°€ ë˜ì–´ì•¼ í•œë‹¤. ë§Œì•½ì—ë¼ë„ ê° ë…¸ë“œì— static ipê°€ ì—†ì„ ê²½ìš° ë…¸ë“œë¼ë¦¬ ì°¾ëŠ”ì¼ì´ ê²°ê³  ì‰½ì§€ëŠ” ì•Šì„ ê²ƒì´ë‹¤. íŠ¹íˆ ë°©í™”ë²½ì„ ìš´ì˜í•˜ëŠ” ì—”í„°í”„ë¼ì´ì¦ˆ ì¡°ì§ì˜ ê²½ìš°ì— ë”ìš±ë” ê¹Œë‹¤ë¡œìš´ ì¼ì´ ëœë‹¤ê³  ë§í•œë‹¤.</p><p>ê·¸ë˜ì„œ Tailscaleì—ì„œ ì´ì•¼ê¸°í•˜ëŠ” ê°€ì¥ í•µì‹¬ì€ ë…¸ë“œ ê°„ì˜ íŠ¸ë˜í”½ì„ ê°ì‚¬, í†µì œí•  ìˆ˜ ìˆëŠ” ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ì„ ë‘ëŠ”ê²ƒì´ë‹¤. ë°©í™”ë²½ì´ë‚˜ static ipê°€ ì—†ëŠ” í™˜ê²½ì—ì„œë„ ë…¸ë“œ, í”¼ì–´ê°„ì˜ í†µì œê°€ ê°€ëŠ¥í•œ í™˜ê²½ì„ ì œê³µí•˜ëŠ” ê²ƒì´ ê¸°ë³¸ ì‚¬ìƒì´ë‹¤. </p><p><img loading="lazy" src="https://tailscale.com/blog/how-tailscale-works/mesh-coordination-server.svg" alt="controlplane" class="img_E7b_"></p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ê¸°ë³¸-ì‘ë™ë°©ì‹">ê¸°ë³¸ ì‘ë™ë°©ì‹<a class="hash-link" href="#ê¸°ë³¸-ì‘ë™ë°©ì‹" title="Direct link to heading">â€‹</a></h3><ul><li>ê° ë…¸ë“œ(í´ë¼ì´ì–¸íŠ¸)ëŠ” ëœë¤ ê³µê°œí‚¤ì™€ ê°œì¸í‚¤ë¥¼ ìƒì„±í•˜ê³  ê³µê°œí‚¤ë¥¼ ID(tailscale account)ì™€ ì—°ê²°í•œë‹¤.</li><li>ë…¸ë“œëŠ” ì¤‘ì•™ì˜ tailscaleì„œë²„ì— ê³µê°œí‚¤ì™€ í•´ë‹¹ ë…¸ë“œê°€ í˜„ì¬ ì—°ê²°ê°€ëŠ¥í•œì§€ì™€ ë„ë©”ì¸ ì •ë³´(client name) ì •ë³´ë¥¼ ì „ë‹¬í•œë‹¤. </li><li>ë…¸ë“œëŠ” tailscaleì„œë²„ ì—…ë°ì´íŠ¸ëœ ë„ë©”ì¸ì˜ ê³µê°œí‚¤ ë° ì£¼ì†Œ ëª©ë¡ì„ ë‹¤ìš´ë¡œë“œ í•œë‹¤.</li><li>ë…¸ë“œëŠ” ë‚´ë ¤ë°›ì€ ê³µê°œ í‚¤ ì„¸íŠ¸ë¡œ Wireguard ì¸ìŠ¤í„´ìŠ¤ë¥¼ êµ¬ì„±í•œë‹¤.</li></ul><p>ì´ëŠ” ë‹¤ì‹œ hub-and-spoke ëª¨ë¸ë¡œ ëŒì•„ê°„ê²ƒ ê°™ì§€ë§Œ ì‹¤ì œ ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ê³¼ ë°ì´í„° í”Œë ˆì¸ì„ ë¶„ë¦¬í•´ì„œ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— ì‹¤ì œ ì¤‘ì•™ ì„œë²„ê°€ ê´€ë¦¬í•˜ëŠ” ê²ƒì€ ê³µê°œí‚¤ ì„¸íŠ¸ì™€ ì—°ê²°ê°€ëŠ¥í•œ ë…¸ë“œ ë¦¬ìŠ¤íŠ¸ ì •ë³´ë¿ì´ë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="tailscale-í…ŒìŠ¤íŠ¸">Tailscale í…ŒìŠ¤íŠ¸<a class="hash-link" href="#tailscale-í…ŒìŠ¤íŠ¸" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="talescale-ì„¤ì¹˜-macos-ê¸°ì¤€">talescale ì„¤ì¹˜ (macOS ê¸°ì¤€)<a class="hash-link" href="#talescale-ì„¤ì¹˜-macos-ê¸°ì¤€" title="Direct link to heading">â€‹</a></h3><ul><li><a href="https://tailscale.com/download" target="_blank" rel="noopener noreferrer">https://tailscale.com/download</a></li></ul><p>macOSìš© CLI ì„¤ì¹˜ ì •ë³´ëŠ” ì•„ë˜ ë§í¬ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><ul><li><a href="https://tailscale.com/kb/1065/macos-variants/" target="_blank" rel="noopener noreferrer">https://tailscale.com/kb/1065/macos-variants/</a></li></ul><p>macOSìš© GUI í´ë¼ì´ì–¸íŠ¸ì— CLIë„ ë‚´ì¥ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— <code>.zshrc</code>ì— aliasë¥¼ ì¶”ê°€í–ˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">alias tailscale="/Applications/Tailscale.app/Contents/MacOS/Tailscale"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>2022ë…„ 2ì›” 5ì¼ì ê¸°ì¤€ìœ¼ë¡œ 1.20.2 ë²„ì „ì„ ì‚¬ìš©í•œë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ tailscale version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1.20.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  tailscale commit: 312750ddd288cf4073cfaef56a45102b9c1e8421</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  other commit: 2c164d9c7443e2f3014fa54ea45e946b35152680</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  go version: go1.17.6-tse44d304e54</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>windowsì—ì„œë„ ì‰½ê²Œ ì„¤ì¹˜ê°€ ê°€ëŠ¥í•˜ê³ , ë¬¼ë¡  ì• ì •í•˜ëŠ” Synologyì—ë„ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•  ìˆ˜ ìˆë‹¤. </p><p><a href="https://github.com/tailscale/tailscale-synology" target="_blank" rel="noopener noreferrer">https://github.com/tailscale/tailscale-synology</a></p><p>ì„¤ì¹˜ëœ í´ë¼ì´ì–¸íŠ¸ ëª¨ë‘ë¥¼ tailscale ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ë©´ VPNì—°ê²°ì´ ëë‚œë‹¤. </p><p>ì—°ê²°ëœ ë¨¸ì‹ ë¦¬ìŠ¤íŠ¸ëŠ” ì•„ë˜ì™€ ê°™ì´ <a href="https://login.tailscale.com/admin/machines" target="_blank" rel="noopener noreferrer">Machines</a> ë©”ë‰´ ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆê³  ê° ë…¸ë“œë‚˜ í´ë¼ì´ì–¸íŠ¸ë¡œ í• ë‹¹ëœ <code>100.*</code> ëŒ€ì—­ IPë¡œ ì ‘ì†ì´ ê°€ëŠ¥í•˜ë‹¤. </p><p><img loading="lazy" alt="machine" src="/assets/images/tailscale-web-3a41c37cafdc8bbc9c7868e3dfe96040.png" width="948" height="1024" class="img_E7b_"></p><p>ì—¬ê¸°ì„œ machine nameìœ¼ë¡œ ì§ì ‘ ì ‘ì†ì´ ê°€ëŠ¥í•˜ê¸° ìœ„í•´ì„œëŠ” MagicDNS ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ë° <code>beta</code> ê¸°ëŠ¥ìœ¼ë¡œ <a href="https://login.tailscale.com/admin/dns" target="_blank" rel="noopener noreferrer">í™œì„±í™”</a>ë¥¼ í•  ìˆ˜ ìˆê³  ë„¤íŠ¸ì›Œí¬ì— ìˆëŠ” ì¥ì¹˜ì˜ DNS ì´ë¦„ì„ ìë™ìœ¼ë¡œ ë“±ë¡í•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤.</p><ul><li>DNS ì„¤ì •ê°€ì´ë“œ : <a href="https://tailscale.com/kb/1081/magicdns/" target="_blank" rel="noopener noreferrer">https://tailscale.com/kb/1081/magicdns/</a></li></ul><p>CLIë¡œ í˜„ì¬ ì—°ê²°ëœ client ì •ë³´ë‚˜ publickey ë“±ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ tailscale status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100.89.226.113  88665a4a51c4         ddiiwoong@   macOS   -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100.76.233.116  jinwoonuimbp141      ddiiwoong@   macOS   offline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100.95.209.95   proxy                ddiiwoong@   linux   -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100.106.65.5    win11                ddiiwoong@   windows -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ tailscale status --json | jq '.Self.PublicKey'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">"nodekey:97c4dc44ecdf56******************adb3246d87fd9e270"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>DNS ë“±ë¡ ë°©ì‹ì€ ì•„ë˜ì™€ ê°™ì´ êµ¬ì„±ë˜ê³ </p><p><img loading="lazy" src="https://tailscale.com/kb/1081/magicdns/magic-dns-naming.png" alt="magicdns" class="img_E7b_"></p><p>ë‚´ê°€ ë“±ë¡í•œ ë¨¸ì‹ ë¦¬ìŠ¤íŠ¸ì—ì„œ win11 ì€ ë‹¤ìŒ ì •ë³´ë¡œ ë„ë©”ì¸ì´ ë“±ë¡ëœë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">win11.ddiiwoong.gmail.com.beta.tailscale.net</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë‘ê°€ì§€ ë°©ì‹ìœ¼ë¡œ í•´ë‹¹ ë¨¸ì‹ ì— ping checkë¥¼ í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ ping win11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PING win11.ddiiwoong.gmail.com.beta.tailscale.net (100.106.65.5): 56 data bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 100.106.65.5: icmp_seq=0 ttl=128 time=124.031 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 100.106.65.5: icmp_seq=1 ttl=128 time=2.180 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 100.106.65.5: icmp_seq=2 ttl=128 time=2.776 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ping win11.ddiiwoong.gmail.com.beta.tailscale.net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PING win11.ddiiwoong.gmail.com.beta.tailscale.net (100.106.65.5): 56 data bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 100.106.65.5: icmp_seq=0 ttl=128 time=5.086 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 100.106.65.5: icmp_seq=1 ttl=128 time=2.060 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 100.106.65.5: icmp_seq=2 ttl=128 time=2.213 ms</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kubernetes-í™˜ê²½êµ¬ì„±">kubernetes í™˜ê²½êµ¬ì„±<a class="hash-link" href="#kubernetes-í™˜ê²½êµ¬ì„±" title="Direct link to heading">â€‹</a></h3><p>kubernetes ë¦¬ì†ŒìŠ¤ë¡œ tailscaleì„ êµ¬ì„±ì„ í•´ë³´ì. ë¨¼ì € <code>1.16</code> ë²„ì „ ì´ìƒì˜ kubernetes í´ëŸ¬ìŠ¤í„°ë¥¼ ì¤€ë¹„í•œë‹¤. ì•„ë˜ êµ¬ì„±í™˜ê²½ì€ <code>1.21.5</code> ë²„ì „ìœ¼ë¡œ eksctlë¡œ ì„¤ì¹˜í•œ ê¸°ë³¸ EKS í´ëŸ¬ìŠ¤í„°ì´ë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                                 STATUS   ROLES    AGE   VERSION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ip-192-168-101-195.ap-northeast-2.compute.internal   Ready    &lt;none&gt;   19h   v1.21.5-eks-9017834</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ip-192-168-134-35.ap-northeast-2.compute.internal    Ready    &lt;none&gt;   19h   v1.21.5-eks-9017834</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ip-192-168-186-235.ap-northeast-2.compute.internal   Ready    &lt;none&gt;   19h   v1.21.5-eks-9017834</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="authkey-ë°œê¸‰-ë°-secret-ë“±ë¡">authKey ë°œê¸‰ ë° Secret ë“±ë¡<a class="hash-link" href="#authkey-ë°œê¸‰-ë°-secret-ë“±ë¡" title="Direct link to heading">â€‹</a></h3><p>authKeyëŠ” tailscale ë„¤íŠ¸ì›Œí¬ì— ë“±ë¡í•˜ê¸° ìœ„í•œ Keyë¡œ ì•„ë˜ì™€ ê°™ì´ ê´€ë¦¬ë¥¼ Webì—ì„œ í•  ìˆ˜ ìˆë‹¤.</p><p><img loading="lazy" alt="key" src="/assets/images/tailscale-key-7bc957707fe91c3c4465cb95ad0af640.png" width="1119" height="700" class="img_E7b_"></p><p><a href="https://login.tailscale.com/admin/settings/keys" target="_blank" rel="noopener noreferrer">Keys</a> ë©”ë‰´ë¡œ ì´ë™í•´ì„œ auth Keyë¥¼ ë°œê¸‰ë°›ëŠ”ë‹¤. ë°œê¸‰ì„ í• ë•Œ ì—¬ëŸ¬ë¨¸ì‹ ì—ì„œ ì‚¬ìš©í•  ê²½ìš°ëŠ” <code>Reusable</code>, ì„ì‹œë¡œ í‚¤ë¥¼ ì‚¬ìš©í• ë•ŒëŠ” <code>Ephemeral</code> ì˜µì…˜ì„ ì‚¬ìš©í•  ìˆ˜ë„ ìˆë‹¤. ì•„ë˜ì™€ ê°™ì€ í˜•ì‹ìœ¼ë¡œ ë°œê¸‰ë˜ê³ , í•´ë‹¹ keyëŠ” kubernetes <code>Secret</code> ë¦¬ì†ŒìŠ¤ì— ë“±ë¡ì„ í•´ì„œ ì‚¬ìš©í•  ê²ƒì´ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">tskey-kZAinb5CNTRL-********************</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í•´ë‹¹ auth Keyë¥¼ Secretìœ¼ë¡œ ìƒì„±í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tailscale</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">stringData</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">AUTH_KEY</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tskey</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">kZAinb5CNTRL</span><span class="token punctuation" style="color:#393A34">-</span><span class="token important">********************</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get secret -n tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                    TYPE                                  DATA   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default-token-fww2j     kubernetes.io/service-account-token   3      18h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tailscale-auth          Opaque                                3      18h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tailscale-token-7cgsc   kubernetes.io/service-account-token   3      17h</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="image-build--push">image build &amp; push<a class="hash-link" href="#image-build--push" title="Direct link to heading">â€‹</a></h3><p>tailscale imageë¥¼ ë¹Œë“œí•œë‹¤. ìì„¸í•œ ë‚´ìš©ì€ ì•„ë˜ ë§í¬ë¥¼ ì°¸ê³ í•œë‹¤.  </p><ul><li><a href="https://github.com/tailscale/tailscale/tree/main/docs/k8s" target="_blank" rel="noopener noreferrer">https://github.com/tailscale/tailscale/tree/main/docs/k8s</a></li></ul><p>Dockerfileì€ ë‹¤ìŒê³¼ ê°™ì´ ê³µì‹ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-dockerfile theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">FROM ghcr.io/tailscale/tailscale:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY run.sh /run.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD "/run.sh"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><a href="https://github.com/tailscale/tailscale/blob/main/docs/k8s/run.sh" target="_blank" rel="noopener noreferrer">run.sh</a>ì„ ì‚´í´ë³´ë©´ <code>tailscaled</code> ë°ëª¬ì„ ì‹¤í–‰í• ë•Œ ëª‡ê°€ì§€ í™˜ê²½ë³€ìˆ˜ë¥¼ ì…ë ¥ë°›ì•„ ì²˜ë¦¬í•˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. </p><p><code>AUTH_KEY</code>ì™€ <code>KUBE_SECRET</code>ì€ ìœ„ Secretìœ¼ë¡œ ì²˜ë¦¬ë¥¼ í•˜ê³  ì—¬ëŸ¬ ì‚¬ìš© ëª¨ë“œ(router, userspace)ë„ ì»¨í…Œì´ë„ˆ ì‹¤í–‰ì‹œ ì…ë ¥ë°›ì•„ ì²˜ë¦¬í•œë‹¤. ë˜í•œ, ë§ˆì§€ë§‰ êµ¬ë¬¸ì„ ë³´ë©´ ëª©ì ì§€ IP DNAT ì²˜ë¦¬ë¥¼ ìœ„í•œ iptables ë“±ë¡ ì˜µì…˜ë„ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#! /bin/sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export PATH=$PATH:/tailscale/bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AUTH_KEY="${AUTH_KEY:-}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ROUTES="${ROUTES:-}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEST_IP="${DEST_IP:-}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXTRA_ARGS="${EXTRA_ARGS:-}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">USERSPACE="${USERSPACE:-true}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KUBE_SECRET="${KUBE_SECRET:-tailscale}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set -e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TAILSCALED_ARGS="--state=kube:${KUBE_SECRET} --socket=/tmp/tailscaled.sock"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if [[ "${USERSPACE}" == "true" ]]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if [[ ! -z "${DEST_IP}" ]]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo "IP forwarding is not supported in userspace mode"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exit 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  TAILSCALED_ARGS="${TAILSCALED_ARGS} --tun=userspace-networking"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if [[ ! -d /dev/net ]]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mkdir -p /dev/net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if [[ ! -c /dev/net/tun ]]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mknod /dev/net/tun c 10 200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo "Starting tailscaled"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tailscaled ${TAILSCALED_ARGS} &amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PID=$!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UP_ARGS="--accept-dns=false"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if [[ ! -z "${ROUTES}" ]]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UP_ARGS="--advertise-routes=${ROUTES} ${UP_ARGS}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if [[ ! -z "${AUTH_KEY}" ]]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UP_ARGS="--authkey=${AUTH_KEY} ${UP_ARGS}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if [[ ! -z "${EXTRA_ARGS}" ]]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UP_ARGS="${UP_ARGS} ${EXTRA_ARGS:-}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo "Running tailscale up"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tailscale --socket=/tmp/tailscaled.sock up ${UP_ARGS}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if [[ ! -z "${DEST_IP}" ]]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo "Adding iptables rule for DNAT"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  iptables -t nat -I PREROUTING -d "$(tailscale --socket=/tmp/tailscaled.sock ip -4)" -j DNAT --to-destination "${DEST_IP}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wait ${PID}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>buildí•˜ê³  ë ˆì§€ìŠ¤íŠ¸ë¦¬ë¡œ push í•˜ì.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ export IMAGE_TAG=ddiiwoong/tailscale-k8s:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ docker build . -t $(IMAGE_TAG)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ docker push $(IMAGE_TAG)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ docker images ddiiwoong/tailscale-k8s:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REPOSITORY            TAG       IMAGE ID       CREATED        SIZE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ddiiwoong/tailscale-k8s   latest    9dc489da64c4   18 hours ago   44.1MB</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="rbac-ë¦¬ì†ŒìŠ¤-ìƒì„±">RBAC ë¦¬ì†ŒìŠ¤ ìƒì„±<a class="hash-link" href="#rbac-ë¦¬ì†ŒìŠ¤-ìƒì„±" title="Direct link to heading">â€‹</a></h3><p>rbac ì„¤ì •ì„ ìœ„í•´ì„œ <code>role</code>, <code>rolebinding</code>, <code>serviceaccount</code>ë¥¼ ìƒì„±í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">export SA_NAME=tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export KUBE_SECRET=tailscale-auth</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ ENVê°’ì„ ì¹˜í™˜í•´ì„œ ìƒì„±í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ServiceAccount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rbac.authorization.k8s.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Role</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">rules</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">apiGroups</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">""</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># "" indicates the core API group</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">"secrets"</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Create can not be restricted to a resource name.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">verbs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">"create"</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">apiGroups</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">""</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># "" indicates the core API group</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">resourceNames</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">"tailscale-auth"</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">"secrets"</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">verbs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">"get"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"update"</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rbac.authorization.k8s.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> RoleBinding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">subjects</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ServiceAccount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">roleRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Role</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">apiGroup</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rbac.authorization.k8s.io</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="sidecar-ë°°í¬">sidecar ë°°í¬<a class="hash-link" href="#sidecar-ë°°í¬" title="Direct link to heading">â€‹</a></h3><p>sidecar ìƒì„±ì„ ìœ„í•´ manifestë¥¼ í™•ì¸í•œë‹¤. ìì„¸íˆ ì‚´í´ë³´ë©´ <code>ts-sidecar</code> ì»¨í…Œì´ë„ˆ securityContextì— <code>NET_ADMIN</code> ê¶Œí•œì´ ì¶”ê°€ëœê²ƒì„ ë³¼ìˆ˜ ìˆë‹¤. ì´ëŠ” sidecar íŒŒë“œê°€ í„°ë„ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬ì„±í•˜ê¸° ìœ„í•´ ìƒìœ„ ë…¸ë“œ <code>CAP_NET_ADMIN</code> ê¶Œí•œì„ ì·¨ë“í•˜ê¸° ìœ„í•¨ì´ë‹¤. ìì„¸í•œ ë‚´ìš©ì€ <a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-capabilities-for-a-container" target="_blank" rel="noopener noreferrer">Set capabilities for a Container</a> ë¬¸ì„œë¥¼ í™•ì¸í•˜ì. </p><p>ê·¸ë¦¬ê³  ì¶”ê°€ sidecarë¡œ <code>nicolaka/netshoot</code>ë¥¼ ì¶”ê°€í–ˆëŠ”ë° ì´ëŠ” <a href="https://github.com/nicolaka/netshoot" target="_blank" rel="noopener noreferrer">ë„¤íŠ¸ì›Œí¬ ì¥ì•  ì²˜ë¦¬ì— ìœ ìš©í•œ í”„ë¡œì íŠ¸</a>ë¡œ ì—¬ëŸ¬ê°€ì§€ ë„¤íŠ¸ì›Œí¬ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">serviceAccountName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> netshoot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nicolaka/netshoot </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">"tail"</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">args</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">"-f"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"/dev/null"</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ts</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">sidecar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">imagePullPolicy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ddiiwoong/tailscale</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">k8s</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># Store the state in a k8s secret</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> KUBE_SECRET</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tailscale</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> USERSPACE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"false"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> AUTH_KEY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">valueFrom</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">secretKeyRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tailscale</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> AUTH_KEY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">optional</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">securityContext</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">capabilities</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">add</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> NET_ADMIN</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìƒì„±ì„ í•˜ê³  ì‚´í´ë³´ë©´ sidecar nginx íŒŒë“œê°€ ìƒì„±ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod nginx -n tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME    READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nginx   3/3     Running   0          25s</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>tailscale sidecar ë¡œê·¸ë¥¼ ì ê¹ ì‚´í´ë³´ì. ìƒˆë¡œìš´ <code>tailscale0</code> tun ì¸í„°í˜ì´ìŠ¤ê°€ ì¶”ê°€ë˜ê³  ì›ë˜ pod eth0 ì¸í„°í˜ì´ìŠ¤ ipë„ í™•ì¸ì´ ëœë‹¤. ë˜í•œ <code>wireguard</code> deviceë„ ì˜¬ë¼ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl logs nginx ts-sidecar -n tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting tailscaled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running tailscale up</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:26 logtail started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:26 Program starting: v1.20.2-t8e643357d, Go 1.17.6-tse44d304e54: []string{"tailscaled", "--state=kube:tailscale-auth", "--socket=/tmp/tailscaled.sock"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:26 LogID: 31416c9a454e3667661bf0f21ccde8ebf72604d7434660b0db55e838be372bc4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:26 logpolicy: using system state directory "/var/lib/tailscale"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logpolicy.Read /var/lib/tailscale/tailscaled.log.conf: open /var/lib/tailscale/tailscaled.log.conf: no such file or directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:26 wgengine.NewUserspaceEngine(tun "tailscale0") ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:26 router: disabling tunneled IPv6 due to system IPv6 config: disable_ipv6 is set</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:26 dns: [rc=unknown ret=direct]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:26 dns: using *dns.directManager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:26 link state: interfaces.State{defaultRoute=eth0 ifs={eth0:[192.168.118.89/32]} v4=true v6=false}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:26 magicsock: disco key = d:1b04c57ebf000fe0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:26 Creating wireguard device...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:26 Bringing wireguard device up...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:26 Bringing router up...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:26 external route: up</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:26 Clearing router settings...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:26 Starting link monitor...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:26 Engine created.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:26 netmap packet filter: (not ready yet)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:26 Start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:26 using backend prefs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:28 active login: ddiiwoong@gmail.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:28 netmap packet filter: 1 filters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:28 dns: Set: {DefaultResolvers:[] Routes:{} SearchDomains:[] Hosts:4}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:28 dns: Resolvercfg: {Routes:{} Hosts:4 LocalDomains:[]}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:28 dns: OScfg: {Nameservers:[] SearchDomains:[] MatchDomains:[]}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:28 Taildrop disabled; no state directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:28 peerapi starting without Taildrop directory configured</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022/02/05 12:20:28 peerapi: serving on http://100.95.209.95:34980</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>netshoot íŒŒë“œë‚´ì—ì„œë„ <code>tailscale0</code> ì¸í„°í˜ì´ìŠ¤ê°€ ì¶”ê°€ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl exec -it nginx -c netshoot -- ip -c addr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet 127.0.0.1/8 scope host lo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3: eth0@if8: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 9001 qdisc noqueue state UP group default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/ether 6e:f8:f5:f3:47:11 brd ff:ff:ff:ff:ff:ff link-netnsid 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet 192.168.118.89/32 scope global eth0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4: tailscale0: &lt;POINTOPOINT,MULTICAST,NOARP,UP,LOWER_UP&gt; mtu 1280 qdisc pfifo_fast state UNKNOWN group default qlen 500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/none</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet 100.95.209.95/32 scope global tailscale0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë¡œì»¬ì—ì„œ <code>tailscale</code> CLIë¥¼ í†µí•´ IPì •ë³´ë„ ë™ì¼í•œ ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ tailscale status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100.89.226.113  88665a4a51c4         ddiiwoong@   macOS   -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100.76.233.116  jinwoonuimbp141      ddiiwoong@   macOS   offline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100.95.209.95   nginx                ddiiwoong@   linux   -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100.106.65.5    win11                ddiiwoong@   windows -</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë¨¼ì € ì–´ë– í•œ kubernetes ì„œë¹„ìŠ¤ë„ ì—†ëŠ” ê²ƒì„ í™•ì¸í•˜ê³ , ë¯¸ë¦¬ magicdnsë¥¼ êµ¬ì„±í•´ë†¨ê¸° ë•Œë¬¸ì— <code>nginx</code> ì£¼ì†Œë¡œ ì§ì ‘ í†µì‹ ì„ ì‹œë„í•´ë³´ì. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get svc -n A</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">No resources found in A namespace.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ping nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PING nginx.ddiiwoong.gmail.com.beta.tailscale.net (100.95.209.95): 56 data bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 100.95.209.95: icmp_seq=0 ttl=255 time=193.606 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 100.95.209.95: icmp_seq=1 ttl=255 time=95.747 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 100.95.209.95: icmp_seq=2 ttl=255 time=94.441 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ curl http://nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;title&gt;Welcome to nginx!&lt;/title&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="userspace-sidecar-í…ŒìŠ¤íŠ¸">Userspace Sidecar í…ŒìŠ¤íŠ¸<a class="hash-link" href="#userspace-sidecar-í…ŒìŠ¤íŠ¸" title="Direct link to heading">â€‹</a></h3><p>userspace ëª¨ë“œë¡œ ì‹¤í–‰í•´ë³´ì. ìœ„ì™€ ì°¨ì´ì ì€ <code>NET_ADMIN</code> ê¶Œí•œì„ ë¹¼ê³ , <code>runAsUser: 1000</code>ì™€ <code>runAsGroup: 1000</code>ì„ ì¶”ê°€í–ˆë‹¤. í•´ë‹¹ í´ë¼ì´ì–¸íŠ¸ë‚˜ ë…¸ë“œê°€ ì™¸ë¶€ë¡œ í†µì‹ ì„ ìœ„í•´ì„œëŠ” <a href="https://tailscale.com/kb/1112/userspace-networking/" target="_blank" rel="noopener noreferrer">SOCKS5 ì´ë‚˜ HTTP proxy ëª¨ë“œ</a>ë¡œ ì‹¤í–‰ë˜ì–´ì•¼ í•œë‹¤. ì´ë²ˆ ë°ëª¨ì—ì„œëŠ” êµ¬ì„±í•˜ì§€ ì•ŠëŠ”ë‹¤.</p><p>userspace ëª¨ë“œëŠ” ì£¼ë¡œ ì„œë²„ë¦¬ìŠ¤ ì›Œí¬ë¡œë“œ(Heroku, Google Cloud Run, AWS Lambda, Github Action)ì—ì„œ í™œìš©ì„ í•  ë•Œ ì¢‹ë‹¤. ë‹¨ ë³´ì•ˆì„ ìœ„í•´ authKeyë¥¼ <code>ephemeral</code> í˜•íƒœë¡œ êµ¬ì„±í•˜ëŠ”ê²Œ ì¢‹ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  serviceAccountName: tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - name: nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image: nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - name: netshoot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image: nicolaka/netshoot </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    command: ["tail"]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    args: ["-f", "/dev/null"]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - name: ts-sidecar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    imagePullPolicy: Always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image: ddiiwoong/tailscale-k8s:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    securityContext:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      runAsUser: 1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      runAsGroup: 1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: KUBE_SECRET</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      value: tailscale-auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: USERSPACE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      value: "true"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: AUTH_KEY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      valueFrom:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        secretKeyRef:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name: tailscale-auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          key: AUTH_KEY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          optional: true</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë™ì¼í•˜ê²Œ ì ‘ì†ì´ ê°€ëŠ¥í•œë°, userspace ëª¨ë“œ ì´ê¸° ë•Œë¬¸ì— netshoot ì»¨í…Œì´ë„ˆë¡œ ì¸í„°í˜ì´ìŠ¤ë¥¼ í™•ì¸í•˜ë©´ ê¶Œí•œì´ ì—†ê¸° ë•Œë¬¸ì— eth0 ë§Œ í™•ì¸ ê°€ëŠ¥í•˜ë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl exec -it nginx -c netshoot -- ip -c addr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet 127.0.0.1/8 scope host lo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3: eth0@if10: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 9001 qdisc noqueue state UP group default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/ether 3a:c5:b6:cf:d1:bd brd ff:ff:ff:ff:ff:ff link-netnsid 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet 192.168.117.251/32 scope global eth0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="proxy-ëª¨ë“œ-í…ŒìŠ¤íŠ¸">Proxy ëª¨ë“œ í…ŒìŠ¤íŠ¸<a class="hash-link" href="#proxy-ëª¨ë“œ-í…ŒìŠ¤íŠ¸" title="Direct link to heading">â€‹</a></h3><p>ê¸°ì¡´ì˜ ë°°í¬ëœ Service ë¦¬ì†ŒìŠ¤ì— ì—°ê²°í•˜ëŠ” ë°©ì‹ì´ë‹¤. ë¯¸ë¦¬ nginxë¥¼ ë„ì›Œ ë†“ê³  ClusterIPë¥¼ í™•ì¸í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create deployment nginx --image nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl expose deployment nginx --port 80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get svc nginx -o=jsonpath='{.spec.clusterIP}'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment.apps/nginx created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service/nginx exposed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">10.100.213.92%</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Proxy íŒŒë“œë¥¼ ë°°í¬í•œë‹¤. ì°¸ê³ í•  ì‚¬í•­ì€ <code>sysctler</code> ì»¨í…Œì´ë„ˆì¸ë°, ê¸°ë³¸ì ìœ¼ë¡œ <code>net.ipv4.ip_forward</code> í”Œë˜ê·¸ëŠ” <code>Kubelet</code>ì—ì„œ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ì²˜ë¦¬ê°€ ë˜ì–´ ìˆì§€ ì•Šìœ¼ë¯€ë¡œ ë‚´ë¶€ì—ì„œ IP Forwardingì„ ìœ„í•´ì„œ ì¶”ê°€ ì„¤ì •ì´ í•„ìš”í•˜ë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: proxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  serviceAccountName: tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  initContainers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - name: sysctler</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image: busybox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    securityContext:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      privileged: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    command: ["/bin/sh"]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    args:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - -c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - sysctl -w net.ipv4.ip_forward=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    resources:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      requests:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        cpu: 1m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        memory: 1Mi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - name: tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    imagePullPolicy: Always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image: ddiiwoong/tailscale-k8s:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: KUBE_SECRET</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      value: tailscale-auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: USERSPACE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      value: "false"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: AUTH_KEY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      valueFrom:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        secretKeyRef:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name: tailscale-auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          key: AUTH_KEY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          optional: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: DEST_IP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      value: 10.100.213.92</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    securityContext:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      capabilities:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        add:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - NET_ADMIN</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pod -n tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                     READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nginx-6799fc88d8-5g49v   1/1     Running   0          5m59s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">proxy                    1/1     Running   0          22s</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì •ìƒì ìœ¼ë¡œ ë°°í¬ëœ proxy ì»¨í…Œì´ë„ˆë¡œ ì ‘ì†í•´ë³´ë©´ ë™ì¼í•˜ê²Œ ì ‘ê·¼ì´ ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ tailscale status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100.89.226.113  88665a4a51c4         ddiiwoong@   macOS   -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100.76.233.116  jinwoonuimbp141      ddiiwoong@   macOS   offline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100.95.209.95   proxy                ddiiwoong@   linux   idle, tx 788 rx 1452</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100.106.65.5    win11                ddiiwoong@   windows -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ curl https://proxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;title&gt;Welcome to nginx!&lt;/title&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="subnet-router-ëª¨ë“œ-í…ŒìŠ¤íŠ¸">Subnet Router ëª¨ë“œ í…ŒìŠ¤íŠ¸<a class="hash-link" href="#subnet-router-ëª¨ë“œ-í…ŒìŠ¤íŠ¸" title="Direct link to heading">â€‹</a></h3><p>Tailscaleì—ì„œ Subnet Router ëª¨ë“œë¥¼ ì‚¬ìš©í•˜ë©´ ì „ì²´ í´ëŸ¬ìŠ¤í„°ì˜ subnet ëŒ€ì—­ìœ¼ë¡œ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë‹¤. </p><p>ê¸°ë³¸ì ìœ¼ë¡œ EKS APIëŠ” ì„œë¹„ìŠ¤ subnetìœ¼ë¡œ <code>10.100.0.0/16</code> ë˜ëŠ” <code>172.20.0.0/16</code> ì„ ì‚¬ìš©í•œë‹¤. ë°°í¬í•œ eksctlë¡œ êµ¬ì„±í•œ EKS í´ëŸ¬ìŠ¤í„° subnetì€ 3ê°œ AZì— 19bitë¡œ ë‚˜ë‰˜ì–´ ë°°í¬ë˜ì—ˆê³  <code>192.168.96.0/19</code>, <code>192.168.128.0/19</code>, <code>192.168.160.0/19</code>ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get node -o wide</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                                 STATUS   ROLES    AGE   VERSION               INTERNAL-IP       EXTERNAL-IP   OS-IMAGE         KERNEL-VERSION                CONTAINER-RUNTIME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ip-192-168-101-195.ap-northeast-2.compute.internal   Ready    &lt;none&gt;   23h   v1.21.5-eks-9017834   192.168.101.195   &lt;none&gt;        Amazon Linux 2   5.4.172-90.336.amzn2.x86_64   docker://20.10.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ip-192-168-134-35.ap-northeast-2.compute.internal    Ready    &lt;none&gt;   23h   v1.21.5-eks-9017834   192.168.134.35    &lt;none&gt;        Amazon Linux 2   5.4.172-90.336.amzn2.x86_64   docker://20.10.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ip-192-168-186-235.ap-northeast-2.compute.internal   Ready    &lt;none&gt;   23h   v1.21.5-eks-9017834   192.168.186.235   &lt;none&gt;        Amazon Linux 2   5.4.172-90.336.amzn2.x86_64   docker://20.10.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod -o wide</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                     READY   STATUS    RESTARTS   AGE     IP                NODE                                                 NOMINATED NODE   READINESS GATES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nginx-6799fc88d8-5g49v   1/1     Running   0          11m     192.168.112.183   ip-192-168-101-195.ap-northeast-2.compute.internal   &lt;none&gt;           &lt;none&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">proxy                    1/1     Running   0          5m39s   192.168.155.196   ip-192-168-134-35.ap-northeast-2.compute.internal    &lt;none&gt;           &lt;none&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get svc -o wide</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME    TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)   AGE   SELECTOR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nginx   ClusterIP   10.100.213.92   &lt;none&gt;        80/TCP    11m   app=nginx</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í•´ë‹¹ subnet ëŒ€ì—­ì„ ì ‘ì†í•˜ê¸° ìœ„í•´ì„œ ì„œë¹„ìŠ¤ ëŒ€ì—­ì¸ <code>10.100.0.0/16</code>ì™€ íŒŒë“œ ëŒ€ì—­ì¸ <code>192.168.96.0/19</code>, <code>192.168.128.0/19</code>, <code>192.168.160.0/19</code>ë¥¼ ì„¤ì •í•´ì„œ router ëª¨ë“œë¡œ tailscaleì„ ì‹¤í–‰í•˜ì.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> subnet</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">router</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">serviceAccountName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">imagePullPolicy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ddiiwoong/tailscale</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">k8s</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> KUBE_SECRET</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tailscale</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> USERSPACE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"true"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> AUTH_KEY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">valueFrom</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">secretKeyRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tailscale</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> AUTH_KEY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">optional</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ROUTES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 10.100.0.0/16</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">192.168.96.0/19</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">192.168.128.0/19</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">192.168.160.0/19</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">securityContext</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">runAsUser</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">runAsGroup</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë°°í¬ëœ router ë””ë°”ì´ìŠ¤ì™€, ë‚´ë¶€ì˜ ì„œë¹„ìŠ¤ì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ íŒŒë“œì™€ ì„œë¹„ìŠ¤ IPë¥¼ í™•ì¸í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ tailscale status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100.89.226.113  88665a4a51c4         ddiiwoong@   macOS   -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100.76.233.116  jinwoonuimbp141      ddiiwoong@   macOS   offline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100.95.209.95   subnet-router        ddiiwoong@   linux   idle, tx 1556 rx 2908</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">100.106.65.5    win11                ddiiwoong@   windows -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod -n tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                     READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nginx-6799fc88d8-5g49v   1/1     Running   0          39m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subnet-router            1/1     Running   0          9m47s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod -n tailscale -o wide</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                     READY   STATUS    RESTARTS   AGE   IP                NODE                                                 NOMINATED NODE   READINESS GATES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nginx-6799fc88d8-5g49v   1/1     Running   0          39m   192.168.112.183   ip-192-168-101-195.ap-northeast-2.compute.internal   &lt;none&gt;           &lt;none&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subnet-router            1/1     Running   0          10m   192.168.137.188   ip-192-168-134-35.ap-northeast-2.compute.internal    &lt;none&gt;           &lt;none&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get svc -n tailscale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME    TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nginx   ClusterIP   10.100.213.92   &lt;none&gt;        80/TCP    40m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë°”ë¡œ ì ‘ì†ì„ í•´ë³´ë©´ ì ‘ì†ì´ ì•ˆëœë‹¤ëŠ”ê±¸ ì•Œìˆ˜ ìˆë‹¤. <a href="https://login.tailscale.com/admin/machines" target="_blank" rel="noopener noreferrer">tailscale ì„œë¹„ìŠ¤</a>ë¡œ ì´ë™í•´ route ì„¤ì •ì—ì„œ ì ‘ê·¼í•  ëŒ€ì—­ì„ ì•„ë˜ì™€ ê°™ì´ í™œì„±í™”í•˜ê³  curlë¡œ ì ‘ì†í•´ë³´ë©´ ì •ìƒì ìœ¼ë¡œ ì ‘ê·¼ì´ ëœë‹¤ëŠ”ê±¸ ì•Œìˆ˜ ìˆë‹¤. ì´ê±¸ë¡œ ìƒê°í•´ë´¤ì„ ë•Œ <code>NetworkPolicy</code> ë“±ê³¼ í•¨ê»˜ ì„¤ì •ì„ í•˜ë©´ ë‚´ë¶€ ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ í†µì œë„ ê°€ëŠ¥í•  ê²ƒìœ¼ë¡œ ìƒê°ëœë‹¤. </p><p><img loading="lazy" alt="router" src="/assets/images/subnetmode-1a9c172f146ddde3e0182a3f40eb7393.png" width="1172" height="720" class="img_E7b_"></p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ curl 192.168.112.183</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;title&gt;Welcome to nginx!&lt;/title&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ curl 10.100.213.92</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;title&gt;Welcome to nginx!&lt;/title&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="í™œìš©ë°©ì•ˆ">í™œìš©ë°©ì•ˆ<a class="hash-link" href="#í™œìš©ë°©ì•ˆ" title="Direct link to heading">â€‹</a></h2><p>ê¸°ì¡´ì—ëŠ” ì§‘ ë‚´ë¶€ì— ìˆëŠ” ìì› NASë‚˜ macOS ë“±ì„ ì›ê²©ìœ¼ë¡œ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ìš©ë„ì˜€ë‹¤ë©´, ì´ë²ˆ í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ ê¸°ë³¸ Personal ë¬´ë£Œ Planìœ¼ë¡œë„ í™œìš©ê°€ëŠ¥í•œ ëª‡ê°€ì§€ ìœ ìŠ¤ì¼€ì´ìŠ¤ë¥¼ ìƒê°í•´ë´¤ë‹¤.  </p><ul><li>ì¶”ê°€ì ì¸ VPN êµ¬ì„±ì—†ì´ ì›ê²©ì§€ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ì¡´ì¬í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ë””ë²„ê¹… ë° ê´€ë¦¬ ê°€ëŠ¥ (Telepresence ëŒ€ì²´)</li><li>sidecar ëª¨ë“œë¡œ í™œìš©ì‹œ Private ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ì„œë¹„ìŠ¤ êµ¬ì„± ë° IPê´€ë¦¬ ë¶ˆí•„ìš” </li><li>Prometheus Service Discovryë¥¼ tailscaleë¡œ ì§„í–‰í•˜ì—¬ ê°œì¸ ê´€ë¦¬ ë””ë°”ì´ìŠ¤ ì „ì²´ ëª¨ë‹ˆí„°ë§</li><li>ëª¨ë°”ì¼ ì›¹ì•± í…ŒìŠ¤íŠ¸ì‹œ ë³¸ì¸ íœ´ëŒ€í°ìœ¼ë¡œ ì§ì ‘ ì•¡ì„¸ìŠ¤ ê°€ëŠ¥</li><li>í˜„ì¬ ê°œì¸ í”„ë¡œì íŠ¸ë¡œ í™œìš©ì¤‘ì¸ Plex(ë¯¸ë””ì–´ì„œë²„), ë…¸íŠ¸ ì•± ë“±ì„ ì„œë¹„ìŠ¤ êµ¬ì„±ì—†ì´ ACL ë° MFA ì ìš©ì„ í†µí•œ ë³´ì•ˆ ê°•í™”</li><li>wireguard í”„ë¡œí† ì½œì„ í™œìš©í•˜ê¸° ë•Œë¬¸ì— ì–´ë””ì„œë“  ëŠê¹€ì—†ì´ í´ëŸ¬ìŠ¤í„° ë¦¬ì†ŒìŠ¤ ì ‘ê·¼</li><li>í˜„ì¬ êµ¬ì„±ì¤‘ì¸ site-to-site vpn ëŒ€ì²´ (OCI-OCIê°„)</li></ul><p>ë” ë§ì€ í™œìš©ë°©ì•ˆì´ ìˆì„í…ë° ì¼ë‹¨ ìƒê°ë‚˜ëŠ” ê²ƒë“¤ë§Œ ì ì–´ë³´ì•˜ë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ì´ë²ˆ í¬ìŠ¤íŒ…ì€ ë„¤íŠ¸ì›Œí¬ ìŠ¤í„°ë””ë¥¼ ì§„í–‰í•˜ë©´ì„œ ê³¼ì œë¡œ ì‘ì„±ëœ ë¶€ë¶„ì´ ì—†ì§€ ì•Šë‹¤. ì •ë§ ì´ë²ˆ ìŠ¤í„°ë””ëŠ” ì—­ëŒ€ê¸‰ìœ¼ë¡œ í€„ë¦¬í‹°ë‚˜ ì—¬ëŸ¬ê°€ì§€ë©´ì—ì„œ ì¢‹ì€ ì ì´ ë§ë‹¤. í•­ìƒ ëŒ€ë‹¨í•˜ë‹¤ê³  ëŠë¼ëŠ” ë¶„ë“¤ê³¼ í•¨ê»˜í•˜ê³  ìˆì–´ì„œ ë§ˆì§€ë§‰ê¹Œì§€ ì™„ì£¼í•  ìˆ˜ ìˆë„ë¡ ì¡°ê¸ˆ ë” ê³µë¶€í•´ì•¼ ê² ë‹¤ëŠ” ìƒê°ì´ ë“ ë‹¤. ë‹¤ì‹œí•œë²ˆ <a href="https://www.facebook.com/jongho.seo.5811" target="_blank" rel="noopener noreferrer">ê°€ì‹œë‹¤</a>ë‹˜ì„ <code>shout-out</code> í•˜ê³  2022ë…„ ì²« í¬ìŠ¤íŒ…ì€ ì´ê²ƒìœ¼ë¡œ ë§ˆë¬´ë¦¬í•œë‹¤.</p><blockquote><p>í•´ë‹¹ í¬ìŠ¤íŒ…ì€ í˜„ì¬ ì¬ì§ì¤‘ì¸ íšŒì‚¬ì— ê´€ë ¨ì´ ì—†ê³ , ê°œì¸ ì—­ëŸ‰ ê°œë°œì„ ìœ„í•œ ìë£Œë¡œ í™œìš©í•  ì˜ˆì •ì…ë‹ˆë‹¤.</p></blockquote>]]></content>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="wireguard" term="wireguard"/>
        <category label="tailscale" term="tailscale"/>
        <category label="vpn" term="vpn"/>
        <category label="network" term="network"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Synology monitoring with Prometheus and snmp exporter]]></title>
        <id>/prometheus/synology-prometheus/</id>
        <link href="https://ddii.dev/prometheus/synology-prometheus/"/>
        <updated>2021-06-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Prometheusë¡œ ì‹œë†€ë¡œì§€ NAS Monitoringí•˜ëŠ” ë°©ë²• ì •ë¦¬]]></summary>
        <content type="html"><![CDATA[<p>ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì•„ì¬ë¼ë©´ ë‹¤ë“¤ í•˜ë‚˜ì”© êµ¬ë¹„í•˜ê³  ìˆì„ ì‹œë†€ë¡œì§€(Synology) NASë¥¼ Prometheusì™€ snmp_exporterë¥¼ í™œìš©í•´ì„œ ëª¨ë‹ˆí„°ë§ í•˜ëŠ” ë°©ë²•ì„ ì •ë¦¬í•œë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="êµ¬ì„±ë°©ì•ˆ">êµ¬ì„±ë°©ì•ˆ<a class="hash-link" href="#êµ¬ì„±ë°©ì•ˆ" title="Direct link to heading">â€‹</a></h2><p>ì´ 5ê°œì˜ êµ¬ì„±ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§ ìŠ¤íƒì„ êµ¬ì„±í•˜ë ¤ê³  í•œë‹¤.  </p><p>êµ¬ì„±ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ë‹¤. ëª¨ë“  êµ¬ì„±ìš”ì†ŒëŠ” ì‹œë†€ë¡œì§€ë‚´ ë„ì»¤ ì»¨í…Œì´ë„ˆë¡œ êµ¬ì„±ë  ì˜ˆì •ì´ë‹¤.</p><ul><li>Prometheus : ë°ì´í„° ìˆ˜ì§‘ ë° ì €ì¥ì„ ë‹´ë‹¹í•˜ëŠ” ì‹œê³„ì—´ ë°ì´í„°ë² ì´ìŠ¤</li><li>Alertmanager : Prometheusì—ì„œ ë°œìƒëœ ì•Œë¦¼ì„ ìˆ˜ì‹ í•˜ì—¬ ë©”ì‹œì§€ë¥¼ ì „ë‹¬</li><li>Node Exporter : Linux Nodeì˜ ëª¨ë‹ˆí„°ë§ ë°ì´í„°ë¥¼ Expose</li><li>SNMP Exporter : SNMP ê¸°ë°˜ ë””ë°”ì´ìŠ¤ì˜ ëª¨ë‹ˆí„°ë§ ë°ì´í„°ë¥¼ Expose</li><li>Grafana : ì‹œê°í™” ë„êµ¬</li></ul><p><img loading="lazy" alt="arch" src="/assets/images/arch-8407219cefc78aa4cd1559137fe51bd4.png" width="511" height="152" class="img_E7b_">  </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì‹œë†€ë¡œì§€-ëª¨ë‹ˆí„°ë§">ì‹œë†€ë¡œì§€ ëª¨ë‹ˆí„°ë§<a class="hash-link" href="#ì‹œë†€ë¡œì§€-ëª¨ë‹ˆí„°ë§" title="Direct link to heading">â€‹</a></h2><p>ê¸°ë³¸ì ìœ¼ë¡œ ì‹œë†€ë¡œì§€ UIì—ì„œë„ ê´€ë ¨ëœ ë°ì´í„°ë“¤ì„ í™•ì¸í• ìˆ˜ ìˆê³  ë””ìŠ¤í¬ ì˜¤ë¥˜ë‚˜ ì „ì› ë“± íŠ¹ë³„í•œ ì´ë²¤íŠ¸ê°€ ë°œìƒí–ˆì„ ê²½ìš°ëŠ” ë³„ë„ë¡œ ì´ë©”ì¼ì´ë‚˜ ì»¤ìŠ¤í…€ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í†µí•´ ì•Œë¦¼ì„ ë°›ì„ ìˆ˜ ìˆì§€ë§Œ ë©”íŠ¸ë¦­ì„ ê¸°ë°˜ìœ¼ë¡œ í•˜ëŠ” íŠ¹ì • ìƒí™©ì—ì„œ ì•Œë¦¼ì„ ë°›ê±°ë‚˜ ë‚´ê°€ ì›í•˜ëŠ” ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œë¥¼ ê¾¸ë¯¸ê¸° ìœ„í•œ ìš©ìœ¼ë¡œ ì‹œë†€ë¡œì§€ëŠ” SNMPê¸°ë°˜ì˜ ëª¨ë‹ˆí„°ë§ì„ ì œê³µí•œë‹¤. ë‹¤ë¥¸ NMS ë˜ëŠ” ëª¨ë‹ˆí„°ë§ ë„êµ¬ë“±ì„ ì‚¬ìš©í•˜ê¸° ë³´ë‹¤ëŠ” ì—…ë¬´ì™€ ê´€ë ¨ìˆëŠ” ì‹¤ì œ SNMP exporterë¥¼ êµ¬ì„±í•´ë³´ê³  í”„ë¡œë©”í…Œìš°ìŠ¤ì™€ ê·¸ë¼íŒŒë‚˜ ëŒ€ì‹œë³´ë“œë¥¼ í†µí•´ ëª¨ë‹ˆí„°ë§ì„ í•˜ëŠ”ë° ëª©ì ì´ ìˆë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì‹œë†€ë¡œì§€-ì„¤ì •">ì‹œë†€ë¡œì§€ ì„¤ì •<a class="hash-link" href="#ì‹œë†€ë¡œì§€-ì„¤ì •" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì‚¬ì „-ìš”êµ¬ì‚¬í•­">ì‚¬ì „ ìš”êµ¬ì‚¬í•­<a class="hash-link" href="#ì‚¬ì „-ìš”êµ¬ì‚¬í•­" title="Direct link to heading">â€‹</a></h3><ul><li><a href="https://www.synology.com/en-global/dsm/packages/Docker" target="_blank" rel="noopener noreferrer">ì‹œë†€ë¡œì§€ Docker</a></li><li>SSH í—ˆìš©</li><li>Admin ê¶Œí•œ</li><li>SNMP ì„¤ì •</li></ul><p>SNMP ì„¤ì •ì„ ì œì™¸í•œ 3ê°€ì§€ êµ¬ì„±ì€ ê¸°ë³¸ì ìœ¼ë¡œ ë˜ì–´ìˆë‹¤ ê°€ì •í•˜ê³  ì§„í–‰í•œë‹¤.  </p><p>ì‹œë†€ë¡œì§€ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ SNMP ì„¤ì •ì´ ë¹„í™œì„±í™” ìƒíƒœì´ê¸° ë•Œë¬¸ì— ë³€ê²½ì´ í•„ìš”í•˜ë‹¤. ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ ì‹œë†€ë¡œì§€ì˜ ì œì–´íŒ - í„°ë¯¸ë„ ë° SNMP - SNMPíƒ­ ìœ¼ë¡œ ì´ë™í•´ì„œ SNMP ì„œë¹„ìŠ¤ë¥¼ í™œì„±í™”ë¥¼ ì²´í¬í•˜ê³  ì´í›„ snmp exporter ì„¤ì •ì—ì„œ ì‚¬ìš©ë  communityê°’ì„ ì›í•˜ëŠ” ê°’ìœ¼ë¡œ ë³€ê²½í•œ í›„ ì €ì¥í•œë‹¤.  </p><p><img loading="lazy" alt="snmp" src="/assets/images/snmp-1dd8d97d83c6837b21f36919cc3e5c1c.png" width="991" height="559" class="img_E7b_"></p><p>ê·¸ëŸ¼ ì´ì œ ì‹œë†€ë¡œì§€ëŠ” ì™¸ë¶€ í†µì‹ ì„ ìœ„í•œ Portì¸ UDP 161 portë¡œ snmpdì„ ì‹¤í–‰í•˜ê²Œ ëœë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">root@DSM2:~# netstat -unlp | grep 161</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">udp        0      0 0.0.0.0:161             0.0.0.0:*                           9437/snmpd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">udp6       0      0 :::161                  :::*                                9437/snmpd</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="snmp-exporter">SNMP Exporter<a class="hash-link" href="#snmp-exporter" title="Direct link to heading">â€‹</a></h2><p><a href="https://github.com/prometheus/snmp_exporter" target="_blank" rel="noopener noreferrer">https://github.com/prometheus/snmp_exporter</a></p><p>SNMP ExporterëŠ” í”„ë¡œë©”í…Œìš°ìŠ¤ê°€ ìˆ˜ì§‘í•  ìˆ˜ ìˆëŠ” í˜•ì‹ìœ¼ë¡œ SNMP ë©”íŠ¸ë¦­ ë°ì´í„°ë¥¼ Expose í• ë•Œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ì „í†µì ì¸ ëª¨ë‹ˆí„°ë§ ë„êµ¬ì™€ ë§ˆì°¬ê°€ì§€ë¡œ MIBë¥¼ ì‚¬ìš©í•˜ê²Œ ëœë‹¤. ë ˆí¬ì§€í† ë¦¬ ì»¨ì…‰ì—ë„ ì„¤ëª…ì´ ì í˜€ìˆë“¯ì´ SNMP ë°ì´í„°ëŠ” ê³„ì¸µí˜• ë°ì´í„° êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆê³  í”„ë¡œë©”í…Œìš°ìŠ¤ëŠ” ë‹¤ì°¨ì› ë§¤íŠ¸ë¦­ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ë‘ ì‹œìŠ¤í…œì€ ì˜ ë§ëŠ”ë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤.</p><p>SNMP ë°ì´í„° êµ¬ì¡°ë¥¼ ì—¬ê¸°ì„œ ìì„¸íˆ ì„¤ëª…í•˜ì§€ëŠ” ì•Šê² ì§€ë§Œ  SNMP indexì™€ labelì„ ë§¤í•‘í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•œë‹¤. ë‹¤ë¥¸ ìµìŠ¤í¬í„°ì™€ ë™ì¼í•˜ê²Œ daemon í˜•íƒœë¡œ ì‹¤í–‰ì´ ë˜ê³  <code>http://localhost:9116/snmp?module=if_mib&amp;target=1.2.3.4</code> ì™€ ê°™ì´ moduleê³¼ targetì„ ì„¤ì •í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë°ì´í„° ìˆ˜ì§‘ì„ í•  ìˆ˜ ìˆë‹¤.</p><p>ê¸°ë³¸ config íŒŒì¼ì„ <code>snmp.yml</code>ì„ ì°¸ì¡°í•˜ê²Œ ë˜ëŠ”ë° ìˆ˜ë™ìœ¼ë¡œ ì‘ì„±í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ generatorë¥¼ í†µí•´ ìƒì„±í•˜ê²Œ ëœë‹¤.<br>
<a href="https://github.com/prometheus/snmp_exporter/tree/main/generator" target="_blank" rel="noopener noreferrer">https://github.com/prometheus/snmp_exporter/tree/main/generator</a></p><p>í•´ë‹¹ ë§í¬ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë“¯ì´ generatorì—ì„œ ë²¤ë”ë³„ MIB íŒŒì¼ê³¼ generator.ymlë¥¼ ì°¸ì¡°í•´ì„œ ë¹Œë“œ, ì‹¤í–‰í•˜ê³  ê²°ê³¼ê°’ìœ¼ë¡œ snmp.ymlì´ ìƒì„±ë˜ê²Œ ëœë‹¤. ë”°ë¡œ ë§Œë“¤ì–´ë„ ë˜ì§€ë§Œ ì‹œë†€ë¡œì§€ì—ë§Œ í•´ë‹¹ íŒŒì¼ì„ ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ë¯¸ë¦¬ ë§Œë“¤ì–´ ë‘ì‹  ë¶„ì´ ê³„ì…”ì„œ <a href="https://grafana.com/orgs/tumak" target="_blank" rel="noopener noreferrer">tumak</a>ì˜ ê·¸ë¼íŒŒë‚˜ ëŒ€ì‹œë³´ë“œë¥¼ ì°¸ì¡°í•˜ì˜€ë‹¤. ê·¸ë¦¬ê³  ì´í›„ ì‹œë†€ë¡œì§€ ëŒ€ì‹œë³´ë“œë¡œë„ ì‚¬ìš©í•  ì˜ˆì •ì´ë‹¤.  </p><p><a href="https://grafana.com/grafana/dashboards/14284" target="_blank" rel="noopener noreferrer">https://grafana.com/grafana/dashboards/14284</a></p><p>ë§Œë“¤ì–´ì§„ <code>snmp.yml</code>ì—ì„œ ë³€ê²½í•´ì•¼ í•  ë¶€ë¶„ì€ í˜„ì¬ ì‹œë†€ë¡œì§€ì—ì„œ ì„¤ì •ëœ SNMP community ì„¤ì •ì´ë‹¤. snmp.yml ë§¨ ì•„ë˜ community ê°’ì„ ì‹œë†€ë¡œì§€ì— ì„¤ì •í•œ ê°’ê³¼ ì¼ì¹˜í•˜ê²Œ ë³€ê²½í•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">auth</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">community</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> synology</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="prometheus-alertmanager-exporter-grafana-êµ¬ì„±">Prometheus, Alertmanager, Exporter, Grafana êµ¬ì„±<a class="hash-link" href="#prometheus-alertmanager-exporter-grafana-êµ¬ì„±" title="Direct link to heading">â€‹</a></h2><p>ê°„ë‹¨í•œ ì•„í‚¤í…ì²˜ êµ¬ì„±ë„ë¡œ ì‹œë†€ë¡œì§€ ìì²´ ë˜ëŠ” OSê¸°ë°˜ì—ì„œ ë°œìƒí•˜ëŠ” ëª¨ë‹ˆí„°ë§ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ëŠ” ê°ê°ì˜ Exporterë¥¼ êµ¬ì„±í•˜ê³  í•´ë‹¹ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ëŠ” Prometheus ì„œë²„ì™€ ê´€ë ¨ ë°ì´í„°ë¥¼ ì‹œê°í™”í•˜ëŠ” Grafanaê¹Œì§€ í•œë²ˆì— êµ¬ì„±í•˜ê¸° ìœ„í•´ Docker-composeë¥¼ ì‚¬ìš©í•  ì˜ˆì •ì´ë‹¤.  </p><p>Docker Compose íŒŒì¼ì„ ë§¨ ì•„ë˜ snmp exporter ë¶€í„° í•˜ë‚˜ì”© ìª¼ê°œì„œ ì‚´í´ë³´ì.  </p><p>SNMP ExporterëŠ” ìœ„ì—ì„œ ë§Œë“  snmp.yml íŒŒì¼ì„ ë§ˆìš´íŠ¸í•´ì„œ ì‹¤í–‰ë˜ë„ë¡ í•œë‹¤. ê·¸ëŸ¬ë©´ SNMP exporterê°€ ì‹¤í–‰ë˜ë©´ì„œ snmpíŒŒì¼ì„ ì°¸ì¡°í•´ì„œ ì‹¤í–‰ì´ ë˜ê³  prometheus.yamlì—ì„œ ì •ì˜í•œ targetê³¼ SNMP í”„ë¡œí† ì½œì„ í†µí•´ ê´€ë ¨ëœ ë©”íŠ¸ë¦­ ê°’ì„ ìˆ˜ì§‘í•´ì„œ Exposeí•˜ê²Œ ë  ê²ƒì´ë‹¤.  </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">snmp-exporter</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prom/snmp</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">exporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">container_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> snmp_exporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ./snmp_exporter/</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/etc/snmp_exporter/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 9116</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">9116</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ./snmp</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">synology/snmp.yml</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/etc/snmp_exporter/snmp.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"--config.file=/etc/snmp_exporter/snmp.yml"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë‹¤ìŒì€ Node Exporterë¥¼ ì‹¤í–‰í•˜ëŠ” ë¶€ë¶„ìœ¼ë¡œ ì‹œìŠ¤í…œì— ê´€ë ¨ëœ ê¶Œí•œì´ í•„ìš”í•˜ë¯€ë¡œ <code>/proc, /sys, /</code> ë“± íŒŒì¼ì‹œìŠ¤í…œì˜ read only ê¶Œí•œê³¼ <code>privileged: true</code> ì„¤ì •ì„ í†µí•´ ì‹¤í–‰ë˜ê²Œ ë  ê²ƒì´ë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">node-exporter</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">privileged</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prom/node</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">exporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">container_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">exporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">restart</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"9100:9100"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> /proc</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/host/proc</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">ro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> /sys</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/host/sys</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">ro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> /</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/rootfs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">ro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"--path.procfs=/host/proc"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"--path.sysfs=/host/sys"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"--collector.filesystem.ignored-mount-points"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"^/(rootfs/)?(dev|etc|host|proc|run|sys|volume1)($$|/)"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë‹¤ìŒì€ ì‹œê°í™”ì™€ ì•Œë¦¼ì„ ë‹´ë‹¹í•  Grafanaì™€ Alertmanager ë¶€ë¶„ìœ¼ë¡œ Alertmanagerì˜ ê²½ìš° ê¸°ë³¸ì ì¸ configë¥¼ ë§ˆìš´íŠ¸í•´ì„œ ì‹¤í–‰ì„ í•  ì˜ˆì •ì´ë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">grafana</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">container_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> grafana</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> grafana/grafana</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"3000:3000"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">depends_on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">alertmanager</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">container_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> alertmanager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prom/alertmanager</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">v0.21.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 9093</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">9093</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ./config/alertmanager.yml</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/etc/alertmanager/alertmanager.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">restart</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> always</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë§ˆì§€ë§‰ìœ¼ë¡œ, PrometheusëŠ” ì•Œë¦¼ë£°ì„ ìƒì„±í•˜ê¸° ìœ„í•´ì„œ ë³„ë„ë¡œ rules ë””ë ‰í† ë¦¬ì™€ ë¯¸ë¦¬ ìƒì„±í•´ë‘” configë¥¼ mount ì‹œí‚¨ë‹¤.  </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"3.8"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">prometheus</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">container_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> quay.io/prometheus/prometheus</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">v2.26.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ./config/prometheus.yml</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/etc/prometheus/prometheus.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ./rules</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/etc/prometheus/rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"--config.file=/etc/prometheus/prometheus.yml --storage.tsdb.path=/prometheus"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 9090</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">9090</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>prometheus.yml configë¥¼ ì‚´í´ë³´ë©´ ìˆ˜ì§‘ì£¼ê¸°ëŠ” 1ë¶„ìœ¼ë¡œ, ë‚˜ë¨¸ì§€ ì–¼ëŸ¿ë§¤ë‹ˆì €ì™€ ìˆ˜ì§‘í•  ëŒ€ìƒì¸ exporterë“¤ì˜ target endpointë¥¼ ì¶”ê°€í•˜ì—¬ ì‹¤í–‰í•  ì˜ˆì •ì´ë‹¤. ì—¬ê¸°ì„œëŠ” ì‹œë†€ë¡œì§€ SNMP ì„œë¹„ìŠ¤ì™€ í†µì‹ í•˜ê¸° ìœ„í•´ SNMP Exporterì˜ targetì„ ì‹¤ì œ ì‚¬ìš©ì¤‘ì¸ ì‹œë†€ë¡œì§€ IPë¥¼ ë“±ë¡í•˜ë„ë¡ í•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">global</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">scrape_interval</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">     1m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">evaluation_interval</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 1m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">alerting</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">alertmanagers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">static_configs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">targets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'alertmanager:9093'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">rule_files</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"/etc/prometheus/rules/*"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">scrape_configs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">job_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'prometheus'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">static_configs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">targets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'localhost:9090'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">group</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'prometheus'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">job_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">static_configs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">targets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'node-exporter:9100'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">job_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'snmp-exporter'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">static_configs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">targets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'192.168.0.100'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">metrics_path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /snmp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">params</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">module</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">synology</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">relabel_configs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">source_labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">__address__</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">target_label</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> __param_target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">source_labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">__param_target</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">target_label</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> instance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">target_label</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> __address__</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">replacement</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 192.168.0.100</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">9116</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># The SNMP exporter's real synology hostname:port. </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="stack-ì‹¤í–‰">Stack ì‹¤í–‰<a class="hash-link" href="#stack-ì‹¤í–‰" title="Direct link to heading">â€‹</a></h2><p>ëª¨ë“  ì„¤ì •ì´ ì™„ë£Œë˜ë©´ ì¼ë‹¨ ê¸°ë³¸ì ì¸ ì‹¤í–‰ì´ ê°€ëŠ¥í•œ ìƒíƒœë¡œ ì‹œë†€ë¡œì§€ CLIë¥¼ ì‹¤í–‰í•œë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ ì‹œë†€ë¡œì§€ëŠ” adminê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•´ì„œ sudo ê¶Œí•œì„ í†µí•´ Docker Compose ì‹¤í–‰ì„ í•´ì•¼ í•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ssh admin@192.168.31.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo -i</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><a href="https://github.com/ddiiwoong/synology-prometheus.git" target="_blank" rel="noopener noreferrer">https://github.com/ddiiwoong/synology-prometheus.git</a>ì„ cloneí•´ì„œ /snmp-synology/snmp.yml íŒŒì¼ì˜ community ê°’ì„ ë³¸ì¸ì˜ synology ê°’ìœ¼ë¡œ ë³€ê²½í•œ í›„ Docker Composeë¥¼ ë°ëª¬í˜•íƒœë¡œ ì‹¤í–‰í•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose up -d</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë³¸ì¸ì˜ <code>http://&lt;ì‹œë†€ë¡œì§€ IP&gt;:9090/targets</code> ìœ¼ë¡œ ì ‘ì†í•´ì„œ 3ê°œì˜ targetì´ ì •ìƒì¸ì§€ í™•ì¸í•œë‹¤. ê·¸ë¦¬ê³  í‘œí˜„ì‹ ë¸Œë¼ìš°ì €ë¡œ ëŒì•„ì™€ì„œ <code>node_cpu_seconds_total</code> ê³¼ <code>diskModel</code>ì„ í†µí•´ ë‘ê°œì˜ exporterì—ì„œ ë°ì´í„°ê°€ ìˆ˜ì§‘ë˜ê³  ìˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤. <code>diskModel</code>ì€ ì‹œë†€ë¡œì§€ì— ì¥ì°©ëœ í•˜ë“œë””ìŠ¤í¬ ëª¨ë¸ ì •ë³´ë¥¼ ë³´ì—¬ì£¼ëŠ” ë©”íŠ¸ë¦­ì´ë‹¤.  </p><p><img loading="lazy" alt="diskmodel" src="/assets/images/diskmodel-bf2516bf4a6315cc67bf93a4daf244c8.png" width="751" height="425" class="img_E7b_"></p><p>ê·¸ë¼íŒŒë‚˜ ëŒ€ì‹œë³´ë“œëŠ” <code>http://&lt;ì‹œë†€ë¡œì§€ IP&gt;:3000</code> ë¡œ ì ‘ì†í•´ì„œ ì´ˆê¸° ê³„ì •ì¸ <code>admin:admin</code>ì„ ì…ë ¥í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ê¸°ë³¸ í™”ë©´ì„ ë³¼ìˆ˜ ìˆë‹¤. ì—¬ê¸°ì„œ ì¢Œì¸¡ì˜ ê¸°ì–´ëª¨ì–‘ ë©”ë‰´(Configuration)ì˜ <code>Data Sources</code>ë¥¼ í´ë¦­í•˜ê³  í”„ë¡œë©”í…Œìš°ìŠ¤ ë°ì´í„°ì†ŒìŠ¤ë¥¼ ë“±ë¡í•œë‹¤.  </p><p>Docker Composeë¡œ ì‹¤í–‰í•  ë•Œ ì•„ë˜ì™€ ê°™ì´ <code>prometheus</code> ì´ë¦„ìœ¼ë¡œ ì‹¤í–‰í–ˆê¸° ë•Œë¬¸ì— HTTP URLì— <code>prometheus:9090</code>ì„ ì…ë ¥í•˜ê³  <code>Save &amp; Test</code>ë¡œ ë°ì´í„° ì†ŒìŠ¤ë¥¼ ì €ì¥í•œë‹¤.  </p><p><img loading="lazy" alt="grafana" src="/assets/images/grafana-0f11cac8c12e28ca7f02fe4835593ede.png" width="906" height="1144" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì‹œë†€ë¡œì§€-ëŒ€ì‹œë³´ë“œ-êµ¬ì„±">ì‹œë†€ë¡œì§€ ëŒ€ì‹œë³´ë“œ êµ¬ì„±<a class="hash-link" href="#ì‹œë†€ë¡œì§€-ëŒ€ì‹œë³´ë“œ-êµ¬ì„±" title="Direct link to heading">â€‹</a></h2><p>ë§ˆì§€ë§‰ìœ¼ë¡œ <a href="https://grafana.com/grafana/dashboards/14284" target="_blank" rel="noopener noreferrer">https://grafana.com/grafana/dashboards/14284</a>ì˜ ëŒ€ì‹œë³´ë“œë¥¼ ì¶”ê°€í•˜ëŠ” ê³¼ì •ì„ ì§„í–‰í•œë‹¤.  </p><p>ì¢Œì¸¡ì˜ + ë©”ë‰´(Create)ì˜ <code>Import</code>ë¥¼ í´ë¦­í•˜ê³  ìœ„ ëŒ€ì‹œë³´ë“œ ID <code>14284</code>ë¥¼ ì…ë ¥í•˜ê³  ë“±ë¡í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ì‹œë†€ë¡œì§€ì˜ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><p><img loading="lazy" alt="synology" src="/assets/images/synology-0fb30768e59fa34c0bf2890f96e7b5aa.png" width="1286" height="1015" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ê°„ë‹¨(?)í•˜ê²Œ ì‹œë†€ë¡œì§€ ë‚˜ìŠ¤ë¥¼ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì •ë¦¬í•´ë´¤ë‹¤. ëˆ„êµ°ê°€ì—ê²ŒëŠ” ì¬ë¯¸ë¡œ ëˆ„êµ°ê°€ì—ê²ŒëŠ” ë„ì›€ì´ ë˜ê¸¸ ë°”ë¼ë©°, í¬ìŠ¤íŒ…ê³¼ ê´€ë ¨ëœ ëª¨ë“ ê²ƒì€ ê°œì¸ ì·¨ë¯¸ë¡œ ì‘ì„±ëœ ë‚´ìš©ìœ¼ë¡œ íšŒì‚¬ë‚˜ ë‚˜ìŠ¤ì™€ ê´€ë ¨ëœ ì œí’ˆê³¼ ê´€ê³„ê°€ ì—†ìŒì„ ì•Œë¦°ë‹¤.</p>]]></content>
        <category label="Prometheus, Synology, ì‹œë†€ë¡œì§€" term="Prometheus, Synology, ì‹œë†€ë¡œì§€"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[vSphere with Tanzu homelab running on ASUS PN50 (2/2)]]></title>
        <id>kubernetes/vSphere-with-Tanzu-homelab-2/</id>
        <link href="https://ddii.dev/kubernetes/vSphere-with-Tanzu-homelab-2/"/>
        <updated>2020-12-06T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ” Tanzu Clusterë¥¼ ë‹¨ì¼ í™ˆë© vSphere ì„œë²„ì— ì˜¬ë ¤ë³¸ë‹¤]]></summary>
        <content type="html"><![CDATA[<p>ì§€ë‚œê¸€ì— ì´ì–´ ì´ë²ˆì—ëŠ” ë„¤íŠ¸ì›Œí¬ êµ¬ì„±í•˜ëŠ” ë°©ë²•ê³¼ vSphere Clusterì— ì¶”ê°€ì ì¸ Kubernetes í´ëŸ¬ìŠ¤í„°ë¥¼ ë°°í¬í•˜ëŠ” ê²ƒì— ëŒ€í•´ ì´ì•¼ê¸° í•˜ê³ ì í•œë‹¤. ì´ë²ˆ ê¸€ë„ ì§€ë‚œê¸€ê³¼ ë™ì¼í•˜ê²Œ <a href="https://www.virtuallyghetto.com/" target="_blank" rel="noopener noreferrer">virtuallyGhetto</a> ë¸”ë¡œê·¸ í¬ìŠ¤íŒ…ì„ ì°¸ê³ í•˜ì—¬ ê·¸ëŒ€ë¡œ ì§„í–‰í•œ ë‚´ìš©ì´ë¼ê³  ë³´ë©´ ëœë‹¤.</p><p><a href="https://www.virtuallyghetto.com/2020/11/complete-vsphere-with-tanzu-homelab-with-just-32gb-of-memory.html" target="_blank" rel="noopener noreferrer">https://www.virtuallyghetto.com/2020/11/complete-vsphere-with-tanzu-homelab-with-just-32gb-of-memory.html</a></p><p>ì§€ë‚œ í¬ìŠ¤íŒ…ì€ ë‹¤ìŒ ë§í¬ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><blockquote><p>ì´ì „ê¸€ - <a href="https://ddii.dev/kubernetes/vSphere-with-Tanzu-homelab/" target="_blank" rel="noopener noreferrer">vSphere with Tanzu homelab running on ASUS PN50 (1/2)</a></p></blockquote><p><img loading="lazy" alt="vcsa" src="/assets/images/vcsa-21b40b1ba6ed8f23180bd647230b492b.png" width="1143" height="625" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="vdsvsphere-distributed-switch-êµ¬ì„±">VDS(vSphere Distributed Switch) êµ¬ì„±<a class="hash-link" href="#vdsvsphere-distributed-switch-êµ¬ì„±" title="Direct link to heading">â€‹</a></h2><p>ì´ë²ˆ êµ¬ì„±ì˜ ê²½ìš°ì—ëŠ” usb nicë¥¼ í•˜ë‚˜ë§Œì„ ì‚¬ìš©í•´ì„œ ì§„í–‰í•˜ê¸° ë•Œë¬¸ì— ìœ„ì—ì„œ ì„¤ì •í–ˆë˜ 3ê°œì˜ ë„¤íŠ¸ì›Œí¬(Management, Frontend, Workload)ë¡œ ë¶„ë¦¬í•˜ê¸° ìœ„í•´ VDSë¥¼ ì‹ ê·œë¡œ ìƒì„±í•˜ê³  ê¸°ì¡´ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„°ë¥¼ ë³€ê²½í•˜ëŠ” ì‘ì—…ì„ ìˆ˜í–‰í•´ì•¼ í•œë‹¤.  </p><p>ë¨¼ì € ì‹ ê·œ êµ¬ì„±í•œ vCenter UI(<a href="https://vcsa.tanzu.local/ui" target="_blank" rel="noopener noreferrer">https://vcsa.tanzu.local/ui</a>)ë¡œ ì ‘ì†í•´ <code>Networking</code> ë©”ë‰´ë¡œ ì´ë™í•´ì„œ <code>VDS</code> ë©”ë‰´ ìš°í´ë¦­ í›„ <code>Add and Manage Hosts</code>ë¥¼ ì„ íƒí•œë‹¤. </p><p><img loading="lazy" alt="network" src="/assets/images/vcsa_network_menu-7d5081225e5a1d27d8ffc03e95c166cf.png" width="911" height="451" class="img_E7b_"></p><p>VDS ì„¤ì •í•˜ëŠ” 6ë‹¨ê³„ë¥¼ ì§„í–‰í•œë‹¤. </p><ul><li>1ë‹¨ê³„ -  <code>Add hosts</code>ë¥¼ ì„ íƒí•œë‹¤.</li><li>2ë‹¨ê³„ - ESXi hostë¥¼ ì„ íƒí•œë‹¤. </li><li>3ë‹¨ê³„ - pyhysical adapterë¥¼ ìƒì„±í•œ í›„ì— ì„ íƒí•˜ê²Œ ë˜ëŠ”ë° êµ¬ì„±í•œ ë©ì—ì„œëŠ” USB TYPE NICë¥¼ ì‚¬ìš©í•˜ì—¬ <code>vusb0</code> ì–´ëŒ‘í„°ë¥¼ ì„ íƒí•˜ê³  <code>Assign uplink</code>ì—ì„œ <code>dvUplink1</code>ë¥¼ Assigní•œë‹¤.</li><li>4ë‹¨ê³„ - VMkernel adapterì—ì„œ vmk0ì„ ì„ íƒí•˜ê³  <code>Assign port group</code>ì—ì„œ Networkë¥¼ Managementë¥¼ Assigní•œë‹¤.</li><li>5ë‹¨ê³„ - VM Migrationì€ ìƒëµí•œë‹¤.</li><li>6ë‹¨ê³„ - ì„¤ì •ë˜ëŠ” ë‚´ìš©ì„ í™•ì¸í•˜ê³  Finishë¥¼ í•˜ê²Œ ë˜ë©´ ê¸°ì¡´ VCSAì˜ ê¸°ë³¸ ë„¤íŠ¸ì›Œí¬ê°€ <code>vSwitch</code>ì—ì„œ <code>VDS</code>ë¡œ ë³€ê²½ë˜ì—ˆê¸° ë•Œë¬¸ì— VSCA Client ì ‘ì†ì´ ëŠì–´ì§€ê²Œ ëœë‹¤. </li></ul><p>ë‹¤ì‹œ ESXi Clientë¡œ ì ‘ì†í•´ì„œ VCSA Port Group(ë„¤íŠ¸ì›Œí¬)ì„ ì•„ë˜ì™€ ê°™ì´ ê¸°ì¡´ <code>VM Network</code>ì—ì„œ <code>Management</code>ë¡œ ë³€ê²½í•˜ë©´ ë‹¤ì‹œ VSCA Clientë¡œ ì ‘ì†ì´ ê°€ëŠ¥í•˜ê²Œ ëœë‹¤.</p><p><img loading="lazy" alt="network_adapter" src="/assets/images/vcsa_network-8a0d605b125e949f2ff5adf466e9867c.png" width="720" height="502" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="routervmì˜-network-port-group-ì¶”ê°€frontend-workload">RouterVMì˜ Network Port Group ì¶”ê°€(Frontend, Workload)<a class="hash-link" href="#routervmì˜-network-port-group-ì¶”ê°€frontend-workload" title="Direct link to heading">â€‹</a></h2><p>ì´ì „ í¬ìŠ¤íŒ…ì—ì„œ ìƒì„±í•œ Router VMì€ êµ¬ì„±í•  ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬(10.10.0.0/24 &amp; 10.20.0.0/24)ë¡œì˜ ë¼ìš°íŒ…ê³¼ ì™¸ë¶€ ë„¤íŠ¸ì›Œí¬ë¡œ NAT ë° í¬ì›Œë”©ì„ ìœ„í•´ì„œ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— vSphere ë˜ëŠ” VCSA Clientì—ì„œ <code>router.tanzu.local</code>ì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„°ë¥¼ <code>Frontend</code>, <code>Workload</code>ë¡œ ì¶”ê°€í•˜ëŠ” ì‘ì—…ì´ í•„ìš”í•˜ë‹¤.</p><p><img loading="lazy" alt="routervm" src="/assets/images/routervm-0ec21646dbb1c8a57fee486e93e78920.png" width="723" height="502" class="img_E7b_"></p><p>êµ¬ì„±ì„ ì™„ë£Œí•œ í›„ì— ê°„ë‹¨í•œ ë„¤íŠ¸ì›Œí¬ êµ¬ì„±ì„ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.  </p><p><img loading="lazy" alt="vswitch" src="/assets/images/vswitch-cd0a014db46be6a31193bca2c2a153cd.png" width="789" height="604" class="img_E7b_"></p><p>ë¬¼ë¦¬ ì¸í„°í˜ì´ìŠ¤ <code>vusb0</code> ì•„ë˜ ê°€ìƒ ìŠ¤ìœ„ì¹˜ê°€ 3ê°œ êµ¬ì„±ë˜ì–´ ìˆê³  ì™¸ë¶€ì—ì„œë„ RouterVMì„ í†µí•´ ì ‘ì†ì´ ê°€ëŠ¥í•˜ë„ë¡ ì ‘ì†í•˜ëŠ” ë¡œì»¬ ë¨¸ì‹ ì—ì„œ ë¼ìš°íŒ… ê²½ë¡œ ì¶”ê°€ê°€ í•„ìš”í•˜ë‹¤.</p><ul><li><p>Windows<br>
<code>route print</code> ëª…ë ¹ìœ¼ë¡œ ì¸í„°í˜ì´ìŠ¤ IDë¥¼ ë¨¼ì € í™•ì¸í•˜ê³  ì•„ë˜ì™€ ê°™ì´ ì„¤ì •í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-powershell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-powershell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">route ADD 10.10.0.0 MASK 255.255.255.0 192.168.0.201 METRIC 3 IF 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">route ADD 10.20.0.0 MASK 255.255.255.0 192.168.0.201 METRIC 3 IF 5</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li><li><p>MacOS</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">sudo route -n add -net 10.10.0.0/24 192.168.0.201</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo route -n add -net 10.20.0.0/24 192.168.0.201</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li><li><p>WSL</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">sudo route -n add -net 10.10.0.0/24 gw &lt;Gateway IP&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo route -n add -net 10.20.0.0/24 gw &lt;Gateway IP&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="haproxyvm-ì„¤ì •">HAProxyVM ì„¤ì •<a class="hash-link" href="#haproxyvm-ì„¤ì •" title="Direct link to heading">â€‹</a></h2><p>ì´ì „ í¬ìŠ¤íŒ…ì—ì„œ ìƒì„±í•œ HAProxyë„ ì¶”ê°€ëœ ë„¤íŠ¸ì›Œí¬ í™˜ê²½ìœ¼ë¡œ ì„¤ì •ì„ í•˜ê¸° ìœ„í•´ ë‹¤ìŒ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•œë‹¤.   </p><ul><li><a href="https://github.com/lamw/vsphere-with-tanzu-homelab-scripts/blob/master/deploy_3nic_haproxy.ps1" target="_blank" rel="noopener noreferrer">https://github.com/lamw/vsphere-with-tanzu-homelab-scripts/blob/master/deploy_3nic_haproxy.ps1</a></li></ul><p>êµ¬ì„±í•œ í™˜ê²½ì— ë§ê²Œ ìŠ¤í¬ë¦½íŠ¸ë‚´ ë³€ìˆ˜ë“¤ì„ ìˆ˜ì •í•œ í›„ ì‹¤í–‰í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-powershell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-powershell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyOVA = "C:\esxi\vmware-haproxy-v0.1.8.ova"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$Cluster = "Tanzu-Cluster"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$VMHost = "esxi-01.tanzu.local"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$Datastore = "datastore1"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyDisplayName = "haproxy.tanzu.local"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyHostname = "haproxy.tanzu.local"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyDNS = "192.168.0.201"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyManagementNetwork = "Management"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyManagementIPAddress = "192.168.0.203/24" # Format is IP Address/CIDR Prefix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyManagementGateway = "192.168.0.1"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyFrontendNetwork = "Frontend"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyFrontendIPAddress = "10.10.0.2/24" # Format is IP Address/CIDR Prefix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyFrontendGateway = "10.10.0.1"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyWorkloadNetwork = "Workload"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyWorkloadIPAddress = "10.20.0.2/24" # Format is IP Address/CIDR Prefix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyWorkloadGateway = "10.20.0.1"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyLoadBalanceIPRange = "10.10.0.64/26" # Format is Network CIDR Notation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyOSPassword = "VMware1!"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyPort = "5556"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyUsername = "wcp"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$HAProxyPassword = "VMware1!"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-powershell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-powershell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">./deploy_3nic_haproxy.ps1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´í›„ HAProxy VMë‚´ì—ì„œ ì—¬ëŸ¬ ì¸í„°í˜ì´ìŠ¤ì—ì„œ <code>Reverse Path Filtering</code>ì„ <code>Disable</code>í•˜ê¸° ìœ„í•´ ë‹¤ìŒ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•œë‹¤. </p><p>*<a href="https://github.com/lamw/vsphere-with-tanzu-homelab-scripts/blob/master/setup_haproxy.sh" target="_blank" rel="noopener noreferrer">setup_haproxy.sh</a>  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">touch /etc/sysctl.d/999-tanzu.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod +x /etc/sysctl.d/999-tanzu.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IFS=$'\n'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for i in $(sysctl -a | grep rp_filter | grep 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SYSCTL_SETTING=$(echo ${i} | awk '{print $1}')</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Update live system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sysctl -w ${SYSCTL_SETTING}=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Persist settings upon reboot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo "${SYSCTL_SETTING}=0" &gt;&gt; /etc/sysctl.d/999-tanzu.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><blockquote><p><code>Reverse Path Filtering</code>ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ í•˜ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ì—¬ëŸ¬ê°œì˜ ì¸í„°í˜ì´ìŠ¤ë¡œ ë“¤ì–´ì˜¤ëŠ” íŒ¨í‚·ì˜ ì†ŒìŠ¤IPì— ëŒ€í•´ì„œ ë¼ìš°íŒ… í…Œì´ë¸”ì„ í™•ì¸í•œ í›„ íŒ¨í‚·ì´ ë“¤ì–´ì˜¨ ë™ì¼í•œ ì¸í„°í˜ì´ìŠ¤ë¡œ ë‹¤ì‹œ ë‚˜ê°€ëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒì„ ë§í•œë‹¤. <code>rp_filter</code>ê°€ 1ë¡œ ì„¤ì •ì´ ë˜ì–´ìˆìœ¼ë©´, íŠ¹ì • ì¸í„°í˜ì´ìŠ¤ë¡œ ë“¤ì–´ì˜¨ íŒ¨í‚· ì •ë³´ì™€ OSì˜ FIB(Forward Information Base)ì— ì •ì˜ëœ ì •ë³´ì™€ ì¼ì¹˜í•˜ì§€ ì•Šì„ê²½ìš°, ë“¤ì–´ì˜¨ íŒ¨í‚·ì„ ë²„ë¦¬ëŠ” ê¸°ëŠ¥ì„ í•˜ê¸° ë•Œë¬¸ì— ìœ„ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í†µí•´ rp_filter ê°’ì„ ëª¨ë‘ 0ìœ¼ë¡œ ë³€ê²½í•˜ëŠ” ê²ƒì´ë‹¤. ìì„¸í•œ ë‚´ìš©ì€ <a href="https://access.redhat.com/solutions/53031" target="_blank" rel="noopener noreferrer">https://access.redhat.com/solutions/53031</a>ë¥¼ ì°¸ê³ í•˜ì.</p></blockquote><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="content-library-êµ¬ì„±">Content Library êµ¬ì„±<a class="hash-link" href="#content-library-êµ¬ì„±" title="Direct link to heading">â€‹</a></h2><p><code>Content Library</code>ëŠ” ë ˆí¬ì§€í† ë¦¬ì˜ ê°œë…ìœ¼ë¡œ ì—¬ëŸ¬ vApp í…œí”Œë¦¿ê³¼ ISO ì´ë¯¸ì§€ ë“±ê³¼ ê°™ì€ íŒŒì¼ë“¤ê³¼ ì»¨í…Œì´ë„ˆ ê°œì²´ë¥¼ ì €ì¥í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ë„êµ¬ì´ë‹¤. ë ˆì§€ìŠ¤íŠ¸ë¦¬(Registry)ì™€ ìœ ì‚¬í•˜ì§€ë§Œ <code>Content Library</code>ì—ëŠ” VM templates, OVA, OVF íŒŒì¼ ë“±ì´ ì €ì¥ëœë‹¤.  </p><p><code>Menu</code> -&gt; <code>Content Libraries</code>ë¡œ ì´ë™í•´ì„œ ìƒˆë¡œìš´ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶”ê°€ë¥¼ í•œë‹¤. ì´ë¦„ê³¼ vCenter Serverë¥¼ ì„ íƒí•˜ê³  2ë²ˆì§¸ ë‹¨ê³„ì—ì„œ Subscribed content libraryë¥¼ ì„ íƒí•˜ê³  <code>Subscription URL</code>ì— <a href="https://wp-content.vmware.com/v2/latest/lib.json" target="_blank" rel="noopener noreferrer">https://wp-content.vmware.com/v2/latest/lib.json</a> ë¥¼ ì…ë ¥í•˜ê³  3ë²ˆì§¸ ë‹¨ê³„ì—ì„œ ì €ì¥ë  ë°ì´í„°ìŠ¤í† ì–´ë¥¼ ì„ íƒí•˜ë©´ ëœë‹¤.  </p><p>ì‹¤ì œ ìœ„ URLì€ <code>OVF Template</code> ì—¬ëŸ¬ê°œë¥¼ ë‹¤ìš´ë°›ëŠ”ë° Tanzu Clusterë‚´ì—ì„œ Masterì™€ Worker Nodeë“¤ë¡œ ì“°ì¼ Kubernetes 1.16 ~ 1.18ê¹Œì§€ ì—¬ëŸ¬ê°œì˜ VMì´ë¯¸ì§€ (photon OS)ë“¤ì´ ì¶”ê°€ê°€ ë˜ëŠ”ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ì•„ë˜ ê·¸ë¦¼ì„ ë³´ë©´ í˜„ì¬ Tanzuì—ì„œ ì‚¬ìš©ë˜ëŠ” Kubernetes í´ëŸ¬ìŠ¤í„° ë²„ì „ì´ 1.18.5ë¼ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.</p><p><img loading="lazy" alt="tkg" src="/assets/images/content_tkg-375173ad9665d2e90a26db7433cc49d4.png" width="1259" height="692" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="workload-management-êµ¬ì„±">Workload Management êµ¬ì„±<a class="hash-link" href="#workload-management-êµ¬ì„±" title="Direct link to heading">â€‹</a></h2><p>Workload Managementë€ ì‰½ê²Œ ìƒê°í•˜ë©´ vSphere ê¸°ë°˜ì—ì„œ Kubernetes í´ëŸ¬ìŠ¤íŠ¸ë¥¼ í”„ë¡œë¹„ì €ë‹í•˜ëŠ” ì—­í• ì„ í•˜ëŠ” ë„êµ¬ë¼ ë³´ë©´ ëœë‹¤.  </p><p>Workload ManagementëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì—­í• ì„ í•œë‹¤.  </p><ul><li>Kubernetes í´ëŸ¬ìŠ¤í„°ì˜ ì»´í“¨íŒ…, ìŠ¤í† ë¦¬ì§€ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ì‚¬ì´ì§• ë° ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ê´€ë¦¬</li><li>Kubernetes í´ëŸ¬ìŠ¤í„°ì˜ ë„¤íŠ¸ì›Œí¬ ë° DNS, NTP ë° VDSê°™ì€ ë„¤íŠ¸ì›Œí¬ ê´€ë¦¬</li><li>Kubernetes í´ëŸ¬ìŠ¤í„° ìƒì„¸ ì •ë³´ (Node ê°œìˆ˜ ë° ìƒíƒœ ì •ë³´)</li></ul><p>Workload Managementì—ì„œ í´ëŸ¬ìŠ¤í„° ìƒì„±ì„ ìŠ¤í¬ë¦½íŠ¸ë¡œ ì§„í–‰í•˜ê¸° ì „ì— PowerCLIë¥¼ í†µí•´ ì ‘ì† í…ŒìŠ¤íŠ¸ë¥¼ í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-powershell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-powershell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Connect-VIServer -Server vcsa.tanzu.local -User administrator@vsphere.local -Password VMware1!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connect-CisServer -Server vcsa.tanzu.local -User administrator@vsphere.local -Password VMware1!</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê·¸ë¦¬ê³  PowerCLI Workload Management ëª¨ë“ˆì„ ì„¤ì¹˜í•˜ê³  ì—¬ëŸ¬ í™˜ê²½ë³€ìˆ˜ë“¤ì„ ì„¤ì •í•œë‹¤. ê¸°ì¡´ì— ì‚¬ìš©í•œ ì •ë³´ë“¤ê³¼ ìœ„ì—ì„œ ë§Œë“  Content Library ì´ë¦„ìœ¼ë¡œ ë³€ê²½í•˜ê³  ì‹¤í–‰í•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-powershell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-powershell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Import-Module VMware.WorkloadManagement</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$vSphereWithTanzuParams = @{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ClusterName = "Tanzu-Cluster";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TanzuvCenterServer = "vcsa.tanzu.local";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TanzuvCenterServerUsername = "administrator@vsphere.local";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TanzuvCenterServerPassword = "VMware1!";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TanzuContentLibrary = "TKG"; # Content Library ì´ë¦„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ControlPlaneSize = "TINY";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MgmtNetwork = "Management";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MgmtNetworkStartIP = "192.168.0.220";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MgmtNetworkSubnet = "255.255.255.0";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MgmtNetworkGateway = "192.168.0.1";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MgmtNetworkDNS = @("192.168.0.201");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MgmtNetworkDNSDomain = "tanzu.local";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MgmtNetworkNTP = @("162.159.200.123");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WorkloadNetwork = "Workload";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WorkloadNetworkStartIP = "10.20.0.10";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WorkloadNetworkIPCount = 20;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WorkloadNetworkSubnet = "255.255.255.0";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WorkloadNetworkGateway = "10.20.0.1";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WorkloadNetworkDNS = @("192.168.0.201");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WorkloadNetworkServiceCIDR = "10.96.0.0/24";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    StoragePolicyName = "Tanzu-Storage-Policy";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HAProxyVMvCenterServer = "vcsa.tanzu.local";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HAProxyVMvCenterUsername = "administrator@vsphere.local";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HAProxyVMvCenterPassword = "VMware1!";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HAProxyVMName = "haproxy.tanzu.local";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HAProxyIPAddress = "192.168.0.203";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HAProxyRootPassword = "VMware1!";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HAProxyPassword = "VMware1!";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LoadBalancerStartIP = "10.10.0.64";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LoadBalancerIPCount = 64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">New-WorkloadManagement2 @vSphereWithTanzuParams</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•˜ëŠ” ì‹œê°„ì€ ì•½ 40ë¶„ ì´ìƒ ì†Œìš”ë˜ëŠ”ë° Tanzu-Clusterì˜ Control Plane Node (Master Node) ìƒì„±ì´ ì™„ë£Œë˜ë©´ IPê°€ 10.10.0.64(HAProxy Load Balancerì—ì„œ í• ë‹¹ëœ ì²«ë²ˆì§¸ ì£¼ì†Œ)ë¡œ í• ë‹¹ì´ ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  </p><p>ë‹¤ìŒì€ Namespaceë¥¼ ìƒì„±í•˜ëŠ” ê³¼ì •ì„ ì§„í–‰í•œë‹¤. <code>Workload Management</code>ì—ì„œ <code>NEW NAMESPACE</code>ë©”ë‰´ë¥¼ í´ë¦­í•˜ê³  ìœ„ì—ì„œ ìƒì„±í•œ <code>Tanzu-Cluster</code>ë¥¼ ì„ íƒí•˜ê³  ì´ë¦„(test)ì„ ì…ë ¥í•˜ê³  Namespaceë¥¼ ìƒì„±í•œë‹¤. </p><p><img loading="lazy" alt="tkg_permission" src="/assets/images/tkg_permission-9ef770e7197c1de2636adb2d065b4f58.png" width="568" height="367" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="cluster-ì ‘ì†--kubernetes-cli">Cluster ì ‘ì†  (Kubernetes CLI)<a class="hash-link" href="#cluster-ì ‘ì†--kubernetes-cli" title="Direct link to heading">â€‹</a></h2><p>ìƒì„±ëœê±¸ í™•ì¸í•œ í›„ ë¸Œë¼ìš°ì €ì— í•´ë‹¹ í´ëŸ¬ìŠ¤í„°ì˜ Control Plane IP (<a href="https://10.10.0.64)%EB%A1%9C" target="_blank" rel="noopener noreferrer">https://10.10.0.64)ë¡œ</a> ì ‘ì†í•˜ë©´ OSë³„(Linux, MacOS, Windows)ë¡œ CLI í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•  ìˆ˜ ìˆë‹¤.  </p><p>ì„¤ì¹˜ ë° PATH ì„¤ì •ì„ ì§„í–‰í•˜ê³  ì•„ë˜ì™€ ê°™ì´ Control Planeìœ¼ë¡œ CLI ë¡œê·¸ì¸ì„ í•˜ë©´ í˜„ì¬ ì„¤ì •ëœ Context í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl vsphere login --server=10.10.0.64 -u administrator@vsphere.local --insecure-skip-tls-verify</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ğŸ¥³vSphere with Tanzu Basic Cluster enabled by William Lam's Script ğŸ¥³</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Password:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Logged in successfully.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">You have access to the following contexts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   10.10.0.64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   docker-desktop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   nexclipper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If the context you wish to use is not in this list, you may need to try</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logging in again later, or contact your cluster administrator.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To change context, use `kubectl config use-context &lt;workload name&gt;`</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl config use-context nexclipper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Switched to context "nexclipper".</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl get nodes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                               STATUS   ROLES    AGE     VERSION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">422f46864113e3de3361943d14073728   Ready    master   4d21h   v1.18.2-6+38ac483e736488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">422faddc15554b09d82907c0dfb57752   Ready    master   4d21h   v1.18.2-6+38ac483e736488</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>nexclipper namespaceë¡œ contextë¥¼ ì „í™˜í•˜ê³  nodeë¥¼ í™•ì¸í•˜ë©´ master nodeë¥¼ 2ê°œ í™•ì¸í•  ìˆ˜ ìˆëŠ”ë° ì´ëŠ” <code>nexclipper</code>ë¼ëŠ” ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ì´ê´„í•˜ëŠ” Super Master(Control Plane) ê°™ì€ ê°œë…ì´ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤. ì²˜ìŒì— í´ëŸ¬ìŠ¤í„° ë°°í¬ì „ì— Namespace ë¦¬ì†ŒìŠ¤ë¥¼ ë§Œë“¤ê¸¸ë˜ ë‹¤ì†Œ í—·ê°ˆë¦¬ê¸´ í–ˆì§€ë§Œ Tanzuì—ì„œì˜ NamespaceëŠ” ê¸°ì¡´ ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ë…¼ë¦¬ì ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” ì»¨ì…‰ì´ ì•„ë‹Œ, ì •í•´ì§„ ë¦¬ì†ŒìŠ¤ì™€ ìœ ì €ì™€ ê·¸ë£¹ì˜ ê¶Œí•œì„ ë¨¼ì € Namespaceë¡œ í• ë‹¹í•˜ê³  ê·¸ë‹´ì— ë‹¤ì‹œ ì¡°ì§ì´ë‚˜ ì–´í”Œë¦¬ì¼€ì´ì…˜ ë³„ë¡œ Kubernetes Workloadë¥¼ ë‹¤ì‹œ ì œê³µí•˜ëŠ” ì»¨ì…‰ì´ë¼ê³  ë³´ë©´ëœë‹¤.  </p><p>ìµœê·¼ì— <code>SKT</code>ë‚˜ <code>Kakao Enterprise</code> ì²˜ëŸ¼ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì˜ ë¼ì´í”„ì‚¬ì´í´ì„ ì¿ ë²„ë„¤í‹°ìŠ¤ë¡œ ê´€ë¦¬í•˜ëŠ” ì»¨ì…‰ìœ¼ë¡œ ì´í•´í•˜ë©´ ì¢‹ë‹¤. ì•„ë˜ ê·¸ë¦¼ì„ ì°¸ê³ í•˜ë©´ ì‰½ê²Œ ì´í•´í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.  </p><p><img loading="lazy" src="https://docs.vmware.com/en/VMware-vSphere/7.0/vmware-vsphere-with-tanzu/img/GUID-DF8905E1-C098-4882-BFC1-B0BAC668B424-high.png" alt="tanzu" class="img_E7b_"><br>
<!-- -->ì°¸ì¡° : <a href="https://docs.vmware.com/en/VMware-vSphere/7.0/vmware-vsphere-with-tanzu/img/GUID-DF8905E1-C098-4882-BFC1-B0BAC668B424-high.png" target="_blank" rel="noopener noreferrer">https://docs.vmware.com/en/VMware-vSphere/7.0/vmware-vsphere-with-tanzu/img/GUID-DF8905E1-C098-4882-BFC1-B0BAC668B424-high.png</a></p><p>TanzuKubernetesCluster CRDë¥¼ í†µí•´ í´ëŸ¬ìŠ¤í„°ë¥¼ ì‹ ê·œë¡œ ìƒì„±í•œë‹¤.<br>
<code>namespace: nexclipper</code>ë¡œ ì„¤ì •í•˜ê³  ì›í•˜ëŠ” ë°°í¬ ë²„ì „ê³¼ ì´ë¦„, CNI, Control Plane, Worker Node ê°œìˆ˜ ë“±ì„ ê¸°ì¬í•˜ê²Œ ë˜ëŠ”ë° íŠ¹ì´í•œ ê²ƒì€ CNIëŠ” <a href="https://github.com/vmware-tanzu/antrea" target="_blank" rel="noopener noreferrer">Antrea</a>ë¥¼ ì‚¬ìš©í•˜ëŠ”ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> run.tanzu.vmware.com/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> TanzuKubernetesCluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nexclipper</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nexclipper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">distribution</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1.17.8+vmware.1</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">tkg.1.5417466</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">settings</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">network</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">cni</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> antrea</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">pods</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">cidrBlocks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 193.0.2.0/16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">serviceDomain</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> managedcluster.local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">cidrBlocks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 195.51.100.0/12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">topology</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">controlPlane</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">class</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> best</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">effort</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xsmall</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">count</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">storageClass</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tanzu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">storage</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">policy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">workers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">class</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> best</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">effort</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xsmall</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">count</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">storageClass</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> tanzu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">storage</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">policy</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì‹ ê·œ TKG í´ëŸ¬ìŠ¤í„°ë¥¼ ë°°í¬í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl apply -f tkc.yaml  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tanzukubernetescluster.run.tanzu.vmware.com/nexclipper-cluster created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë°°í¬í•˜ê³  tanzukubernetescluster ë¥¼ ì¡°íšŒí•´ë³´ë©´ Control Plane 1ê°œ, Worker Node 1ê°œì˜  v1.17.8 ë²„ì „ì˜ í´ëŸ¬ìŠ¤í„°ê°€ ë°°í¬ëœê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl get tanzukubernetescluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                 CONTROL PLANE   WORKER   DISTRIBUTION                     AGE   PHASE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nexclipper-cluster   1               1        v1.17.8+vmware.1-tkg.1.5417466   33m   running</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìƒì„±í•œ tanzukubernetesclusterë¡œ ì ‘ì†í•˜ì—¬ í´ëŸ¬ìŠ¤í„° ì •ë³´ë¥¼ í™•ì¸í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl-vsphere login --server=10.10.0.64 -u administrator@vsphere.local --insecure-skip-tls-verify --tanzu-kubernetes-cluster-name nexclipper-cluster --tanzu-kubernetes-cluster-namespace nexclipper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl config use-context nexclipper-cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Switched to context "nexclipper-cluster".</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl get nodes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                                STATUS   ROLES    AGE     VERSION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nexclipper-cluster-control-plane-95nhv              Ready    master   3h10m   v1.17.8+vmware.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nexclipper-cluster-workers-kp68q-78df45db5c-jzmmv   Ready    &lt;none&gt;   3h6m    v1.17.8+vmware.1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìƒì„±í•œ í´ëŸ¬ìŠ¤í„°ì— ê°„ë‹¨í•œ ì•±ì„ ë°°í¬í•œë‹¤.<br>
<a href="https://github.com/storax/kubedoom" target="_blank" rel="noopener noreferrer">Kubedoom</a>ì€ Doom ê²Œì„ë‚´ì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜(ê´´ë¬¼)ì„ ì¼ë¶€ëŸ¬ ì¢…ë£Œì‹œì¼œ ë³µì›ì„±ì„ ë³´ê²Œí•˜ëŠ” ì¬ë¯¸ìˆëŠ” ì•±ì´ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; git clone https://github.com/storax/kubedoom.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; cd kubedoom</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl apply -f manifest/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; kubectl -n kubedoom port-forward deployment/kubedoom 5900:5900</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Forwarding from 127.0.0.1:5900 -&gt; 5900</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Forwarding from [::1]:5900 -&gt; 5900</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë°°í¬í•œí›„ì— í¬íŠ¸í¬ì›Œë”©ì„ í•œ ì•±ìœ¼ë¡œ VNC viewerë¡œ ì ‘ì†í•˜ë©´ ì¬ë¯¸ìˆëŠ” í™”ë©´ì„ ë³¼ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. VNC íŒ¨ìŠ¤ì›Œë“œëŠ” <code>idbehold</code>ì´ë‹¤.</p><p><img loading="lazy" alt="doom" src="/assets/images/doom-05a849f186a914571aa3c73ce8d9070c.png" width="642" height="512" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="tanzu-ì¥ë‹¨ì -ê°œì¸ì˜ê²¬">Tanzu ì¥ë‹¨ì  (ê°œì¸ì˜ê²¬)<a class="hash-link" href="#tanzu-ì¥ë‹¨ì -ê°œì¸ì˜ê²¬" title="Direct link to heading">â€‹</a></h2><p>í•˜ë“œì›¨ì„œ ê³ ë¯¼, êµ¬ë§¤, ESXi ì„¤ì¹˜, vCenter, TKGì„ ì„¤ì¹˜í•˜ê³  ì•„í‚¤í…ì²˜ë“¤ì„ ì°¾ì•„ë³´ë©´ì„œ ëª‡ê°€ì§€ ì¥ë‹¨ì ì´ ëˆˆì— ë³´ì˜€ëŠ”ë° ê°€ì¥ í° ì¥ì ì€ í•˜ë‚˜ì˜ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ë§Œë“¤ì–´ Super Master(Control Plane)ë¥¼ ë¨¼ì € êµ¬ì„±í•˜ê³  ìì›(ì»´í“¨íŒ…, ë„¤íŠ¸ì›Œí¬, ìŠ¤í† ë¦¬ì§€ ë“±)ê³¼ ê¸°ì¡´ì— ë³´ìœ í•˜ê³  ìˆëŠ” ê¶Œí•œ ì²´ê³„ë¡œ í• ë‹¹ì„ í•œ ë’¤ í•„ìš”í• ë•Œ ë§ˆë‹¤ íŠ¹ì • íŒ€ì´ë‚˜ ì¡°ì§ì—ê²Œ ë³„ë„ì˜ í´ëŸ¬ìŠ¤í„°ë¥¼ í• ë‹¹í•˜ëŠ” ì•„í‚¤í…ì²˜ë¥¼ ì¶”êµ¬í•˜ê³  ìˆì–´ VMware í™˜ê²½ì—ì„œ Kubernetesë¥¼ ì‹ ê·œ ë„ì…í•˜ê³  ì—”í„°í”„ë¼ì´ì¦ˆì— ì ìš©í•˜ê¸° ìš©ì´í•˜ë‹¤ëŠ” ì ì´ë‹¤.  </p><p>ë˜í•œ ê¸°ë³¸ì ìœ¼ë¡œ ê°–ì¶°ì•¼ í•˜ëŠ” Security Policyë‚˜ ë¦¬ì†ŒìŠ¤ í• ë‹¹ì´ í´ëŸ¬ìŠ¤í„° êµ¬ì¶•ì´í›„ì— ë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì´ë¯¸ ì •ì˜ëœ ê·œì¹™ìœ¼ë¡œ í´ëŸ¬ìŠ¤í„° êµ¬ì„±ì´ ì´í›„ì— ì§„í–‰ë˜ê¸° ë•Œë¬¸ì— ê´€ë¦¬ì ì¸ ì¸¡ë©´ì—ì„œë„ ì¥ì ì´ ìˆë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤. </p><p>í•˜ì§€ë§Œ ê°œì¸ì ìœ¼ë¡œ ìƒê°í•˜ëŠ” ë‹¨ì ë“¤ë„ ëª‡ê°€ì§€ ìˆëŠ”ë° ì²«ë²ˆì§¸ëŠ” ìš©ì–´ì˜ ì¤‘ë³µìœ¼ë¡œ ì¸í•œ í˜¼ë™ì´ ìˆì—ˆë‹¤ëŠ”ì ì´ë‹¤. ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë‚˜ ê¸°ì¡´ ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œ ë§ì´ ì‚¬ìš©ë˜ëŠ” ìš©ì–´ë³´ë‹¤ëŠ” VMwareì—ì„œ ë§Œë“  CRDë“±ì„ ë¯¸ë¦¬ í•™ìŠµí•˜ê±°ë‚˜ ì•Œê³  ìˆì§€ ì•Šìœ¼ë©´ ê¸°ì¡´ ê²½í—˜ì´ ìˆëŠ” ìœ ì €ë„ ì ‘ê·¼ì„±ì´ ë–¨ì–´ì§ˆ ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆë‹¤. </p><p>ë¹„ìš© ì¸¡ë©´ì—ì„œëŠ” ì¼ë‹¨ <code>vCenter</code> ì´ì™¸ì— <code>Workload Management</code> ë¼ì´ì„¼ìŠ¤ê°€ ë³„ë„ë¡œ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— ìì„¸íˆ ì•Œì•„ë³´ì§„ ì•Šì•˜ì§€ë§Œ ì ì§€ ì•Šì€ ë¹„ìš©ì´ ë“¤ ê²ƒìœ¼ë¡œ ì˜ˆìƒëœë‹¤. ê²Œë‹¤ê°€ ë§ì€ êµ¬ì„±ìš”ì†Œë¡œ ì¸í•œ ìì›ì´ ì†Œìš”ê°€ ìˆì–´ í•˜ë‚˜ì˜ ì‘ì€ í´ëŸ¬ìŠ¤í„°ë§Œ ë„ì› ìŒì—ë„ 64GB ë¨¸ì‹ ì˜ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì´ ê±°ì˜ 60GBì— ìœ¡ë°•í–ˆê¸° ë•Œë¬¸ì— ê¸°ì¡´ ì¸í”„ë¼ ë¹„ìš©ì— ì¶”ê°€ì ì¸ ë¹„ìš©ì— ëŒ€í•œ ê³ ë ¤ê°€ ë°˜ë“œì‹œ í•„ìš”í•  ê²ƒ ê°™ë‹¤. </p><p>ìœ„ì—ë„ ì–¸ê¸‰í–ˆì§€ë§Œ ëŸ¬ë‹ì»¤ë¸Œì— ëŒ€í•œ ë¶€ë¶„ë„ ë¬¸ì œì ì´ ë  ìˆ˜ ìˆì„ê²ƒì´ë‹¤. NSXê¸°ë°˜ì˜ ìƒˆë¡œìš´ CNIë¿ë§Œ ì•„ë‹ˆë¼ ê¸°ì¡´ VMware ìš´ì˜ì„ í•˜ë˜ DevOpsíŒ€ì´ë‚˜ ì¸í”„ë¼ ìš´ì˜ì¡°ì§ì˜ ëŸ¬ë‹ì»¤ë¸Œ, ì¶”ìƒí™” ë ˆë²¨ì´ ë†’ì•„ì ¸ì„œ ë‚´ê°€ ì›í•˜ëŠ” í´ëŸ¬ìŠ¤í„°ì˜ ì´ë²¤íŠ¸ë‚˜ ë¡œê·¸ë¥¼ í™•ì¸í•  ë•Œ íƒìƒ‰ì ìœ¼ë¡œ ë©”ë‰´ë¥¼ ì°¾ê¸°ê°€ ì‰½ì§€ ì•Šì€ ë¶€ë¶„ë“¤ì´ ìˆì—ˆë‹¤. ê·¸ë˜ì„œ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ë•Œì—ë„ ë¡œê·¸ì˜ ì›ì²œì„ ì°¾ëŠ”ë° ì‹œê°„ì´ ë‹¤ì†Œ ê±¸ë¦¬ê¸°ë„ í–ˆë‹¤. </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>í•œ ì¼ì£¼ì¼ë™ì•ˆ ìŠ¤í† ë¦¬ì§€ ì˜¤ë¥˜ë¡œ ì”¨ë¦„í•˜ë‹¤ê°€ ê²¨ìš° ì•±ì„ ë°°í¬í–ˆì§€ë§Œ ê±°ì˜ 2ì£¼ë™ì•ˆ ì¬ë¯¸ìˆê²Œ êµ¬ì„±í•´ë³¼ìˆ˜ ìˆì—ˆë‹¤. ì†”ì§íˆ ì´ì•¼ê¸°í•˜ìë©´ ê°œì¸ í´ëŸ¬ìŠ¤í„°ë¡œ êµ¬ì„±í•˜ëŠ”ë°ëŠ” ì¶”ì²œí•˜ì§€ ì•Šì§€ë§Œ Tanzuë¥¼ ê³µë¶€í•˜ê³  ìš´ì˜í•´ì•¼ í•˜ëŠ” ê²½ìš°ë‚˜ ìê²©ì¦ì„ ì·¨ë“í•˜ëŠ” ë¶€ë¶„ì´ í•„ìš”í•˜ë‹¤ë©´ í•œë²ˆì¯¤ì€ í•´ë³¼ ê°€ì¹˜ê°€ ìˆë‹¤ê³  ìƒê°í•œë‹¤.  </p><p>ê±°ì˜ 1ë…„ë§Œì— í¬ìŠ¤íŒ…ì„ ì‘ì„±í–ˆëŠ”ë° ë‹¤ìŒ í¬ìŠ¤íŒ…ì—ëŠ” Security Policy ê´€ë ¨í•œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ì„œ ì—°ë§ì„ ì •ë¦¬í•´ë³¼ ìƒê°ì´ë‹¤.</p>]]></content>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="Tanzu" term="Tanzu"/>
        <category label="vSphere" term="vSphere"/>
        <category label="Homelab" term="Homelab"/>
        <category label="ASUS" term="ASUS"/>
        <category label="PN50" term="PN50"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[vSphere with Tanzu homelab running on ASUS PN50 (1/2)]]></title>
        <id>kubernetes/vSphere-with-Tanzu-homelab/</id>
        <link href="https://ddii.dev/kubernetes/vSphere-with-Tanzu-homelab/"/>
        <updated>2020-11-30T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ” Tanzu Clusterë¥¼ ë‹¨ì¼ í™ˆë© vSphere ì„œë²„ì— ì˜¬ë ¤ë³¸ë‹¤]]></summary>
        <content type="html"><![CDATA[<p>ìŠ¤íƒ€íŠ¸ì—…ìœ¼ë¡œ ì´ì§í›„ ì •ì‹ ì—†ëŠ” 6ê°œì›”ì„ ë³´ëƒˆê³  ì§‘ì—ì„œ í•˜ëŠ” ì‚¬ì´ë“œ í”„ë¡œì íŠ¸ë‚˜ ê³µë¶€í•˜ëŠ” ê²ƒë“¤ì´ ì†Œí™€í•´ì§€ëŠ”ê²ƒ ê°™ì•„ ë§ˆìŒì„ ë‹¤ì¡ê³ ì ì‘ì„±í•˜ëŠ” í¬ìŠ¤íŒ…ì´ë‹¤. ìµœê·¼ ëª‡ê°œì›” ê°„ì€ íšŒì‚¬ ë¸”ë¡œê·¸ ê¸€ë§Œ ì‘ì„±í•˜ë‹¤ë³´ë‹ˆ ê°œì¸ ë¸”ë¡œê·¸ë¥¼ ê±°ì˜ ëª»í•˜ê³  ìˆì–´ì„œ íšŒì‚¬ ì œí’ˆê³¼ëŠ” ì•„ì§ê¹Œì§€ ê±°ë¦¬ê°€ ìˆëŠ” í”Œë«í¼ ê³µë¶€ì°¨ ì‘ì„±í•œë‹¤. ìˆœìˆ˜í•˜ê²Œ ì •ë³´ê³µìœ ì°¨ ì‘ì„±í•˜ëŠ” ê²ƒì´ë©°, íŠ¹ì •íšŒì‚¬ì˜ íšŒì‚¬ì˜ ì œí’ˆì´ë‚˜ í”Œë«í¼ì„ í™ë³´í•˜ê³ ì í•¨ì€ ì•„ë‹ˆë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="tanzu">Tanzu<a class="hash-link" href="#tanzu" title="Direct link to heading">â€‹</a></h2><p><a href="https://tanzu.vmware.com/content/blog/simplify-your-approach-to-application-modernization-with-4-simple-editions-for-the-tanzu-portfolio" target="_blank" rel="noopener noreferrer">https://tanzu.vmware.com/content/blog/simplify-your-approach-to-application-modernization-with-4-simple-editions-for-the-tanzu-portfolio</a>  </p><p>TanzuëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œ, êµ¬ë™, ìš´ì˜í•˜ëŠ” ëª¨ë“  ì»¨í…Œì´ë„ˆ í™˜ê²½ì„ í†µí•© ê´€ë¦¬í•˜ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ë¥¼ ìƒìš©í™” í•œ ì œí’ˆìœ¼ë¡œ ì´í•´í•˜ëŠ” ê²ƒì´ ê°€ì¥ ì‰½ë‹¤. </p><p><img loading="lazy" alt="tanzu" src="/assets/images/tanzu-31ee2ad3f4e378ea6b48dd7368fad618.png" width="550" height="272" class="img_E7b_"><br>
<!-- -->(ì¶œì²˜ : VMì›¨ì–´ ì½”ë¦¬ì•„ ë°œí‘œìë£Œ ê°ˆë¬´ë¦¬)</p><p>í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ê°„ë‹¨íˆ ì‚´í´ë³´ë©´ ê¸°ì¡´ ì¸í”„ë¼ë¥¼ êµ¬ì„±í•˜ëŠ” ë ˆì´ì–´ì¸ vSphere ìœ„ì— <code>VMware Tanzu Kubernetes Grid</code>ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.  </p><p>ì˜¤ëŠ˜ì€ ê¸°ì¡´ Pivotal ì´ë‚˜ Spring Bootë¥¼ ì œì™¸í•œ í”Œë«í¼ ë ˆì´ì–´ì˜ TKG(Tanzu Kubernetes Grid)ë¥¼ í™ˆë©ìœ¼ë¡œ êµ¬ì„±í•˜ëŠ” ê³¼ì •ì„ ì •ë¦¬í–ˆë‹¤. </p><p>ëª¨ë“  ê³¼ì •ì€ virtuallyGhetto ë¸”ë¡œê·¸ë¥¼ ì°¸ê³ í•˜ì—¬ ì‘ì„±í–ˆê³  ê°€ì¥ ë”°ë¼í•œ ë¶€ë¶„ì€ ì•„ë˜ í¬ìŠ¤íŒ…ì´ë‹ˆ NUCìœ¼ë¡œ êµ¬ì„±í•˜ë ¤ë©´ ì›ë¬¸ì„ ì°¸ê³ í•˜ë©´ ëœë‹¤.<br>
<a href="https://www.virtuallyghetto.com/2020/11/complete-vsphere-with-tanzu-homelab-with-just-32gb-of-memory.html#comments" target="_blank" rel="noopener noreferrer">https://www.virtuallyghetto.com/2020/11/complete-vsphere-with-tanzu-homelab-with-just-32gb-of-memory.html#comments</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì¤€ë¹„ì‚¬í•­hardware">ì¤€ë¹„ì‚¬í•­(Hardware)<a class="hash-link" href="#ì¤€ë¹„ì‚¬í•­hardware" title="Direct link to heading">â€‹</a></h2><ul><li><p>ASUS PN50<br>
<a href="https://www.asus.com/kr/Mini-PCs/Mini-PC-PN50/" target="_blank" rel="noopener noreferrer">https://www.asus.com/kr/Mini-PCs/Mini-PC-PN50/</a></p><p>PN50 ë² ì–´ë³¸ì„ ì„ íƒí•œ ì´ìœ ëŠ” ì¼ë‹¨ AMD Ryzen 4800u CPUê°€ ì €ì „ë ¥ì¸ë°ë„ ë¶ˆêµ¬í•˜ê³  8ì½”ì–´ 16ìŠ¤ë ˆë“œ, 64GB sodimmì´ ì§€ì›ë˜ë©°, 2.5ì¸ì¹˜ì™€ M.2 SSDê°€ ë™ì‹œ ì¥ì°©ì´ ê°€ëŠ¥í•˜ë‹¤ëŠ” ì ì´ë‹¤. ì˜¨ë³´ë“œ NIC ë“œë¼ì´ë²„ê°€ vSphere 7.0ì—ì„œ ì§€ì›ë˜ì§€ ì•Šì§€ë§Œ USB Network Adapterë¥¼ í†µí•´ êµ¬ì„±ì´ ê°€ëŠ¥í–ˆê¸° ë•Œë¬¸ì— ë§ì„¤ì„ ì—†ì´ êµ¬ë§¤ë¥¼ ê²°ì •í–ˆë‹¤. êµ¬ì…ì€ ë„¤ì´ë²„ ê²€ìƒ‰(asus pn50 4800u)ì„ í†µí•´ 71ë§Œì› ì •ë„ì— êµ¬ë§¤ë¥¼ í–ˆë‹¤. ì´ë„ ìŠ¤ë§ˆì¼ ìºì‹œë¥¼ ì§ì ‘ êµ¬ë§¤í•´ì„œ ì‹¤ì œ êµ¬ë§¤ê¸ˆì•¡ì€ 65ë§Œì› ì •ë„ê°€ ì†Œìš”ë˜ì—ˆë‹¤.</p></li><li><p>SODIMM DDR4 32G PC4-25600 (TeamGroup)<br>
<!-- -->í•´ë‹¹ ì œí’ˆì€ ê°€ì„±ë¹„ë¡œ ê°€ì¥ ì €ë ´í•˜ê²Œ ì‚´ ìˆ˜ ìˆëŠ” êµ­ë‚´ ì›ŒëŸ°í‹°ê°€ ê°€ëŠ¥í•œ SODIMM ë©”ëª¨ë¦¬ë¡œ 32G 2ê°œë¥¼ êµ¬ë§¤í–ˆìœ¼ë©° ë„¤ì´ë²„ ê²€ìƒ‰ìœ¼ë¡œ 2ê°œ 25ë§Œì› ì •ë„ë¡œ êµ¬ë§¤í–ˆë‹¤.</p></li><li><p>2.5 SSD (ADATA SU655 240GB)<br>
<!-- -->ESXi ì„œë²„ ì„¤ì¹˜ìš©ìœ¼ë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ê¸°ì¡´ì— ê°–ê³  ìˆë˜ ADATA SU655 240GBë¥¼ ì‚¬ìš©í–ˆê³  í˜„ì¬ 3.5ë§Œì› ì •ë„ì— êµ¬ë§¤ê°€ëŠ¥í•˜ë‹¤. </p></li><li><p>M.2 SSD (WD BLACK SN750 M.2 NVMe 500GB)<br>
<!-- -->ì•„ë§ˆì¡´ì—ì„œ ì§êµ¬í•œ ë…€ì„ìœ¼ë¡œ 69.99ë‹¬ëŸ¬ ì†Œìš”ë˜ì—ˆë‹¤. ë°°ëŒ€ì§€ ê°€ê²©ì„ í•©ì¹˜ë©´ 8.5ë§Œì› ì •ë„ ì†Œìš”ë˜ì—ˆë‹¤. </p></li><li><p>Gigabit USB Lancard (tplink UE300C)<br>
<!-- -->ESXi 7.0ë²„ì „ì—ì„œ ì˜¨ë³´ë“œ NIC ì¸ì‹ì´ ë¶ˆê°€ëŠ¥í•œ ì´ìœ ë¡œ ë³„ë„ë¡œ ê¸°ê¸°ë¹„íŠ¸ ìœ ì„  ëœì¹´ë“œë¥¼ êµ¬ë§¤í–ˆë‹¤. 1.5ë§Œì› ì •ë„ì— êµ¬ë§¤ê°€ëŠ¥ í•˜ê³  3ë…„ ë³´ì¦ì´ ë˜ëŠ” TPLINKì œí’ˆìœ¼ë¡œ ì„ íƒí•˜ì˜€ë‹¤.<br>
<a href="https://coupa.ng/bM0lN8" target="_blank" rel="noopener noreferrer">https://coupa.ng/bM0lN8</a> -&gt; <code>í•´ë‹¹ ë§í¬ë¥¼ í†µí•´ êµ¬ë§¤í•˜ë©´ ì €ì—ê²Œ ì¿ íŒ¡ íŒŒíŠ¸ë„ˆìŠ¤ë¥¼ í†µí•´ ì ë¦½ê¸ˆì´ ì§€ê¸‰ë˜ë‹ˆ í•„ìš”í•˜ì‹  ë¶„ì€ ì•„ë˜ë¥¼ í†µí•´ êµ¬ë§¤ë¥¼ ë¶€íƒë“œë¦½ë‹ˆë‹¤</code></p></li></ul><p>ì‹¤ì œ ìœ„ ìŠ¤í™ìœ¼ë¡œ ëŒ€ì¶© êµ¬ë§¤ë¥¼ ì§„í–‰í•˜ê²Œ ë˜ë©´ <code>104ë§Œì›</code> ì •ë„ ì†Œìš”ê°€ ë ê²ƒìœ¼ë¡œ ì˜ˆìƒëœë‹¤. í™˜ìœ¨ì´ë‚˜ í• ì¸ì„ ì „í˜€ ë°›ì§€ ì•Šê³  1ê°œì˜ SSDë¡œ êµ¬ì„±í•œë‹¤ê³  ê°€ì •í•´ë„ ì•½ 8ì½”ì–´ 16ìŠ¤ë ˆë“œ 64GB ë¨¸ì‹ ì„ <code>110ë§Œì›</code> ì •ë„ë¡œ êµ¬ì„±ì´ ê°€ëŠ¥í•˜ë‹¤. ë¬¼ë¡  ì„œë²„ë‚˜ ì›Œí¬ìŠ¤í…Œì´ì…˜ì´ë‚˜ Intel NUCê¸°ë°˜ìœ¼ë¡œë„ êµ¬ì„±ì´ ê°€ëŠ¥í•˜ì§€ë§Œ ì „ë ¥ì†Œëª¨ì™€ ì§‘ì•ˆì„ ì°¨ì§€í•˜ëŠ” ë¶€í”¼ë¥¼ ê³ ë ¤í•˜ë©´ ê¸ˆì•¡ì ìœ¼ë¡œ ë©”ë¦¬íŠ¸ê°€ ìˆë‹¤ê³  ìƒê°í•œë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì¤€ë¹„ì‚¬í•­software">ì¤€ë¹„ì‚¬í•­(Software)<a class="hash-link" href="#ì¤€ë¹„ì‚¬í•­software" title="Direct link to heading">â€‹</a></h2><ul><li><p>Windows PC (with Powershell, WSL) or MAC
Windowë¥¼ ì‚¬ìš©ì„ í•˜ì§€ ì•Šê³  MACì´ë‚˜ ë¦¬ëˆ…ìŠ¤ë¡œ êµ¬ì„±í•˜ë ¤ í–ˆìœ¼ë‚˜ ì˜¨ë³´ë“œ NIC ì¸ì‹ì„ ìœ„í•œ ë“œë¼ì´ë²„ í†µí•© ì»¤ìŠ¤í…€ ì´ë¯¸ì§€ ì‘ì„± í¸ì˜ë¥¼ ìœ„í•´ Window í™˜ê²½ì„ ì‚¬ìš©í•˜ì˜€ë‹¤.</p></li><li><p><a href="https://www.ventoy.net/en/index.html" target="_blank" rel="noopener noreferrer">ventoy</a><br>
<!-- -->ESXi ë¶€íŒ… ì´ë¯¸ì§€ ì œì‘ì„ ìœ„í•œ íˆ´ì´ë©° <a href="https://rufus.ie/" target="_blank" rel="noopener noreferrer">rufus</a>ì— ë¹„í•´ í™œìš©ë„ê°€ ë†’ë‹¤.</p></li><li><p><a href="https://my.vmware.com/en/group/vmware/downloads/info/slug/datacenter_cloud_infrastructure/vmware_vsphere/7_0" target="_blank" rel="noopener noreferrer">vSphere 7.0 Update 1</a><br>
<!-- -->í‰ê°€íŒì€ <a href="https://my.vmware.com/en/group/vmware/evalcenter?p=vsphere-eval-7" target="_blank" rel="noopener noreferrer">https://my.vmware.com/en/group/vmware/evalcenter?p=vsphere-eval-7</a> ì—ì„œ ë‹¤ìš´ë¡œë“œê°€ ê°€ëŠ¥í•˜ë‹¤.</p></li><li><p><a href="https://github.com/PowerShell/PowerShell/releases/tag/v7.1.0" target="_blank" rel="noopener noreferrer">PowerShell 7.10</a><br>
<!-- -->ê¸°ë³¸ì ìœ¼ë¡œ Windowì—ëŠ” 6.x ë²„ì „ì˜ PowerShellì´ ì„¤ì¹˜ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— 7.1.0 ë²„ì „ì„ ì‹ ê·œë¡œ ì„¤ì¹˜í•´ì•¼ í•œë‹¤.</p></li><li><p><a href="https://www.powershellgallery.com/packages?q=VMware.PowerCLI" target="_blank" rel="noopener noreferrer">PowerCLI</a><br>
<a href="https://www.powershellgallery.com/packages/VMware.PowerCLI/12.1.0.17009493" target="_blank" rel="noopener noreferrer">https://www.powershellgallery.com/packages/VMware.PowerCLI/12.1.0.17009493</a>
ì»¤ìŠ¤í…€ ESXi 7.0 ì´ë¯¸ì§€ ì œì‘ì„ ìœ„í•´ í•„ìš”í•˜ë‹¤.</p></li><li><p><a href="https://flings.vmware.com/usb-network-native-driver-for-esxi?download_url=https%3A%2F%2Fdownload3.vmware.com%2Fsoftware%2Fvmw-tools%2FUSBNND%2FESXi701-VMKUSB-NIC-FLING-40599856-component-17078334.zip" target="_blank" rel="noopener noreferrer">USB Network Native Driver for ESXi</a><br>
<!-- -->PN50 USB NIC(RTL8153) ì¸ì‹ì„ ìœ„í•œ ë„¤ì´í‹°ë¸Œ ë“œë¼ì´ë²„.</p></li><li><p><a href="https://my.vmware.com/group/vmware/downloads/details?downloadGroup=OVFTOOL440P01&amp;productId=974" target="_blank" rel="noopener noreferrer">OVFTool</a><br>
<!-- -->OVAë¥¼ ë°°í¬í•˜ê¸° ìœ„í•œ ë„êµ¬ë¡œ Linux 64 bundleë¡œ WSLì— ì„¤ì¹˜í•œë‹¤. </p></li><li><p><a href="https://my.vmware.com/group/vmware/evalcenter?p=vsphere-eval-7" target="_blank" rel="noopener noreferrer">vcsa-deploy</a><br>
<!-- -->vCenterë¥¼ ë°°í¬í•˜ëŠ” ë„êµ¬ë¡œ ì´ë¯¸ì§€ë‚´ì— í¬í•¨ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— vCenter Server Appliance ISOë¥¼ ë‹¤ìš´ë°›ì•„ ì••ì¶•ì„ í’€ë©´ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ìµœì¢…-ì˜ˆìƒ-êµ¬ì„±ìš”ì†Œ">ìµœì¢… ì˜ˆìƒ êµ¬ì„±ìš”ì†Œ<a class="hash-link" href="#ìµœì¢…-ì˜ˆìƒ-êµ¬ì„±ìš”ì†Œ" title="Direct link to heading">â€‹</a></h2><ul><li>vCenter Server Appliance</li><li>VMFS Storage</li><li>vSphere with Tanzu Cluster</li><li>HAProxy</li><li>Router (Forwarding, DNS)</li><li>Supervisor Control Plane VMs (Master 2ea, Worker 3ea)</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="esxi-ì„¤ì¹˜">ESXi ì„¤ì¹˜<a class="hash-link" href="#esxi-ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h2><p>ì´ˆë°˜ì—ë„ ì´ì•¼ê¸° í–ˆë“¯ì´ ESXi 7.0ì´ìƒì—ì„œëŠ” ASUS PN50ì˜ ì˜¨ë³´ë“œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ëª»í•œë‹¤. ê·¸ë˜ì„œ ë³„ë„ë¡œ êµ¬ë§¤í•œ USB ì¸í„°í˜ì´ìŠ¤ì˜ RTL8153 ì¹©ì…‹ì„ ì´ë¯¸ì§€ì— í†µí•©ì‹œí‚¤ëŠ” ì‘ì—…ì´ í•„ìš”í•˜ë‹¤.  </p><p>ë“œë¼ì´ë²„ ì´ë¯¸ì§€ í†µí•©ì„ ìœ„í•œ ë‚´ìš©ì€ ì•„ë˜ í¬ìŠ¤íŒ…ì„ ì°¸ê³ í–ˆë‹¤.  </p><ul><li><a href="https://www.virten.net/2020/09/esxi-on-amd-ryzen-based-asus-pn50/" target="_blank" rel="noopener noreferrer">https://www.virten.net/2020/09/esxi-on-amd-ryzen-based-asus-pn50/</a></li><li><a href="https://www.virten.net/2020/04/how-to-add-the-usb-nic-fling-to-esxi-7-0-base-image/" target="_blank" rel="noopener noreferrer">https://www.virten.net/2020/04/how-to-add-the-usb-nic-fling-to-esxi-7-0-base-image/</a></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="esxi-ë‹¤ìš´ë¡œë“œ">ESXi ë‹¤ìš´ë¡œë“œ<a class="hash-link" href="#esxi-ë‹¤ìš´ë¡œë“œ" title="Direct link to heading">â€‹</a></h3><p>ë‹¤ìŒ ë§í¬ì—ì„œ <code>VMware vSphere 7.0 Update 1</code> ë¥¼ ë‹¤ìš´ë¡œë“œ í•œë‹¤.  </p><ul><li><a href="https://my.vmware.com/en/group/vmware/downloads/info/slug/datacenter_cloud_infrastructure/vmware_vsphere/7_0" target="_blank" rel="noopener noreferrer">https://my.vmware.com/en/group/vmware/downloads/info/slug/datacenter_cloud_infrastructure/vmware_vsphere/7_0</a></li></ul><p>ê¸°ë³¸ì ìœ¼ë¡œ VMware íšŒì›ê°€ì…ì´ í•„ìš”í•˜ë©° ë¼ì´ì„¼ìŠ¤ê°€ ì—†ëŠ” ê²½ìš° 60ì¼ trialë¡œ ê°€ëŠ¥í•˜ë‹¤.  </p><ul><li><a href="https://my.vmware.com/en/group/vmware/evalcenter?p=vsphere-eval-7" target="_blank" rel="noopener noreferrer">https://my.vmware.com/en/group/vmware/evalcenter?p=vsphere-eval-7</a></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="usb-network-native-driver-for-esxi">USB Network Native Driver for ESXi<a class="hash-link" href="#usb-network-native-driver-for-esxi" title="Direct link to heading">â€‹</a></h3><p>USB NIC Fling ë“œë¼ì´ë²„ë¥¼ ì¤€ë¹„í•œë‹¤. </p><ul><li><a href="https://flings.vmware.com/usb-network-native-driver-for-esxi?download_url=https%3A%2F%2Fdownload3.vmware.com%2Fsoftware%2Fvmw-tools%2FUSBNND%2FESXi701-VMKUSB-NIC-FLING-40599856-component-17078334.zip" target="_blank" rel="noopener noreferrer">https://flings.vmware.com/usb-network-native-driver-for-esxi?download_url=https%3A%2F%2Fdownload3.vmware.com%2Fsoftware%2Fvmw-tools%2FUSBNND%2FESXi701-VMKUSB-NIC-FLING-40599856-component-17078334.zip
</a></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="powershell-710-ì„¤ì¹˜">PowerShell 7.1.0 ì„¤ì¹˜<a class="hash-link" href="#powershell-710-ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h3><p>ê¸°ë³¸ì ìœ¼ë¡œ Windowì—ëŠ” 6.x ë²„ì „ì˜ PowerShellì´ ì„¤ì¹˜ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— íŠ¹ì • ìŠ¤í¬ë¦½íŠ¸ë¥¼ êµ¬ë™í•˜ê¸° ìœ„í•´ì„œëŠ” 7.1.0 ë²„ì „ì„ ì‹ ê·œë¡œ ì„¤ì¹˜í•´ì•¼ í•œë‹¤.  </p><ul><li><a href="https://github.com/PowerShell/PowerShell" target="_blank" rel="noopener noreferrer">https://github.com/PowerShell/PowerShell</a></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="powercli-ì¤€ë¹„">PowerCLI ì¤€ë¹„<a class="hash-link" href="#powercli-ì¤€ë¹„" title="Direct link to heading">â€‹</a></h3><p>PowerCLI ë‹¤ìš´ë¡œë“œ ë° ì„¤ì¹˜</p><ul><li><a href="https://www.powershellgallery.com/packages/VMware.PowerCLI/12.1.0.17009493" target="_blank" rel="noopener noreferrer">https://www.powershellgallery.com/packages/VMware.PowerCLI/12.1.0.17009493</a></li></ul><p>ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ PowerShellì„ ì‹¤í–‰í•˜ê³  PowerCLI ëª¨ë“ˆ ì„¤ì¹˜ì „ì— ì‹¤í–‰ ê¶Œí•œì„ ìˆ˜ì •í•œë‹¤.  </p><ul><li>ì°¸ê³  : <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-7.1" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-7.1</a></li></ul><div class="codeBlockContainer_I0IT language-powershell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-powershell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Set-ExecutionPolicy -ExecutionPolicy RemoteSigned</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>PowerCLIë¥¼ ì„¤ì¹˜í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-powershell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-powershell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Install-Module -Name VMware.PowerCLI -Scope CurrentUser</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="image-profile-í™•ì¸">Image Profile í™•ì¸<a class="hash-link" href="#image-profile-í™•ì¸" title="Direct link to heading">â€‹</a></h3><p>í¬ìŠ¤íŒ…ì„ í•˜ëŠ” 20ë…„ 11ì›” 29ì¼ ìµœì‹  ESXi ì´ë¯¸ì§€ëŠ” <code>ESXi-7.0U1b-17168206-standard</code>ë¡œ vSphere ESXi 7.0 ì´ë¯¸ì§€ í”„ë¡œí•„ì€ ì•„ë˜ì—ì„œ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤.  </p><ul><li><a href="https://www.virten.net/vmware/vmware-esxi-image-profiles/" target="_blank" rel="noopener noreferrer">https://www.virten.net/vmware/vmware-esxi-image-profiles/</a></li></ul><p>stable ë¦´ë¦¬ìŠ¤ë¡œ êµ¬ì„±í•˜ê¸° ìœ„í•´ ì´ì „ ë¦´ë¦¬ìŠ¤ì¸ <code>ESXi-7.0.1-16850804-standard</code> ì´ë¯¸ì§€ í”„ë¡œí•„ë¡œ ì„¤ì¹˜ë¥¼ ì§„í–‰í•œë‹¤.  </p><p>ì„¤ì¹˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ì‚´í´ë³´ë©´ <code>Add-EsxSoftwareDepot</code>ë¡œ repoì„¤ì •ì„ í•˜ê³  <code>Export-ESXImageProfile</code>ë¥¼ í†µí•´ ì›í•˜ëŠ” ì´ë¯¸ì§€ í”„ë¡œí•„ì˜ bundleì„ ë‹¤ìš´ë¡œë“œ ë°›ëŠ”ë‹¤. ìœ„ì—ì„œ ë‹¤ìš´ë¡œë“œ ë°›ì€ ë“œë¼ì´ë²„ë¥¼ <code>Add-EsxSoftwarePackage</code>ë¡œ íŒ¨í‚¤ì§€ë¥¼ ì¶”ê°€í•˜ê³  ìƒˆë¡œìš´ ISOì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ëŠ” ê³¼ì •ì„ ì•Œ ìˆ˜ ìˆë‹¤.  </p><p>ì´ë¯¸ì§€ í”„ë¡œí•„ ë³€ê²½ì„ í†µí•´ ì›í•˜ëŠ” ì´ë¯¸ì§€ ë²„ì „ìœ¼ë¡œ êµ¬ì„±ì´ ê°€ëŠ¥í•˜ë‹¤.  </p><div class="codeBlockContainer_I0IT language-powershell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-powershell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Add-EsxSoftwareDepot https://hostupdate.vmware.com/software/VUM/PRODUCTION/main/vmw-depot-index.xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Export-ESXImageProfile -ImageProfile "ESXi-7.0.1-16850804-standard" -ExportToBundle -filepath  ESXi-7.0.1-16850804-standard.zip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Remove-EsxSoftwareDepot https://hostupdate.vmware.com/software/VUM/PRODUCTION/main/vmw-depot-index.xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Add-EsxSoftwareDepot .\ESXi-7.0.0-15843807-standard.zip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Add-EsxSoftwareDepot .\ESXi701-VMKUSB-NIC-FLING-40599856-component-17078334.zip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">New-EsxImageProfile -CloneProfile "ESXi-7.0.1-16850804-standard" -name "ESXi-7.0.1-16850804-USBNIC" -Vendor "virten.net"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Add-EsxSoftwarePackage -ImageProfile "ESXi-7.0.1-16850804-USBNIC" -SoftwarePackage "vmkusb-nic-fling"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Export-ESXImageProfile -ImageProfile "ESXi-7.0.1-16850804-USBNIC" -ExportToIso -filepath ESXi-7.0.1-16850804-USBNIC.iso</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Export-ESXImageProfile -ImageProfile "ESXi-7.0.1-16850804-USBNIC" -ExportToBundle -filepath ESXi-7.0.1-16850804-USBNIC.zip</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="esxi-ì„¤ì¹˜-ì´ë¯¸ì§€-ì œì‘">ESXi ì„¤ì¹˜ ì´ë¯¸ì§€ ì œì‘<a class="hash-link" href="#esxi-ì„¤ì¹˜-ì´ë¯¸ì§€-ì œì‘" title="Direct link to heading">â€‹</a></h3><p>ESXi ë¶€íŒ… ì´ë¯¸ì§€ ì œì‘ì€ <a href="https://rufus.ie/" target="_blank" rel="noopener noreferrer">rufus</a>, <a href="https://www.ventoy.net/en/index.html" target="_blank" rel="noopener noreferrer">ventoy</a> ë‘˜ ì¤‘ í¸í•œ ë„êµ¬ë¡œ ì„ íƒí•˜ë©´ ë˜ëŠ”ë° ventoyê°€ ì¡°ê¸ˆ ë” í™œìš©ë„ê°€ ë†’ë‹¤ê³  íŒë‹¨í•˜ì—¬ ì§„í–‰í–ˆê³ , OSì„¤ì¹˜ USB ìƒì„±ì€ ìƒëµí•œë‹¤. </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ë¶€íŒ…-ë°-ì„¤ì¹˜">ë¶€íŒ… ë° ì„¤ì¹˜<a class="hash-link" href="#ë¶€íŒ…-ë°-ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h3><p>ì¼ë°˜ì ì¸ ë°”ì´ì˜¤ìŠ¤ ì„¤ì •ê³¼ ë™ì¼í•˜ê²Œ Boot ìš°ì„ ìˆœìœ„ë¥¼ USBë¡œ ì„¤ì •í•˜ê³  ë‹¤ìŒê³¼ ê°™ì€ ventoyí™”ë©´ì—ì„œ ì•ì„œ ìƒì„±í•œ <code>ESXi-7.0.1-16850804-USBNIC.iso</code> ì´ë¯¸ì§€ë¡œ ESXi ì„¤ì¹˜ë¥¼ ì§„í–‰í•œë‹¤.</p><p><img loading="lazy" src="https://nuanceofiqlusion.files.wordpress.com/2020/07/ventoymainmenu-e1594484932538.png" alt="ventoy" class="img_E7b_">
<a href="https://nuanceofiqlusion.files.wordpress.com/2020/07/ventoymainmenu-e1594484932538.png" target="_blank" rel="noopener noreferrer">https://nuanceofiqlusion.files.wordpress.com/2020/07/ventoymainmenu-e1594484932538.png</a>  </p><p>ì´í›„ ì¹œìˆ™í•œ DCUI(Direct Console User Interface)ë¡œ ì ‘ì†í•˜ì—¬ F2ëª¨ë“œë¡œ ì ‘ì†í•˜ì—¬ Static IP ì„¤ì •ê³¼ network í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•œë‹¤.  </p><p><img loading="lazy" alt="esxi" src="/assets/images/esxi7-5ef7454cef904dde1696b3ce9d0028a2.png" width="640" height="480" class="img_E7b_"></p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="vsphere-web-client-ì ‘ì†">vSphere Web Client ì ‘ì†<a class="hash-link" href="#vsphere-web-client-ì ‘ì†" title="Direct link to heading">â€‹</a></h3><p>ì„¤ì •í•œ Static IPë¡œ ì ‘ì†í•˜ì—¬ í™˜ê²½ì„ ì ê²€í•œë‹¤.  </p><p><img loading="lazy" alt="nw" src="/assets/images/esxi_network-290297edf5689dc50b1a67459aed6a37.png" width="1138" height="687" class="img_E7b_"></p><p>Management Networkì— vSwitch0ì´ êµ¬ì„±ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  </p><p>ê·¸ë¦¬ê³  ì„¤ì¹˜í•œ M.2 SSDë¡œ datastore2ë¥¼ ì¶”ê°€í•˜ì—¬ vCenter ì„¤ì¹˜ë¥¼ ì§„í–‰í•˜ë„ë¡ í•œë‹¤.</p><p><img loading="lazy" alt="storage" src="/assets/images/esxi_storage-564ca3d7a6401db1e1aef917ab9048b3.png" width="1143" height="458" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="router-ì„¤ì¹˜-ë°-í™˜ê²½-êµ¬ì„±">Router ì„¤ì¹˜ ë° í™˜ê²½ êµ¬ì„±<a class="hash-link" href="#router-ì„¤ì¹˜-ë°-í™˜ê²½-êµ¬ì„±" title="Direct link to heading">â€‹</a></h2><p>Router VMì€ DNS ì„œë²„ì˜ ì—­í• ë¿ ì•„ë‹ˆë¼ ì•ìœ¼ë¡œ êµ¬ì„±ë  ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬(10.10.0.0/24 &amp; 10.20.0.0/24)ì™€ ì™¸ë¶€ ë„¤íŠ¸ì›Œí¬ì˜ í¬ì›Œë”©ê³¼ NAT ì—­í• ì„ ìˆ˜í–‰í•œë‹¤.  </p><p>Photon OS 3.0 OVAë¡œ ë°°í¬ë˜ë©° <a href="https://my.vmware.com/group/vmware/downloads/details?downloadGroup=OVFTOOL440P01&amp;productId=974" target="_blank" rel="noopener noreferrer">OVFTool</a>ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°°í¬ë¥¼ ì§„í–‰í•˜ëŠ”ë° ì´ë¯¸ ì‘ì„±ëœ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í™œìš©í•œë‹¤. </p><ul><li><a href="https://packages.vmware.com/photon/3.0/Rev3/ova/photon-hw13_uefi-3.0-a383732.ova" target="_blank" rel="noopener noreferrer">Photon OS 3.0 OVA</a></li><li><a href="https://github.com/lamw/vsphere-with-tanzu-homelab-scripts.git" target="_blank" rel="noopener noreferrer">https://github.com/lamw/vsphere-with-tanzu-homelab-scripts</a></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="router-ì„¤ì¹˜">Router ì„¤ì¹˜<a class="hash-link" href="#router-ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h3><p>ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ì€ ë™ì¼í•œ PowerShellì´ ë™ì‘í•˜ëŠ” Window WSL2 í™˜ê²½ì—ì„œ ìˆ˜í–‰í–ˆê¸° ë•Œë¬¸ì— Window <code>hosts</code> íŒŒì¼ê³¼ WSLí™˜ê²½ì˜ <code>/etc/hosts</code> íŒŒì¼ì— ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•˜ê³ ì í•˜ëŠ” IPì£¼ì†Œë¥¼ ë¯¸ë¦¬ ë“±ë¡í•´ë†“ëŠ”ë‹¤.  </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">192.168.0.10    esxi-01.tanzu.local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.0.201   router.tanzu.local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.0.202   vcsa.tanzu.local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.0.203   haproxy.tanzu.local</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><a href="https://github.com/lamw/vsphere-with-tanzu-homelab-scripts.git" target="_blank" rel="noopener noreferrer">ìŠ¤í¬ë¦½íŠ¸ ë ˆí¬</a>ì˜ <code>deploy_photon_router_ova.sh</code>ë¥¼ ìì‹ ì˜ í™˜ê²½ì— ë§ê²Œ ìˆ˜ì •í•œë‹¤. WSLë‚´ì—ì„œ Window ì‹œìŠ¤í…œë‚´ì— ë‹¤ìš´ë¡œë“œí•œ OVAíŒŒì¼ ê²½ë¡œëŠ” WSLë‚´ì—ì„œ ì‹¤í–‰ë  ê²ƒì´ê¸°ì— <code>/mnt/c/esxi/photon-hw13_uefi-3.0-a383732.ova</code>ë¡œ ë³€ê²½í•˜ì˜€ë‹¤. Routerì™€ ESXi hostname, passwordë“±ì„ í™•ì¸í•˜ê³  Networkê³¼ DatastoreëŠ” ìœ„ì—ì„œ í™•ì¸í•œ ë‚´ìš©ìœ¼ë¡œ ìˆ˜ì •í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># William Lam</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># www.virtuallyghetto</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PhotonOVA="/mnt/c/esxi/photon-hw13_uefi-3.0-a383732.ova"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PhotonRouterVMName="router.tanzu.local"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ESXiHostname="esxi-01.tanzu.local"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ESXiUsername="root"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ESXiPassword='VMware1!'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PhotonRouterNetwork="VM Network"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PhotonRouterDatastore="datastore1"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### DO NOT EDIT BEYOND HERE ###</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ovftool \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--name=${PhotonRouterVMName} \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--X:waitForIpv4 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--powerOn \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--acceptAllEulas \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--noSSLVerify \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--datastore=${PhotonRouterDatastore} \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--net:"None=${PhotonRouterNetwork}" \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">${PhotonOVA} \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">"vi://${ESXiUsername}:${ESXiPassword}@${ESXiHostname}"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìŠ¤í¬ë¦½ë“œë¥¼ ì‹¤í–‰í•˜ë©´ OVAíŒŒì¼ì„ ë°°í¬í•˜ê²Œ ëœë‹¤.  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./deploy_photon_router_ova.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Opening OVA source: /mnt/c/esxi/photon-hw13_uefi-3.0-a383732.ova</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The manifest validates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The provided certificate is in valid period</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Source is signed and the certificate validates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Certificate information:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CertIssuer:/C=US/ST=California/L=Palo Alto/O=VMware, Inc.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CertSubject:/C=US/ST=California/L=Palo Alto/O=VMware, Inc.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -----BEGIN CERTIFICATE-----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -----END CERTIFICATE-----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Warning:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - Line -1: Unsupported value 'uefi.secureBoot.enabled' for attribute 'key' on element 'ExtraConfig'.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Opening VI target: vi://root@esxi-01.tanzu.local:443/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Deploying to VI: vi://root@esxi-01.tanzu.local:443/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transfer Completed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Powering on VM: router.tanzu.local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Task Completed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Received IP address: 192.168.0.47</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Completed successfully</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ì™€ ê°™ì´ DHCPë¥¼ í†µí•´ ì„ì˜ì˜ ì£¼ì†Œ(192.168.0.47)ë¥¼ í• ë‹¹ ë°›ê²Œ ë˜ê³  í•´ë‹¹ IPë¡œ SSHì ‘ì†í•˜ì—¬ ê¸°ë³¸ íŒ¨ìŠ¤ì›Œë“œ(<code>changeme</code>)ë¥¼ ì›í•˜ëŠ” íŒ¨ìŠ¤ì›Œë“œë¡œ ë³€ê²½í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh root@192.168.0.47</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The authenticity of host '192.168.0.47 (192.168.0.47)' can't be established.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ECDSA key fingerprint is SHA256:ESpN1DMTIu9PKWW4QZIYs4DZ602SsdhjxEYhugkmi+g.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Warning: Permanently added '192.168.0.47' (ECDSA) to the list of known hosts.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Password:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt; /etc/systemd/network/10-static-eth0.network &lt;&lt; EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">You are required to change your password immediately (administrator enforced)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Changing password for root.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Current password:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">New password:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Retype new password:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 08:58:54 up 32 min,  0 users,  load average: 0.00, 0.00, 0.00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tdnf update info not available yet!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@photon-machine [ ~ ]#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@photon-machine [ ~ ]# exit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection to 192.168.0.47 closed.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="router-í™˜ê²½-êµ¬ì„±">Router í™˜ê²½ êµ¬ì„±<a class="hash-link" href="#router-í™˜ê²½-êµ¬ì„±" title="Direct link to heading">â€‹</a></h3><p>ìœ„ ìŠ¤í¬ë¦½íŠ¸ <a href="https://github.com/lamw/vsphere-with-tanzu-homelab-scripts" target="_blank" rel="noopener noreferrer">ë ˆí¬ì§€í† ë¦¬</a>ì—ì„œ DNSì—­í• , í¬ì›Œë”©ì„ ìˆ˜í–‰í•˜ë„ë¡ <a href="https://github.com/lamw/vsphere-with-tanzu-homelab-scripts/blob/master/setup_photon_router.sh" target="_blank" rel="noopener noreferrer"><code>setup_photon_router.sh</code></a>ë¥¼ ìˆ˜ì •í•œë‹¤. </p><ul><li><code>PHOTON_ROUTER_IP</code>=192.168.0.201 : Router ì„¤ì •í•  IP</li><li><code>PHOTON_ROUTER_GW</code>=192.168.0.1 : Routerì˜ ê²Œì´íŠ¸ì›¨ì´</li><li><code>PHOTON_ROUTER_DNS</code>=192.168.0.1 : Routerì˜ Forwader DNS</li><li><code>SETUP_DNS_SERVER</code>=1 : Routerê°€ í´ëŸ¬ìŠ¤í„° ë‚´ DNS ì—­í• ì„ ìˆ˜í–‰</li></ul><p>ìœ„ ì„¤ì • ì´ì™¸ì—ë„ ì¶”í›„ ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ êµ¬ì„±ì„ ìœ„í•œ iptables êµ¬ì„±ì´ í¬í•¨ë˜ì–´ ìˆë‹¤.  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PHOTON_ROUTER_IP=192.168.0.201</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PHOTON_ROUTER_GW=192.168.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PHOTON_ROUTER_DNS=192.168.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SETUP_DNS_SERVER=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tdnf -y update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if [ ${SETUP_DNS_SERVER} -eq 1 ]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tdnf install -y unbound</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cat &gt; /etc/unbound/unbound.conf &lt;&lt; EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    server:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        interface: 0.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        port: 53</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        do-ip4: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        do-udp: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        access-control: 192.168.0.0/24 allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        access-control: 10.10.0.0/24 allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        access-control: 10.20.0.0/24 allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        verbosity: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    local-zone: "tanzu.local." static</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    local-data: "router.tanzu.local A 192.168.0.201"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    local-data-ptr: "192.168.0.201 router.tanzu.local"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    local-data: "vcsa.tanzu.local A 192.168.0.202"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    local-data-ptr: "192.168.0.202 vcsa.tanzu.local"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    local-data: "haproxy.tanzu.local A 192.168.0.203"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    local-data-ptr: "192.168.0.203 haproxy.tanzu.local"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    local-data: "esxi-01.tanzu.local A 192.168.0.10"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    local-data-ptr: "192.168.0.10 esxi-01.tanzu.local"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í•´ë‹¹ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ìˆ˜í–‰í•˜ê³  ë‚˜ë©´ IPê°€ ë³€ê²½ë˜ê³  ì™¸ë¶€ì—ì„œë„ Router DNSë¥¼ í†µí•´ ì¿¼ë¦¬ê°€ ê°€ëŠ¥í•œê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  </p><div class="codeBlockContainer_I0IT language-powershell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-powershell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">PS C:\Users\rokak&gt; nslookup vmware.com 192.168.0.201</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ì„œë²„:    router.tanzu.local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Address:  192.168.0.201</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ê¶Œí•œ ì—†ëŠ” ì‘ë‹µ:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ì´ë¦„:    vmware.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Addresses:  2a02:e980:b5::b7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            2a02:e980:b1::b7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            45.60.101.183</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            45.60.11.183</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="vcsavcenter-server-appliance-ë°°í¬-ë°-êµ¬ì„±">VCSA(vCenter Server Appliance) ë°°í¬ ë° êµ¬ì„±<a class="hash-link" href="#vcsavcenter-server-appliance-ë°°í¬-ë°-êµ¬ì„±" title="Direct link to heading">â€‹</a></h3><p><code>vcsa-deploy</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°°í¬ë¥¼ ì§„í–‰í•œë‹¤. <code>vcsa-deploy</code>ëŠ” VCSA ì´ë¯¸ì§€ë‚´ì— ë°”ì´ë„ˆë¦¬ í˜•íƒœë¡œ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— ë¨¼ì € VCSA 7.0 Update 1 ISOë¥¼ ë‹¤ìš´ë¡œë“œí•œë‹¤.  </p><ul><li><a href="https://my.vmware.com/group/vmware/evalcenter?p=vsphere-eval-7" target="_blank" rel="noopener noreferrer">https://my.vmware.com/group/vmware/evalcenter?p=vsphere-eval-7</a></li></ul><p>ìœ„ ìŠ¤í¬ë¦½íŠ¸ <a href="https://github.com/lamw/vsphere-with-tanzu-homelab-scripts" target="_blank" rel="noopener noreferrer">ë ˆí¬ì§€í† ë¦¬</a>ì—ì„œ <a href="https://github.com/lamw/vsphere-with-tanzu-homelab-scripts/blob/master/vcsa.tanzu.local.json" target="_blank" rel="noopener noreferrer"><code>vcsa.tanzu.local.json</code></a>ë¥¼ ìˆ˜ì •í•œë‹¤.  </p><p>íŒ¨ìŠ¤ì›Œë“œ, <code>Network</code>ì™€ <code>Datastore</code>ë¥¼ ì„¤ì •í•˜ê³  <code>dns_servers</code>ë¥¼ Router IPë¡œ ë³€ê²½í•œë‹¤. ë‚˜ë¨¸ì§€ëŠ” ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">"deployment_network"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"VM Network"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">"datastore"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"datastore2"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">"appliance"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">"__comments"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">"thin_disk_mode"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">"deployment_option"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"tiny"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">"name"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"vcsa.tanzu.local"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">"network"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">"ip_family"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"ipv4"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">"mode"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"static"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">"system_name"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"vcsa.tanzu.local"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">"ip"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"192.168.0.202"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">"prefix"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"24"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">"gateway"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"192.168.0.1"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">"dns_servers"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">"192.168.0.201"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ì—ì„œ ë‹¤ìš´ë¡œë“œ ë°›ì•˜ë˜ VCSA ISOë¥¼ ì••ì¶•ì„ í’€ê³  ìœ„ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì°¸ì¡°í•˜ì—¬ ë°°í¬ ëª…ë ¹ì„ ì‹¤í–‰í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ cd VMware-VCSA-all-7.0.1-17004997/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./vcsa-deploy install --accept-eula --acknowledge-ceip --no-ssl-certificate-verification /mnt/c/esxi/vsphere-with-tanzu-homelab-scripts/vcsa.tanzu.local.json</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>vCenterê°€ ì„¤ì¹˜ê°€ ì™„ë£Œëœ í›„ SSHë¡œ ì ‘ì†í•œë‹¤. ê¸°ë³¸ Shellì´ Bashê°€ ì•„ë‹ˆë¯€ë¡œ <code>shell</code> ëª…ë ¹ìœ¼ë¡œ ì ‘ì†í•œí›„ <code>chsh -s /bin/bash</code>ë¡œ ê¸°ë³¸ Shellì„ Bashë¡œ ë³€ê²½í•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh root@192.168.0.202</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The authenticity of host '192.168.0.202 (192.168.0.202)' can't be established.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ECDSA key fingerprint is SHA256:oMr5nJ9RDeZS9E3m586kSFDoNXM76yNiLYaIyDQ6ca4.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Warning: Permanently added '192.168.0.202' (ECDSA) to the list of known hosts.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VMware vCenter Server 7.0.1.00100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Type: vCenter Server with an embedded Platform Services Controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@192.168.0.202's password:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connected to service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * List APIs: "help api list"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * List Plugins: "help pi list"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * Launch BASH: "shell"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Command&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Command&gt; shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Shell access is granted to root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@vcsa [ ~ ]# chsh -s /bin/bash</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="vcsa-ì„¤ì •-ë³€ê²½">VCSA ì„¤ì • ë³€ê²½<a class="hash-link" href="#vcsa-ì„¤ì •-ë³€ê²½" title="Direct link to heading">â€‹</a></h3><p>ë©”ëª¨ë¦¬ ì ˆì•½ì„ ìœ„í•´ ë§ˆìŠ¤í„° ë…¸ë“œ ê°œìˆ˜ë¥¼ ë³€ê²½í•œë‹¤. <code>/etc/vmware/wcp/wcpsvc.yaml</code> ì—ì„œ <code>clusterconfig.minmasters</code> ì™€ <code>clusterconfig.maxmasters</code> ê°’ì„ 2ë¡œ ë³€ê²½í•˜ë©´ ëœë‹¤. ìì„¸í•œ ë‚´ìš©ì€ ë‹¤ìŒ ë§í¬ë¥¼ ì°¸ì¡°í•œë‹¤.</p><ul><li><a href="https://www.virtuallyghetto.com/2020/04/deploying-a-minimal-vsphere-with-kubernetes-environment.html" target="_blank" rel="noopener noreferrer">https://www.virtuallyghetto.com/2020/04/deploying-a-minimal-vsphere-with-kubernetes-environment.html</a></li></ul><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">logging</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> debug</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">maxsizemb</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># By default, WCP Agent VM OVF URL points to the ovf bundled in vCSA, served</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># through lighttpd web server. To override it, set kubevmconfig.ovfurl param.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#kubevm:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#  ovfurl: 'https://this_vc_pnid:5480/wcpagent/photon-ova-%%SIZE%%.ovf'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#  apiserverport: 6443</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#  authproxyport: 443</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">rhttpproxy_port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">443</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">clusterconfig</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">minmasters</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">maxmasters</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">disable_ssl</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace_graceful_disable_duration</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1800</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">upgrade_precheck_timeout</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">300</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># force_upgrade_clusters:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">force_version_for_enable</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1\.18\..*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">logging_fluentbit_enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># logging_fluentbit_rsyslog: ""</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">csisetting</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">csi_enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">hdcsconfig</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">ovf_url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'file:///storage/lifecycle/vmware-hdcs'</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>vCenter UIì‚¬ìš©ì„ ìœ„í•´ <a href="https://github.com/lamw/vsphere-with-tanzu-homelab-scripts/blob/master/setup_vcsa.ps1" target="_blank" rel="noopener noreferrer"><code>setup_vcsa.ps1</code></a> ìŠ¤í¬ë¦½íŠ¸ë¥¼ ìˆ˜ì •í•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-powershell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-powershell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">.\setup_vcsa.ps1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connect-VIServer: C:\esxi\vsphere-with-tanzu-homelab-scripts\setup_vcsa.ps1:17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Line |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  17 |  $vc = Connect-VIServer $VCSAHostname -User $VCSAUsername -Password $V â€¦</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     |        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     | 2020-11-30 ì˜¤ì „ 12:45:18 Connect-VIServer  The SSL connection could not be established,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     | see inner exception.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ì™€ ê°™ì´ SSL connection ì—ëŸ¬ê°€ ë°œìƒí•˜ê¸° ë•Œë¬¸ì— ì¸ì¦ì„œ ì²´í¬ë¥¼ ë¬´ì‹œí•˜ëŠ” ì„¤ì •ì„ ë¨¼ì„œ í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-powershell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-powershell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Set-PowerCLIConfiguration -InvalidCertificateAction:Ignore</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>$VCSAPassword</code>, <code>$DatastoreName</code>, <code>$ESXiPassword</code> ë“±ì„ ìˆ˜ì •í•˜ê³  ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-powershell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-powershell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">PS C:\esxi\vsphere-with-tanzu-homelab-scripts&gt; .\setup_vcsa.ps1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì„¤ì¹˜ê°€ ì™„ë£Œë˜ë©´ ì‹ ê·œUIë¡œ ì ‘ì†ì´ ê°€ëŠ¥í•´ì§„ë‹¤. ì´ì œë¶€í„°ëŠ” VCSAë¡œ ì§ì ‘ ì ‘ì†ì´ ê°€ëŠ¥í•˜ë‹¤.<br>
<!-- -->ê¸°ë³¸ ë¡œê·¸ì¸ ì•„ì´ë””ëŠ” <code>administrator@vsphere.local</code>ë¡œ <code>vcsa.tanzu.local.json</code> ì—ì„œ ì„¤ì •í•œ íŒ¨ìŠ¤ì›Œë“œë¡œ ì ‘ì†í•˜ë©´ vCenter ê¸°ë°˜ì˜ Client UIë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì •ìƒì ìœ¼ë¡œ í´ëŸ¬ìŠ¤í„°ì— ì—°ê²°ëœ ESXi í˜¸ìŠ¤íŠ¸ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  </p><p><img loading="lazy" alt="VCSA" src="/assets/images/vcsa_home-4abc614139248554017057d16eaf1911.png" width="1007" height="460" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ì¼ë‹¨ ì•„ì£¼ ì‘ì€ í•˜ë“œì›¨ì–´ë¡œ ê°€ì„±ë¹„ ì¢‹ì€ í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì¶•í•  ìˆ˜ ìˆëŠ” PN50ìœ¼ë¡œ Tanzu í´ëŸ¬ìŠ¤í„° êµ¬ì„±ì„ í•˜ê¸° ìœ„í•œ ê¸°ì´ˆì‘ì—…ì´ ì™„ë£Œë˜ì—ˆë‹¤.  </p><p>ê¸€ì´ ê¸¸ì–´ì§€ëŠ” ê´€ê³„ë¡œ VDS(vSphere Distributed Switch)ë¥¼ êµ¬ì„±í•˜ëŠ” ì´í›„ ë¶€ë¶„ì€ ë‹¤ìŒ í¬ìŠ¤íŒ…ì—ì„œ ê³„ì† ì´ì–´ë‚˜ê°ˆ ì˜ˆì •ì´ë‹¤. </p><blockquote><p>ë‹¤ìŒê¸€ - <a href="https://ddii.dev/kubernetes/vSphere-with-Tanzu-homelab-2/" target="_blank" rel="noopener noreferrer">vSphere with Tanzu homelab running on ASUS PN50 (2/2)</a></p></blockquote>]]></content>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="Tanzu" term="Tanzu"/>
        <category label="vSphere" term="vSphere"/>
        <category label="Homelab" term="Homelab"/>
        <category label="ASUS" term="ASUS"/>
        <category label="PN50" term="PN50"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[2019 Retrospective]]></title>
        <id>retrospective/2020plan/</id>
        <link href="https://ddii.dev/retrospective/2020plan/"/>
        <updated>2020-01-03T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[19ë…„ë„ë¥¼ ëŒì•„ë³´ë©°]]></summary>
        <content type="html"><![CDATA[<p>ë˜ í•œí•´ê°€ ì§€ë‚˜ê°”ë‹¤. 2019ë…„ í•œì¼ ì •ë¦¬í•˜ë©´ì„œ 2020ë…„ í”Œëœ ê¸°ë¡ìš©ìœ¼ë¡œ ë„ì ê±°ë ¤ë³¸ë‹¤.</p><ul><li><p>Work</p><ul><li>18ë…„ë„ ê¹Œì§€ ì„œë¹„ìŠ¤ ê°œë°œì„ ë§¡ì•˜ì§€ë§Œ ê°‘ì‘ìŠ¤ëŸ½ê²Œ ë¶€ì„œ ì´ë™ìœ¼ë¡œ ì¸í•´ FaaS ê°œë°œì„ ì†ì„ ë–¼ê³  ì‹ ê·œ ë¶€ì„œë¡œ ì´ì „í•˜ê²Œ ë˜ì—ˆë‹¤. ì‘ë…„ ì´ˆì—ë„ í° ë³€í™”ì˜€ëŠ”ë° ì´ë²ˆì—ë„ ë” í° ë³€í™”ì˜€ë‹¤.</li><li>ë¬¸ì œëŠ” ê°œë°œë³´ë‹¤ëŠ” ê¸°íšìª½ì— ë” ê°€ê¹Œìš´ ì—…ë¬´ì˜€ê³  ë°ì´í„° ë¶„ì„ ê´€ë ¨í•œ í”Œë«í¼ì„ ê°œë°œí•˜ëŠ” TFì— í¬í•¨ë˜ê²Œ ë˜ì—ˆë‹¤. ë¨¸ì‹ ëŸ¬ë‹, ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ê³¼ëŠ” ë‹´ì„ ìŒ“ì•˜ì—ˆì§€ë§Œ ì–´ì©”ìˆ˜ ì—†ì´ ë¶„ì„ ê´€ë ¨í•˜ì—¬ ê³¼ì œ ìˆ˜í–‰</li><li>1-3ì›”ì—ëŠ” ì£¼ë¡œ ëª¨ë¹Œë¦¬í‹° ê´€ë ¨ ì—ì½”íŒŒíŠ¸ë„ˆë“¤ê³¼ í˜‘ë ¥ ë° ì‚¬ì—…ê°œë°œì„ ìœ„í•œ ê¸°ìˆ ê²€í†  ë° ê²€ì¦.</li><li>4-6ì›”ì—ëŠ” ê·¸ë£¹ ê´€ê³„ì‚¬ë“¤ì˜ ë°ì´í„°ë ˆì´í¬ì— ëŒ€í•œ ì •ì˜ì™€ ì„¤ê³„, í”Œë«í¼ êµ¬í˜„ì„ ìœ„í•œ Design-Thinking, ì„œë¹„ìŠ¤ í¬í„¸ ê¸°íš ë“±ì„ ìˆ˜í–‰í•˜ê³  ê·¸ë£¹ ê´€ê³„ì‚¬ë“¤ì˜ ë°ì´í„°ë ˆì´í¬ì— ëŒ€í•œ ì •ì˜ì™€ ì„¤ê³„ ì§„í–‰.</li><li>7-9ì›”ì—ëŠ” ì„œë¹„ìŠ¤ í¬í„¸ ê°œë°œì„ ìœ„í•œ CI/CD ì„ ì • ë° devops íŒŒì´í”„ë¼ì¸ êµ¬ì„±, ë°ì´í„° preparation íˆ´ ê²€í†  ë° AWS Managed ì„œë¹„ìŠ¤ ê²€ì¦ ë° êµ¬í˜„ ì—…ë¬´ë¥¼ ìˆ˜í–‰í–ˆë‹¤. ë˜í•œ í”„ë¡ íŠ¸ì—”ë“œ ì„œë¹„ìŠ¤ ì²˜ë¦¬ë¥¼ ìœ„í•œ ëŒë‹¤í•¨ìˆ˜ ê°œë°œ ë° documents ë ˆí¬ì§€í† ë¦¬ êµ¬ì¶• ì§„í–‰.</li><li>10-12ì›”ê¹Œì§€ëŠ” ì„œë¹„ìŠ¤ í¬í„¸ ì˜¤í”ˆ ë° ê³ ë„í™”, ë‹¤ìŒ ë‹¨ê³„ ì„œë¹„ìŠ¤ ê¸°íš ìˆ˜í–‰í•¨.</li></ul></li><li><p>Main Tools</p><ul><li>Python, Node.js, Java(Springboot)</li><li>AWS - ECS, Lambda, CloudFront, Athena, Glue, S3, SageMaker</li><li>IBM Cloud - Object Storage</li><li>Github Team</li><li>CircleCI, Github Action</li></ul></li><li><p>Side (Communityí¬í•¨)</p><ul><li>ë²ˆì—­ : <a href="http://acornpub.co.kr/book/monitoring-prometheus" target="_blank" rel="noopener noreferrer">í”„ë¡œë©”í…Œìš°ìŠ¤ ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ ëª¨ë‹ˆí„°ë§ [ê°€ìƒë¨¸ì‹ , ì»¨í…Œì´ë„ˆ í™˜ê²½ì˜ í”„ë¡œë©”í…Œìš°ìŠ¤ ëª¨ë‹ˆí„°ë§ ì‹¤ìŠµê³¼ í™œìš©]</a></li><li>ë¸”ë¡œê·¸ í¬ìŠ¤íŒ… - 13íšŒ (ëª©í‘œ 25íšŒ ë¯¸ë‹¬ì„±)</li><li>ì‚¬ë‚´ ì—°êµ¬ ê³¼ì œ - ë©€í‹°í´ë¼ìš°ë“œ êµ¬í˜„ì„ ìœ„í•œ IaC ì—°êµ¬ (5-10ì›”)<ul><li>Terraform, Terratest, Ansible, Kubespary, CircleCI ì¡°í•©ìœ¼ë¡œ í•˜ë‚˜ì˜ íŒŒì´í”„ë¼ì¸ì—ì„œ Bastion ì—†ì´ ë©€í‹° í´ë¼ìš°ë“œ(AWS, IBM, GCP) í™˜ê²½ì— Elastic ë° K8s í´ëŸ¬ìŠ¤í„° ë°°í¬ ë° í…ŒìŠ¤íŠ¸ ìë™í™” í™˜ê²½ êµ¬ì„±</li></ul></li><li>Istio ìŠ¤í„°ë”” (9-11ì›”)<ul><li>ë‹¤ì–‘í•œ íšŒì‚¬ë¶„ë“¤ê³¼ ìŠ¤í„°ë”” ì§„í–‰ (ì¹´ì¹´ì˜¤ë±…í¬, ì´ë² ì´, í•˜ì´í¼ì»¤ë„¥íŠ¸)<ul><li>ë‹¤ì–‘í•œ ê²½í—˜ì„ ë“¤ì„ìˆ˜ ìˆì–´ì„œ ì¢‹ì€ ê²½í—˜!!</li></ul></li><li>ìë£Œ : <a href="https://github.com/dev-chulbuji/istio-study" target="_blank" rel="noopener noreferrer">https://github.com/dev-chulbuji/istio-study</a></li></ul></li><li>K8s Korea Group ëª¨ë‹ˆí„°ë§ ì†Œëª¨ì„ ì§„í–‰<ul><li>1ì°¨ (4/25) SK u-tower<ul><li>ë°œí‘œ1 : OpenCensus with Prometheus and Kubernetes (ê¹€ì§„ì›…)</li><li>ë°œí‘œ2 - Service Mesh(Istio) Monitoring (ë‚˜ì •í˜¸)</li></ul></li><li>2ì°¨(6/4) ë©”ê°€ì¡´<ul><li>ë°œí‘œ1 : ì¿ ë²„ë„¤í‹°ìŠ¤ ìš´ì˜ ê´€ë¦¬ ì˜¤í”ˆì†ŒìŠ¤: NexClipper ì†Œê°œ (ê¹€ì§„ìš©)</li><li>ë°œí‘œ2 : ë‚œìƒí† ì˜ (ëª¨ë‹ˆí„°ë§, ì•„í‚¤í…ì²˜ ê²½í—˜ ë“± ììœ ì£¼ì œ ê³µìœ , í† ì˜)</li></ul></li></ul></li><li>AWS Korea User ì†Œëª¨ì„ ì°¸ì—¬<ul><li>íŒêµ, ì»¨í…Œì´ë„ˆ, ì„œë²„ë¦¬ìŠ¤, ë°ì´í„° ì‚¬ì´ì–¸ìŠ¤, ë¨¸ì‹ ëŸ¬ë‹ ìŠ¤í„°ë””, ë°ë¸Œì˜µìŠ¤</li></ul></li><li>CircleCI ë°‹ì—… ì°¸ì—¬<ul><li>1ì°¨ (5/14), 2ì°¨ (8/27)</li></ul></li><li>Open Infrastructure &amp; Cloud Native Days Korea 2019 ì°¸ì—¬ (7/18-19)</li><li>Kubernetes Forum Seoul ì°¸ì—¬ (12/9)<ul><li>CFP íƒˆë½ ã… ã… </li></ul></li><li>ê°œì¸ ì„œë²„, NAS 2ëŒ€ Shutdown (ì „ê¸°ì„¸ ì••ë°•ì—ì„œ í•´ë°©ë¨)<ul><li>G Suite Business ë¡œ ê°ˆì•„íƒ</li></ul></li><li>ë¯¸ë””ì–´ í™˜ê²½ ê°œí¸<ul><li>ìŠ¤ë§ˆíŠ¸TV ì§êµ¬ (75SM8670PUA)</li><li>PS4 êµ¬ë§¤ (ë‹Œí…ë„ ìŠ¤ìœ„ì¹˜, Xbox ê¸°ì¡´ë³´ìœ )</li></ul></li><li>K3s Home Labêµ¬ì„± ë° ì´ë”íŒ¨ë“œ ì„œë¹„ìŠ¤ ìš´ì˜<ul><li>1.16 í´ëŸ¬ìŠ¤í„° : 1 Master, 3 Workers</li></ul></li><li>ë…ì„œ<ul><li>20ê¶Œ ë‚´ì™¸ (ê¸°ìˆ ì„œ í¬í•¨)</li></ul></li><li>êµìœ¡<ul><li>Google Study Jam - í´ë¼ìš°ë“œ 4íšŒ, ë¨¸ì‹ ëŸ¬ë‹ 4íšŒ ìˆ˜ë£Œ</li><li>Udemy - CKA, CKAD</li><li>Elasticsearch Engineer I, II</li></ul></li></ul></li><li><p>Speak</p><ul><li>2018ë…„ì— ë¹„í•´ ëŒ€ì™¸ ë°œí‘œê°€ ë§ì´ ì ì—ˆë‹¤. ì‹¤ì œ K8s ê´€ë ¨ ì—…ë¬´ë¥¼ í•˜ì§€ ì•Šì•„ ê·¸ëŸ° ë“¯ í•˜ë‹¤.</li><li>4ì›” AWS Korea User Group íŒêµì†Œëª¨ì„<ul><li><a href="https://www.slideshare.net/JinwoongKim8/eks-workshop-140043415" target="_blank" rel="noopener noreferrer">Amazon EKS Workshop ì‚´í´ë³´ê¸°</a></li></ul></li><li>4ì›” Kubernetes Korea Group ëª¨ë‹ˆí„°ë§ ì†Œëª¨ì„<ul><li><a href="https://www.slideshare.net/JinwoongKim8/open-census-with-prometheus-and-kubernetes" target="_blank" rel="noopener noreferrer">Opencensus with prometheus and kubernetes</a></li></ul></li><li>4ì›” Google Cloud Next â€˜19 Extended Korea<ul><li><a href="https://www.slideshare.net/JinwoongKim8/knative" target="_blank" rel="noopener noreferrer">Knativeë¡œ ì„œë²„ë¦¬ìŠ¤ ì›Œí¬ë¡œë“œ êµ¬í˜„</a></li></ul></li><li>6ì›” Korea DevOps MeetUP â€˜19 - 4ì›” ë°œí‘œ ìˆ˜ì •<ul><li><a href="https://www.slideshare.net/JinwoongKim8/opencensus-with-prometheus-and-kubernetes" target="_blank" rel="noopener noreferrer">OpenCensus with Prometheus and Kubernetes</a></li></ul></li><li>7ì›” CircleCI Korea User Group 2nd Meetup<ul><li><a href="https://www.slideshare.net/JinwoongKim8/dataops-with-circleci" target="_blank" rel="noopener noreferrer">Data(?)Ops with CircleCI</a></li></ul></li><li>9ì›” AWS Korea User Group íŒêµì†Œëª¨ì„<ul><li><a href="https://www.slideshare.net/JinwoongKim8/dataops-with-circleci" target="_blank" rel="noopener noreferrer">DataOps with CircleCI</a></li></ul></li><li>11ì›” ì‚¬ë‚´ Open Tech Lounge ë°œí‘œ<ul><li>ë©€í‹°í´ë¼ìš°ë“œ êµ¬í˜„ì„ ìœ„í•œ IaC ì—°êµ¬</li></ul></li></ul></li><li><p>2020 ëª©í‘œ</p><ul><li>ì»¤ë®¤ë‹ˆí‹° í™œë™ì€ ìµœëŒ€í•œ ì¤„ì´ê¸° (í•„ìˆ˜ì ì¸ ë¶€ë¶„ë§Œ)<ul><li>SRE group í™œì„±í™” ë°©ì•ˆ ê³ ë¯¼</li><li>ë°‹ì—…, ì„¸ë¯¸ë‚˜ ê´€ë ¨ ìº˜ë¦°ë” ì—°ë™ ìë™í™” ë°©ì•ˆ ê³ ë¯¼</li></ul></li><li>ë²ˆì—­ ë° ì±… ì“°ëŠ”ê±´ ê³ ë¯¼ì„ ë”...</li><li>Level Up<ul><li>ì˜ì–´!! - ë°œí‘œê¹Œì§€</li><li>Full-Stack ??</li><li>ë¨¸ì‹ ëŸ¬ë‹, ë”¥ëŸ¬ë‹</li><li>ELK ì¿¼ë¦¬ ì˜ì§œê¸°</li><li>NoSQL</li></ul></li><li>ê¸°ì¡´ì—…ë¬´ K8s ì „í™˜ ë° ê³ ë„í™”<ul><li>ì„œë²„ë¦¬ìŠ¤, ë§¤ë‹ˆì§€ë“œ ë°©í–¥ìœ¼ë¡œ</li></ul></li><li>ì‚¬ì´ë“œ í”„ë¡œì íŠ¸<ul><li>í™ˆ ë¯¸ë””ì–´ ê´€ë¦¬ ê³ ë„í™” (Plex)</li><li><a href="https://nextcloud.com/" target="_blank" rel="noopener noreferrer">nextcloud</a> ì„œë¹„ìŠ¤ ì˜¤í”ˆ (ì§€ì¸ ëŒ€ìƒ)</li><li>ëª¨ë°”ì¼ ì›¹ì•± 3ê°œ ë§Œë“¤ê¸° (ë¯¸ë””ì–´ ê´€ë¦¬, ì½”ë¯¹ ë·°ì–´, ìŠ¤íŠ¸ë¦¬ë°)</li><li>ì˜¤í”ˆì†ŒìŠ¤ ê¸°ì—¬</li></ul></li></ul></li></ul>]]></content>
        <category label="Retrospective" term="Retrospective"/>
        <category label="2019" term="2019"/>
        <category label="2020" term="2020"/>
        <category label="Planning" term="Planning"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[CircleCIë¡œ AWS BATCH(ECS) CI/CD Pipeline êµ¬ì„±]]></title>
        <id>devops/circleci-ecs/</id>
        <link href="https://ddii.dev/devops/circleci-ecs/"/>
        <updated>2019-06-30T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[ì´ì „ í¬ìŠ¤íŒ…ì—ì„œ EKS í´ëŸ¬ìŠ¤í„°ì™€ ì–´í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬ ë° í…ŒìŠ¤íŠ¸ë¥¼ ê°„ë‹¨í•˜ê²Œ í•´ë´¤ë‹¤.  ì´ë²ˆì—ëŠ” AWS ECS ë˜ëŠ” AWS Batch Applicationì„ CircleCIë¥¼ í†µí•´ ë°°í¬ ë° ì—…ë°ì´íŠ¸ í•˜ëŠ” ê²ƒì„ ì•Œì•„ë³¸ë‹¤.]]></summary>
        <content type="html"><![CDATA[<p><a href="https://ddii.dev/devops/circleci/" target="_blank" rel="noopener noreferrer">ì´ì „ í¬ìŠ¤íŒ…</a>ì—ì„œ EKS í´ëŸ¬ìŠ¤í„°ì™€ ì–´í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬ ë° í…ŒìŠ¤íŠ¸ë¥¼ ê°„ë‹¨í•˜ê²Œ í•´ë´¤ë‹¤.  ì´ë²ˆì—ëŠ” AWS ECS ë˜ëŠ” AWS Batch Applicationì„ CircleCIë¥¼ í†µí•´ ë°°í¬ ë° ì—…ë°ì´íŠ¸ í•˜ëŠ” ê²ƒì„ ì•Œì•„ë³¸ë‹¤.  </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="application-ìš”êµ¬ì‚¬í•­">Application ìš”êµ¬ì‚¬í•­<a class="hash-link" href="#application-ìš”êµ¬ì‚¬í•­" title="Direct link to heading">â€‹</a></h2><p>ê¸°ë³¸ì ìœ¼ë¡œ í˜„ì¬ ì—…ë¬´ ì¤‘ì— IBMí´ë¼ìš°ë“œì—ì„œ AWSë¡œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ì•¼ í•˜ëŠ” ì—…ë¬´ê°€ ìƒê²¨ì„œ ì‹œì‘ë˜ì—ˆê³  ì •ê¸°ì ìœ¼ë¡œ ë§¤ì¼ ìƒˆë²½ì— í¬ë¡¤ë§(Pull)ë°©ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë³µì œí•´ì•¼í•˜ëŠ” Use-Caseë¥¼ êµ¬í˜„í•´ì•¼ í–ˆë‹¤.<br>
<!-- -->CI/CD Pipelineêµ¬ì„±ì´ ì£¼ ëª©ì ìœ¼ë¡œ Applicationêµ¬í˜„ì€ í¬ìŠ¤íŒ… ë‚´ìš©ì—ì„œ ì œì™¸í•˜ì˜€ë‹¤.  </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ê¸°ë³¸-ìš”êµ¬ì‚¬í•­">ê¸°ë³¸ ìš”êµ¬ì‚¬í•­<a class="hash-link" href="#ê¸°ë³¸-ìš”êµ¬ì‚¬í•­" title="Direct link to heading">â€‹</a></h3><ul><li>Github Account</li><li>CircleCI Account (Github Auth)</li><li>AWS ECR(Elastic Container Registry)</li><li>AWS Batch(ECS) </li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="cicd-êµ¬ì„±ì•ˆ">CI/CD êµ¬ì„±ì•ˆ<a class="hash-link" href="#cicd-êµ¬ì„±ì•ˆ" title="Direct link to heading">â€‹</a></h2><p>ì‹¤ì œ í”„ë¡œì íŠ¸ì— ì ìš©í•  êµ¬ì„±ì•ˆì´ë‹¤.<br>
<!-- -->ê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë“  êµ¬ì„±ì€ ìµœëŒ€í•œ ë¹„ìš©ì´ ë“¤ì§€ ì•Šê³  AWS ì¢…ì†ì„±ì„ ì œê±°í•œ ë°©ë²•ìœ¼ë¡œ êµ¬ì„±í•˜ì˜€ë‹¤.  </p><ul><li>Code Repository : Github</li><li>CI : CircleCI</li><li>Registry : AWS ECR</li><li>CD : CircleCI</li><li>Target : AWS Batch(ECS)</li><li>Notification : Slack</li></ul><p>ì´ë²ˆ ë°ëª¨ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì‹œë‚˜ë¦¬ì˜¤ë¡œ ì§„í–‰í•˜ë ¤ê³  í•œë‹¤.  </p><ol><li>Terraformìœ¼ë¡œ AWS Batch ìƒì„±</li><li>Githubì— ìˆ˜ì •ëœ Batch Code(Shell Script) Commit &amp; Triggering CircleCI</li><li>Docker Build &amp; AWS ECRë¡œ Push</li><li>S3ë¡œ myjob shell íŒŒì¼ ë³µì‚¬</li><li>AWS Batch(ECS) Job Definition ë³€ê²½(Change Image)</li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="aws-batch">AWS Batch<a class="hash-link" href="#aws-batch" title="Direct link to heading">â€‹</a></h3><p>ê¸°ë³¸ì ìœ¼ë¡œ Batch ì»´í“¨íŒ…ì„ ëª©ì ìœ¼ë¡œ í•˜ëŠ” ì„œë¹„ìŠ¤ë¡œ ì»´í“¨íŒ… íƒ€ì…ì„ Fargate ë˜ëŠ” EC2 ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•˜ì—¬ ë™ì ìœ¼ë¡œ í”„ë¡œë¹„ì €ë‹í•˜ëŠ” ì„œë¹„ìŠ¤ì´ë‹¤.<br>
<!-- -->ì´ˆê¸° ì„¤ì •ì´ ë²ˆê±°ë¡­ê¸´ í•˜ì§€ë§Œ í•œë²ˆ êµ¬ì„±í•˜ê³  ë‚˜ë©´ ë³„ë„ ê´€ë¦¬ê°€ í•„ìš”ì—†ê³  Batchì‘ì—…ì´ ë°œìƒí•˜ëŠ”ê²ƒê³¼ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ë³´ê´€ë¹„ìš© ì´ì™¸ì—ëŠ” ì¶”ê°€ ë¹„ìš©ì´ ë°œìƒí•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë¹„ìš©ì¸¡ë©´ì—ì„œ ì¥ì ì´ ìˆëŠ” ì„œë¹„ìŠ¤ì´ë‹¤.<br>
<!-- -->ìœ„ì—ì„œ ì´ì•¼ê¸°í•œ ì •ê¸°ì ìœ¼ë¡œ ìƒˆë²½ë§ˆë‹¤ í¬ë¡¤ë§(Pull)ë°©ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë³µì œí•´ì•¼í•˜ëŠ” Use-Caseë¥¼ êµ¬í˜„í•˜ëŠ”ê²ƒì´ ì ë‹¹í•œ ì›Œí¬ë¡œë“œ êµ¬í˜„ë°©ë²•ì´ë¼ ìƒê°í–ˆê¸° ë•Œë¬¸ì— AWS Batch ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ì—ˆë‹¤.  </p><p>ê°„ë‹¨í•œ Batch demoëŠ” <a href="https://github.com/awslabs/aws-batch-helpers/" target="_blank" rel="noopener noreferrer">https://github.com/awslabs/aws-batch-helpers/</a>ì—ì„œ í™•ì¸ì´ ê°€ëŠ¥í•˜ë©° CircleCIì—°ë™ì„ ìœ„í•´ Forkí›„  ì§„í–‰í•˜ì˜€ë‹¤.</p><p>Demo Repository : <a href="https://github.com/ddiiwoong/aws-batch-helpers/" target="_blank" rel="noopener noreferrer">https://github.com/ddiiwoong/aws-batch-helpers/</a></p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="circleci">CircleCI<a class="hash-link" href="#circleci" title="Direct link to heading">â€‹</a></h3><p>ëª¨ë“  Pipelineì€ CircleCIê¸°ë°˜ìœ¼ë¡œ ì‘ì„±í•˜ì˜€ë‹¤.  í˜¹ìëŠ” AWS Code Commit, Pipelineì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠëƒê³  ë¬¸ì˜í•˜ì‹œëŠ” ë¶„ë“¤ë„ ìˆëŠ”ë° ë‹¤ìŒê³¼ ê°™ì€ ì´ìœ ë¡œ CircleCIë¥¼ ì„ íƒí•˜ì˜€ë‹¤.  </p><ul><li>Fully Managed (Serverless)</li><li>AWS ì¢…ì†ì„± ìµœì†Œí™”  </li><li>Git, Registry, CDì˜ì—­ì˜ í™•ì¥ì„± ê³ ë ¤</li><li>AWS Console ì ‘ì† ìµœì†Œí™”</li><li>ì‰½ê³  ë‹¨ìˆœí•˜ê²Œ ë¹Œë“œ í™˜ê²½êµ¬ì„±</li><li>ì†Œê·œëª¨ í”„ë¡œì íŠ¸ ë¹ ë¥´ê²Œ ì‹œì‘ ê°€ëŠ¥</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="amazon-elastic-container-registry-ecr">Amazon Elastic Container Registry (ECR)<a class="hash-link" href="#amazon-elastic-container-registry-ecr" title="Direct link to heading">â€‹</a></h3><p>ê°œì¸ì ìœ¼ë¡œ RegistryëŠ” êµ¬ì¶•í˜•ë³´ë‹¤ëŠ” Managedì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ”ê²ƒì´ ì¢‹ë‹¤ê³  ë³´ê¸° ë•Œë¬¸ì— Webhookì„ Nativeí•˜ê²Œ ì§€ì›í•˜ëŠ” DockerHubë„ ëŒ€ì²´ ê°€ëŠ¥í•˜ë‹¤ê³  ìƒê°í•œë‹¤.  </p><ul><li>Fully Managed</li><li>Security (IAM) ì—°ë™</li><li>CircleCI Orbs ì œê³µ</li><li>EKS, ECS ì—°ë™ ìš©ì´</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="terraform">Terraform<a class="hash-link" href="#terraform" title="Direct link to heading">â€‹</a></h3><p><a href="https://www.terraform.io/docs/providers/aws/index.html" target="_blank" rel="noopener noreferrer">https://www.terraform.io/docs/providers/aws/index.html</a>  </p><p>ì„ ì–¸ì  ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ ê´€ë¦¬ ë„êµ¬ë¡œ ë§ì´ ì‚¬ìš©í•˜ê³  ìˆëŠ” ë„êµ¬ì´ë©° Docsì™€ ë¸”ë¡œê·¸ ìë£Œê°€ ë§ì€ ê´€ê³„ë¡œ ë”°ë¡œ ì„¤ëª…í•˜ì§€ ì•Šê² ë‹¤.<br>
<!-- -->ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ” AWS Batchë¥¼ ìƒì„±í•˜ëŠ” ì˜ì—­ì„ Terraformì´ ë‹´ë‹¹í•œë‹¤.  </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="circleci-config-ì‘ì„±">CircleCI Config ì‘ì„±<a class="hash-link" href="#circleci-config-ì‘ì„±" title="Direct link to heading">â€‹</a></h2><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">orbs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">aws-ecr</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> circleci/aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">ecr@6.1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">aws-ecs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> circleci/aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">ecs@0.0.8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">aws-s3</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> circleci/aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">s3@1.0.11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">aws-cli</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> circleci/aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cli@0.1.13</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">sh-s3-upload</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">docker</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'circleci/python:2.7'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> checkout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">aws-s3/copy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">from</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ./myjob.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">to</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'s3://batch-ecr-test/myjob.sh'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">deploy-batch</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">executor</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cli/default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> checkout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cli/install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Update AWS Batch Job</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            aws batch register-job-definition --job-definition-name fetch_and_run --type container --container-properties '{ "image": "823928750534.dkr.ecr.ap-northeast-2.amazonaws.com/fetch_and_run:v20190623", "vcpus": 1, "memory": 512}'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">workflows</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">build-and-deploy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">aws-ecr/build-and-push-image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">repo</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $AWS_RESOURCE_NAME_PREFIX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">tag</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v20190623</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">sh-s3-upload</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sh</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">s3</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">upload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">requires</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">ecr/build</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">and</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">push</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">deploy-batch</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">batch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">requires</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> sh</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">s3</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">upload</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë‹¨ê³„ë³„ ì„¤ëª…ì„ ìœ„í•´ ë¶€ë¶„ì ìœ¼ë¡œ ì„¤ëª…í•˜ë„ë¡ í•˜ê² ë‹¤.  </p><ol><li><p>Terraformìœ¼ë¡œ Batch ë°°í¬</p><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">resource </span><span class="token string" style="color:#e3116c">"aws_batch_compute_environment"</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"default"</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  compute_environment_name = </span><span class="token string" style="color:#e3116c">"env_fetch_and_run"</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  compute_resources </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    instance_role = </span><span class="token string" style="color:#e3116c">"arn:aws:iam::823928750534:instance-profile/ecsInstanceRole"</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    instance_type = </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">"optimal"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    desired_vcpus = </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    max_vcpus = </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    min_vcpus = </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    security_group_ids = </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">"sg-0632cf81b5c4dff17"</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    subnets = </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">"subnet-0c4f8135b536e8fab"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">"subnet-0a261950d894cf27e"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    type = </span><span class="token string" style="color:#e3116c">"EC2"</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  service_role = </span><span class="token string" style="color:#e3116c">"arn:aws:iam::823928750534:role/service-role/AWSBatchServiceRole"</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type =</span><span class="token string" style="color:#e3116c">"MANAGED"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Batch Computing í™˜ê²½ì„ êµ¬ì„±í•˜ê²Œ ë˜ëŠ”ë° <code>"aws_batch_compute_environment"</code>ë¥¼ ì‚¬ìš©í•œë‹¤.  </p><ul><li>compute_environment_name : (í•„ìˆ˜) ì»´í“¨íŒ… í™˜ê²½ ì´ë¦„</li><li>compute_resources.instance_role : (í•„ìˆ˜) EC2ì— ì ìš©ë˜ëŠ” Role</li><li>compute_resources.instance_type : (í•„ìˆ˜) ì‚¬ìš© ê°€ëŠ¥í•œ instance ìœ í˜•</li><li>compute_resources.desired_vcpus : (ì˜µì…˜) ì›í•˜ëŠ” CPUìˆ˜</li><li>compute_resources.max_vcpus : (í•„ìˆ˜) ìµœëŒ€ CPUìˆ˜  </li><li>compute_resources.min_vcpus : (í•„ìˆ˜) ìµœì†Œ CPUìˆ˜</li><li>compute_resources.security_group_ids : (í•„ìˆ˜) EC2ì— ì ìš©ë˜ëŠ” Security Group</li><li>compute_resources.subnets : (í•„ìˆ˜) Subnets ëª©ë¡</li><li>compute_resources.type : (í•„ìˆ˜) EC2ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìƒì„±, SPOT instance ì‚¬ìš©ê°€ëŠ¥  </li><li>service_role : (í•„ìˆ˜) AWS Batchê°€ ë‹¤ë¥¸ AWS ì„œë¹„ìŠ¤ë¥¼ í˜¸ì¶œ í• ìˆ˜ìˆê²Œ í•´ì£¼ëŠ” IAM Role(ARN)</li><li>type : (í•„ìˆ˜) MANAGEDë‚˜ UNMANAGEDë¥¼ ì„ íƒí•  ìˆ˜ ìˆê³ , MANAGEDì˜ ê²½ìš° compute_resourcesì— ì„¸ë¶€ ì‚¬í•­ì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.  </li></ul><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">resource </span><span class="token string" style="color:#e3116c">"aws_batch_job_definition"</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"default"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name = </span><span class="token string" style="color:#e3116c">"fetch_and_run"</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type = </span><span class="token string" style="color:#e3116c">"container"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  container_properties = &lt;&lt;CONTAINER_PROPERTIES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"command"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"image"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"823928750534.dkr.ecr.ap-northeast-2.amazonaws.com/fetch_and_run:v20190623"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"vcpus"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"memory"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">512</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"volumes"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"environment"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"mountPoints"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"ulimits"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONTAINER_PROPERTIES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Job Definition ì •ì˜("aws_batch_job_definition")ì—ì„œëŠ” Resource spec ë° Command(Docker RUN), Container IMAGE ë“±ì„ ì„ ì–¸í•˜ê²Œ ëœë‹¤.  </p><ul><li>name : (í•„ìˆ˜) Job Definition ì´ë¦„</li><li>type : (í•„ìˆ˜) Job Definition ìœ í˜•, ECSë¡œ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ containerë¡œ ì„ íƒ</li><li>container_properties : (ì„ íƒ) JSON í˜•íƒœë¡œ ì‘ì„±í•˜ëŠ” container ì†ì„±ì •ë³´ (Image, Resources, Command, MountPoint ë“±)</li></ul></li><li><p>.circleci/config.ymlì— CircleCI ë²„ì „ ëª…ì‹œ ë° ê´€ë ¨ orb(ecr,ecs,s3,cli) ì¶”ê°€<br>
<!-- -->ê¸°ë³¸ì ìœ¼ë¡œ 2.1ë¡œ ì„¤ì •ì„ í•´ì•¼ ecs, eks orb ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">orbs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">aws-ecr</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> circleci/aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">ecr@6.1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">aws-ecs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> circleci/aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">ecs@0.0.8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">aws-s3</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> circleci/aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">s3@1.0.11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">aws-cli</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> circleci/aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cli@0.1.13</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li><li><p>workflow êµ¬ì„±</p><p><code>build-and-push-image</code> -&gt; <code>sh-s3-upload</code> -&gt; <code>deploy-batch</code> ìˆœìœ¼ë¡œ ìˆœì°¨ì ìœ¼ë¡œ pipelineêµ¬ì„±ì„ í•˜ì˜€ë‹¤.  </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">workflows:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  build-and-deploy:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - aws-ecr/build-and-push-image:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          repo: $AWS_RESOURCE_NAME_PREFIX # data-crawler-test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          tag: v20190623</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          # create-repo: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          # dockerfile: Dockerfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - sh-s3-upload:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name: sh-s3-upload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          requires:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - aws-ecr/build-and-push-image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - deploy-batch:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name: deploy-batch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          requires:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - sh-s3-upload</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê¸°ë³¸ì ìœ¼ë¡œ CircleCIì—ì„œëŠ” orb jobì„ <!-- -->[orb name]<!-- -->/<!-- -->[predefined-job]<!-- --> í˜•ì‹ìœ¼ë¡œ ì„ ì–¸í•œë‹¤.  </p><p>I. ì²«ë²ˆì§¸ stepì—ì„œëŠ” container imageë¥¼ buildí•˜ê³  pushí•˜ëŠ” Jobì„ ìˆ˜í–‰í•˜ë¯€ë¡œ <code>aws-ecr/build-and-push-image</code>ì„ ì„ ì–¸í•œë‹¤.<br>
<!-- -->ìì„¸í•œ ë‚´ìš©ì€ <a href="https://circleci.com/orbs/registry/orb/circleci/aws-ecr" target="_blank" rel="noopener noreferrer">https://circleci.com/orbs/registry/orb/circleci/aws-ecr</a>ë¥¼ í™•ì¸í•˜ì.  </p><p>II. ë‘ë²ˆì§¸ stepì—ì„œëŠ” S3ì— ë°°ì¹˜ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì˜¬ë¦¬ëŠ” Custom Jobì„ ìˆ˜í–‰í•œë‹¤.  Jobì€ Stepì˜ ëª¨ìŒìœ¼ë¡œ ì„ í–‰ë˜ì–´ì•¼í•  Jobì€ ìƒìœ„ì— <code>requires:</code> ì—ì„œ ì„ ì–¸í•˜ë©´ ëœë‹¤.  </p><p>III. ì„¸ë²ˆì§¸ stepì—ì„œëŠ” AWS Batch job definitionì˜ container imageë¥¼ êµì²´(revision ë³€ê²½)í•˜ëŠ” Custom Jobì„ ìˆ˜í–‰í•œë‹¤.  </p></li><li><p>custom job êµ¬ì„±
Workflowì—ì„œ ì„ ì–¸í•œ Custom Jobì˜ ìƒì„¸ definitionì„ ê¸°ì¬í•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">sh-s3-upload</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">docker</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'circleci/python:2.7'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> checkout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">aws-s3/copy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">from</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ./myjob.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">to</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'s3://batch-ecr-test/myjob.sh'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">deploy-batch</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">executor</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cli/default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cli/install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Update AWS Batch Job</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            aws batch register-job-definition --job-definition-name fetch_and_run --type container --container-properties '{ "image": "823928750534.dkr.ecr.ap-northeast-2.amazonaws.com/fetch_and_run:v20190623", "vcpus": 1, "memory": 512}'</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>I. <code>sh-s3-upload</code> ì—ì„œëŠ” <code>aws-s3/copy</code> ë¥¼ ì‚¬ìš©í•˜ì—¬ ì›í•˜ëŠ” S3ë²„í‚·ì— ì‚¬ìš©í•  ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì—…ë¡œë“œ í•œë‹¤.  <code>checkout</code>ì—ì„œëŠ” í˜„ì¬ ìƒíƒœì˜ git repoë¥¼ cloneí•˜ê²Œ ëœë‹¤.  </p><p>II. <code>deploy-batch</code> ì—ì„œëŠ” <code>aws-cli/install</code> ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸°ì¡´ì— ì‘ì„±í•œ Batch Job definitionì„ awsclië¡œ ì›í•˜ëŠ” ìƒˆë¡œìš´ imageë¡œ ì—…ë°ì´íŠ¸ í•˜ê²Œ ëœë‹¤.  </p></li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="circleci-ì‹¤í–‰">CircleCI ì‹¤í–‰<a class="hash-link" href="#circleci-ì‹¤í–‰" title="Direct link to heading">â€‹</a></h2><p>ë¹Œë“œ ë° ë°°í¬ê³¼ì •ì„ ê°„ë‹¨í•˜ê²Œ ì„¤ëª…í•˜ë©´ ì½”ë“œê°€ ì—…ë°ì´íŠ¸ë˜ë©´ CircleCIëŠ” í•´ë‹¹ ì €ì¥ì†Œì˜ <code>.circleci/config.yml</code> ì„ ê¸°ì¤€ìœ¼ë¡œ ë¹Œë“œ ë° ë°°í¬ë¥¼ ì‹œì‘í•˜ê²Œ ëœë‹¤.  </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="readmemdì—-build-status-badge-ë‹¬ê¸°">README.mdì— Build Status Badge ë‹¬ê¸°<a class="hash-link" href="#readmemdì—-build-status-badge-ë‹¬ê¸°" title="Direct link to heading">â€‹</a></h2><p><a href="https://circleci.com/docs/2.0/status-badges/" target="_blank" rel="noopener noreferrer">https://circleci.com/docs/2.0/status-badges/</a>  </p><p><img loading="lazy" alt="badge" src="/assets/images/circle-badge-24ad544bce8cfd19a433ce635078fa5c.png" width="1000" height="660" class="img_E7b_">
ìœ„ ë§í¬ì™€ ì„¤ì •ì„ ì°¸ê³ í•˜ì—¬ ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ Build Statud Badgeë¥¼ ë‹¬ ìˆ˜ ìˆë‹¤.  </p><p><img loading="lazy" alt="badge" src="/assets/images/circle-badge-ss-0aa981c32cb500f9508dd854153420ae.png" width="854" height="374" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ì´ë²ˆì—ëŠ” CircleCIë¥¼ ê°€ì§€ê³  AWS Batch jobì„ êµ¬ì„±í•˜ëŠ” ë°ëª¨ë¥¼ ì§„í–‰í•˜ì˜€ë‹¤.  </p><p>ì–¼ë§ˆì „ì¸ê°€ì—ë„ <a href="https://github.com/leoh0" target="_blank" rel="noopener noreferrer">ì–´í˜•ë¶€í˜•</a>ë‹˜ê»˜ì„œë„ ì–¸ê¸‰í•˜ì‹  ì„ ì–¸ì ì¸ êµ¬ì„± ê¸°ë°˜ì— ìµœëŒ€í•œ serverless í™˜ê²½ì—ì„œì˜ ë°°í¬ë¥¼ ì¶”êµ¬í•˜ê²Œ ë˜ë‹¤ ë³´ë‹ˆ ì•„ë˜ì™€ ê°™ì€ <code>CI/CD Pipeline ì‹œë‚˜ë¦¬ì˜¤</code>ë¥¼ êµ¬ìƒí•˜ê²Œ ë˜ì—ˆë‹¤.  </p><p><img loading="lazy" alt="cicd" src="/assets/images/circlecicd-01a869820c0d70040071bbc7a5704933.png" width="972" height="599" class="img_E7b_"></p><p>ìƒˆë¡œìš´ ê¸°ëŠ¥ì˜ ë¸Œëœì¹˜(New Feature)ê°€ Gitì— pushë˜ë©´ ë¹Œë“œì™€ í…ŒìŠ¤íŠ¸ê°€ íŠ¸ë¦¬ê±°ë˜ì–´ ìë™ìœ¼ë¡œ ì§„í–‰ë˜ê³  ë™ì‹œì— ê°œë°œìê°€ PRì„ ì‘ì„±í•˜ë©´ ë™ë£Œ ë° ë‹´ë‹¹ ìƒê¸‰ìì—ê²Œ ì½”ë“œ ë¦¬ë·°ë¥¼ ë°›ê²Œ ëœë‹¤.  </p><p>ë¦¬ë·°ê°€ í†µê³¼ë˜ê³  CircleCIì—ì„œ ë¹Œë“œê°€ ì„±ê³µí–ˆë‹¤ë©´ ìŠ¹ì¸ë‹¨ê³„ë¥¼ í†µí•´ Mergeë¥¼ í•˜ê³  CircleCI ê°€ í•œ ë²ˆ ë” ë¹Œë“œë¥¼ ì‹œì‘í•˜ê³  ë°°í¬ê¹Œì§€ ìˆ˜í–‰í•˜ê²Œ ëœë‹¤.  </p><p>ECSë‚˜ Batchë¡œ ë°°í¬ëŠ” CircleCIë¥¼ í†µí•´ ì§ì ‘ ë°°í¬ë¥¼ í•˜ê³  EC2ë‚˜ EKSë¡œì˜ ë°°í¬ëŠ” Terraform ë° ArgoCDë¥¼ í†µí•´ ë°°í¬ë¥¼ ì§„í–‰í•˜ëŠ” ë°©ì‹ì´ë‹¤.  </p><p>ë‹¤ìŒë²ˆ í¬ìŠ¤íŒ…ì—ëŠ” ìœ„ ê·¸ë¦¼ ê¸°ë°˜ìœ¼ë¡œ CircleCIì™€ ArgoCDë¥¼ í™œìš©í•˜ì—¬ EKSê¸°ë°˜ ë°°í¬ê³¼ì •ì„ ì •ë¦¬í•  ì˜ˆì •ì´ë‹¤.  </p><p><a href="https://ko-fi.com/X8X1W6OZ" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="https://www.ko-fi.com/img/githubbutton_sm.svg" alt="ko-fi" class="img_E7b_"></a></p>]]></content>
        <category label="DevOps" term="DevOps"/>
        <category label="CI/CD" term="CI/CD"/>
        <category label="Pipeline" term="Pipeline"/>
        <category label="CircleCI" term="CircleCI"/>
        <category label="GitHub" term="GitHub"/>
        <category label="GitOps" term="GitOps"/>
        <category label="ECS" term="ECS"/>
        <category label="AWS Batch" term="AWS Batch"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[CircleCI - GitHub ì—°ë™ ë° EKS êµ¬ì„±í•˜ê¸°]]></title>
        <id>devops/circleci/</id>
        <link href="https://ddii.dev/devops/circleci/"/>
        <updated>2019-06-18T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[CI/CDëŠ” ê°œë°œë‹¨ê³„ì—ì„œ ì§€ì†ì ì¸ í†µí•©, ë°°í¬ë¥¼ í†µí•´ íš¨ìœ¨ì„±ì„ ë†’ì—¬ì£¼ëŠ” ë„êµ¬ë¼ê³  ë§í• ìˆ˜ ìˆë‹¤.  íŠ¹íˆ GitOpsê°€ ì¤‘ìš”ì‹œ ë˜ëŠ” ìµœê·¼ íŠ¸ë Œë“œì—ì„œ Public Gitì„œë¹„ìŠ¤ì™€ í†µí•©ì€ í•„ìˆ˜ì ì¸ ìš”ì†Œì´ë‹¤.]]></summary>
        <content type="html"><![CDATA[<p>CI/CDëŠ” ê°œë°œë‹¨ê³„ì—ì„œ ì§€ì†ì ì¸ í†µí•©, ë°°í¬ë¥¼ í†µí•´ íš¨ìœ¨ì„±ì„ ë†’ì—¬ì£¼ëŠ” ë„êµ¬ë¼ê³  ë§í• ìˆ˜ ìˆë‹¤.  íŠ¹íˆ GitOpsê°€ ì¤‘ìš”ì‹œ ë˜ëŠ” ìµœê·¼ íŠ¸ë Œë“œì—ì„œ Public Gitì„œë¹„ìŠ¤ì™€ í†µí•©ì€ í•„ìˆ˜ì ì¸ ìš”ì†Œì´ë‹¤. </p><p><a href="https://github.com/marketplace" target="_blank" rel="noopener noreferrer">GitHub MarketPlace</a>ì—ì„œ <code>CI</code> ë¼ê³  ê²€ìƒ‰í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ê²°ê³¼ë¥¼ ì–»ì„ìˆ˜ ìˆë‹¤.  </p><p><img loading="lazy" alt="github-ci" src="/assets/images/github-ci-a6a8bfaf143484e079fd19a79207b6c2.png" width="2020" height="1370" class="img_E7b_"></p><p>CircleCI, Travis CI, Google Cloud Build ë“± ìµœê·¼ íŠ¸ë Œë“œí•œ ë„êµ¬ë“¤ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  </p><p>ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” <code>CircleCI</code>ë¥¼ <code>GitHub</code>ê³¼ ì—°ë™í•´ì„œ AWS ECR Push ë° EKSë¡œ ë°°í¬í•˜ëŠ” ê°„ë‹¨í•œ Pipelineì„ êµ¬ì„±í•˜ëŠ” ë°©ë²•ì„ ì ì–´ë³´ê³ ì í•œë‹¤.  </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="circleci---github-accout-ì—°ë™">CircleCI - GitHub Accout ì—°ë™<a class="hash-link" href="#circleci---github-accout-ì—°ë™" title="Direct link to heading">â€‹</a></h2><p><a href="https://circleci.com" target="_blank" rel="noopener noreferrer">circleci.com</a>ì— ì ‘ì†í•˜ì—¬ Sign Upì„ ì§„í–‰í•˜ë©´ GitHubê³¼ BitBucket ê³„ì •ì„ ì—°ë™í•  ìˆ˜ ìˆëŠ”ë° ì¼ë°˜ì ì¸ GitHub 3rd Party OAuthì—°ë™ ì§„í–‰ì„ í•˜ê²Œëœë‹¤.  </p><p><img loading="lazy" alt="init" src="/assets/images/circleci-init-b44a7c81c0dbf4cf4ff0a4b775427186.png" width="2482" height="1928" class="img_E7b_"></p><p>ìœ„ ê·¸ë¦¼ì²˜ëŸ¼ ëª¨ë“  Repositoryê°€ í™•ì¸ë˜ê³  Followí•  Repositoryë¥¼ ì„ íƒí•˜ë©´ ì´ˆê¸° êµ¬ì„±ì´ ì™„ë£Œëœë‹¤.  </p><p><img loading="lazy" alt="error" src="/assets/images/init-error-dde1c8ca577589b364d02c1f94c47230.png" width="2476" height="2024" class="img_E7b_"></p><p>ì²« ì—°ë™ì´ ë˜ë©´ Buildë¥¼ ì§„í–‰í•˜ê²Œ ë˜ëŠ”ë° ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ errorë¥¼ ë³´ê²Œ ë˜ëŠ”ë° ì´ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ circleciê°€ í•„ìš”ë¡œ í•˜ëŠ” ê¸°ë³¸ ì„¤ì •ê°’(.circleci/config.yaml)ì´ ì—†ì–´ì„œ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜ì´ë‹¤.  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/sh -eo pipefail</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># No configuration was found in your project. Please refer to https://circleci.com/docs/2.0/ to get started with your configuration.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># -------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Warning: This configuration was auto-generated to show you the message above.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Don't rerun this job. Rerunning will have no effect.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">false</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ì—ì„œ ë³´ì´ëŠ”ê²ƒ ì²˜ëŸ¼ configë¥¼ ì²´í¬í•˜ëŠ”ê²ƒë„ í•˜ë‚˜ì˜ ê°€ìƒë¨¸ì‹ (ì»¨í…Œì´ë„ˆ)ì´ ì§„í–‰í•˜ëŠ”ë° CircleCIì½˜ì†”ì—ì„œ <code>Spin up Environment</code> ë¡œê·¸ë¥¼ ë³´ë©´ Docker(18.09.6)ë¡œ aws Linuxê¸°ë°˜ìœ¼ë¡œ í™˜ê²½êµ¬ì„±ì„ í•˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Build-agent version 1.0.11727-b0960fc9 (2019-05-23T02:12:54+0000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Docker Engine Version: 18.09.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Kernel Version: Linux 9a20a41aeae4 4.15.0-1035-aws #37-Ubuntu SMP Mon Mar 18 16:15:14 UTC 2019 x86_64 Linux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting container bash:4.4.19</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  using image bash@sha256:9f0a4aa3c9931bd5fdda51b1b2b74a0398a8eabeaf9519d807e010b9d9d41993</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="circleci-grossary">CircleCI Grossary<a class="hash-link" href="#circleci-grossary" title="Direct link to heading">â€‹</a></h2><p>ì•„ë˜ ë§í¬ëŠ” CircleCIì—ì„œ ìì£¼ ì‚¬ìš©í•˜ëŠ” ìš©ì–´ë“¤ì„ ë”°ë¡œ ì •ë¦¬í•œ í˜ì´ì§€ì´ë‹¤.  ì£¼ë¡œ ì»¨í…Œì´ë„ˆ ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•˜ê¸° ë•Œë¬¸ì— ìš©ì–´ë“¤ì€ Dockerì—ì„œ ì‚¬ìš©í•˜ëŠ” ìš©ì–´ê³¼ ê²¹ì¹˜ëŠ” ë¶€ë¶„ì´ ë§ë‹¤.   </p><p><a href="https://circleci.com/docs/2.0/glossary/" target="_blank" rel="noopener noreferrer">https://circleci.com/docs/2.0/glossary/</a></p><p>ìœ„ ë§í¬ ë‚´ìš©ì„ í™•ì¸í•˜ë©´ <code>Orbs</code>ë¼ëŠ” ìš©ì–´ê°€ ë‚˜ì˜¤ëŠ”ë° ì´ëŠ” ê³µìœ ê°€ëŠ¥í•œ íŒ¨í‚¤ì§€ë¡œ Jenkinsì˜ Pluginê³¼ ìœ ì‚¬í•œ ê°œë…ì´ë¼ê³  ë³´ë©´ ëœë‹¤. CircleCIì—ì„œ ì œê³µí•˜ëŠ” ìì²´ íŒ¨í‚¤ì§€ ë¿ë§Œ ì•„ë‹ˆë¼ 3rd Party orbsë¥¼ ì œê³µí•˜ê³  ìˆë‹¤. </p><p>MacOSì—ì„œëŠ” brewë¥¼ í†µí•´ clië¥¼ ì„¤ì¹˜í•˜ê³  orb ë¦¬ìŠ¤íŠ¸ë¥¼ í™•ì¸í•˜ê±°ë‚˜ <a href="https://circleci.com/orbs/registry/" target="_blank" rel="noopener noreferrer">https://circleci.com/orbs/registry/</a>ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ brew install circleci</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ circleci orb list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Orbs found: 43. Showing only certified orbs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Add --uncertified for a list of all orbs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">circleci/android (0.1.0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">circleci/artifactory (1.0.0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">circleci/aws-cli (0.1.13)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">circleci/aws-code-deploy (0.0.9)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">circleci/aws-ecr (6.1.0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">circleci/aws-ecs (0.0.8)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">circleci/aws-eks (0.1.0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">circleci/aws-s3 (1.0.11)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">circleci/jira (1.0.5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">circleci/jq (1.9.0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">circleci/kubernetes (0.3.0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">circleci/lein-nvd (0.0.2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">circleci/maven (0.0.8)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">circleci/node (1.0.1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">circleci/slack (3.2.0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">circleci/twilio (0.0.1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">circleci/welcome-orb (0.3.1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In order to see more details about each orb, type: `circleci orb info orb-namespace/orb-name`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Search, filter, and view sources for all Orbs online at https://circleci.com/orbs/registry/</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="circle-architecture">Circle Architecture<a class="hash-link" href="#circle-architecture" title="Direct link to heading">â€‹</a></h2><p><img loading="lazy" src="https://circleci.com/docs/assets/img/docs/arch.png" alt="circle-arch" class="img_E7b_"></p><p>GitHub ë˜ëŠ” Bitbucketì—ì„œ ê´€ë¦¬í•˜ëŠ” Repositoryê°€ CircleCI í”„ë¡œì íŠ¸ë¡œ ìŠ¹ì¸ë˜ë©´ ìµœì´ˆì—ëŠ” ì»¨í…Œì´ë„ˆë‚˜ ê°€ìƒë¨¸ì‹ í™˜ê²½(2core 4GB)ì´ í”„ë¡œë¹„ì €ë‹ ë˜ê³  ìë™ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ê°€ ì§„í–‰ëœë‹¤.  </p><p>í…ŒìŠ¤íŠ¸ê°€ ì™„ë£Œëœ í›„ ì„±ê³µ ë˜ëŠ” ì‹¤íŒ¨ì— ëŒ€í•œ Alertì„¤ì •(Email, Slack)ì´ ê°€ëŠ¥í•˜ê³  ê° ë‹¨ê³„(job, workflow)ì— ëŒ€í•œ ê²°ê³¼ëŠ” ê° ë‹¨ê³„ë³„ ì„¸ë¶€ ì •ë³´ í˜ì´ì§€ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  </p><p>ë˜í•œ ë°°í¬ëŠ” AWS CodeDeploy, AWS ECS, AWS S3, AWS EKS, Google Kubernetes Engine (GKE) ë° Heroku ë“± ë‹¤ì–‘í•œ í™˜ê²½ì— ì½”ë“œë¥¼ ë°°í¬í•˜ë„ë¡ êµ¬ì„± í•  ìˆ˜ ìˆë‹¤. ì´ì™¸ì˜ í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ ë°°í¬ëŠ” SSHë¥¼ í†µí•´ ì§ì ‘ ì‚¬ìš©í•˜ê±°ë‚˜ terraformê³¼ ê°™ì€ ë„êµ¬ë¥¼ ê°€ì§€ê³  í•´ë‹¹ í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ì˜ APIí†µí•´ ìë™í™”ê°€ ê°€ëŠ¥í•œ êµ¬ì¡°ë¡œ ë˜ì–´ìˆë‹¤.  </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="circelci-aws-eks">CircelCI AWS EKS<a class="hash-link" href="#circelci-aws-eks" title="Direct link to heading">â€‹</a></h2><p><a href="https://github.com/CircleCI-Public/circleci-demo-aws-eks" target="_blank" rel="noopener noreferrer">https://github.com/CircleCI-Public/circleci-demo-aws-eks</a></p><p>ìœ„ demoëŠ” CircleCIë¥¼ ì´ìš©í•˜ì—¬ ë‹¤ìŒê³¼ ê°™ì€ workflow (ìƒì„¸ë‚´ìš© ì•„ë˜ config.yaml ì°¸ê³ )ë¥¼ ìˆ˜í–‰í•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">orbs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">aws-eks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> circleci/aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">eks@0.1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">aws-ecr</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> circleci/aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">ecr@3.1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">kubernetes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> circleci/kubernetes@0.3.0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê³µí†µì ìœ¼ë¡œ orbë¥¼ 3ê°€ì§€ë¥¼ ì¶”ê°€í•˜ì˜€ê¸° ë•Œë¬¸ì— ê°ë‹¨ê³„ë§ˆë‹¤ ê´€ë ¨ orbë¥¼ ì¶”ê°€í•˜ëŠ” ë‹¨ê³„ë¥¼ ê±°ì¹˜ê²Œ ëœë‹¤.</p><ol><li>í™˜ê²½ì„¤ì • ë° Docker Build ë° ECRë¡œ Push<div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">workflows</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">aws-ecr/build_and_push_image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> build</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">and</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">push</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">account-url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> AWS_ECR_URL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">region</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> AWS_DEFAULT_REGION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">repo</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eks_orb_demo_app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">dockerfile</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ~/project/demo_app/Dockerfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ~/project/demo_app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">tag</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">CIRCLE_SHA1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic"># repositoryê°€ ì—†ì„ ê²½ìš° ìƒì„±í•˜ëŠ” ì˜µì…˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic"># create-repo: true</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li></ol><ul><li>environment variables ì„¤ì • <ul><li>Project - BUILD SETTINGS - Environment Variables ì—ì„œ Key-Valueí˜•íƒœë¡œ ì…ë ¥  <ul><li>AWS_DEFAULT_REGION : <code>us-west-2</code></li><li>AWS_ECR_URL : <code>219547004475.dkr.ecr.us-west-2.amazonaws.com/eks_orb_demo_app</code>  </li></ul></li></ul></li><li>github ì—°ë™ (ssh-key ì—°ë™ ë° repo clone)</li><li>aws cli ì„¤ì¹˜ ë° AWS Access, Secret Keyì„¤ì •</li><li>ECR Login</li><li>Image Build (<a href="https://github.com/ddiiwoong/circleci-demo-aws-eks/blob/master/demo_app/Dockerfile" target="_blank" rel="noopener noreferrer">https://github.com/ddiiwoong/circleci-demo-aws-eks/blob/master/demo_app/Dockerfile</a>)</li><li>Push Image to ECR</li></ul><ol><li>EKSí´ëŸ¬ìŠ¤í„° ìƒì„± (No Scripts)<div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">workflows</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">aws-eks/create-cluster</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">cluster-name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eks</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">orb</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">aws-region</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $AWS_DEFAULT_REGION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">requires</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> build</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">and</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">push</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">image</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li></ol><ul><li>kops, kubectl, aws iam authenticator, aws cli ì„¤ì¹˜</li><li>kubectl config ì„¤ì • (aws iam authenticator)</li><li>eksctl ì„¤ì¹˜</li><li>eksctlë¡œ í´ëŸ¬ìŠ¤í„° ìƒì„± ë° ê²€ì¦ (Cloudformation)<ul><li>variables ì‚¬ì „ ì„¤ì •ê°€ëŠ¥ ($AWS_DEFAULT_REGION)</li></ul></li></ul><ol start="2"><li>Demo Application ë°°í¬<div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">deploy-application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">executor</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">eks/python3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">parameters</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> checkout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Create deployment manifest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            BUILD_DATE=$(date '+%Y%m%d%H%M%S')</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            cat deployment/demo-app-deployment.yaml.template |\</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">              sed "s|DOCKER_IMAGE_NAME|&lt;&lt; parameters.docker-image-name &gt;&gt;|\</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                g;s|BUILD_DATE_VALUE|$BUILD_DATE|g;s|VERSION_INFO_VALUE|\</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                &lt;&lt; parameters.version-info &gt;&gt;|g" &gt; deployment/demo-app-deployment.yaml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">aws-eks/update-kubeconfig-with-authenticator</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">cluster-name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> &lt;&lt; parameters.cluster</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">name </span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">install-kubectl</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">aws-region</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> &lt;&lt; parameters.aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">region </span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">kubernetes/create-or-update-resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource-file-path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"deployment/demo-app-deployment.yaml"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">get-rollout-status</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource-name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> deployment/demoapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">kubernetes/create-or-update-resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource-file-path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"deployment/demo-app-service.yaml"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">workflows</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">deploy-application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">cluster-name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eks</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">orb</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">aws-region</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $AWS_DEFAULT_REGION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">docker-image-name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"${AWS_ECR_URL}/eks_orb_demo_app:${CIRCLE_SHA1}"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">version-info</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"${CIRCLE_SHA1}"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">requires</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">eks/create</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li></ol><ul><li>deployment manifestìƒì„± (deployment template)</li><li>kops, kubectl, aws iam authenticator, aws cli ì„¤ì¹˜ (orbì„¤ì •: aws-eks,kubernetes)</li><li>kubectl config ì„¤ì • (aws iam authenticator)</li><li>resource(deployment, service) ë°°í¬ (orbì„¤ì •: aws-eks,kubernetes)</li><li>rollout ìˆ˜í–‰ (0-&gt;3)</li></ul><ol start="3"><li>application test<div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">workflows</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">test-application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> test</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">application</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">cluster-name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eks</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">orb</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">aws-region</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $AWS_DEFAULT_REGION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">expected-version-info</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"${CIRCLE_SHA1}"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">requires</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">application</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">test-application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">executor</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">eks/python3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">parameters</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">aws-eks/update-kubeconfig-with-authenticator</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">cluster-name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> &lt;&lt; parameters.cluster</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">name </span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">install-kubectl</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">aws-region</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> &lt;&lt; parameters.aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">region </span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Wait for service to be ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            kubectl get pods</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            kubectl get services</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            sleep 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            for attempt in {1..20}; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">              EXTERNAL_IP=$(kubectl get service demoapp | awk '{print $4}' | tail -n1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">              echo "Checking external IP: ${EXTERNAL_IP}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">              if [ -n "${EXTERNAL_IP}" ] &amp;&amp; [ -z $(echo "${EXTERNAL_IP}" | grep "pending") ]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">                break</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">              fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">              echo "Waiting for external IP to be ready: ${EXTERNAL_IP}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">              sleep 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            done</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            sleep 180</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            curl -s --retry 10 "http://$EXTERNAL_IP" | grep "&lt;&lt; parameters.expected-version-info &gt;&gt;"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li></ol><ul><li>kops, kubectl, aws iam authenticator, aws cli ì„¤ì¹˜ (orbì„¤ì •: aws-eks,kubernetes)</li><li>kubectl config ì„¤ì • (aws iam authenticator)</li><li>External IP ì²´í¬ ë° curl í…ŒìŠ¤íŠ¸</li></ul><ol start="4"><li>Demo Application ì‚­ì œ<div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">undeploy-application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">executor</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">eks/python3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">parameters</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">aws-eks/update-kubeconfig-with-authenticator</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">cluster-name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> &lt;&lt; parameters.cluster</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">name </span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">install-kubectl</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">aws-region</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> &lt;&lt; parameters.aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">region </span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">kubernetes/delete-resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource-types</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"deployment,service"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">label-selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"app=demo"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">wait</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Check on pod status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            kubectl get pods</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">workflows</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">undeploy-application</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">cluster-name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eks</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">orb</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">aws-region</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $AWS_DEFAULT_REGION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">requires</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> test</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">application</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li></ol><ul><li>kops, kubectl, aws iam authenticator, aws cli ì„¤ì¹˜ (orbì„¤ì •: aws-eks,kubernetes)</li><li>kubectl config ì„¤ì • (aws iam authenticator)</li><li>deployment ì‚­ì œ ë° ìƒíƒœ ì²´í¬</li></ul><ol start="5"><li>EKSí´ëŸ¬ìŠ¤í„° ì‚­ì œ (No Scripts)<div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">workflows</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">deployment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">aws-eks/delete-cluster</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">cluster-name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eks</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">orb</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">aws-region</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $AWS_DEFAULT_REGION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">wait</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">requires</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> undeploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">application</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li></ol><ul><li>kops, kubectl, aws iam authenticator, aws cli ì„¤ì¹˜ (orbì„¤ì •: aws-eks,kubernetes)</li><li>kubectl config ì„¤ì • (aws iam authenticator)</li><li>eksctl ì„¤ì¹˜</li><li>eksctlë¡œ í´ëŸ¬ìŠ¤í„° ì‚­ì œ ë° ê²€ì¦ (Cloudformation)</li></ul><p>ìƒì„¸ configëŠ” ë‹¤ìŒ ë§í¬ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br>
<a href="https://github.com/ddiiwoong/circleci-demo-aws-eks/blob/master/.circleci/config.yml" target="_blank" rel="noopener noreferrer">https://github.com/ddiiwoong/circleci-demo-aws-eks/blob/master/.circleci/config.yml</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="pipeline-ìˆ˜í–‰">pipeline ìˆ˜í–‰<a class="hash-link" href="#pipeline-ìˆ˜í–‰" title="Direct link to heading">â€‹</a></h2><p>ìœ„ Workflowë¥¼ ìˆ˜í–‰í•˜ê²Œ ë˜ë©´ ë§ˆì§€ë§‰ì— ì–´í”Œë¦¬ì¼€ì´ì…˜ê³¼ í´ëŸ¬ìŠ¤í„°ë¥¼ ì‚­ì œí•˜ê¸° ë•Œë¬¸ì— í•´ë‹¹ workflowëŠ” ì œì™¸í•˜ê³  ìˆ˜í–‰í•œë‹¤. í•´ë‹¹ configë¥¼ commití•˜ë©´ ë°”ë¡œ í•´ë‹¹ CIê°€ íŠ¸ë¦¬ê±° ë˜ì–´ ì‹œì‘ë˜ê²Œ ëœë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># - undeploy-application:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">#     cluster-name: eks-orb-demo-app-deployment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">#     aws-region: $AWS_DEFAULT_REGION</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">#     requires:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">#       - test-application</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># - aws-eks/delete-cluster:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">#     cluster-name: eks-orb-demo-app-deployment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">#     aws-region: $AWS_DEFAULT_REGION</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">#     wait: true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">#     requires:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">#     - undeploy-application</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><img loading="lazy" alt="result" src="/assets/images/workflow-result-1507577220f3902e6add662d37db5fcf.png" width="1218" height="473" class="img_E7b_"></p><p>í´ëŸ¬ìŠ¤í„° êµ¬ì„±í¬í•¨í•´ì„œ ì´ 20ë¶„ì •ë„ ì†Œìš”ë˜ì—ˆë‹¤. ì‹¤ì œ <code>eksctl</code>ë¡œ í”„ë¡œë¹„ì €ë‹í•˜ê²Œ ë˜ë©´ CloudFormationìœ¼ë¡œ ìˆ˜í–‰ë˜ê¸° ë•Œë¬¸ì— ì•½ 15-20ë¶„ ì •ë„ ì†Œìš”ë˜ë‹ˆ ê°„ë‹¨í•œ ë¹Œë“œ,ë°°í¬,í…ŒìŠ¤íŠ¸ëŠ” 5ë¶„ì •ë„ ì†Œìš”ëœê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.  </p><p>ì‚­ì œëŠ” ì—­ìˆœìœ¼ë¡œ ì§„í–‰í•˜ê±°ë‚˜ ìœ„ì— ì£¼ì„ ì²˜ë¦¬ëœ ì˜ì—­ë§Œ ìˆ˜í–‰í•˜ë©´ ëœë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ê°„ë‹¨í•˜ê²Œ CircleCIë¥¼ ê°€ì§€ê³  GitOpsì™€ CI/CDë¥¼ êµ¬ì„±í•˜ëŠ” ë°ëª¨ë¥¼ ì§„í–‰í•˜ì˜€ë‹¤.  </p><p>CircleCIëŠ” Jenkinsì™€ ìœ ì‚¬í•˜ì§€ë§Œ Publicì„œë¹„ìŠ¤ì´ê³  Slaveê´€ë¦¬ì— ëŒ€í•´ì„œ ì˜ì¡´ì ì´ì§€ ì•Šê¸° ë•Œë¬¸ì— ê¸°ì¡´ì— Jenkinsë¥¼ ì‚¬ìš©í•œ ê²½í—˜ì´ ìˆë‹¤ë©´ ì•„ì£¼ ì‰½ê²Œ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤.  </p><p><a href="https://circleci.com/docs/2.0/migrating-from-jenkins" target="_blank" rel="noopener noreferrer">https://circleci.com/docs/2.0/migrating-from-jenkins</a>ë¥¼ ì°¸ê³ í•˜ë©´ Jenkinsì™€ ì°¨ì´ì ì„ ì•Œ ìˆ˜ ìˆëŠ”ë° ê°€ì¥ í° ì¥ì ì€ ë³‘ë ¬ë¡œ í…ŒìŠ¤íŠ¸ë‚˜ Jobì„ ìˆ˜í–‰í• ìˆ˜ ìˆë‹¤ëŠ” ì ê³¼ Lambdaì™€ ê°™ì€ ì„œë²„ë¦¬ìŠ¤ ì•±ì„ ë°°í¬í• ë•Œ ì •ë§ ì„œë²„ë¦¬ìŠ¤ í™˜ê²½ìœ¼ë¡œ êµ¬ì„±í• ìˆ˜ ìˆë‹¤ëŠ” ì ì´ë‹¤.  </p><p>ì´ëŠ” Git Repositoryë¥¼ ì—°ë™í• ë•Œë„ Java Pluginì„ ì„¤ì¹˜í•´ì•¼í•˜ëŠ” ë²ˆê±°ë¡œì›€ì„ ëœ ìˆ˜ ìˆë‹¤. ê°€ì¥ ì¤‘ìš”í•œê±´ SaaSë¼ëŠ” ì¥ì ë„ ë¬´ì‹œí• ìˆ˜ ì—†ë‹¤. Travis ë¬´ë£Œ í”Œëœê³¼ ë¹„êµí•´ë„ ì‘ì€ í”„ë¡œì íŠ¸ì˜ ê²½ìš° ë³„ë„ì˜ Docker environment(2core, 4GB)ë¥¼ ì œê³µë°›ê¸° ë•Œë¬¸ì— ì§€ì—°ì—†ì´ ë°”ë¡œ ë¹Œë“œê°€ ê°€ëŠ¥í•˜ë‹¤ëŠ” ì ì´ë‹¤.  </p><p>ë‹¤ìŒë²ˆ í¬ìŠ¤íŒ…ì—ëŠ” terraformì„ í†µí•´ ECRê³¼ ECSë¡œ ë°°í¬í•˜ëŠ” workflowë¥¼ ì‚´í´ë³´ë ¤ê³  í•œë‹¤.</p>]]></content>
        <category label="DevOps" term="DevOps"/>
        <category label="CI/CD" term="CI/CD"/>
        <category label="Pipeline" term="Pipeline"/>
        <category label="CircleCI" term="CircleCI"/>
        <category label="GitHub" term="GitHub"/>
        <category label="GitOps" term="GitOps"/>
        <category label="EKS" term="EKS"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Yaml ì‘ì„± ê¸°ë³¸ Tip]]></title>
        <id>kubernetes/CKAD-1/</id>
        <link href="https://ddii.dev/kubernetes/CKAD-1/"/>
        <updated>2019-06-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[CKADê²€ì •ì‹œ YAML ì‘ì„± tip]]></summary>
        <content type="html"><![CDATA[<p>ìµœê·¼ í¬ìŠ¤íŒ…ì„ í•  ì—¬ìœ ê°€ ë˜ì§€ ì•Šì•„ ì¼ë‹¨ í‹ˆí‹ˆíˆ ì¤€ë¹„ì¤‘ì¸ CKAD ì¤€ë¹„í•˜ëŠ” íŒì´ë‚˜ ì •ë³´ë“±ì„ ë¨¼ì € ì •ë¦¬í•˜ê³ ì í•œë‹¤.<br>
<!-- -->ê·¸ì¤‘ ê¸°ë³¸ì´ ë˜ëŠ” YAMLì„ ìµœì´ˆ ì‘ì„±í• ë•Œ íŒì„ ì •ë¦¬í•´ë´¤ë‹¤.  </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="manifest-yamlì‘ì„±-tip">Manifest YAMLì‘ì„± Tip<a class="hash-link" href="#manifest-yamlì‘ì„±-tip" title="Direct link to heading">â€‹</a></h2><p>CLIì•ˆì—ì„œ Manifest YAMLíŒŒì¼ì„ ì‘ì„±í•˜ëŠ”ê²ƒì€ ì‰½ì§€ ì•Šë‹¤. íŠ¹íˆ ì‹œí—˜ì¤‘ì— Copy/Pasteë¥¼ í•˜ëŠ”ê²ƒì€ ì–´ë µê³  ëŠë¦¬ê²Œ ì§„í–‰ë ìˆ˜ ìˆìœ¼ë¯€ë¡œ CLIì•ˆì—ì„œ í•´ê²°í•˜ëŠ”ê²ƒì´ ì¢‹ë‹¤.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kubectl-run-í™œìš©">kubectl run í™œìš©<a class="hash-link" href="#kubectl-run-í™œìš©" title="Direct link to heading">â€‹</a></h3><p><a href="https://kubernetes.io/docs/reference/kubectl/conventions/#generators" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/reference/kubectl/conventions/</a></p><p>ìœ„ ë§í¬ë¥¼ ì˜ ê¸°ì–µí•´ë†“ê³  ì‹¤ì œ ì‹œí—˜ì„ ë³¼ë•Œ templateì‘ì„±ì„ ìœ„í•´ ì•„ë˜ì™€ ê°™ì´ Manifestë¥¼ í•´ë³´ëŠ”ê²ƒì´ ê°€ì¥ ì¢‹ë‹¤.</p><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="pod-manifest-yaml">Pod Manifest YAML<a class="hash-link" href="#pod-manifest-yaml" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl run --generator=run-pod/v1 nginx --image=nginx --dry-run -o yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="deployment-yaml">Deployment YAML<a class="hash-link" href="#deployment-yaml" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl run --generator=deployment/v1beta1 nginx --image=nginx --dry-run --replicas=4 -o yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="yamlë¡œ-ì €ì¥">YAMLë¡œ ì €ì¥<a class="hash-link" href="#yamlë¡œ-ì €ì¥" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl run --generator=deployment/v1beta1 nginx --image=nginx --dry-run --replicas=4 -o yaml &gt; nginx-deployment.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div>]]></content>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="CKAD" term="CKAD"/>
        <category label="Exam" term="Exam"/>
        <category label="Tip" term="Tip"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Knative on EKS]]></title>
        <id>kubernetes/knative-on-aws/</id>
        <link href="https://ddii.dev/kubernetes/knative-on-aws/"/>
        <updated>2019-05-14T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[EKSì—ì„œë„ Knativeë¥¼ êµ¬ì„±í•´ë³´ì]]></summary>
        <content type="html"><![CDATA[<p>ì´ë²ˆì—ëŠ” Knativeë¥¼ EKSì— êµ¬ì„±í•´ë³´ë ¤ê³  í•œë‹¤. 4ì›”ì€ ë°œí‘œ ë° ì—¬ëŸ¬ê°€ì§€ ì—…ë¬´ë¡œ ì¸í•´ì„œ í¬ìŠ¤íŒ…ì„ í•  ì‹œê°„ì´ ë¶€ì¡±í–ˆì§€ë§Œ 5ì›”ë¶€í„° ì¡°ê¸ˆì”© ì—¬ìœ ê°€ ìƒê²¨ì„œ ë” ë°”ë¹ ì§€ê¸°ì „ì— ì¢€ ì¨ë³´ë ¤ê³  í•œë‹¤. ì‚¬ì‹¤ <a href="https://www.facebook.com/yongho1037" target="_blank" rel="noopener noreferrer">Facebook @ìµœìš©í˜¸</a>ë‹˜ê»˜ì„œ í•œë²ˆ í•´ë³´ëŠ”ê²ƒë„ ì¢‹ê² ë‹¤ê³  í•˜ì…”ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ì˜€ë‹¤.  </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="knative-on-eks">Knative on EKS<a class="hash-link" href="#knative-on-eks" title="Direct link to heading">â€‹</a></h2><p>ì œëª©ë§Œ ë³´ë©´ Lambdaë‚˜ ECS, Batch ì„œë¹„ìŠ¤ê°€ ìˆëŠ”ë° ì™œ ì´ê±¸ ì¨ì•¼í•˜ì§€? ë¼ëŠ” ìƒê°ë¶€í„° í•˜ëŠ” ì‚¬ëŒë„ ìˆì„ê²ƒ ê°™ë‹¤. í•˜ì§€ë§Œ ì´ì „ í¬ìŠ¤íŒ…ë“¤ê³¼ ë°œí‘œì—ì„œë„ ì—¬ëŸ¬ë²ˆ ì´ì•¼ê¸° í•œê²ƒì²˜ëŸ¼ KnativeëŠ” ê°„ë‹¨í•˜ê²Œ ì„œë²„ë¦¬ìŠ¤ ì›Œí¬ë¡œë“œë¥¼ ë¹Œë“œ, ë°°í¬, ê´€ë¦¬í•˜ê¸° ìœ„í•œ Kubernetesê¸°ë°˜ FaaSí”Œë«í¼ì´ê³  í˜„ì¬ <a href="https://landscape.cncf.io/" target="_blank" rel="noopener noreferrer">CNCF Landscape</a>ì—ì„œ ê°€ì¥ ë¹ ë¥¸ ì†ë„ë¡œ ê°œë°œë˜ê³  ìˆëŠ” ì˜¤í”ˆì†ŒìŠ¤ í”„ë¡œì íŠ¸ ì¤‘ í•˜ë‚˜ì´ë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="eks-ë°°í¬">EKS ë°°í¬<a class="hash-link" href="#eks-ë°°í¬" title="Direct link to heading">â€‹</a></h2><p>ì•ì„  <a href="https://ddii.dev/kubernetes/eksworkshop/" target="_blank" rel="noopener noreferrer">eksworkshop í¬ìŠ¤íŒ…</a>ì—ì„œì²˜ëŸ¼ ê°„ë‹¨í•œ ë°°í¬ë¥¼ ìœ„í•´ <code>eksctl</code>ë¡œ 2-node í´ëŸ¬ìŠ¤í„°ë¥¼ ë°°í¬í•œë‹¤.<br>
<!-- -->ì‚¬ì „ ì¤€ë¹„ì‚¬í•­ì€ <a href="https://ddii.dev/kubernetes/eksworkshop/" target="_blank" rel="noopener noreferrer">ì´ì „ í¬ìŠ¤íŒ…</a>ì´ë‚˜ <a href="https://eksctl.io/" target="_blank" rel="noopener noreferrer">https://eksctl.io/</a>ì„ ì°¸ê³ í•˜ì.  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ eksctl create cluster --name=eksworkshop-eksctl --nodes=2 --node-ami=auto</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìƒì„±ëœ í´ëŸ¬ìŠ¤í„° ìƒíƒœë¥¼ í™•ì¸í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get nodes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                                STATUS    ROLES     AGE       VERSION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ip-192-168-24-168.ap-northeast-2.compute.internal   Ready     &lt;none&gt;    2m        v1.11.9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ip-192-168-78-204.ap-northeast-2.compute.internal   Ready     &lt;none&gt;    2m        v1.11.9</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="istio-ì„¤ì¹˜">istio ì„¤ì¹˜<a class="hash-link" href="#istio-ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h2><p>KnativeëŠ” istio ì˜ì¡´ì„±ì„ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— Istioë¥¼ ë¨¼ì € ë°°í¬í•œë‹¤. ë¬¼ë¡  <a href="https://ddii.dev/kubernetes/knative-using-gloo/" target="_blank" rel="noopener noreferrer">ì´ì „ í¬ìŠ¤íŒ…</a>ì—ì„œ ì„¤ëª…í•œê²ƒ ì²˜ëŸ¼ Glooë¥¼ ì‚¬ìš©í•´ë„ ë˜ì§€ë§Œ ì´ë²ˆì—ëŠ” Istioë¥¼ ì„¤ì¹˜í•˜ì˜€ë‹¤.  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl apply -f https://github.com/knative/serving/releases/download/v0.5.0/istio-crds.yaml </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl apply -f https://github.com/knative/serving/releases/download/v0.5.0/istio.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë°°í¬ëœ Pods, Services, Replicasets ì„ í™•ì¸í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pods -n istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                     READY     STATUS      RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cluster-local-gateway-65c8b667c8-269cf   1/1       Running     0          17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-citadel-76bd44d8f7-5cltj           1/1       Running     0          17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-cleanup-secrets-7jpth              0/1       Completed   0          17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-egressgateway-b9d56b4f8-pdjhs      1/1       Running     0          17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-galley-7db7db89db-5stkp            1/1       Running     0          17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-ingressgateway-f77fbc787-npw9d     1/1       Running     0          17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-pilot-69f975bf4f-4dq4d             2/2       Running     0          17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-pilot-69f975bf4f-q9g8g             2/2       Running     0          16m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-pilot-69f975bf4f-tnm92             2/2       Running     0          16m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-policy-8db48cbcd-dl2th             2/2       Running     0          17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-security-post-install-xv8z6        0/1       Completed   0          17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-sidecar-injector-cd54ffccd-kj2n6   1/1       Running     0          17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-telemetry-d78cd45db-8x2cw          2/2       Running     0          17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get svc -n istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                     TYPE           CLUSTER-IP       EXTERNAL-IP                                                                   PORT(S)                                                                                                                   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cluster-local-gateway    ClusterIP      10.100.97.146    &lt;none&gt;                                                                        80/TCP,443/TCP,31400/TCP,15011/TCP,8060/TCP,15030/TCP,15031/TCP                                                           17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-citadel            ClusterIP      10.100.147.235   &lt;none&gt;                                                                        8060/TCP,9093/TCP                                                                                                         17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-egressgateway      ClusterIP      10.100.25.44     &lt;none&gt;                                                                        80/TCP,443/TCP                                                                                                            17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-galley             ClusterIP      10.100.158.45    &lt;none&gt;                                                                        443/TCP,9093/TCP                                                                                                          17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-ingressgateway     LoadBalancer   10.100.62.157    a4e1d5201758f11e9b7f402c4d4b0376-510368564.ap-northeast-2.elb.amazonaws.com   80:31000/TCP,443:30753/TCP,31400:31922/TCP,15011:31331/TCP,8060:30389/TCP,853:30257/TCP,15030:30827/TCP,15031:30153/TCP   17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-pilot              ClusterIP      10.100.25.194    &lt;none&gt;                                                                        15010/TCP,15011/TCP,8080/TCP,9093/TCP                                                                                     17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-policy             ClusterIP      10.100.73.149    &lt;none&gt;                                                                        9091/TCP,15004/TCP,9093/TCP                                                                                               17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-sidecar-injector   ClusterIP      10.100.117.18    &lt;none&gt;                                                                        443/TCP                                                                                                                   17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-telemetry          ClusterIP      10.100.87.12     &lt;none&gt;                                                                        9091/TCP,15004/TCP,9093/TCP,42422/TCP                                                                                     17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get rs -n istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                               DESIRED   CURRENT   READY     AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cluster-local-gateway-65c8b667c8   1         1         1         17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-citadel-76bd44d8f7           1         1         1         17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-egressgateway-b9d56b4f8      1         1         1         17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-galley-7db7db89db            1         1         1         17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-ingressgateway-f77fbc787     1         1         1         17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-pilot-69f975bf4f             3         3         3         17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-policy-8db48cbcd             1         1         1         17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-sidecar-injector-cd54ffccd   1         1         1         17m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-telemetry-d78cd45db          1         1         1         17m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Istio injectionì„ í•˜ê¸° ìœ„í•´ ë°°í¬í•  defaults namespace ì „ì²´ì— Labelingì„ í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl label namespace default istio-injection=enabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namespace/default labeled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get namespaces --show-labels</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME           STATUS    AGE       LABELS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default        Active    43m       istio-injection=enabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-system   Active    27m       istio-injection=disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-public    Active    43m       &lt;none&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system    Active    43m       &lt;none&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="knative-ì„¤ì¹˜">Knative ì„¤ì¹˜<a class="hash-link" href="#knative-ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h2><p>build, evening, serving ë° ëª¨ë‹ˆí„°ë§ ë¦¬ì†ŒìŠ¤ë¥¼ ë°°í¬í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f https://github.com/knative/serving/releases/download/v0.5.0/serving.yaml \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   -f https://github.com/knative/build/releases/download/v0.5.0/build.yaml \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   -f https://github.com/knative/eventing/releases/download/v0.5.0/release.yaml \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   -f https://github.com/knative/eventing-sources/releases/download/v0.5.0/eventing-sources.yaml \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   -f https://github.com/knative/serving/releases/download/v0.5.0/monitoring.yaml \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   -f https://raw.githubusercontent.com/knative/serving/v0.5.0/third_party/config/build/clusterrole.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ëª¨ë“  Knative namespaces ë° resourcesë¥¼ í™•ì¸í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get namespaces | grep knative</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">knative-build        Active    8m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">knative-eventing     Active    8m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">knative-monitoring   Active    8m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">knative-serving      Active    8m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">knative-sources      Active    8m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pods -n knative-serving</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                          READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">activator-664b5b9598-dsjvq    2/2       Running   0          10m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">autoscaler-64d5bd84b8-bqghq   2/2       Running   0          10m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">controller-658b9d5c6c-tnwvz   1/1       Running   0          10m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">webhook-5dffbfbb8b-525vt      1/1       Running   0          10m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pods -n knative-build </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">build-controller-86f5b5b96d-zg8j2   1/1       Running   0          11m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">build-webhook-6fddd7c6df-68fkw      1/1       Running   0          11m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pods -n knative-eventing </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                            READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eventing-controller-6fdccd8c95-bckws            1/1       Running   0          11m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">in-memory-channel-controller-6fddb6655f-vbc64   1/1       Running   0          11m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">in-memory-channel-dispatcher-7684cd7c7d-ftqhc   2/2       Running   2          11m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">webhook-d496c66bd-688xz                         1/1       Running   0          11m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pods -n knative-monitoring </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                  READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">elasticsearch-logging-0               1/1       Running   0          14m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">elasticsearch-logging-1               1/1       Running   0          12m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grafana-754bc795bb-wxwml              1/1       Running   0          14m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kibana-logging-7f7b9698bc-rrnw6       1/1       Running   0          14m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-state-metrics-5bccdf746f-fhv7t   4/4       Running   0          12m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">node-exporter-w9jlq                   2/2       Running   0          14m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">node-exporter-wgv2j                   2/2       Running   0          14m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prometheus-system-0                   1/1       Running   0          14m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prometheus-system-1                   1/1       Running   0          14m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ëª¨ë‹ˆí„°ë§ ë¦¬ì†ŒìŠ¤ë„ í™•ì¸í•œë‹¤. ìœ„ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ë³´ë©´ Fluentdê°€ ë°°í¬ë˜ì§€ ì•Šì€ ìƒíƒœì´ë¯€ë¡œ DaemonSetìœ¼ë¡œ ë™ì‘í• ìˆ˜ ìˆë„ë¡ ì•„ë˜ì™€ ê°™ì´ ì„¤ì •í•˜ë©´ DaemonSetì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl label nodes --all beta.kubernetes.io/fluentd-ds-ready="true"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="buildì—ì„œ-ì‚¬ìš©í• -docker-credential-ì„¤ì •">Buildì—ì„œ ì‚¬ìš©í•  Docker Credential ì„¤ì •<a class="hash-link" href="#buildì—ì„œ-ì‚¬ìš©í• -docker-credential-ì„¤ì •" title="Direct link to heading">â€‹</a></h2><p>ì¼ë‹¨ Knative Buildë¥¼ ìˆ˜í–‰í• ë•Œ ì¼ë°˜ì ìœ¼ë¡œ Container Registryë¥¼ ë§ì´ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— Registry Credential ì„¤ì •ì„ í•´ì•¼í•œë‹¤.  </p><p>ECRì˜ ê²½ìš° <a href="https://github.com/knative/build-templates" target="_blank" rel="noopener noreferrer">https://github.com/knative/build-templates</a>ì˜ ecr_helperë¥¼ ì‚¬ìš©í•˜ë©´ ì‰½ê²Œ ECR accountë¥¼ ì„¤ì •í•  ìˆ˜ ìˆì§€ë§Œ <code>Serving</code>ë‹¨ê³„ì—ì„œ 401ì—ëŸ¬ê°€ ë‚˜ëŠ” ì´ìœ ë¥¼ ì¡ì§€ ëª»í•´ì„œ ì¼ë‹¨ Dockerhubë¥¼ ê°€ì§€ê³  ì§„í–‰í•˜ì˜€ë‹¤.</p><p>ê°„ë‹¨í•œ ë°ëª¨ì½”ë“œëŠ” ì•„ë˜ repositoryì— ë¯¸ë¦¬ ì‘ì„±í•´ë†¨ë‹¤.  </p><p><a href="https://github.com/ddiiwoong/hello-python.git" target="_blank" rel="noopener noreferrer">https://github.com/ddiiwoong/hello-python.git</a></p><p><code>docker-secret.yaml</code> ì„ ë³´ë©´ dockerhub pushë¥¼ ìœ„í•´ basic-authë¥¼ ìˆ˜í–‰í•˜ê²Œ ë˜ëŠ”ë° dockerhub id/password ë¥¼ base64ë¡œ encodingí•´ì„œ Secretìœ¼ë¡œ ì €ì¥í•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> basic</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">annotations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">build.knative.dev/docker-0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//index.docker.io/v1/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kubernetes.io/basic</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Use 'echo -n "username" | base64' to generate this string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">username</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> BASE64_ENCODED_USERNAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Use 'echo -n "password" | base64' to generate this string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">password</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> BASE64_ENCODED_PASSWORD</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê·¸ë¦¬ê³  ServiceAccount <code>build-bot</code>ì„ ìƒì„±í•˜ê¸° ìœ„í•œ yaml (sa.yaml)ë¥¼ ì‘ì„±í•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ServiceAccount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> build</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">bot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">secrets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> basic</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pass</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ì—ì„œ ì‘ì„±í•œ Secret(basic-user-pass)ê³¼ ServiceAccount(build-bot)ë¥¼ ë°°í¬í•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl apply -f docker-secret.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">secret "basic-user-pass" created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl apply -f sa.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">serviceaccount "build-bot" created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì €ì¥ëœ Secret(basic-user-pass)ê³¼ ServiceAccount(build-bot)ë¥¼ í™•ì¸í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                        TYPE                                  DATA      AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basic-user-pass             kubernetes.io/basic-auth              2         2h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">build-bot-token-gfkg9       kubernetes.io/service-account-token   3         2h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder-token-kp7ww         kubernetes.io/service-account-token   3         10h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default-token-9cpp5         kubernetes.io/service-account-token   3         10h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ecr-creds                   kubernetes.io/basic-auth              2         10h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio.build-bot             istio.io/key-and-cert                 3         2h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio.builder               istio.io/key-and-cert                 3         10h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio.default               istio.io/key-and-cert                 3         10h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio.knative-serve         istio.io/key-and-cert                 3         2h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">knative-serve-token-9j82l   kubernetes.io/service-account-token   3         2h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get sa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME            SECRETS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">build-bot       2         2h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder         2         10h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default         1         10h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">knative-serve   2         2h</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="python-ì½”ë“œ-ë°-dockerfile-ì‘ì„±">Python ì½”ë“œ ë° Dockerfile ì‘ì„±<a class="hash-link" href="#python-ì½”ë“œ-ë°-dockerfile-ì‘ì„±" title="Direct link to heading">â€‹</a></h2><p>TARGET í™˜ê²½ë³€ìˆ˜ë¥¼ ë°›ì•„ì„œ Hello Worldì™€ ê°™ì´ ì¶œë ¥í•˜ëŠ” ê°„ë‹¨í•œ Flaskê¸°ë°˜ ì•±ì„ ì‘ì„±í•œë‹¤.  </p><p>ê°„ë‹¨í•œ ë°ëª¨ì½”ë“œëŠ” ì•„ë˜ repositoryì— ë¯¸ë¦¬ ì‘ì„±í•´ë†¨ë‹¤.  </p><p><a href="https://github.com/ddiiwoong/hello-python.git" target="_blank" rel="noopener noreferrer">https://github.com/ddiiwoong/hello-python.git</a></p><div class="codeBlockContainer_I0IT language-py theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-py codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> flask </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Flask</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Flask</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">__name__</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@app</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">route</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'/'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">hello_world</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    target </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'TARGET'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'NOT SPECIFIED'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Hello World: {}!\n'</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"__main__"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">debug</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> host</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">'0.0.0.0'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> port</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'PORT'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8080</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ ì•±(app.py)ì„ ë°°í¬í•˜ëŠ” Dockerfileì„ ì‘ì„±í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-dockerfile theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">FROM python:alpine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENV APP_HOME /app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY . $APP_HOME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WORKDIR $APP_HOME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN pip install Flask</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENTRYPOINT ["python"]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD ["app.py"]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="knative-build">Knative Build<a class="hash-link" href="#knative-build" title="Direct link to heading">â€‹</a></h2><p>ë¯¸ë¦¬ Dockerhubì—ì„œ <code>hello-python</code> repository(docker.io/ddiiwoong/hello-python)ë¥¼ ìƒì„±í•œë‹¤.<br>
<!-- -->ê·¸ë¦¬ê³  ìœ„ì—ì„œ ìƒì„±í•œ <code>build-bot</code> ê³„ì •ê³¼ image tag <code>hello-python</code>ì •ë³´ë¥¼ Build templateì— ì‘ì„±í•˜ì—¬ ë°°í¬í•œë‹¤.<br>
<!-- -->ì•„ë˜ Knative Build ê³¼ì •ì€ <code>kaniko executor</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ìŒê³¼ ê°™ì€ ê³¼ì •ì„ ìˆ˜í–‰í•œë‹¤.  </p><ol><li><code>spec.source</code> ì—ì„œ Source Clone (git)ë¥¼ ìˆ˜í–‰í•˜ê³  ì´í›„  </li><li><code>spec.steps</code> ì—ì„œ Docker Build, Tag, Registry Login, Pushë¥¼ ìˆ˜í–‰í•œë‹¤.  </li></ol><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> build.knative.dev/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> python</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">serviceAccountName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> build</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">bot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">source</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">git</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//github.com/ddiiwoong/hello</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">python.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">revision</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> build</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">and</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">push</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gcr.io/kaniko</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">project/executor</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">v0.1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">args</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">dockerfile=/workspace/Dockerfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">destination=docker.io/ddiiwoong/hello</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">python</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>build</code>ë¥¼ ìˆ˜í–‰í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl apply -f build.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">build.build.knative.dev/python-build created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME           SUCCEEDED   REASON    STARTTIME   COMPLETIONTIME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python-build   True                  18m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì •ìƒì ìœ¼ë¡œ Buildê°€ ì™„ë£Œë˜ë©´ Dockerhubì— ì •ì˜í•œ TAG(ddiiwoong/hello-python)ë¡œ ì´ë¯¸ì§€ê°€ ë“±ë¡ëœê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ docker pull ddiiwoong/hello-python</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Using default tag: latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">latest: Pulling from ddiiwoong/hello-python</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">e7c96db7181b: Pull complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">799a5534f213: Pull complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">913b50bbe755: Pull complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">11154abc6081: Pull complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c805e63f69fe: Pull complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6eabcf0f7a50: Pull complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">74101057f4ec: Pull complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Digest: sha256:51dc4a7ce38a5e7894adcfc00eaee6c5ea6aca1ef6c7521f9b7ea6382c013b9b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Status: Downloaded newer image for ddiiwoong/hello-python:latest</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="knative-serving-ìœ¼ë¡œ-ë°°í¬">Knative Serving ìœ¼ë¡œ ë°°í¬<a class="hash-link" href="#knative-serving-ìœ¼ë¡œ-ë°°í¬" title="Direct link to heading">â€‹</a></h2><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="serviceyaml">service.yaml<a class="hash-link" href="#serviceyaml" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> serving.knative.dev/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> helloworld</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">python</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">runLatest</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">configuration</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">revisionTemplate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">container</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ddiiwoong/hello</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">python</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> TARGET</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Python Sample v1 with Knative on EKS"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë¹Œë“œëœ image (ddiiwoong/hello-python:latest)ë¡œ Knative Serviceë¥¼ ìƒì„±í•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl apply -f service.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service.serving.knative.dev/helloworld-python created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>istio-system</code> Namespaceì— <code>istio-ingressgateway</code> Serviceë¥¼ í™•ì¸í•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get svc istio-ingressgateway --namespace istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                   TYPE           CLUSTER-IP      EXTERNAL-IP                                                                    PORT(S)                                                                                                                   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-ingressgateway   LoadBalancer   10.100.208.80   a220723d475df11e980220a02e220b34-2021915778.ap-northeast-2.elb.amazonaws.com   80:31581/TCP,443:31490/TCP,31400:30367/TCP,15011:32495/TCP,8060:31418/TCP,853:30310/TCP,15030:32405/TCP,15031:31410/TCP   13h</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ALB: a220723d475df11e980220a02e220b34-2021915778.ap-northeast-2.elb.amazonaws.com  </p><p>ìœ„ì™€ ê°™ì´ AWS LoadBalancerë¡œ ë°°í¬ë©´ ALBê°€ ìë™ìœ¼ë¡œ ìƒì„±ë˜ë¯€ë¡œ ì¶”í›„ eksctlë¡œ í´ëŸ¬ìŠ¤í„°ë¥¼ ì‚­ì œí•˜ê¸° ì „ì— ë°˜ë“œì‹œ LoadBalancer í˜•íƒœë¡œ ë°°í¬ëœ ì„œë¹„ìŠ¤ë¥¼ ì‚­ì œí•˜ê³  ì§„í–‰í•´ì•¼ í•œë‹¤.  </p><p>Knative Serviceë¥¼ í™•ì¸í•œë‹¤. </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get ksvc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                DOMAIN                                  LATESTCREATED             LATESTREADY               READY     REASON</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helloworld-python   helloworld-python.default.example.com   helloworld-python-4rw95   helloworld-python-4rw95   True</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ì—ì„œ ì–»ì€ ë‘ê°€ì§€ ì •ë³´(LoadBalancer, Domain)ë¡œ ìƒì„±ëœ appì„ í…ŒìŠ¤íŠ¸í•œë‹¤.<br>
<!-- -->KnativeëŠ” ë‚´ë¶€ì ìœ¼ë¡œ example.comì´ë¼ê³  í•˜ëŠ” ê¸°ë³¸ domainì„ ì‚¬ìš©í•˜ë¯€ë¡œ ë‚´ë¶€ì ìœ¼ë¡œëŠ” <code>helloworld-python.default.example.com</code>ìœ¼ë¡œ curlì„ ì‹¤í–‰í•˜ê²Œ ëœë‹¤.  </p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ curl -H "Host:helloworld-python.default.example.com" http://a220723d475df11e980220a02e220b34-2021915778.ap-northeast-2.elb.amazonaws.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello World: Python Sample v1 with Knative on EKS!</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>Cold Start</code>(default timeout 5ë¶„) ë•Œë¬¸ì— ì ì‹œ ì‘ë‹µì´ ëŠ¦ì–´ì§ˆ ìˆ˜ë„ ìˆì§€ë§Œ(2-5ì´ˆ) ì ì‹œ ê¸°ë‹¤ë¦¬ë©´ ìœ„ì²˜ëŸ¼ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ìœ„ì—ì„œë„ ì ê¹ ì–¸ê¸‰í–ˆì§€ë§Œ Lambdaë‚˜ ECS, Batch ì„œë¹„ìŠ¤ê°€ ìˆëŠ”ë° Knative on EKS ë¥¼ êµ¬ì§€ ì™œ í•˜ëŠëƒë¼ê³  ê¶ê¸ˆí•´í•˜ëŠ” ë¶„ë“¤ì´ ê³„ì‹¤ì§€ë„ ëª¨ë¥¸ë‹¤. í•˜ì§€ë§Œ ë‹¤ë“¤ ì•„ë˜ì™€ ê°™ì€ ê³ ë¯¼ì„ í•´ë´¤ì„ê±°ë¼ ìƒê°í•œë‹¤.  </p><p>ì»¨í…Œì´ë„ˆì™€ Kubernetesê°€ DevOpsë„êµ¬ë¡œì„œì˜ í‘œì¤€ì´ ë˜ì–´ê°€ëŠ” ì‹œëŒ€ì— Lambdaë¥¼ ì“¸ì§€ ì˜¤í”ˆì†ŒìŠ¤ë¥¼ ì“¸ì§€ì— ëŒ€í•œ ê³ ë¯¼ì€ ê²°êµ­ ì´ì‹ì„±ê³¼ ë²¤ë” ì¢…ì†ì„±ì„ ì œê±°í•˜ê³  ìš´ì˜íš¨ìœ¨í™” ì¸¡ë©´ì—ì„œ ê·¸ ë‹µì„ ì°¾ì„ìˆ˜ ìˆì„ê²ƒ ê°™ë‹¤.  </p><p>í˜„ì¬ ëª¸ë‹´ê³  ìˆëŠ” ìµœê·¼ í”„ë¡œì íŠ¸ì—ì„œ Lambda, ECS, Batch ë“±ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ë§ì•„ì¡ŒëŠ”ë° ì‹¤ì œ ì—”í„°í”„ë¼ì´ì¦ˆì—ì„œ ì •í•´ì§„ ìì›ë‚´ì—ì„œ ì •í•´ì§„ ì¼ì„ í• ë•ŒëŠ” ë§¤ë‹ˆì§€ë“œ ì„œë¹„ìŠ¤ê°€ ì í•©í•˜ë‹¤ê³  ìƒê°í•œë‹¤. í•˜ì§€ë§Œ On-Premise ë˜ëŠ” ê·¸ì— ì¤€í•˜ëŠ” Kubernetes í´ëŸ¬ìŠ¤í„°ë¥¼ ìš´ì˜í•˜ëŠ” ì¡°ì§ì—ì„œëŠ” Knativeë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆ ê¸°ë°˜ ì„œë¹„ë¦¬ìŠ¤ ì›Œí¬ë¡œë“œë¥¼ êµ¬í˜„í•˜ëŠ” ê²ƒì´ í–¥í›„ Hybrid ê´€ì ì—ì„œ í™•ì¥ì„±ê³¼ ë²¤ë” ì¢…ì†ì„±ì„ ì œê±°í•˜ëŠ”ë° í° ë„ì›€ì´ ë ê²ƒì´ë¼ ìƒê°í•œë‹¤.  </p><p>ì¡°ê¸ˆì”© Kubernetes ë° ìƒíƒœê³„ Learningì— ëŒ€í•œ í”¼ë¡œë„ê°€ ì¦ê°€í•˜ê³  ìˆê³  Hype Driven Development(ì„¤ë ˆë°œ ì£¼ë„ê°œë°œ)ê°€ ë˜ëŠ”ê²ƒ ê°™ì•„ì„œ ì•„ì‰¬ìš´ ë¶€ë¶„ì€ ìˆì§€ë§Œ í˜„ì¬ ê°€ì¥ í•«í•œ ê¸°ìˆ ì´ê³  ê´€ì‹¬ë„ê°€ ë†’ê¸° ë•Œë¬¸ì— ë°°ì›Œë‘ë©´ ì–¸ì  ê°€ëŠ” ì¨ë¨¹ê²Œ ë ê±°ë¼ í™•ì‹ í•œë‹¤.  </p><p>ë‹¤ì‹œí•œë²ˆ Conference driven development(architecture)ê°€ ë˜ì§€ ì•Šë„ë¡ ìì¤‘í•˜ê³  Loudest Guyê°€ ë˜ì§€ ì•Šë„ë¡ ì¡°ì‹¬í•´ì•¼í•  ê²ƒ ê°™ë‹¤.</p>]]></content>
        <category label="Knative" term="Knative"/>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="FaaS" term="FaaS"/>
        <category label="AWS" term="AWS"/>
        <category label="Lambda" term="Lambda"/>
        <category label="Serverless" term="Serverless"/>
        <category label="EKS" term="EKS"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[eksworkshop]]></title>
        <id>kubernetes/eksworkshop/</id>
        <link href="https://ddii.dev/kubernetes/eksworkshop/"/>
        <updated>2019-03-29T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[eskworkshop íŠœí† ë¦¬ì–¼ì„ ì‹¤í–‰í•˜ê³  ê°„ë‹¨í•œ Microserviceì•±ì„ ë°°í¬í•´ë³´ì]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="amazon-eks-elastic-container-service-for-kubernetes">Amazon EKS (Elastic Container Service for Kubernetes)<a class="hash-link" href="#amazon-eks-elastic-container-service-for-kubernetes" title="Direct link to heading">â€‹</a></h2><p>Kubernetes Managed Serviceì¸ Amazon EKSê°€ 2018ë…„ 7ì›” ì¶œì‹œë˜ê³  2019ë…„ 1ì›” ì •ì‹ìœ¼ë¡œ ì„œìš¸ë¦¬ì „ì— ì¶œì‹œë˜ì—ˆë‹¤. ê°œì¸ì ìœ¼ë¡œ ì™„ì „ê´€ë¦¬í˜• Kubernetes ì¶œì‹œê°€ ëŠ¦ì–´ì ¸ì„œ AWS í–‰ë³´ê°€ ë‹¤ì†Œ ëŠ¦ë‹¤ê³  ìƒê°ì€ í–ˆìœ¼ë‚˜ ALBì™€ VPCì—°ë™, ì—¬ëŸ¬ê°€ì§€ ê¸°ì¡´ OpenSourceì™€ì˜ ì—°ê²°ê³ ë¦¬ë¥¼ ë°°ì œí•˜ê³  ìì²´ Managedì„œë¹„ìŠ¤ì™€ ì—°ë™í• ê²ƒë“¤ì´ ë§ê¸° ë•Œë¬¸ì— ë‹¹ì—°íˆ íƒ€ì‚¬ì— ë¹„í•´ ëŠ¦ì–´ì§„ê±¸ë¡œ ë³´ì¸ë‹¤. ì–¸ì œë‚˜ ê·¸ë¬ì§€ë§Œ ì˜¤í”ˆì†ŒìŠ¤ë¥¼ ë°›ì•„ë“¤ì´ëŠ” ëŠë‚Œì´ ì•„ë‹ˆë¼ ë­”ê°€ ì™„ì„±ëœ ì œí’ˆì„ ì“°ëŠ” ëŠë‚Œ(?)ì´ë‹¤. ë¬¼ë¡  ë¶ˆí¸í•œ ë¶€ë¶„ê³¼ ê°ìˆ˜í•´ì•¼í•  ë‚´ìš©ë“¤ì€ ì¡°ê¸ˆ ìˆì§€ë§Œ ê¸°ì¡´ AWS ì¶©ì„± Userì—ê²Œ í˜¸ì‘ì„ ì–»ì„ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ ì•„ë‹ê¹Œë¼ëŠ” ìƒê°ì„ í•´ë³´ë©´ì„œ í¬ìŠ¤íŒ…ì„ ì‹œì‘í•˜ë ¤ê³  í•œë‹¤.  </p><p>ì˜¤í”ˆì†ŒìŠ¤ê°€ ì•„ë‹Œ Managedì„œë¹„ìŠ¤ì— ëŒ€í•œ ë¦¬ë·°ëŠ” ì²˜ìŒì´ì§€ë§Œ 4ì›” 10ì¼ <a href="https://www.meetup.com/ko-KR/awskrug/events/260024327/" target="_blank" rel="noopener noreferrer">AWSíŒêµì†Œëª¨ì„</a> ë°œí‘œë„ ìˆê³ , ì‹¤ì œ ê³ ë ¤ì¤‘ì¸ ì•„í‚¤í…ì²˜ì— í¬í•¨ì´ ë˜ì–´ì•¼ í•˜ëŠ” EKSì— ëŒ€í•´ì„œ ì‚´í´ë³´ê³  eskworkshop íŠœí† ë¦¬ì–¼ì„ ì‹¤í–‰í•´ë³´ë©´ì„œ ë‹¤ë¥¸ ê´€ë¦¬í˜• Kubernetes ì„œë¹„ìŠ¤ë“¤ì— ë¹„í•´ ì–´ë–¤ ì‚¬í•­ì„ ì¢€ë” ê³ ë¯¼í•´ì•¼ í•˜ëŠ”ì§€ ì •ë¦¬í•´ë³´ê³  ë„˜ì–´ê°€ë©´ ì¢‹ì„ë“¯ í•˜ë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="eksworkshopcom">eksworkshop.com<a class="hash-link" href="#eksworkshopcom" title="Direct link to heading">â€‹</a></h2><p><a href="https://eksworkshop.com/" target="_blank" rel="noopener noreferrer">https://eksworkshop.com/</a><br>
<!-- -->Kuberneteë¥¼ ì²˜ìŒì ‘í•˜ëŠ” ìœ ì €ë¥¼ ìœ„í•œ ê¸°ë³¸ ê°œë…ê³¼ ì•„í‚¤í…ì²˜, ê·¸ë¦¬ê³  VPC, ALBë¥¼ í™œìš©í•˜ì—¬ EKSì— ëŒ€í•œ ì„¤ì¹˜, êµ¬ì„±, ë°ëª¨ì•± ë°°í¬ ë“±ì„ í•´ë³¼ìˆ˜ ìˆëŠ” íŠœí† ë¦¬ì–¼ ì‚¬ì´íŠ¸ì´ë‹¤.  </p><p><a href="https://www.facebook.com/groups/awskrug/" target="_blank" rel="noopener noreferrer">AWSKRUG</a>ì—ì„œ í•œê¸€í™” ì‘ì—…ë„ ì§„í–‰ì¤‘ì´ë‹¤.  <a href="https://awskrug.github.io/eks-workshop/deploy/" target="_blank" rel="noopener noreferrer">í•œê¸€í™” ë§í¬</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="eksworkshop-ë”°ë¼í•˜ê¸°ì „-ì‚¬ì „-ì¤€ë¹„ì‚¬í•­">eksworkshop ë”°ë¼í•˜ê¸°ì „ ì‚¬ì „ ì¤€ë¹„ì‚¬í•­<a class="hash-link" href="#eksworkshop-ë”°ë¼í•˜ê¸°ì „-ì‚¬ì „-ì¤€ë¹„ì‚¬í•­" title="Direct link to heading">â€‹</a></h2><p>eksworkshopì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ workshopì´ë¼ëŠ” ì‹ ê·œ IAM ê³„ì •ì„ ìƒì„±í•˜ê³  Cloud9 Workspace ì™€ ëª‡ê°€ì§€ ì„¤ì •ë“¤ì„ ì§„í–‰í•˜ì§€ë§Œ <a href="https://www.meetup.com/ko-KR/awskrug/events/260024327/" target="_blank" rel="noopener noreferrer">AWSíŒêµì†Œëª¨ì„</a>ì„ ìœ„í•´ ìµœëŒ€í•œ ë¹„ìš©ì´ ë“œëŠ” êµ¬ì„±ìš”ì†Œë¥¼ ë°°ì œí•˜ê³  ì‘ì„±í•˜ê³ ì í•œë‹¤.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="aws-account">AWS account<a class="hash-link" href="#aws-account" title="Direct link to heading">â€‹</a></h3><p>Free TierëŠ” EKSë¥¼ ììœ ë¡­ê²Œ í™œìš©í• ìˆ˜ ì—†ë‹¤.<br>
<!-- -->ê´€ë ¨ issue - <a href="https://github.com/aws/containers-roadmap/issues/78" target="_blank" rel="noopener noreferrer">https://github.com/aws/containers-roadmap/issues/78</a>  </p><p>ì‹¤ì œ ì‚¬ìš©ì¤‘ì¸ ê³„ì •ì´ë‚˜ Creditì´ í™•ë³´ëœ ê³„ì •ì´ í•„ìš”í•˜ë‹¤.  </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="iam-ì„¤ì •-json-template">IAM ì„¤ì • (JSON template)<a class="hash-link" href="#iam-ì„¤ì •-json-template" title="Direct link to heading">â€‹</a></h3><p>EKSworkshopì—ì„œëŠ” Full administrator ê³„ì •ì„ í•„ìš”ë¡œ í•˜ì§€ë§Œ eksctlë¡œ ë°°í¬ë¥¼ ì§„í–‰í•˜ë¯€ë¡œ ê·¸ ê¸°ì¤€ìœ¼ë¡œ IAMì„¤ì •ì„ ì§„í–‰í•œë‹¤.  </p><p><a href="https://github.com/terraform-aws-modules/terraform-aws-eks/blob/master/examples/eks_test_fixture/README.md" target="_blank" rel="noopener noreferrer">terraform eks iam ì„¤ì •</a>ì„ ì°¸ê³ í•˜ë ¤ê³  í–ˆì§€ë§Œ eksctlê³¼ terraformê³¼ì˜ ì•½ê°„ ë‹¤ë¥¸ ë°©ì‹ì˜ ë°°í¬ë¡œ ì¸í•´ ì–´ì©”ìˆ˜ì—†ì´ EKS Full Accessê¶Œí•œì„ í• ë‹¹í•˜ì˜€ë‹¤.<br>
<!-- -->(ë‹¤ë¥¸ ìœ ê²½í—˜ìì˜ ë„ì›€ì´ í•„ìš”í•œ ìƒí™© ã… ã… )</p><p>ìì„¸í•œ JSON ë‚´ìš©ì€ <a href="https://github.com/ddiiwoong/eksworkshop/blob/master/iam_for_eksworkshop.json" target="_blank" rel="noopener noreferrer">ë§í¬</a>ë¥¼ ì°¸ê³ í•œë‹¤.  </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kubectl-aws-iam-authenticator">kubectl, aws-iam-authenticator<a class="hash-link" href="#kubectl-aws-iam-authenticator" title="Direct link to heading">â€‹</a></h3><ul><li>kubectl : kubernetes CLI</li><li>aws-iam-authenticator : AWS IAM Authenticator CLI</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kubectl-configë¥¼-ì €ì¥í•˜ê¸°-ìœ„í•´-kube-directoryë¥¼-ìƒì„±">kubectl configë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´ .kube directoryë¥¼ ìƒì„±<a class="hash-link" href="#kubectl-configë¥¼-ì €ì¥í•˜ê¸°-ìœ„í•´-kube-directoryë¥¼-ìƒì„±" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> -p ~/.kube</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kubectl-ì„¤ì¹˜-linux">kubectl ì„¤ì¹˜ (linux)<a class="hash-link" href="#kubectl-ì„¤ì¹˜-linux" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> --silent --location -o /usr/local/bin/kubectl </span><span class="token string" style="color:#e3116c">"https://amazon-eks.s3-us-west-2.amazonaws.com/1.11.5/2018-12-06/bin/linux/amd64/kubectl"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> +x /usr/local/bin/kubectl</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kubectl-ì„¤ì¹˜-macos-homebrew">kubectl ì„¤ì¹˜ (MacOS Homebrew)<a class="hash-link" href="#kubectl-ì„¤ì¹˜-macos-homebrew" title="Direct link to heading">â€‹</a></h4><p>MacOSëŠ” brewë¡œ ì„¤ì¹˜í•˜ì˜€ë‹¤.<br>
<a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/#install-with-homebrew-on-macos" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/tasks/tools/install-kubectl/#install-with-homebrew-on-macos</a></p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ brew </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> kubernetes-cli</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kubectl-ì„¤ì¹˜-windows-powershell">kubectl ì„¤ì¹˜ (windows PowerShell)<a class="hash-link" href="#kubectl-ì„¤ì¹˜-windows-powershell" title="Direct link to heading">â€‹</a></h4><p><a href="https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/install-kubectl.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/install-kubectl.html</a></p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">curl -o kubectl.exe https://amazon-eks.s3-us-west-2.amazonaws.com/1.10.3/2018-07-26/bin/windows/amd64/kubectl.exe</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kubectl-ì„¤ì¹˜-í™•ì¸">kubectl ì„¤ì¹˜ í™•ì¸<a class="hash-link" href="#kubectl-ì„¤ì¹˜-í™•ì¸" title="Direct link to heading">â€‹</a></h4><p>í˜„ì¬ MacOSì—ì„œëŠ” 1.11.7 ë²„ì „ì´ ì„¤ì¹˜ë˜ì–´ ìˆë‹¤. (ë‹¤ë¥¸ê²½ë¡œë¡œ ì„¤ì¹˜ë¨)</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl version --short --client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Client Version: v1.11.7-dispatcher</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="aws-iam-authenticator-ì„¤ì¹˜">aws-iam-authenticator ì„¤ì¹˜<a class="hash-link" href="#aws-iam-authenticator-ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h4><p>Amazon EKSëŠ” IAMì„ ì‚¬ìš©í•˜ì—¬ Kubernetesìš© AWS IAM Authenticatorë¥¼ í†µí•´ Kubernetes í´ëŸ¬ìŠ¤í„°ì— ì¸ì¦ì„ ì œê³µí•œë‹¤.  Go(ë²„ì „ 1.7ì´ìƒ)ê°€ ì„¤ì¹˜ë˜ì–´ ìˆìœ¼ë©´ ì•„ë˜ì™€ ê°™ì´ ì§„í–‰í•˜ë©´ ëœë‹¤. </p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ go get -u -v github.com/kubernetes-sigs/aws-iam-authenticator/cmd/aws-iam-authenticator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mv</span><span class="token plain"> ~/go/bin/aws-iam-authenticator /usr/local/bin/aws-iam-authenticator</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë§Œì•½ Goì„¤ì¹˜ê°€ ì•ˆë˜ì–´ ìˆë‹¤ë©´ ë‹¤ìŒ ë§í¬ë¥¼ í†µí•´ ì„¤ì¹˜ ì§„í–‰í• ìˆ˜ ìˆë‹¤.<br>
<a href="https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/install-aws-iam-authenticator.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/install-aws-iam-authenticator.html</a></p><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="aws-iam-authenticator-binary-ë‹¤ìš´ë¡œë“œ">aws-iam-authenticator binary ë‹¤ìš´ë¡œë“œ<a class="hash-link" href="#aws-iam-authenticator-binary-ë‹¤ìš´ë¡œë“œ" title="Direct link to heading">â€‹</a></h4><p>Linux: <a href="https://amazon-eks.s3-us-west-2.amazonaws.com/1.10.3/2018-07-26/bin/linux/amd64/aws-iam-authenticator" target="_blank" rel="noopener noreferrer">https://amazon-eks.s3-us-west-2.amazonaws.com/1.10.3/2018-07-26/bin/linux/amd64/aws-iam-authenticator</a><br>
<!-- -->MacOS: <a href="https://amazon-eks.s3-us-west-2.amazonaws.com/1.10.3/2018-07-26/bin/darwin/amd64/aws-iam-authenticator" target="_blank" rel="noopener noreferrer">https://amazon-eks.s3-us-west-2.amazonaws.com/1.10.3/2018-07-26/bin/darwin/amd64/aws-iam-authenticator</a><br>
<!-- -->Windows: <a href="https://amazon-eks.s3-us-west-2.amazonaws.com/1.10.3/2018-07-26/bin/windows/amd64/aws-iam-authenticator.exe" target="_blank" rel="noopener noreferrer">https://amazon-eks.s3-us-west-2.amazonaws.com/1.10.3/2018-07-26/bin/windows/amd64/aws-iam-authenticator.exe</a></p><h5 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="macosì˜-ê²½ìš°">MacOSì˜ ê²½ìš°<a class="hash-link" href="#macosì˜-ê²½ìš°" title="Direct link to heading">â€‹</a></h5><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -o aws-iam-authenticator https://amazon-eks.s3-us-west-2.amazonaws.com/1.10.3/2018-07-26/bin/darwin/amd64/aws-iam-authenticator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> +x ./aws-iam-authenticator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> ./aws-iam-authenticator </span><span class="token environment constant" style="color:#36acaa">$HOME</span><span class="token plain">/bin/aws-iam-authenticator </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable environment constant" style="color:#36acaa">PATH</span><span class="token operator" style="color:#393A34">=</span><span class="token environment constant" style="color:#36acaa">$HOME</span><span class="token plain">/bin:</span><span class="token environment constant" style="color:#36acaa">$PATH</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="macos-bash-í™˜ê²½ë³€ìˆ˜-ì¶”ê°€">MacOS bash í™˜ê²½ë³€ìˆ˜ ì¶”ê°€<a class="hash-link" href="#macos-bash-í™˜ê²½ë³€ìˆ˜-ì¶”ê°€" title="Direct link to heading">â€‹</a></h5><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'export PATH=$HOME/bin:$PATH'</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> ~/.bash_profile</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="macos-zsh-í™˜ê²½ë³€ìˆ˜-ì¶”ê°€">MacOS zsh í™˜ê²½ë³€ìˆ˜ ì¶”ê°€<a class="hash-link" href="#macos-zsh-í™˜ê²½ë³€ìˆ˜-ì¶”ê°€" title="Direct link to heading">â€‹</a></h5><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'export PATH=$HOME/bin:$PATH'</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> ~/.zshrc</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="aws-iam-authenticator-binary-í™•ì¸">aws-iam-authenticator binary í™•ì¸<a class="hash-link" href="#aws-iam-authenticator-binary-í™•ì¸" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ aws-iam-authenticator </span><span class="token builtin class-name">help</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="eksctl">eksctl<a class="hash-link" href="#eksctl" title="Direct link to heading">â€‹</a></h3><p><img loading="lazy" src="https://github.com/weaveworks/eksctl/blob/master/logo/eksctl.png?raw=true" alt="mascot" class="img_E7b_"></p><p>eksctlì€ weaveworksì—ì„œ contributeí•˜ê³  ìˆëŠ” ì˜¤í”ˆì†ŒìŠ¤ë¡œ EKS í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•˜ëŠ” ê°„ë‹¨í•œ CLI ë„êµ¬ì´ë‹¤. Goë¡œ ì‘ì„±ë˜ì–´ ìˆê³  CloudFormationì„ ê¸°ë³¸ìœ¼ë¡œ ë™ì‘í•œë‹¤.  </p><p><a href="https://eksctl.io/" target="_blank" rel="noopener noreferrer">https://eksctl.io/</a><br>
<a href="https://github.com/weaveworks/eksctl" target="_blank" rel="noopener noreferrer">https://github.com/weaveworks/eksctl</a></p><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="eksctl-binary-ë‹¤ìš´ë¡œë“œ">eksctl binary ë‹¤ìš´ë¡œë“œ<a class="hash-link" href="#eksctl-binary-ë‹¤ìš´ë¡œë“œ" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> --silent --location </span><span class="token string" style="color:#e3116c">"https://github.com/weaveworks/eksctl/releases/download/latest_release/eksctl_</span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable function" style="color:#d73a49">uname</span><span class="token string variable" style="color:#36acaa"> -s</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">_amd64.tar.gz"</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">tar</span><span class="token plain"> xz -C /tmp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mv</span><span class="token plain"> -v /tmp/eksctl /usr/local/bin</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="macos-homebrew-ì„¤ì¹˜">MacOS Homebrew ì„¤ì¹˜<a class="hash-link" href="#macos-homebrew-ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ brew tap weaveworks/tap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ brew </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> weaveworks/tap/eksctl</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="windows-ì„¤ì¹˜-powershell-chocolatey">Windows ì„¤ì¹˜ (PowerShell, chocolatey)<a class="hash-link" href="#windows-ì„¤ì¹˜-powershell-chocolatey" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">chocolatey install eksctl</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="eksctl-ë™ì‘í™•ì¸">eksctl ë™ì‘í™•ì¸<a class="hash-link" href="#eksctl-ë™ì‘í™•ì¸" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ eksctl version</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="cli-api-ìê²©ì¦ëª…-êµ¬ì„±">CLI API ìê²©ì¦ëª… êµ¬ì„±<a class="hash-link" href="#cli-api-ìê²©ì¦ëª…-êµ¬ì„±" title="Direct link to heading">â€‹</a></h4><p>ì‚¬ì „ì„¤ì •í•œ aws configureê°€ ìˆëŠ”ì§€ í™•ì¸. ê¸°ì¡´ Terraformì´ë‚˜ kops ì‚¬ìš©í•œì ì´ ìˆìœ¼ë©´ ê±´ë„ˆë›°ì–´ë„ ëœë‹¤.  </p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain">  ~/.aws</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì—†ì„ê²½ìš° aws ìê²©ì¦ëª…ì„ ìƒì„±í•œë‹¤.</p><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="awscredentials">~/.aws/credentials<a class="hash-link" href="#awscredentials" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">[default]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws_access_key_id={EXAMPLE}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws_secret_access_key={EXAMPLEKEY}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="awsconfig">~/.aws/config<a class="hash-link" href="#awsconfig" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">[default]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">region=ap-northeast-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">output=json</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="eks-ë°°í¬">EKS ë°°í¬<a class="hash-link" href="#eks-ë°°í¬" title="Direct link to heading">â€‹</a></h2><p>kubectl, aws-iam-authenticator, eksctl, AWS ìê²©ì¦ëª… í™˜ê²½ê¹Œì§€ êµ¬ì„±ë˜ì–´ ìˆìœ¼ë©´ ë°”ë¡œ ë°°í¬ê°€ ê°€ëŠ¥í•˜ë‹¤.  </p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ eksctl create cluster --name</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">eksworkshop-eksctl --nodes</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> --node-ami</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">auto</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  using region ap-northeast-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  setting availability zones to </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ap-northeast-2a ap-northeast-2c ap-northeast-2a</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  subnets </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> ap-northeast-2a - public:192.168.0.0/19 private:192.168.96.0/19</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  subnets </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> ap-northeast-2c - public:192.168.32.0/19 private:192.168.128.0/19</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  subnets </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> ap-northeast-2a - public:192.168.64.0/19 private:192.168.160.0/19</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  nodegroup </span><span class="token string" style="color:#e3116c">"ng-cfb3cb01"</span><span class="token plain"> will use </span><span class="token string" style="color:#e3116c">"ami-0c7972077aa002104"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">AmazonLinux2/1.11</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  creating EKS cluster </span><span class="token string" style="color:#e3116c">"eksworkshop-eksctl"</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"ap-northeast-2"</span><span class="token plain"> region</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  will create </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> separate CloudFormation stacks </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> cluster itself and the initial nodegroup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> you encounter any issues, check CloudFormation console or try </span><span class="token string" style="color:#e3116c">'eksctl utils describe-stacks --region=ap-northeast-2 --name=eksworkshop-eksctl'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  creating cluster stack </span><span class="token string" style="color:#e3116c">"eksctl-eksworkshop-eksctl-cluster"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  creating nodegroup stack </span><span class="token string" style="color:#e3116c">"eksctl-eksworkshop-eksctl-nodegroup-ng-cfb3cb01"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  --nodes-min</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> was </span><span class="token builtin class-name">set</span><span class="token plain"> automatically</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  --nodes-max</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> was </span><span class="token builtin class-name">set</span><span class="token plain"> automatically</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">âœ”</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  all EKS cluster resource </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"eksworkshop-eksctl"</span><span class="token plain"> had been created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">âœ”</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  saved kubeconfig as </span><span class="token string" style="color:#e3116c">"/Users/ddii/.kube/config"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  nodegroup </span><span class="token string" style="color:#e3116c">"ng-cfb3cb01"</span><span class="token plain"> has </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  waiting </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> at least </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> to become ready </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"ng-cfb3cb01"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  nodegroup </span><span class="token string" style="color:#e3116c">"ng-cfb3cb01"</span><span class="token plain"> has </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"ip-192-168-42-42.ap-northeast-2.compute.internal"</span><span class="token plain"> is ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"ip-192-168-66-165.ap-northeast-2.compute.internal"</span><span class="token plain"> is ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  kubectl </span><span class="token builtin class-name">command</span><span class="token plain"> should work with </span><span class="token string" style="color:#e3116c">"/Users/ddii/.kube/config"</span><span class="token plain">, try </span><span class="token string" style="color:#e3116c">'kubectl get nodes'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">âœ”</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  EKS cluster </span><span class="token string" style="color:#e3116c">"eksworkshop-eksctl"</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"ap-northeast-2"</span><span class="token plain"> region is ready</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì„œìš¸ë¦¬ì „(ap-northeast-2)ê¸°ì¤€ ì•½ 15-20ë¶„ì´ ì†Œìš”ë˜ë©° <code>eksctl</code> ê¸°ë³¸ ì„¤ì •ê°’ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p><ul><li>í´ëŸ¬ìŠ¤í„°ëª…ì€ ìë™ìƒì„±, --name ì˜µì…˜ìœ¼ë¡œ ì§€ì •ê°€ëŠ¥ (eksworkshop-eksctl)</li><li>CloudFormation : eksctl-{$Cluster_Name}-cluster</li><li>m5.large * 2 instances (<a href="https://github.com/awslabs/amazon-eks-ami/blob/7f6c8cb3597e17f6e5f7df96d12bccf5604dc909/amazon-eks-nodegroup.yaml" target="_blank" rel="noopener noreferrer">EKS Instance Type</a> NodeInstanceType.AllowedValues ì°¸ê³ )</li><li>Default AMI : AWS EKS AMI (custom EKS AMI ê°€ëŠ¥ - Packerí™œìš©)</li><li>Default Region : us-west-2</li><li>dedicated VPC : 192.168.0.0/16 </li><li>kubernetes version : 1.11.x (<a href="https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/platform-versions.html" target="_blank" rel="noopener noreferrer">EKS Version</a> ì°¸ê³ )</li><li>StorageClass : gp2 (<a href="https://kubernetes.io/docs/concepts/storage/storage-classes/#aws-ebs" target="_blank" rel="noopener noreferrer">AWS EBS</a> ì°¸ê³ )</li><li>CNI : <a href="https://github.com/aws/amazon-vpc-cni-k8s" target="_blank" rel="noopener noreferrer">Amazon VPC</a></li><li>Node Autoscaler : --node-min, --node-max Auto Scaling ì„¤ì •</li><li>ê¸°ë³¸ Pod ê°œìˆ˜ : <a href="https://github.com/awslabs/amazon-eks-ami/blob/7f6c8cb3597e17f6e5f7df96d12bccf5604dc909/files/eni-max-pods.txt" target="_blank" rel="noopener noreferrer">ì°¸ê³ </a></li><li>nodegroup : workerê°€ í¬í•¨ë˜ëŠ” group </li><li>kubeconfig : ~/.kube/config ë¡œ í†µí•©ë¨</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="config-file-ì‚¬ìš©">Config File ì‚¬ìš©<a class="hash-link" href="#config-file-ì‚¬ìš©" title="Direct link to heading">â€‹</a></h3><p><a href="https://github.com/weaveworks/eksctl/tree/master/examples" target="_blank" rel="noopener noreferrer">https://github.com/weaveworks/eksctl/tree/master/examples</a>ë¥¼ ì°¸ê³ í•˜ì—¬ <code>YAML</code>í˜•íƒœë¡œ ì‘ì„±í•˜ì—¬ ë°°í¬ê°€ëŠ¥í•˜ë‹¤. </p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ eksctl create cluster -f example.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê¸°ì¡´ì— ê´€ë¦¬í•˜ëŠ” VPC subnetì •ë³´ ë° AutoScaling, AZ(availabilityZones)ì„¤ì •, nodegroup ê´€ë¦¬, node Instanceì— preBootstrapCommandë“±ì„ ì•„ë˜ ì˜ˆì‹œì™€ ê°™ì´ ë¯¸ë¦¬ ì‘ì„±í•˜ë©´ GitOpsì¸¡ë©´ì—ì„œ í™œìš©ë„ê°€ ë”ìš± ë†’ì•„ì§ˆìˆ˜ ìˆë‹¤.</p><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="05-advanced-nodegroupsyaml">05-advanced-nodegroups.yaml<a class="hash-link" href="#05-advanced-nodegroupsyaml" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># An advanced example of ClusterConfig object with customised nodegroups:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">---</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eksctl.io/v1alpha4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ClusterConfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cluster</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">region</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> eu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">west</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">nodeGroups</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ng1</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">public</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">instanceType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> m5.xlarge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">minSize</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">maxSize</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">nodegroup-type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> frontend</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">workloads</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">iam</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">withAddonPolicies</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">autoScaler</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ng2</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">private</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">instanceType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> m5.large</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">desiredCapacity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">nodegroup-type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> backend</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cluster</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">addons</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">privateNetworking</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">preBootsrapCommand</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># allow docker registries to be deployed as cluster service </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'echo {\"insecure-registries\": [\"172.20.0.0/16\",\"10.100.0.0/16\"]} &gt; /etc/docker/daemon.json'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"systemctl restart docker"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ng3</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">private</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">instanceType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> c3.8xlarge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">desiredCapacity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">nodegroup-type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> very</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">special</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">science</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">workloads</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">privateNetworking</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">availabilityZones</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">"eu-west-2a"</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># use single AZ to optimise data transfer between isntances</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">preBootstrapCommand</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># disable hyperthreading</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"for n in $(cat /sys/devices/system/cpu/cpu*/topology/thread_siblings_list | cut -s -d, -f2- | tr ',' '\n' | sort -un); do echo 0 &gt; /sys/devices/system/cpu/cpu${n}/online; done"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># cluster AZs must be set explicitly for single AZ nodegroup example to work</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">availabilityZones</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">"eu-west-2a"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"eu-west-2b"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"eu-west-2c"</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kubernetes-ëŒ€ì‹œë³´ë“œ-ë°°í¬">Kubernetes ëŒ€ì‹œë³´ë“œ ë°°í¬<a class="hash-link" href="#kubernetes-ëŒ€ì‹œë³´ë“œ-ë°°í¬" title="Direct link to heading">â€‹</a></h2><p>Kubernetes ê³µì‹ ëŒ€ì‹œë³´ë“œëŠ” ê¸°ë³¸ìœ¼ë¡œ ë°°í¬ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ìˆ˜ë™ìœ¼ë¡œ ë°°í¬í•´ì•¼í•œë‹¤. ì„¤ì¹˜ ë°©ë²•ì€ <a href="https://kubernetes.io/docs/tasks/access-application-cluster/web-ui-dashboard/" target="_blank" rel="noopener noreferrer">ê³µì‹ ë¬¸ì„œ</a>ì—ì„œ í™•ì¸ê°€ëŠ¥í•˜ë‹¤.  </p><p>ìœ„ì—ì„œ êµ¬ì„±ëœ í´ëŸ¬ìŠ¤í„°ì—ì„œ Kubernetes ëŒ€ì‹œë³´ë“œë¥¼ ë°°í¬í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v1.10.1/src/deploy/recommended/kubernetes-dashboard.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì ‘ì†ì„ ìœ„í•´ kube-proxy ê¸°ëŠ¥ì„ í™œìš©í•˜ì—¬ 8080í¬íŠ¸ë¡œ exposeë¥¼ ì§„í–‰í•œë‹¤. ëª¨ë“  ì¸í„°í˜ì´ìŠ¤ì—ì„œ í•„í„°ë§ì—†ì´ ì ‘ì†ì´ ê°€ëŠ¥í•˜ë„ë¡ ì˜µì…˜ì„ ì§€ì •í•œë‹¤.
ì•„ë˜ ëª…ë ¹ì€ í„°ë¯¸ë„ì—ì„œ ë°±ê·¸ë¼ìš´ë“œë¡œ ê³„ì† ë™ì‘í•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl proxy --port</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">8080</span><span class="token plain"> --address</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">'0.0.0.0'</span><span class="token plain"> --disable-filter</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">true </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">W0328 </span><span class="token number" style="color:#36acaa">16</span><span class="token plain">:39:09.061754    </span><span class="token number" style="color:#36acaa">9100</span><span class="token plain"> proxy.go:139</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Request filter disabled, your proxy is vulnerable to XSRF attacks, please be cautious</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>TOKENìœ¼ë¡œ ì ‘ì†í•˜ê¸° ìœ„í•´ aws-iam-authenticatorë¥¼ í†µí•´ í•´ë‹¹ í´ëŸ¬ìŠ¤í„° tokenì„ í™•ì¸í•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ aws-iam-authenticator token -i eksworkshop-eksctl --token-only</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">k8s-aws-v1.aHR0cHM6Ly9zdHMuYXAtbm9ydGhlYXN0LTIuYW1hem9uYXdzLmNvbS8_QWN0aW9uPUdldENhbGxlcklkZW50aXR5JlZlcnNpb249MjAxMS0wNi0xNSZYLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFKMjVNVjJSVVZQNlRWTURBJTJGMjAxOTAzMjglMkZhcC1ub3J0aGVhc3QtMiUyRnN0cyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMTkwMzI4VDA3NDEwNVomWC1BbXotRXhwaXJlcz0wJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCUzQngtazhzLWF3cy1pZCZYLUFtei1TaWduYXR1cmU9Yjc0NzkzYzUwOTU5NDYwMzMxMjY2YjExYWY4ODBkM2Q2OWQ5MWRhYzFhZWY1NjZmZTAwNTNlNWY2MTM0NGFlZQ</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê·¸ëƒ¥ localhost:8080 ìœ¼ë¡œë§Œ ì ‘ì†í•˜ë©´ êµ¬ì„±ëœ í´ëŸ¬ìŠ¤í„° kube API listë¥¼ í™•ì¸ë˜ë¯€ë¡œ ì•„ë˜ ê²½ë¡œë¡œ ì ‘ì†í•œë‹¤.<br>
<!-- -->ìœ„ì—ì„œ ì¶œë ¥ëœ TOKENê°’ìœ¼ë¡œ ë¡œê·¸ì¸í•œë‹¤. Token ì„¸ì…˜ Timeoutì´ ìˆìœ¼ë‹ˆ ì„¸ì…˜ë§Œë£Œì‹œ <code>aws-iam-authenticator</code> ëª…ë ¹ì„ í†µí•´ ê°±ì‹ ê°’ì„ ì…ë ¥í•˜ë©´ ëœë‹¤.  </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">http://localhost:8080/api/v1/namespaces/kube-system/services/https:kubernetes-dashboard:/proxy/#!/login</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><img loading="lazy" alt="dashboard" src="/assets/images/k8s_dashboard-b1c80ac04a6d1ec9d73b613952ef37c1.png" width="1950" height="1118" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="microservice-app-ë°°í¬">Microservice app ë°°í¬<a class="hash-link" href="#microservice-app-ë°°í¬" title="Direct link to heading">â€‹</a></h2><p>ê°€ì¥ ê¸°ë³¸ì ì¸ <a href="https://microservices-demo.github.io/" target="_blank" rel="noopener noreferrer">Sock Shop</a>ì„ ë°°í¬í•˜ê¸° ìœ„í•´ Git Clone ìˆ˜í–‰</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/microservices-demo/microservices-demo.git sockshop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token builtin class-name">cd</span><span class="token plain"> sockshop/deploy/kubernetes</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>NodePort</code>ë¡œ ë˜ì–´ìˆëŠ” Front-End Serviceë¥¼ <code>LoadBalancer</code>ë¡œ ìˆ˜ì •í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">sed</span><span class="token plain"> -i </span><span class="token string" style="color:#e3116c">'s/NodePort/LoadBalancer/g'</span><span class="token plain"> complete-demo.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> complete-demo.yaml </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> LoadBalancer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> type: LoadBalancer</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>namespace ìƒì„± ë° sock-shop ë°°í¬</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create namespace sock-shop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl apply -f complete-demo.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get all</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì„œë¹„ìŠ¤ ì ‘ì†í™•ì¸ì„ ìœ„í•´ì„œëŠ” ALBë°°í¬ì‹œê°„(DNSì „íŒŒ)ì´ ì¼ì • ì†Œìš”ë˜ë¯€ë¡œ ì ì‹œí›„ ì ‘ì†ì„ ì‹œë„í•œë‹¤.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get svc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME           TYPE           CLUSTER-IP       EXTERNAL-IP                                                                 PORT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">S</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">        AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">carts          ClusterIP      </span><span class="token number" style="color:#36acaa">10.100</span><span class="token plain">.84.58     </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">                                                                      </span><span class="token number" style="color:#36acaa">80</span><span class="token plain">/TCP         1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">carts-db       ClusterIP      </span><span class="token number" style="color:#36acaa">10.100</span><span class="token plain">.227.156   </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">                                                                      </span><span class="token number" style="color:#36acaa">27017</span><span class="token plain">/TCP      1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">catalogue      ClusterIP      </span><span class="token number" style="color:#36acaa">10.100</span><span class="token plain">.206.52    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">                                                                      </span><span class="token number" style="color:#36acaa">80</span><span class="token plain">/TCP         1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">catalogue-db   ClusterIP      </span><span class="token number" style="color:#36acaa">10.100</span><span class="token plain">.119.66    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">                                                                      </span><span class="token number" style="color:#36acaa">3306</span><span class="token plain">/TCP       1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">front-end      LoadBalancer   </span><span class="token number" style="color:#36acaa">10.100</span><span class="token plain">.249.164   a4c42cfe951be11e9bb8c0a8cd8a2e5d-8156023.ap-northeast-2.elb.amazonaws.com   </span><span class="token number" style="color:#36acaa">80</span><span class="token plain">:30001/TCP   1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">orders         ClusterIP      </span><span class="token number" style="color:#36acaa">10.100</span><span class="token plain">.160.17    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">                                                                      </span><span class="token number" style="color:#36acaa">80</span><span class="token plain">/TCP         1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">orders-db      ClusterIP      </span><span class="token number" style="color:#36acaa">10.100</span><span class="token plain">.70.203    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">                                                                      </span><span class="token number" style="color:#36acaa">27017</span><span class="token plain">/TCP      1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payment        ClusterIP      </span><span class="token number" style="color:#36acaa">10.100</span><span class="token plain">.57.233    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">                                                                      </span><span class="token number" style="color:#36acaa">80</span><span class="token plain">/TCP         1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">queue-master   ClusterIP      </span><span class="token number" style="color:#36acaa">10.100</span><span class="token plain">.146.109   </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">                                                                      </span><span class="token number" style="color:#36acaa">80</span><span class="token plain">/TCP         1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rabbitmq       ClusterIP      </span><span class="token number" style="color:#36acaa">10.100</span><span class="token plain">.32.115    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">                                                                      </span><span class="token number" style="color:#36acaa">5672</span><span class="token plain">/TCP       1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shipping       ClusterIP      </span><span class="token number" style="color:#36acaa">10.100</span><span class="token plain">.180.174   </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">                                                                      </span><span class="token number" style="color:#36acaa">80</span><span class="token plain">/TCP         1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user           ClusterIP      </span><span class="token number" style="color:#36acaa">10.100</span><span class="token plain">.211.41    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">                                                                      </span><span class="token number" style="color:#36acaa">80</span><span class="token plain">/TCP         1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user-db        ClusterIP      </span><span class="token number" style="color:#36acaa">10.100</span><span class="token plain">.87.142    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">                                                                      </span><span class="token number" style="color:#36acaa">27017</span><span class="token plain">/TCP      1h</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë¸Œë¼ìš°ì €ì—ì„œ ALBì£¼ì†Œ <code>a4c42cfe951be11e9bb8c0a8cd8a2e5d-8156023.ap-northeast-2.elb.amazonaws.com</code> ë¡œ ì ‘ì†í•˜ì—¬ sock-shop Demo Webì„ í™•ì¸í• ìˆ˜ ìˆë‹¤.  </p><p><img loading="lazy" alt="sockshop" src="/assets/images/sock-shop-42ee8cb05cf4ad155e4890fd1370a6d8.png" width="719" height="800" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="eks-í´ëŸ¬ìŠ¤í„°-ë°-ì‚­ì œ">EKS í´ëŸ¬ìŠ¤í„° ë° ì‚­ì œ<a class="hash-link" href="#eks-í´ëŸ¬ìŠ¤í„°-ë°-ì‚­ì œ" title="Direct link to heading">â€‹</a></h2><p>ìœ„ì—ì„œ ì™¸ë¶€ì ‘ì†ì„ ìœ„í•´ LoadBalancerë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì„¤ì •í•˜ì˜€ìœ¼ë¯€ë¡œ EC2 - Load Balancerì„œ í”„ë¡œë¹„ì €ë‹ëœ ALBë¥¼ ì‚­ì œí•˜ê³  ì§„í–‰í•´ì•¼ í•œë‹¤.  </p><p>í´ëŸ¬ìŠ¤í„°ì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ëª¨ë“  ì„œë¹„ìŠ¤ë¥¼ ë‹¤ì‹œ í™•ì¸í•˜ê³  EXTERNAL-IPê°’ê³¼ ì—°ê²°ëœ ëª¨ë“  ì„œë¹„ìŠ¤ë¥¼ ì‚­ì œí•œë‹¤.  </p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get svc --all-namespaces</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl delete svc front-end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ALBì™€ VPC ì‚­ì œê°€ ì™„ë£Œëœê²ƒì„ í™•ì¸í•˜ê³  í´ëŸ¬ìŠ¤í„°ë¥¼ ì‚­ì œí•˜ì.  </p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ eksctl delete cluster --name</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">eksworkshop-eksctl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  deleting EKS cluster </span><span class="token string" style="color:#e3116c">"eksworkshop-eksctl"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  will delete stack </span><span class="token string" style="color:#e3116c">"eksctl-eksworkshop-eksctl-nodegroup-ng-3af535b7"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  waiting </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> stack </span><span class="token string" style="color:#e3116c">"eksctl-eksworkshop-eksctl-nodegroup-ng-3af535b7"</span><span class="token plain"> to get deleted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">â„¹</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  will delete stack </span><span class="token string" style="color:#e3116c">"eksctl-eksworkshop-eksctl-cluster"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">âœ”</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  kubeconfig has been updated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">âœ”</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  the following EKS cluster resource</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"eksworkshop-eksctl"</span><span class="token plain"> will be deleted: cluster. If </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> doubt, check CloudFormation console</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ì„œìš¸ ë¦¬ì „(ap-northeast-2)ì— EKSê°€ ì˜¤í”ˆë˜ê³  Productioní™˜ê²½ì„ EKSë¡œ ë„˜ì–´ê°€ëŠ” ê¸°ì—…ë“¤ì´ ë§ì•„ì§€ê³  ìˆëŠ”ê±´ ì•„ì£¼ ê¸ì •ì ì¸ í˜„ìƒì´ë‹¤.<br>
<!-- -->ë˜í•œ ì—„ì²­ë‚œ ì†ë„ì˜ ê¸°ìˆ ê°œë°œê³¼ ë‹¤ì–‘í•œ íˆ´ë“¤ë¡œ Kubernetes Clusterë¥¼ êµ¬ì„±í•˜ê±°ë‚˜ Microserviceí˜•íƒœì˜ Appì„ ë°°í¬í•˜ëŠ”ê²ƒì€ ì ì  ëŒ€ì¤‘í™” ë˜ì–´ê°€ê³  ìˆë‹¤.<br>
<!-- -->ì‹¤ì œ Productionì—ì„œ êµ¬í˜„ì„ í•˜ê¸° ìœ„í•´ì„œëŠ” ë³´ì•ˆ ë° ì„±ëŠ¥ì„ ë™ì‹œì— ê³ ë ¤í•œ ë„¤íŠ¸ì›Œí¬(CNI), Ingress ì„¤ì •ì´ë‚˜ ì „ì²´ í´ëŸ¬ìŠ¤í„° í¼í¬ë¨¼ìŠ¤ ì¸¡ë©´ì—ì„œì˜ íŒŒë¼ë¯¸í„° íŠœë‹ì´ ë”ìš± ë” ì¤‘ìš”í•´ì§€ê³  ê´€ë ¨ëœ DevOps(SRE) ì¸ë ¥ë“¤ì˜ ì¤‘ìš”ë„ê°€ ë†’ì•„ì§ˆê²ƒì€ ë¶„ëª…í•´ ë³´ì¸ë‹¤.  </p><p>EKSë¥¼ ì˜¤í”ˆì†ŒìŠ¤ ì¸¡ë©´ì—ì„œ ê³ ë ¤í–ˆì„ë•Œì—ëŠ” ì˜ˆì „ì— í˜ì´ìŠ¤ë¶ì´ë‚˜ ë‹¤ë¥¸ê³³ì—ì„œ ì¢…ì¢… ì´ì•¼ê¸° í–ˆë˜ê²ƒì²˜ëŸ¼ AWS ê³ ìœ ì˜ Lock-in ì „ëµì„ ì—„ì²­ë‚˜ê²Œ ê³ ë¯¼í•˜ê³  ë°œí‘œí•œë“¯í•œ ìƒê°ì´ í•œ ëŠë‚Œì„ ì§€ìš¸ìˆ˜ëŠ” ì—†ëŠ”ê±´ ì‚¬ì‹¤ì´ì§€ë§Œ í›Œë¥­í•œ ì œí’ˆì¸ê±´ í™•ì‹¤í•˜ê³  ë‹¨ê¸°ê°„ì— ì„œë¹„ìŠ¤ ì„±ì¥ì†ë„ë¥¼ ë‚¼ ìˆ˜ ìˆëŠ” ì„œë¹„ìŠ¤ë¼ ìƒê°í•œë‹¤.  </p><p>ë§ˆì§€ë§‰ìœ¼ë¡œ Managed Kubernetesì˜ ì„ íƒì€ ì—”ì§€ë‹ˆì–´ì˜ ëª«ìœ¼ë¡œ ë³´ê³  ê° ë²¤ë”ë³„ ë¹„êµí•œ ì•„ë˜ ë§í¬ë¥¼ ì°¸ì¡°í•´ì„œ ì„ ì • ê¸°ì¤€ì„ ì¡ìœ¼ë©´ ë”ìš± ì¢‹ì„ê²ƒ ê°™ë‹¤.<br>
<a href="https://docs.google.com/spreadsheets/d/1U0x4-NQegEPGM7eVTKJemhkPy18LWuHW5vX8uZzqzYo/edit#gid=0" target="_blank" rel="noopener noreferrer">https://docs.google.com/spreadsheets/d/1U0x4-NQegEPGM7eVTKJemhkPy18LWuHW5vX8uZzqzYo/edit#gid=0</a></p>]]></content>
        <category label="eks" term="eks"/>
        <category label="aws" term="aws"/>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="eskworkshop" term="eskworkshop"/>
        <category label="kubectl" term="kubectl"/>
        <category label="Managed Kubernetes" term="Managed Kubernetes"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[git-sync]]></title>
        <id>kubernetes/git-sync/</id>
        <link href="https://ddii.dev/kubernetes/git-sync/"/>
        <updated>2019-03-21T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[git-syncì— ëŒ€í•´ì„œ ì•Œì•„ë³¸ë‹¤.]]></summary>
        <content type="html"><![CDATA[<p>git repoë¥¼ kubernetes volumeìœ¼ë¡œ êµ¬í˜„í• ìˆ˜ ìˆëŠ” sidecar pattern <code>git-sync</code> í”„ë¡œì íŠ¸ì— ëŒ€í•´ì„œ ì•Œì•„ë³¸ë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="git-sync">git-sync<a class="hash-link" href="#git-sync" title="Direct link to heading">â€‹</a></h2><p><a href="https://github.com/kubernetes" target="_blank" rel="noopener noreferrer">Kubernetes Github</a>ì— ë°©ë¬¸í•˜ë©´ ë‹¤ì–‘í•œ í”„ë¡œì íŠ¸ë“¤ì„ ë³¼ ìˆ˜ ìˆë‹¤.<br>
<a href="https://github.com/kubernetes/kubernetes" target="_blank" rel="noopener noreferrer">Kubernetes Project</a>ë¶€í„° minikube, kubeadm, kubectl, kubelet, dashboardë“± í•„ìˆ˜ì ìœ¼ë¡œ í•„ìš”í•˜ê±°ë‚˜ ë§ì´ ì‚¬ìš©ë˜ëŠ” í”„ë¡œì íŠ¸ë¥¼ ë³¼ ìˆ˜ ìˆëŠ”ë°,
ê¸°ì¡´ì— storage volume ìœ¼ë¡œ í™œìš©ë˜ë˜ <a href="https://kubernetes.io/docs/concepts/storage/volumes/#gitrepo" target="_blank" rel="noopener noreferrer">gitrepo</a>ê°€ <code>deprecated</code> ë˜ì–´ì„œ ë°©ë²•ì„ ì°¾ë‹¤ê°€ ìœ ì‚¬í•œ í”„ë¡œì íŠ¸ë¥¼ ê³µì‹ repoì—ì„œ ìš°ì—°íˆ ë°œê²¬í•˜ê²Œ ë˜ì—ˆë‹¤.  </p><p><a href="https://github.com/kubernetes/git-sync" target="_blank" rel="noopener noreferrer">git-sync</a>ëŠ” sidecar ë°©ì‹ìœ¼ë¡œ git repositoryë¥¼ cloneí•˜ëŠ” í”„ë¡œì íŠ¸ì´ë‹¤.  </p><p>ìµœì´ˆ í•œë²ˆ cloneë„ ê°€ëŠ¥í•˜ê³  ì¼ì •í•œ ê°„ê²©ìœ¼ë¡œ ëŒì–´ì™€ì„œ ì‘ìš©í”„ë¡œê·¸ë¨ì— ì‚¬ìš©í•  ìˆ˜ ìˆê³  ì›í•˜ëŠ” branch, Tag ë˜ëŠ” íŠ¹ì • git hash ê¸°ë°˜ìœ¼ë¡œ pullingì´ ê°€ëŠ¥í•˜ë‹¤.  </p><p>upstreamì˜ repositoryì—ì„œ ëŒ€ìƒì´ ë³€ê²½ë˜ì—ˆì„ë•Œ ë‹¤ì‹œ pullingí•˜ê³ , webhookê¸°ëŠ¥ì„ ì¶”ê°€í•˜ì—¬ ë¹„ë™ê¸°ì„±ìœ¼ë¡œ POST ìš”ì²­ì´ ìˆì„ë•Œë§Œ git-syncë¥¼ ìˆ˜í–‰í• ìˆ˜ ìˆê¸° ë•Œë¬¸ì—
Continuous Deploymentë¥¼ ê°„ë‹¨í•˜ê²Œ êµ¬í˜„í•˜ëŠ”ë° í™œìš©ë  ìˆ˜ ìˆë‹¤. </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="github-sshì„¤ì •">GitHub SSHì„¤ì •<a class="hash-link" href="#github-sshì„¤ì •" title="Direct link to heading">â€‹</a></h2><p>git ë‚´ìš©ì„ pullingì„ í• ë•Œ https, ssh ë°©ë²•ì„ ì‚¬ìš©í•˜ëŠ”ë° GitHub ssh keyë¥¼ kubernetes clusterì˜ secretìœ¼ë¡œ ì‚¬ìš©ì„ í• ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ssh ë°©ì‹ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ì‘ì„±í•˜ì˜€ë‹¤.  </p><p>ì•„ë˜ ëª¨ë“  ê³¼ì •ì€ MacOSì—ì„œ ì§„í–‰í•˜ì˜€ê³  ë‹¤ë¥¸ OSëŠ” ì•„ë˜ ë§í¬ì—ì„œ í™•ì¸ ê°€ëŠ¥í•˜ë‹¤.<br>
<a href="https://help.github.com/en/articles/connecting-to-github-with-ssh" target="_blank" rel="noopener noreferrer">https://help.github.com/en/articles/connecting-to-github-with-ssh</a></p><p>ì‚¬ìš©í•˜ê³ ì í•˜ëŠ” í„°ë¯¸ë„ì—ì„œ ë“±ë¡í‚¤ë¥¼ í™•ì¸í•˜ì.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ê¸°ì¡´ì—-ë“±ë¡ëœ-ssh-key-í™•ì¸">ê¸°ì¡´ì— ë“±ë¡ëœ SSH key í™•ì¸<a class="hash-link" href="#ê¸°ì¡´ì—-ë“±ë¡ëœ-ssh-key-í™•ì¸" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ ls -al ~/.ssh</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ìƒˆë¡œìš´-ssh-key-ìƒì„±">ìƒˆë¡œìš´ SSH key ìƒì„±<a class="hash-link" href="#ìƒˆë¡œìš´-ssh-key-ìƒì„±" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh-keygen -t rsa -b 4096 -C "ddiiwoong@gmail.com"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Start the SSH key creation process</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Enter file in which the key is (/Users/you/.ssh/id_rsa): [Hit enter]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Key has comment '/Users/you/.ssh/id_rsa'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Enter new passphrase (empty for no passphrase): [Type new passphrase]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Enter same passphrase again: [One more time for luck]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Your identification has been saved with the new passphrase.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ssh-agent-ì‹¤í–‰ì¤‘ì¸ì§€-í™•ì¸">ssh agent ì‹¤í–‰ì¤‘ì¸ì§€ í™•ì¸<a class="hash-link" href="#ssh-agent-ì‹¤í–‰ì¤‘ì¸ì§€-í™•ì¸" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">eval â€œ$(ssh-agent -s)â€</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Agent pid 59566</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ìƒì„±ëœ-í‚¤ë¥¼-keychainì—-ì €ì¥-ë°-í™•ì¸">ìƒì„±ëœ í‚¤ë¥¼ keychainì— ì €ì¥ ë° í™•ì¸<a class="hash-link" href="#ìƒì„±ëœ-í‚¤ë¥¼-keychainì—-ì €ì¥-ë°-í™•ì¸" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh-add -K ~/.ssh/id_rsa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ cat ~/.ssh/id_rsa.pub</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ë³µì‚¬-ë°-githubì—-ì¶”ê°€">ë³µì‚¬ ë° githubì— ì¶”ê°€<a class="hash-link" href="#ë³µì‚¬-ë°-githubì—-ì¶”ê°€" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ pbcopy &lt; ~/.ssh/id_rsa.pub</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Setting - SSH and GPG keys - SSH keys - New SSH key<br>
<code>Title</code>ì€ êµ¬ë¶„ìë¡œ ì…ë ¥í•˜ê³  GitHub passwordë¥¼ í•œë²ˆë” ì…ë ¥í•˜ê³  ì™„ë£Œí•œë‹¤.  </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="í„°ë¯¸ë„ì—ì„œ-sshì ‘ì†-í™•ì¸">í„°ë¯¸ë„ì—ì„œ SSHì ‘ì† í™•ì¸<a class="hash-link" href="#í„°ë¯¸ë„ì—ì„œ-sshì ‘ì†-í™•ì¸" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh -T git@github.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hi ddiiwoong! You've successfully authenticated, but GitHub does not provide shell access.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="git-syncë¥¼-ìœ„í•œ-secret-ë“±ë¡">git-syncë¥¼ ìœ„í•œ secret ë“±ë¡<a class="hash-link" href="#git-syncë¥¼-ìœ„í•œ-secret-ë“±ë¡" title="Direct link to heading">â€‹</a></h2><p><a href="https://github.com/kubernetes/git-sync/blob/master/docs/ssh.md" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes/git-sync/blob/master/docs/ssh.md</a></p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="secret-ìƒì„±">secret ìƒì„±<a class="hash-link" href="#secret-ìƒì„±" title="Direct link to heading">â€‹</a></h3><p>ìœ„ì—ì„œ ìƒì„±í•œ SSH keyë¥¼ Kubernetes Clusterì— Secret resourceë¡œ ì €ì¥ì„ í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh-keyscan github.com &gt; /tmp/known_hosts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># github.com:22 SSH-2.0-babeld-9d924d26</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># github.com:22 SSH-2.0-babeld-9d924d26</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># github.com:22 SSH-2.0-babeld-9d924d26</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>known_hostsì™€ keyë¥¼ Secretìœ¼ë¡œ ì €ì¥í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create secret generic git-creds \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --from-file=ssh=$HOME/.ssh/id_rsa \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --from-file=known_hosts=/tmp/known_hosts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get secret git-creds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME        TYPE      DATA      AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git-creds   Opaque    2         1d</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="sample-ngnix-ë°°í¬">sample ngnix ë°°í¬<a class="hash-link" href="#sample-ngnix-ë°°í¬" title="Direct link to heading">â€‹</a></h2><p>ê¸°ë³¸ì ìœ¼ë¡œ <code>git-sync/cmd/git-sync/main.go</code> ì†ŒìŠ¤ë¥¼ í™•ì¸í•˜ë©´ ì—¬ëŸ¬ê°€ì§€ flagë¥¼ í™•ì¸í•  ìˆ˜ ìˆëŠ”ë° ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” ì˜µì…˜ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p><ul><li>ssh : pulling ë°©ì‹ (default=false)</li><li>root : git cloneì´ ìˆ˜í–‰ë˜ëŠ” root directory (default="$HOME/git")</li><li>repo : clone ëŒ€ìƒ Repository (default="")</li><li>branch : branch (default=master)</li><li>rev : git revision (tag or hash) to check out</li><li>depth : commit depth (default=0)</li><li>dest : repository ë°°í¬ directory</li></ul><p>ê¸°íƒ€ ì˜µì…˜ë“¤ì€ <code>git-sync/cmd/git-sync/main.go</code> ì—ì„œ í™•ì¸ì´ ê°€ëŠ¥í•˜ë©° í•´ë‹¹ ì˜µì…˜ë“¤ì„ ë³€ìˆ˜ë¡œ ì²˜ë¦¬í•˜ì—¬ í™œìš©í•˜ë©´ ëœë‹¤.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="git-sync-demoyaml-ì‘ì„±">git-sync-demo.yaml ì‘ì„±<a class="hash-link" href="#git-sync-demoyaml-ì‘ì„±" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: extensions/v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app: git-sync-demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: git-sync-demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  replicas: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  selector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    matchLabels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      app: git-sync-demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  template:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        app: git-sync-demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        image: nginx:1.14-alpine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - containerPort: 80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        volumeMounts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - name: git-sync-volume</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          mountPath: /usr/share/nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: git-sync</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        image: k8s.gcr.io/git-sync:v3.1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        imagePullPolicy: Always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        args:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         - "-ssh"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         - "-repo=git@github.com:ddiiwoong/git-sync-demo.git"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         - "-root=/usr/share/nginx"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         - "-dest=html"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         - "-branch=master"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         - "-depth=1"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        volumeMounts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - name: git-sync-volume</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          mountPath: /usr/share/nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - name: git-secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          mountPath: /etc/git-secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: git-sync-volume</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        emptyDir: {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: git-secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        secret:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          secretName: git-creds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          defaultMode: 288 # = mode 0440</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      securityContext:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fsGroup: 65533 # to make SSH key readable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: git-sync-demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type: NodePort</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  selector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app: git-sync-demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - protocol: TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    port: 80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    targetPort: 80</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="í™•ì¸ì‚¬í•­">í™•ì¸ì‚¬í•­<a class="hash-link" href="#í™•ì¸ì‚¬í•­" title="Direct link to heading">â€‹</a></h3><p>ì¼ë‹¨ ngnixë¡œ 1.14-alpine Imageë¥¼ ê¸°ë³¸ìœ¼ë¡œ í•˜ê³  git-sync containerê°€ sidecarë¡œ ë“¤ì–´ê°€ë„ë¡ ì‘ì„±í•˜ì˜€ë‹¤.<br>
<!-- -->ì‹¤ì œ ë™ì‘í•˜ëŠ” ìˆœì„œëŒ€ë¡œ manifestë¥¼ ì•„ë˜ì„œë¶€í„° ì‚´í´ë³´ì.</p><ul><li>git-sync-volumeì€ <code>emptyDir</code>, git-secretì€ <code>secret</code> volume ì„¤ì •<div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: git-sync-volume</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      emptyDir: {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: git-secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      secret:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        secretName: git-creds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        defaultMode: 288 # = mode 0440</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li><li>sidecar container imageë¥¼ <code>k8s.gcr.io/git-sync:v3.1.1</code>ë¡œ ì„¤ì •</li><li><code>git-sync-volume</code>, <code>git-sync-volume</code> volumeì„ <code>git-sync</code> sidecarì— ë§ˆìš´íŠ¸</li><li>ìœ„ì—ì„œ ì´ì•¼ê¸°í•œ <code>git-sync</code> flag, argsë¡œ ì„¤ì •<div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: git-sync</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      image: k8s.gcr.io/git-sync:v3.1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      imagePullPolicy: Always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      args:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - "-ssh"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - "-repo=git@github.com:ddiiwoong/git-sync-demo.git"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - "-root=/usr/share/nginx"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - "-dest=html"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - "-branch=master"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       - "-depth=1"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      volumeMounts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: git-sync-volume</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mountPath: /usr/share/nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: git-secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mountPath: /etc/git-secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li><li>nginx ê¸°ë³¸ ìœ„ì¹˜ê°€ <code>/usr/share/nginx</code> ì´ë¯€ë¡œ mount ìœ„ì¹˜ë¥¼ git-sync-volumeìœ¼ë¡œ ì„¤ì •<div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      image: nginx:1.14-alpine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - containerPort: 80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      volumeMounts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: git-sync-volume</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mountPath: /usr/share/nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li></ul><p>ìœ„ nginxë¥¼ ë°°í¬í•˜ê³  ì ‘ì†í•˜ë©´ <code>Hello git-sync demo v1.0</code>ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><p>ê²°êµ­ git repo code (static html page)ëŠ” <code>/usr/share/nginx/html</code> ìœ„ì¹˜ì— clone ë˜ëŠ”ê²ƒì²˜ëŸ¼ ë³´ì´ì§€ë§Œ
ì‹¤ì œ clone ìœ„ì¹˜ë¥¼ í™•ì¸í•´ë³´ë©´ symbolic linkë¡œ íŠ¹ì • revision dirë¥¼ ê°€ë¦¬í‚¤ê³  ìˆë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl exec -it git-sync-demo-665c9c9ddf-6nwc4 sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Defaulting container name to nginx.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Use 'kubectl describe pod/git-sync-demo-665c9c9ddf-6nwc4 -n default' to see all of the containers in this pod.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/ # cd /usr/share/nginx/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/share/nginx # ls -al</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">total 16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxrwsrwx    4 root     nogroup       4096 Mar 21 06:54 .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x    1 root     root          4096 Mar  8 03:09 ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-sr-x    9 65533    nogroup       4096 Mar 21 06:54 .git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx    1 65533    nogroup         44 Mar 21 06:54 html -&gt; rev-07aa36f719091d75b5665203fa5846a549e7d540</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-sr-x    2 65533    nogroup       4096 Mar 21 06:54 rev-07aa36f719091d75b5665203fa5846a549e7d540</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/share/nginx # cat ./html/index.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;title&gt;Hello git-sync demo&lt;/title&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;h1&gt;Hello git-sync demo v1.0&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/html&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>githubì— ìˆëŠ” ìœ„ index.html ë‚´ìš©ì„ ìˆ˜ì •í•˜ê³  commitì„ í•˜ê²Œ ë˜ë©´ ì‹¤ì‹œê°„ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì´ revision ì •ë³´ ë° ë‚´ìš©ì´ ë°”ë€ê²ƒì„ í™•ì¸í• ìˆ˜ ìˆë‹¤.  </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">/usr/share/nginx # ls -al</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">total 16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxrwsrwx    4 root     nogroup       4096 Mar 21 13:40 .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x    1 root     root          4096 Mar  8 03:09 ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-sr-x    9 65533    nogroup       4096 Mar 21 13:40 .git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx    1 65533    nogroup         44 Mar 21 13:40 html -&gt; rev-b125908649135856d79c515c17decba68797a6cb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-sr-x    2 65533    nogroup       4096 Mar 21 13:40 rev-b125908649135856d79c515c17decba68797a6cb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/share/nginx # cat ./html/index.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;title&gt;Hello git-sync demo&lt;/title&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;h1&gt;Hello git-sync demo v1.1&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/html&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>git-syncë¥¼ ê°„ë‹¨í•˜ê²Œ í…ŒìŠ¤íŠ¸í•´ë´¤ë‹¤.<br>
<!-- -->ê°„ë‹¨í•˜ê²Œ <code>sidecar</code> ë°©ì‹ì˜ clone toolë¡œì„œ <code>git-sync</code>ë¥¼ í™œìš©í•˜ë©´ ì—¬ëŸ¬ê°€ì§€ë¡œ ì¶©ë¶„íˆ í™œìš©ì´ ê°€ëŠ¥í•  ê²ƒì´ë‹¤.<br>
<!-- -->í¬ìŠ¤íŒ…ì„ ì‘ì„±í•˜ë©´ì„œ ë– ì˜¤ë¥¸ í™œìš©ìš©ë„ë¥¼ ì •ë¦¬í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤. ì–´ì°Œë³´ë©´ sidecar patternì˜ í™œìš©ë°©ì•ˆì´ë¼ê³ ë„ ë³¼ìˆ˜ ìˆë‹¤.</p><ul><li>CDNì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  gitì—ì„œ ì†Œê·œëª¨ë¡œ ì»¨í…ì¸ ë¥¼ ê°€ì ¸ì˜¬ë•Œ</li><li>DBMSê°€ í•„ìš”ì—†ì„ ì •ë„ì˜ ì ì€ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ë•Œ</li><li>jekyllì´ë‚˜ hugo ê°™ì€ ì •ì  ì‚¬ì´íŠ¸(ë¸”ë¡œê·¸)ì˜ sidecar íŒ¨í„´ (GitPageì²˜ëŸ¼ markdownì„ ì¶”ê°€í•˜ê³  git commití•˜ë©´ ë°”ë¡œ ì‚¬ì´íŠ¸ì— ë°˜ì˜ë˜ëŠ” ë°©ì‹)</li><li>nginx, haproxy, apacheì™€ ê°™ì´ config ë³€ê²½ì´ í•„ìš”í• ë•Œ webhookë°©ì‹ìœ¼ë¡œ ì„¤ì •ì„ ë³€ê²½í•œí›„ podë¥¼ ì¬ê¸°ë™í•˜ëŠ” GitOps êµ¬í˜„</li></ul>]]></content>
        <category label="git-sync" term="git-sync"/>
        <category label="GitOps" term="GitOps"/>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="ssh git" term="ssh git"/>
        <category label="sidecar" term="sidecar"/>
        <category label="sidecar pattern" term="sidecar pattern"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[VScode Server]]></title>
        <id>tools/vscode-server/</id>
        <link href="https://ddii.dev/tools/vscode-server/"/>
        <updated>2019-03-20T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[code-serverë¥¼ ì‚¬ìš©í•˜ì—¬ ë¡œì»¬ VScode ì„¤ì¹˜ì—†ì´ ì›ê²© í™˜ê²½ì—ì„œ ì‚¬ìš©í•´ë³´ì.]]></summary>
        <content type="html"><![CDATA[<p>IntelliJ IDEAë¥¼ ì‚¬ìš©í•˜ë‹¤ê°€ ê°œë°œì—…ë¬´ë¥¼ ê±°ì˜ ì†ë†“ë‹¤ì‹œí”¼ í•˜ë‹¤ë³´ë‹ˆ ë¼ì´ì„¼ìŠ¤ë¥¼ ì—°ì¥í•˜ì§€ ëª»í•˜ê²Œ ë˜ì—ˆê³  ì£¼ë¡œ Localì—ì„œ VScodeë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤. í˜„ì¬ ë¶€ì„œì™€ ì—…ë¬´ë„ ë°”ë€Œì—ˆê³  ì›Œë‚™ ê³ ê°€ë‹¤ë³´ë‹ˆ IDEë¥¼ ë¶€ì„œë¹„ë¡œ êµ¬ë§¤í•˜ë„ ì–´ë µë‹¤. ë­ ì–¼ë§ˆë‚˜ í•œë‹¤ê³  ë§í• ìˆ˜ë„ ìˆê² ì§€ë§Œ ì—…ë¬´íŠ¹ì„±ìƒ ê°œë°œíˆ´ì„ ì‚¬ë‹¬ë¼ê³  í• ìˆ˜ ì—†ê³  ìµœê·¼ í¬ë¡¬ë¶ì´ë‚˜ ì•„ì´íŒ¨ë“œ í”„ë¡œê°™ì€ íƒœë¸”ë¦¿ì„ ê°€ì§€ê³  ë‹¤ë‹ˆì‹œëŠ” ë¶„ë“¤ë„ ë§ê³  ë‹¨ìˆœ í•„ê¸°ë‚˜ ë©”ëª¨ê°€ ì•„ë‹Œ ì˜¨ë¼ì¸ í™˜ê²½ì—ì„œ ë¸”ë¡œê¹… í¬ìŠ¤íŒ… ì •ë„ëŠ” í• ìˆ˜ ìˆë‹¤ëŠ” ê°€ì •ìœ¼ë¡œ Web IDEë¥¼ êµ¬ì„±í•˜ëŠ” í¬ìŠ¤íŒ…ì„ ì‹œì‘í•´ë³¸ë‹¤. </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="web-ide">Web IDE<a class="hash-link" href="#web-ide" title="Direct link to heading">â€‹</a></h2><p>ì´ë²ˆ í¬ìŠ¤íŒ…ì„ ì“°ê¸° ì‹œì‘í•˜ë©´ì„œ 2017ë…„ AWS re;inventì—ì„ ê°€ Cloud9 ì œí’ˆì´ ì¶œì‹œë˜ì–´ì„œ Lambdaì—ì„œ ì‚¬ìš©í–ˆë˜ ì¥ë©´ì´ ê°‘ìê¸° ë– ì˜¬ëë‹¤. Cloud 9ì€ <a href="https://github.com/c9/core" target="_blank" rel="noopener noreferrer">https://github.com/c9/core</a>ë¥¼ ê¸°ë°˜ìœ¼ë¡œ instanceë¥¼ ë„ëŠ”ê²ƒì„ ê¸°ë³¸ìœ¼ë¡œ í•œë‹¤. Lambdaì˜ ê¸°ë³¸ ì—ë””í„°ë„ ë‚˜ì˜ì§„ ì•Šì§€ë§Œ Cloud9ì—ì„œ ê°•ì¡°í•˜ëŠ” ë¶€ë¶„ì€ ì½”ë“œ í˜‘ì—…ì´ë‹¤. </p><p><img loading="lazy" src="https://d1.awsstatic.com/product-marketing/Tulip/C9-Collab-Image@3x.e03a65d9488633c154358430540ab363dd1e8f45.png" alt="cloud9" class="img_E7b_"></p><p>AWSì—ì„œ ì„œë¹„ìŠ¤ë¡œ ì¶œì‹œë˜ê¸° ì´ì „ì—ë„ Dockerhubì—ì„œë„ ì¢…ì¢… í™•ì¸í• ìˆ˜ ìˆì—ˆì§€ë§Œ í˜„ì¬ëŠ” ì°¾ì•„ë³´ê¸° ì–´ë µë‹¤. </p><p>êµ­ë‚´ì—ëŠ” Cloud í˜•íƒœë¡œ <a href="https://ide.goorm.io/" target="_blank" rel="noopener noreferrer">GoormIDE</a> ì œí’ˆì´ ìˆë‹¤.<br>
<!-- -->Free ì—ë””ì…˜ë„ ìˆìœ¼ë‹ˆ ë”°ë¡œ í™•ì¸í•´ë³´ë©´ ëœë‹¤. (ì‘ì›í•©ë‹ˆë‹¤!)</p><p>ì´ì™¸ì—ë„ <a href="https://github.com/theia-ide/theia" target="_blank" rel="noopener noreferrer">https://github.com/theia-ide/theia</a>, <a href="https://github.com/codercom/code-server" target="_blank" rel="noopener noreferrer">https://github.com/codercom/code-server</a>ì™€ ê°™ì€ Webê¸°ë°˜ ì˜¤í”ˆì†ŒìŠ¤ê°€ ì¡´ì¬í•˜ê³  ë‘˜ë‹¤ ìƒìš©ì´ë‚˜ Betaí˜•íƒœë¡œ ì„œë¹„ìŠ¤ ì¤‘ì´ë‹¤. </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="code-server">code-server<a class="hash-link" href="#code-server" title="Direct link to heading">â€‹</a></h2><p><a href="https://github.com/codercom/code-server" target="_blank" rel="noopener noreferrer">code-server</a>ëŠ” ì›ê²©ì„œë²„ í˜•íƒœë¡œ ë™ì‘í•˜ëŠ” ë¸Œë¼ìš°ì € ê¸°ë°˜ <a href="https://github.com/Microsoft/vscode" target="_blank" rel="noopener noreferrer">VSCode</a> IDEì´ë‹¤.</p><p>ê·¸ëŸ°ë° ì™œ êµ¬ì§€ VScode ì„¤ì¹˜í˜•ì„ ëƒ…ë‘ê³  Serverë¡œ êµ¬ë™í•˜ëŠëƒ? ì•„ë˜ì™€ ê°™ì´ ì„¤ëª…í•˜ê³  ìˆë‹¤.</p><ul><li>Chromebook, Table(IPAD) ì—ì„œ Coding ê°€ëŠ¥</li><li>ì €ì‚¬ì–‘ Clientì—ì„œë„ Cloud ê¸°ë°˜ Serverì˜ ì´ì  ì‚¬ìš©ê°€ëŠ¥</li><li>Battery! (ì œì¼ ì¤‘ìš”í¬ì¸íŠ¸) </li></ul><p>êµ¬ë™ë°©ì‹ì€ ì—¬ëŸ¬ë°©ì‹ì´ ì¡´ì¬í•œë‹¤. </p><ul><li>Hosted : <a href="https://coder.com/" target="_blank" rel="noopener noreferrer">coder</a> - Enterprise </li><li>Docker<div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ docker run -t -p 127.0.0.1:8443:8443 -v "${PWD}:/root/project" codercom/code-server code-server --allow-http --no-auth</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li><li>Bianry<div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ code-server &lt;initial directory to open&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="code-server-kubernetesì—-ë°°í¬">code-server kubernetesì— ë°°í¬<a class="hash-link" href="#code-server-kubernetesì—-ë°°í¬" title="Direct link to heading">â€‹</a></h2><p>ê³µì‹ <a href="https://hub.docker.com/r/codercom/code-server" target="_blank" rel="noopener noreferrer">Image</a>ì™€ <a href="https://github.com/codercom/code-server/blob/master/Dockerfile" target="_blank" rel="noopener noreferrer">Dockerfile</a>ëŠ” í•´ë‹¹ ë§í¬ë¥¼ ì°¸ì¡°í•œë‹¤.
ì‚´ì§ ë³€ê²½í•´ì„œ ì¬ë¹Œë“œí•˜ë ¤ê³  í–ˆëŠ”ë° ë§¥ë¶ ë©”ëª¨ë¦¬ê°€ ë¶€ì¡±í•œì§€ <code>yarn build</code>í• ë•Œ <code>Serve fails with Error Code 137</code> ê°€ ë°œìƒí•˜ì˜€ë‹¤. ì´ë¬¸ì œëŠ” ë‚˜ì¤‘ì— í•´ê²°í•˜ê¸°ë¡œ í•˜ê³  ì¼ë‹¨ ë°°í¬í•˜ì.  </p><p>ë¡œì»¬ minikubeì—ì„œ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´<br>
<a href="https://github.com/codercom/code-server/blob/master/deployment/deployment.yaml" target="_blank" rel="noopener noreferrer">https://github.com/codercom/code-server/blob/master/deployment/deployment.yaml</a> ì—ì„œ ClusterIPë¥¼  NodePortë¡œ ìˆ˜ì •í•˜ê³  íŒ¨ìŠ¤ì›Œë“œë¥¼ ë¡œê·¸ì—ì„œ í™•ì¸í•˜ì§€ ì•Šê³  ì‚¬ìš©í• ìˆ˜ ìˆë„ë¡ <code>1234</code>ë¡œ ì„¤ì •í•˜ê³  ë°°í¬í•œë‹¤. </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="deploymentyaml">deployment.yaml<a class="hash-link" href="#deploymentyaml" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: code-server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> name: code-server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> namespace: code-server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - port: 8443</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   name: https</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   protocol: TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> selector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   app: code-server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> type: NodePort</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: extensions/v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app: code-server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: code-server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: code-server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  selector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    matchLabels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      app: code-server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  replicas: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  template:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        app: code-server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - image: codercom/code-server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        imagePullPolicy: Always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        name: code-server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - containerPort: 8443</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name: https</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        args:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         - "--password=1234"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create -f deployment.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´í›„ ì„œë¹„ìŠ¤ í™•ì¸ ë° minikube serviceë¡œ expose ì‹œí‚¨ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get svc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME          TYPE       CLUSTER-IP      EXTERNAL-IP   PORT(S)          AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">code-server   NodePort   10.111.206.64   &lt;none&gt;        8443:32665/TCP   15m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ minikube service code-server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ minikube service list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-------------|---------------|-----------------------------|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  NAMESPACE  |     NAME      |             URL             |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-------------|---------------|-----------------------------|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| code-server | code-server   | http://192.168.99.102:32665 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| default     | git-sync-demo | http://192.168.99.102:31595 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| default     | kubernetes    | No node port                |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| kube-system | kube-dns      | No node port                |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|-------------|---------------|-----------------------------|</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í•´ë‹¹ URLë¡œ ì ‘ì†í•˜ì—¬ íŒ¨ìŠ¤ì›Œë“œ <code>1234</code>ë¥¼ ì…ë ¥í•˜ë©´ vscodeê°€ ì›ê²©ìœ¼ë¡œ ì‹¤í–‰ëœ ê²ƒì„ í™•ì¸í• ìˆ˜ ìˆë‹¤.
<img loading="lazy" alt="vscode" src="/assets/images/vscode-9cbf83b87dd9237022b17c9f3a7c07b2.png" width="1810" height="1263" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ì‹¤ì œ ì‚¬ìš©ì„ í•´ë³´ë©´ ì•„ì§ ë²„ê·¸ê°€ ë§ë‹¤. ì• ë“œì˜¨ì´ë‚˜ í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜ì‹œ ì œëŒ€ë¡œ ë™ì‘ì„ í•˜ì§€ ì•ŠëŠ” ê²½ìš°ë„ ìˆì—ˆê³ 
<a href="https://github.com/kubernetes/git-sync" target="_blank" rel="noopener noreferrer">git-sync</a> í”„ë¡œì íŠ¸ì™€ ì—°ë™ì„ í†µí•´ ì‹¤ì œ gitOPSë¥¼ êµ¬í˜„í•´ë³´ê³ ì í•˜ì˜€ìœ¼ë‚˜ ë°°í¬í›„ì— mountëœ repository volumeì— ë³€ê²½ì‚¬í•­ì´ ë°œìƒì‹œ ê°‘ìê¸° UIê°€ ë¨¹í†µì´ ë˜ëŠ” ê²½ìš°ê°€ ë°œìƒí•˜ê¸°ë„ í•˜ì˜€ë‹¤. Kubernetesí”Œë«í¼ì„ ê°œë°œìì—ê²Œ PaaSí˜•íƒœë¡œ ì œê³µí•˜ëŠ” ê²½ìš° webIDEì˜ ì¢‹ì€ ì˜µì…˜ì´ ë ìˆ˜ ìˆì„ê²ƒ ê°™ë‹¤.</p>]]></content>
        <category label="vscode" term="vscode"/>
        <category label="code-server" term="code-server"/>
        <category label="kubernetes" term="kubernetes"/>
        <category label="online coding" term="online coding"/>
        <category label="GoormIDE" term="GoormIDE"/>
        <category label="Cloud9" term="Cloud9"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[K3s on Raspberry Pi Cluster]]></title>
        <id>kubernetes/k3s-homelab/</id>
        <link href="https://ddii.dev/kubernetes/k3s-homelab/"/>
        <updated>2019-03-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ” k3së¥¼ ë¼ì¦ˆë² ë¦¬íŒŒì´ í´ëŸ¬ìŠ¤í„°ì— ì˜¬ë ¤ë³´ê³  í™œìš©ë°©ì•ˆì— ëŒ€í•´ì„œ ê³ ë¯¼í•´ë³¸ë‹¤]]></summary>
        <content type="html"><![CDATA[<p>ì´ë²ˆì—ëŠ” ê²½ëŸ‰ Kubernetesë¼ê³  ì´ì•¼ê¸°í•˜ëŠ” <a href="https://github.com/rancher/k3s" target="_blank" rel="noopener noreferrer">K3s</a>ë¥¼ Raspberry Pi í´ëŸ¬ìŠ¤í„°ìƒì— êµ¬ë™í•˜ë ¤ê³  í•œë‹¤.
ìˆœìˆ˜í•˜ê²Œ ê°œì¸ì˜ê²¬ìœ¼ë¡œ ì‘ì„±í•˜ì˜€ê³  ì ˆëŒ€ ì œí’ˆì´ë‚˜ ë¶€í’ˆí™ë³´ë¥¼ í•˜ê³ ì í•˜ëŠ” ì˜ë„ëŠ” ì „í˜€ ì—†ë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="k3s">K3s?<a class="hash-link" href="#k3s" title="Direct link to heading">â€‹</a></h2><p><strong>K3s</strong>ëŠ” Rancher Labì—ì„œ ìµœì†Œìì›ì„ ì‚¬ìš©í•˜ëŠ” Kubernetes í´ëŸ¬ìŠ¤í„° êµ¬ì„±ì„ ìœ„í•œ ì†”ë£¨ì…˜ìœ¼ë¡œ ì‹œì‘ë˜ì—ˆê³  2019ë…„ 3ì›” 12ì¼ í˜„ì¬ 0.2ë²„ì „ì´ ë¦´ë¦¬ì¦ˆëœ ìƒíƒœì´ë‹¤. ë°”ì´ë„ˆë¦¬ ì „ì²´ê°€ 40mbê°€ ë˜ì§€ ì•Šê³  ì„¤ì¹˜ê°€ ì‰½ë‹¤ëŠ” ì ì—ì„œ ìµœê·¼ íŠ¸ìœ„í„° ìƒì—ì„œ ì´ìŠˆê°€ ë˜ê³  ìˆëŠ” í”„ë¡œì íŠ¸ë¼ê³  í•  ìˆ˜ ìˆë‹¤. </p><p>ì£¼ë¡œ Edge, IoT ë“± ì €ì „ë ¥, ì €ì‚¬ì–‘ ê¸°ë°˜ ARMê³„ì—´ ì»´í“¨íŒ…ì— ìµœì í™” ë˜ì–´ ìˆê³  ì‹¤ì œ ì‹¤í—˜ì ì´ê¸´ í•˜ì§€ë§Œ ê°„ë‹¨í•œ ê¸°ëŠ¥ì´ë‚˜ baremetal ê¸°ë°˜ í´ëŸ¬ìŠ¤í„° í…ŒìŠ¤íŠ¸ë¥¼ ì§‘ì—ì„œ í•´ë³´ê¸°ì—ëŠ” ë”± ì¢‹ì€ í”„ë¡œì íŠ¸ë¼ í•  ìˆ˜ ìˆë‹¤. ì´ë¯¸ vSphere, OpenStackê¸°ë°˜ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ëŠ” ì°¨ê³  ë„˜ì¹˜ê²Œ í•´ë´¤ì§€ë§Œ ì¼ë‹¨ ë¬¼ë¦¬ì ì¸ ì¼€ì´ìŠ¤ë¶€í„° ë³´ê³ ë‚˜ë©´ í•˜ë“œì›¨ì–´ë¥¼ ì¢‹ì•„í•˜ëŠ” ì‚¬ëŒë“¤ì—ê²ŒëŠ” ì•„ì£¼ ì¬ë¯¸ìˆëŠ” ì¥ë‚œê°ì´ ì•„ë‹ìˆ˜ ì—†ì„ ê²ƒì´ë‹¤. </p><p><a href="https://github.com/rancher/k3s" target="_blank" rel="noopener noreferrer">K3s Github</a> ìƒì„¸ ì„¤ëª…ì— ë³´ë©´ Cloud Provider, Storage Pluginì€ ì œê±°í•˜ì˜€ê³   default ì €ì¥ì†Œê°€ <code>etcd</code>ê°€ ì•„ë‹Œ <code>sqlite3</code>ìœ¼ë¡œ ë˜ì–´ìˆë‹¤ê³  í•œë‹¤. </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì‚¬ì „-ì¤€ë¹„ì‚¬í•­">ì‚¬ì „ ì¤€ë¹„ì‚¬í•­<a class="hash-link" href="#ì‚¬ì „-ì¤€ë¹„ì‚¬í•­" title="Direct link to heading">â€‹</a></h2><ul><li><p>ìµœì†Œ 2ê°œ ì´ìƒì˜ Raspberry Pi 2B/3B/3B+, 4ea<br>
<!-- -->ì˜¤í”ˆë§ˆì¼“ì—ì„œ í• ì¸ì¿ í° ì ìš©í•´ì„œ Raspberry Pi 3B+, 4eaë¥¼ <code>166,820ì›</code>(ëŒ€ë‹¹ 42,000ì›) ì •ë„ì— êµ¬ë§¤í•˜ì˜€ë‹¤.<br>
<!-- -->ìµœì €ê°€ ê²€ìƒ‰ìœ¼ë¡œ ëŒ€ë‹¹ 46,000ì› ì •ë„ í–ˆë˜ê²ƒ ê°™ë‹¤. </p></li><li><p>Stackable Case<br>
<a href="https://www.amazon.com/gp/product/B07CTG5N3V/ref=ppx_yo_dt_b_asin_title_o00_s00?ie=UTF8&amp;psc=1" target="_blank" rel="noopener noreferrer">iUniker Raspberry Pi Cluster Case</a> ê°•ì¶”!! (ê°œì¸ì ìœ¼ë¡œ ì¿¨ëŸ¬ì™€ ë””ìì¸ì´ ë§˜ì— ë“¬)<br>
<!-- -->ë°°ì†¡ë¹„í¬í•¨ 29.19ë‹¬ëŸ¬, ì•½ <code>33,000ì›</code></p></li><li><p>micro SDHC 4ea<br>
<!-- -->16GBë¡œë„ ì¶©ë¶„í•˜ì§€ë§Œ ì‚¼ì„±ì „ì micro SDHC CLASS10 UHS-I EVO (32GB), 4eaë¥¼ ì˜¤í”ˆë§ˆì¼“ì—ì„œ ì‚¬ê²Œë˜ë©´ ë°°ì†¡ë£Œ í¬í•¨í•´ì„œ 8,500ì› * 4ea = <code>34,000ì›</code>ì— êµ¬ë§¤ê°€ ê°€ëŠ¥í•˜ë‹¤. ì˜¤í”ˆë§ˆì¼“ì—ì„œëŠ” ê°œë‹¹ ë°°ì†¡ë£Œë¥¼ ë‚´ì•¼í•œë‹¤. í•˜ì§€ë§Œ ì¿ íŒ¡ì—ì„œëŠ” 2eaë¥¼ ë¡œì¼“ë°°ì†¡ìœ¼ë¡œ 15,380ì›ì— êµ¬ë§¤ê°€ ê°€ëŠ¥í•˜ë¯€ë¡œ ì•½ <code>31,000ì›</code>ì— 4ê°œë¥¼ êµ¬ë§¤í• ìˆ˜ ìˆë‹¤. </p></li><li><p>ë©€í‹°ì¶©ì „ê¸°<br>
<!-- -->1ë§Œì›ëŒ€ í›„ë°˜ì—ì„œ 2ë§Œì› ì´ˆë°˜ì´ë©´ 6í¬íŠ¸ ì¶©ì „ê¸°ë¥¼ êµ¬ë§¤í• ìˆ˜ ìˆëŠ”ë° êµ¬ë§¤í–ˆë˜ ê°€ì¥ í° ê¸°ì¤€ì€ Pi 4ëŒ€ë¥¼ ë™ì‹œì— 2.5A ì „ë¥˜ë¥¼ ì•ˆì •ì ìœ¼ë¡œ ê³µê¸‰í•˜ë ¤ë©´ ìµœëŒ€ 10Aë¥¼ ì§€ì›í•˜ëŠ” ë©€í‹° ì¶©ì „ê¸°ë¥¼ ì‚¬ì•¼í–ˆì—ˆê³  4-5í¬íŠ¸ ì§œë¦¬ ì¶©ì „ê¸°ë“¤ì€ ëŒ€ë¶€ë¶„ ìµœëŒ€ ì „ë¥˜ê°€ 8Aë¡œ ì¶©ì¡±í•˜ì§€ ëª»í•´ 4í¬íŠ¸ë§Œ ì‚¬ìš©í•˜ë”ë¼ë„ ì•ˆì •ì ì¸ ì „ë¥˜ ê³µê¸‰ì„ ìœ„í•´ 6í¬íŠ¸ ì¶©ì „ê¸°ë¡œ ì„ íƒí•˜ì˜€ë‹¤.<br>
<!-- -->ì¿ íŒ¡ ë¡œì¼“ë°°ì†¡ - í¬*ì§€ ê°€ì •ìš© 6í¬íŠ¸ ê¸‰ì† ë©€í‹° ì¶©ì „ê¸°, <code>22,900ì›</code></p></li><li><p>micro 5pin 20cm 2.4A ì§€ì› ì¼€ì´ë¸” 4ea<br>
<!-- -->Pi ê¶Œì¥ ì „ë¥˜ê°€ 2.5Aë¼ê³  í–ˆì§€ë§Œ 2.4A, 3A ì§œë¦¬ì¤‘ì— ì €ë ´í•œ 2.4A ì§€ì› ìˆì¼€ì´ë¸”ë¡œ êµ¬ë§¤í•˜ì˜€ë‹¤.<br>
<!-- -->ì˜¤í”ˆë§ˆì¼“ì—ì„œ ë°°ì†¡ë£Œ í¬í•¨, <code>7800ì›</code></p></li><li><p>UTP Cat5e 30cm ì¼€ì´ë¸” 4ea<br>
<!-- -->ê·¸ëƒ¥ ì œì¼ì‹¼ê±¸ë¡œ ì˜¤í”ˆë§ˆì¼“ì—ì„œ ë°°ì†¡ë£Œ í¬í•¨ <code>4,100ì›</code>ì— êµ¬ë§¤í•˜ì˜€ë‹¤.</p></li><li><p>ê¸°ê°€ë¹„íŠ¸ ì§€ì›ë˜ëŠ” 5í¬íŠ¸ ì´ìƒ ìŠ¤ìœ„ì¹˜ í—ˆë¸Œ(ê³µìœ ê¸°)<br>
<!-- -->ì§‘ì— ìˆë˜ ê³µìœ ê¸° í™œìš© (iptime A1004) í•˜ì˜€ì§€ë§Œ ìµœì € 5í¬íŠ¸ ì´ìƒ ìŠ¤ìœ„ì¹˜ í—ˆë¸Œì¤‘ ì œì¼ ì‹¼ ëª¨ë¸ì€ <code>16,000ì›</code>ëŒ€ë¡œ ê°€ê²© í˜•ì„±ì¤‘ì´ë‹¤. </p></li></ul><p>ì‹¤ì œ ìœ„ ìŠ¤í™ìœ¼ë¡œ ëŒ€ì¶© êµ¬ë§¤ë¥¼ ì§„í–‰í•˜ê²Œ ë˜ë©´ 18.4 + 3.3 + 3.1 + 2.3 + 0.8 + 0.4 + 1.6 = <code>29.9ë§Œì›</code> ì •ë„ ì†Œìš”ê°€ ë  ê²ƒìœ¼ë¡œ ì˜ˆìƒëœë‹¤. ì§‘ì— êµ´ëŸ¬ë‹¤ëŠ” ë¶€í’ˆì´ë‚˜ ì¶©ì „ê¸°, ì¼€ì´ë¸”, SDì¹´ë“œë“¤ì„ í™œìš©í•˜ë©´ <code>25ë§Œì›</code> ì´ë‚´ë¡œë„ ì¶©ë¶„íˆ ê°€ëŠ¥í•˜ë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="êµ¬ë§¤-ì œí’ˆ-ì¡°ë¦½">êµ¬ë§¤ ì œí’ˆ ì¡°ë¦½<a class="hash-link" href="#êµ¬ë§¤-ì œí’ˆ-ì¡°ë¦½" title="Direct link to heading">â€‹</a></h2><p>ì¡°ë¦½ì€ ê·¸ë‹¤ì§€ ì–´ë µì§€ ì•Šì€ë° ì¼€ì´ìŠ¤ êµ¬ë§¤ì‹œ ì œê³µë˜ëŠ” ë°©ì—´íŒ(CPU, GPU, RAM)ì„ ê¼¼ê¼¼í•˜ê²Œ ë¶™ì´ê³  ì¿¨ëŸ¬ë¥¼ GPIOì— ì—°ê²°í•œë‹¤.<br>
<!-- -->ê·¸ë ‡ê²Œ ì–´ë ¤ìš´ ì ì€ ì—†ì§€ë§Œ ë³¸ì²´ë¥¼ ì¼€ì´ìŠ¤ì— ê³ ì •í• ë•Œ ë„ˆíŠ¸ê°€ ì‘ì•„ ì†ì´ í° ì‚¬ëŒì€ ì¡°ê¸ˆ í˜ë“¤ ìˆ˜ë„ ìˆì„ ê²ƒ ê°™ë‹¤. </p><p>ì¼€ì´ìŠ¤ì˜ CPU ì¿¨ëŸ¬ê°€ í™”ë£¡ì ì •ì´ë‹¤.</p><p><img loading="lazy" alt="cases" src="/assets/images/cases-614af9823c3d08feb1cdfd6feecda887.jpg" width="1224" height="689" class="img_E7b_"><br>
<img loading="lazy" alt="heat" src="/assets/images/heat-7b312fa5a5ca45bc55e98323ffdbb690.jpg" width="689" height="1224" class="img_E7b_"><br>
<img loading="lazy" alt="cooler" src="/assets/images/cooler-01a1339b8c2d113ec8cdd527cd9a51f8.jpg" width="1224" height="689" class="img_E7b_">
<img loading="lazy" alt="3stack" src="/assets/images/3stack-c5510bb36fd5f49a56c318a4a175f3fb.jpg" width="1224" height="689" class="img_E7b_">
<img loading="lazy" alt="charger" src="/assets/images/charger-fbc5086db8ea25c819ef915b0f298f5e.jpg" width="1224" height="689" class="img_E7b_">
<img loading="lazy" alt="full" src="/assets/images/fullstack-a0ea32c22662582ec85641753804eaf0.jpg" width="1224" height="689" class="img_E7b_">
<img loading="lazy" alt="complete" src="/assets/images/complete-8db0eac9257463f0ad669a0bc12541ef.jpg" width="1224" height="689" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="os-ì„¤ì¹˜">OS ì„¤ì¹˜<a class="hash-link" href="#os-ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h2><p>SDì¹´ë“œì— ì„¤ì¹˜ëŠ” MacOSìƒì—ì„œ ì§„í–‰í•˜ì˜€ë‹¤.</p><p><a href="https://www.raspberrypi.org/downloads/raspbian/" target="_blank" rel="noopener noreferrer">Raspbian Lite</a>ë¥¼ ë‚´ë ¤ë°›ì•„ <a href="https://www.balena.io/etcher/" target="_blank" rel="noopener noreferrer">Etcher</a>ë¥¼ ì‚¬ìš©í•˜ì—¬ OSë¥¼ ì„¤ì¹˜í•œë‹¤. </p><p>ìì„¸í•œ ì¶”ê°€ì ì¸ ì„¤ì¹˜ë°©ë²•ì€ ë‹¤ìŒ ë§í¬ë¥¼ í†µí•´ì„œë„ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤.<br>
<a href="https://www.raspberrypi.org/documentation/installation/installing-images/README.md" target="_blank" rel="noopener noreferrer">Installing operating system images</a>  </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="í™˜ê²½-ì„¤ì •">í™˜ê²½ ì„¤ì •<a class="hash-link" href="#í™˜ê²½-ì„¤ì •" title="Direct link to heading">â€‹</a></h2><p>Macì—ì„œëŠ” <code>/Volumes/boot</code>ì— ë§ˆìš´íŠ¸ê°€ ëœë‹¤. OSë§ˆë‹¤ ë‹¤ë¥´ì§€ë§Œ Linuxì—ì„œëŠ” <code>/mnt/boot</code>, Windowsì—ì„œëŠ” <code>boot</code> ë¡œ ë§ˆìš´íŠ¸ê°€ ëœë‹¤.</p><p>SSH Service ìë™ í™œì„±í™”ë¥¼ ìœ„í•´ ìœ„ OSë³„ mountëœ root ê²½ë¡œì— ssh ë¹ˆ íŒŒì¼ì„ ìƒì„±í•˜ê²Œ ë˜ë©´ rebootì´í›„ì— SSH ì ‘ì†ì´ ê°€ëŠ¥í•´ì§„ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo touch /Volumes/boot/ssh</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë˜í•œ container ì‚¬ìš©ì„ ìœ„í•´ rootê²½ë¡œì˜ <code>cmdline.txt</code> íŒŒì¼ ë§ˆì§€ë§‰ì— cgroup ì„¤ì •ì„ ì¶”ê°€í•œë‹¤.  </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cgroup_memory=1 cgroup_enable=memory</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>SDì¹´ë“œë¥¼ ë§Œë“¤ê³  ê°ê°ì˜ Piì— ì¥ì°©í›„ì— UTPì¼€ì´ë¸”ê³¼ ì „ì›ì„ ëª¨ë‘ ì—°ê²°í•œë‹¤.
ë¶€íŒ…ì´ ì™„ë£Œë˜ë©´ default id/pass ì¸ <code>pi/raspberry</code>ë¡œ ë¡œê·¸ì¸ í•˜ê³  <code>sudo raspi-config</code> ë¥¼ í†µí•´ íŒ¨ìŠ¤ì›Œë“œ ë³€ê²½, hostname ì„¤ì •, GPU memory split ì„¤ì • ë“±ì„ ì™„ë£Œí•˜ì.<br>
<!-- -->ë‚˜ì¤‘ì—ëŠ” PXE booting ë° ansible ìë™í™”ë¡œ êµ¬í˜„í•˜ë©´ ë¬´ì¸í™˜ê²½ ì„¤ì¹˜ê°€ ê°€ëŠ¥í• ê²ƒ ê°™ë‹¤. (Edge Computing)</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Raspberry Pi Software Configuration Tool (raspi-config) â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚                                                                                                  â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚        1 Change User Password Change password for the current user                               â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚        2 Network Options      Configure network settings                                         â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚        3 Boot Options         Configure options for start-up                                     â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚        4 Localisation Options Set up language and regional settings to match your location       â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚        5 Interfacing Options  Configure connections to peripherals                               â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚        6 Overclock            Configure overclocking for your Pi                                 â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚        7 Advanced Options     Configure advanced settings                                        â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚        8 Update               Update this tool to the latest version                             â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚        9 About raspi-config   Information about this configuration tool                          â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚                                                                                                  â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚                                                                                                  â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚                                                                                                  â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚                           &lt;Select&gt;                           &lt;Finish&gt;                            â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚                                                                                                  â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ul><li>1 Change User Password</li><li>2 Network Options - hostname<ul><li>k3s-master, k3s-slave-01, k3s-slave-02, k3s-slave-03</li></ul></li><li>4 Localisation Options - TimeZone<ul><li>Asia, Seoul</li></ul></li><li>7 Advanced Options - GPU Memory split <ul><li>16mb</li></ul></li></ul><p>ëª¨ë‘ ì™„ë£Œê°€ ë˜ì—ˆìœ¼ë©´ pië“¤ì„ ì¬ê¸°ë™í•˜ì.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo reboot</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="k3s-í´ëŸ¬ìŠ¤í„°-ìƒì„±">k3s í´ëŸ¬ìŠ¤í„° ìƒì„±<a class="hash-link" href="#k3s-í´ëŸ¬ìŠ¤í„°-ìƒì„±" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="server-ê¸°ë™">Server ê¸°ë™<a class="hash-link" href="#server-ê¸°ë™" title="Direct link to heading">â€‹</a></h3><p>armhf(arm hard float) ì§€ì›ì´ ë˜ëŠ” ìµœì‹  ë¦´ë¦¬ì¦ˆ v0.2.0ë¥¼ ë‹¤ìš´ë°›ëŠ”ë‹¤.  </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ wget -O k3s https://github.com/rancher/k3s/releases/download/v0.2.0/k3s-armhf &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  chmod +x k3s &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  sudo mv k3s /usr/local/bin/k3s</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Master node ê¸°ë™ (ë°±ê·¸ë¼ìš´ë“œ)</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo k3s server &amp;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í•´ë‹¹ nodeë¥¼ Control plane í˜•íƒœë¡œ ë¶„ë¦¬ì‹œì¼œ workloadì—ì„œ ì œì™¸í•˜ë ¤ë©´ <code>--disable-agent</code> ì˜µì…˜ì„ ì‚¬ìš©í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&amp; k3s server --disable-agent</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì •ìƒì ìœ¼ë¡œ k3s ê¸°ë™ì´ ì™„ë£Œë˜ë©´ <code>/etc/rancher/k3s/k3s.yaml</code>ì—ì„œ Kubeconfigë¥¼ í™•ì¸í• ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ê³  node ìƒíƒœë„ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo k3s kubectl get nodes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME          STATUS   ROLES    AGE   VERSION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">k3s-master    Ready    &lt;none&gt;   21h   v1.13.4-k3s.1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="node-ì¶”ê°€">node ì¶”ê°€<a class="hash-link" href="#node-ì¶”ê°€" title="Direct link to heading">â€‹</a></h3><p><code>/var/lib/rancher/k3s/server/manifests</code> ì—ì„œ TOKENì„ í™•ì¸í•œë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo cat /var/lib/rancher/k3s/server/node-token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">K100fa5235031f2b8e92e01b8bd3255142422a7aeaa47657ad4c68969d35cddbf3a::node:431342ac6204466e8f81445edb8c2e3a</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>worker nodeì— ì ‘ì†í•œë‹¤ìŒ ë™ì¼í•˜ê²Œ ìµœì‹  ë¦´ë¦¬ì¦ˆ v0.2.0ë¥¼ ë‹¤ìš´ë°›ëŠ”ë‹¤.  </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ wget -O k3s https://github.com/rancher/k3s/releases/download/v0.2.0/k3s-armhf &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  chmod +x k3s &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  sudo mv k3s /usr/local/bin/k3s</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ì—ì„œ ë‚˜ì˜¨ TOKENê°’ê³¼ Kube API Endpointì •ë³´ë¡œ nodeë“¤ì„ ì°¨ë¡€ë¡œ ì¶”ê°€ ì‹œí‚¤ë©´ ëª¨ë“  ì‘ì—…ì´ ì™„ë£Œëœë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ export NODE_TOKEN="K100fa5235031f2b8e92e01b8bd3255142422a7aeaa47657ad4c68969d35cddbf3a::node:431342ac6204466e8f81445edb8c2e3a"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ export MASTER_IP="https://192.168.0.14:6443"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo k3s agent --server https://${MASTER_IP}:6443 --token ${NODE_TOKEN} &amp;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì™„ì„±ëœ í´ëŸ¬ìŠ¤í„°ë¥¼ í™•ì¸í•œë‹¤. ì™¸ë¶€ ë¡œì»¬ì—ì„œ í™•ì¸í•˜ë ¤ë©´ <code>/etc/rancher/k3s/k3s.yaml</code> íŒŒì¼ì„ <code>~/.kube/config</code>ì— ì¶”ê°€í•˜ë©´ ëœë‹¤. í´ëŸ¬ìŠ¤í„° ë‚´ë¶€ì—ì„œ kubectl ëª…ë ¹ì€ k3s ë°”ì´ë„ˆë¦¬ ë‚´ë¶€ì— í¬í•¨ë˜ì–´ ìˆìœ¼ë¯€ë¡œ <code>sudo k3s kubectl</code> ëª…ë ¹ì„ ì‚¬ìš©í•˜ì˜€ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo k3s kubectl get node -o wide</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME          STATUS   ROLES    AGE   VERSION         INTERNAL-IP    EXTERNAL-IP   OS-IMAGE                         KERNEL-VERSION   CONTAINER-RUNTIME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">k3s-master    Ready    &lt;none&gt;   22h   v1.13.4-k3s.1   192.168.1.14   &lt;none&gt;        Raspbian GNU/Linux 9 (stretch)   4.14.79-v7+      containerd://1.2.4+unknown</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">k3s-slave01   Ready    &lt;none&gt;   21h   v1.13.4-k3s.1   192.168.1.15   &lt;none&gt;        Raspbian GNU/Linux 9 (stretch)   4.14.79-v7+      containerd://1.2.4+unknown</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">k3s-slave02   Ready    &lt;none&gt;   10h   v1.13.4-k3s.1   192.168.1.16   &lt;none&gt;        Raspbian GNU/Linux 9 (stretch)   4.14.79-v7+      containerd://1.2.4+unknown</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">k3s-slave03   Ready    &lt;none&gt;   10h   v1.13.4-k3s.1   192.168.1.17   &lt;none&gt;        Raspbian GNU/Linux 9 (stretch)   4.14.79-v7+      containerd://1.2.4+unknown</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>node ìƒì„¸ì •ë³´ë¥¼ ë³´ë©´ ê¸°ë³¸ì ìœ¼ë¡œ K8s <code>v1.13.4</code>, runtimeì€ <code>containerd</code>ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.  </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo k3s kubectl get svc --all-namespaces</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAMESPACE     NAME         TYPE           CLUSTER-IP     EXTERNAL-IP                 PORT(S)                      AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default       kubernetes   ClusterIP      10.43.0.1      &lt;none&gt;                      443/TCP                      21h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-dns     ClusterIP      10.43.0.10     &lt;none&gt;                      53/UDP,53/TCP,9153/TCP       21h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   traefik      LoadBalancer   10.43.19.160   192.168.1.14,192.168.1.15   80:32304/TCP,443:31690/TCP   21h</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Rancherìª½ì—ì„œë„ ì˜¤ëŠ˜ë‚ ì§œ(3/12)ë¡œ F5ê°€ Nginxë¥¼ ì¸ìˆ˜í•˜ëŠ”ê²ƒì„ ì˜ˆê²¬í–ˆë˜ ê²ƒì¼ê¹Œ?<br>
<!-- -->Serviceë¥¼ í™•ì¸í•˜ë©´ traefikì´ ê¸°ë³¸ìœ¼ë¡œ ë˜ì–´ìˆë‹¤. ì•„ë˜ì²˜ëŸ¼ ê¸°ë³¸ì ìœ¼ë¡œ loadbalancerë¡œ í™œìš©ë˜ê³  ìˆëŠ” traefikì„ Helm Chart CRDë¥¼ í†µí•´ ë°°í¬ëœê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ë˜í•œ ì–¼ë§ˆì „ ì¡¸ì—…í•œ CoreDNSë„ ë³´ì¸ë‹¤.   </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo k3s kubectl get pod --all-namespaces</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAMESPACE     NAME                             READY   STATUS      RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   coredns-7748f7f6df-qflx9         1/1     Running     0          21h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   helm-install-traefik-dqqg9       0/1     Completed   0          21h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   svclb-traefik-598fd65c97-4xtkf   2/2     Running     0          21h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   svclb-traefik-598fd65c97-vbsqv   2/2     Running     0          19h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   traefik-6876857645-2sqg9         1/1     Running     0          21h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo k3s kubectl get crd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                            CREATED AT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">addons.k3s.cattle.io            2019-03-11T16:46:22Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helmcharts.k3s.cattle.io        2019-03-11T16:46:22Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">listenerconfigs.k3s.cattle.io   2019-03-11T16:46:22Z</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ì•„ì£¼ ì ì€ë¹„ìš©(?)ìœ¼ë¡œ ì·¨ë¯¸ì‚¼ì•„ k3s í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•´ë´¤ë‹¤.<br>
<!-- -->ì•„ì§ ARMê³„ì—´ì—ì„œ kubernetes workloadë¥¼ êµ¬ë™í•˜ëŠ” ê²ƒì€ ì‹œê¸°ìƒì¡°ì´ê¸´ í•˜ì§€ë§Œ ê¸°ì¡´ì— kubeadmì„ ê°€ì§€ê³  piì— ë°°í¬í•˜ëŠ”ê²ƒì— ë¹„í•˜ë©´ ì„¤ì¹˜ ë‚œì´ë„ë‚˜ ìì›ì‚¬ìš©ëŸ‰ ì¸¡ë©´ì—ì„œ ì¥ì ì´ ë§ì€ í”„ë¡œì íŠ¸ì´ë‹¤.<br>
<!-- -->í•´ì™¸ ë¸”ë¡œê·¸ë‚˜ íŠ¸ìœ„í„°ë¥¼ ë³´ë©´ ìµœê·¼ <code>k3s</code>ì— ëŒ€í•œ ê´€ì‹¬ë„ê°€ ë†’ì•„ì§€ëŠ”ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆëŠ”ë° ë‹¨ìˆœíˆ ì·¨ë¯¸ìƒí™œë§Œì´ ì•„ë‹ˆë¼ IoT, Edgeì—ì„œì˜ Serverless Workload ìˆ˜í–‰ì´ë¼ë˜ì§€ ARM ê³„ì—´ ìµœì í™”ëœ ëª¨ìŠµë§Œìœ¼ë¡œë„ ì¶©ë¶„íˆ ê°€ëŠ¥ì„±ì€ ë³´ì—¬ì¤€ê²ƒ ê°™ë‹¤.<br>
<!-- -->Rancher 2.0 ì´í›„ë¡œ Kubernetes ì—°ê´€ëœ ê´€ì‹¬ë„ê°€ ë–¨ì–´ì¡Œì—ˆëŠ”ë° ì—”ì§€ë‹ˆì–´ë“¤ì˜ ê´€ì‹¬ì„ ë„ëŠ”ë°ëŠ” ì„±ê³µí•œë“¯ í•˜ê³  AWSì˜ Greengrass, Firecrackerì™€ ë™ì¼ì„ ìƒì—ì„œ ë´ë„ ê²¬ì¤„ë§Œí•œ ê°€ì¹˜ê°€ ìˆë‹¤ê³  ìƒê°ëœë‹¤.</p>]]></content>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="Rancher" term="Rancher"/>
        <category label="K3s" term="K3s"/>
        <category label="Raspberry" term="Raspberry"/>
        <category label="Homelab" term="Homelab"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Cloud-Native Microservices Demo Application with OpenCensus]]></title>
        <id>kubernetes/microservices-demo/</id>
        <link href="https://ddii.dev/kubernetes/microservices-demo/"/>
        <updated>2019-03-07T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Hipster Shop: Cloud-Native Microservices Demo Application ë¥¼ ì‚´í´ë³´ê³  ì•ˆì— ë“¤ì–´ìˆëŠ” ì—¬ëŸ¬ê°€ì§€ ì˜¤í”ˆì†ŒìŠ¤ë“¤ì„ ì•Œì•„ë³¸ë‹¤]]></summary>
        <content type="html"><![CDATA[<p><a href="https://github.com/GoogleCloudPlatform/microservices-demo" target="_blank" rel="noopener noreferrer">https://github.com/GoogleCloudPlatform/microservices-demo</a>ì—ì„œ ì†Œê°œëœ Demo Applicationì¸ <code>Hipster Shop</code>ì„ Kubernetes ê¸°ë°˜ìœ¼ë¡œ ë°°í¬í•˜ê³  ê´€ë ¨ ì˜¤í”ˆì†ŒìŠ¤ë“¤ì„ ë” ì•Œì•„ë³´ê³ ì í•œë‹¤.</p><p>ìœ„ ë§í¬ì— ê°€ì„œ ë³´ë©´ ì•Œìˆ˜ ìˆì§€ë§Œ <code>Hipster Shop</code> ì•„ë˜ ê·¸ë¦¼ì²˜ëŸ¼ 10ê°œì˜ Microserviceë¡œ êµ¬ì„±ë˜ì–´ ìˆê³  ìƒí’ˆì„ ê²€ìƒ‰ ë° êµ¬ë§¤í•  ìˆ˜ìˆëŠ” ì›¹ ê¸°ë°˜ ì´ì»¤ë¨¸ìŠ¤ Applicationìœ¼ë¡œ êµ¬ì„± ë˜ì–´ìˆë‹¤.</p><p><img loading="lazy" src="https://github.com/GoogleCloudPlatform/microservices-demo/raw/master/docs/img/architecture-diagram.png" alt="arch" class="img_E7b_"></p><p>ê°ê°ì˜ ì„œë¹„ìŠ¤ëŠ” <strong>gRPC</strong> ë¡œ í†µì‹ í•˜ê³  ì™¸ë¶€ ì‚¬ìš©ìë§Œ HTTPë¡œ ì ‘ê·¼í•œë‹¤. ëª¨ë“  ì„œë¹„ìŠ¤ëŠ” ì„œë¡œ ë‹¤ë¥¸ ì–¸ì–´(Go, C#, Node.js, Python, Java)ë¡œ êµ¬ì„±ë˜ì–´ ìˆê³  ëŒ€ë¶€ë¶„ì˜ Microserviceë“¤ì€ <code>Istio</code> service mesh í˜•íƒœë¡œ êµ¬ì„±í• ìˆ˜ ìˆë„ë¡ ë˜ì–´ìˆë‹¤. <code>Skaffold</code>ë¥¼ í†µí•´ ë°°í¬í•˜ê³  <code>OpenCensus</code>ë¼ê³  í•˜ëŠ” gRPC/HTTPê¸°ë°˜ Tracing toolì„ í™œìš©í•˜ì—¬ Google <code>Stackdriver</code>ë¡œ ë³´ë‚´ë„ë¡ ë˜ì–´ìˆì§€ë§Œ  Prometheusì— í†µí•©í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ ì‘ì„±í•˜ê¸° ìœ„í•´ì„œ Prometheus ê¸°ë°˜ìœ¼ë¡œ Metricì„ ìˆ˜ì§‘í•˜ëŠ” Forkëœ ë°ëª¨ Applicationì„ ê²€ìƒ‰ì„ í†µí•´ ì°¾ì„ìˆ˜ ìˆì—ˆë‹¤.<br>
<a href="https://github.com/census-ecosystem/opencensus-microservices-demo" target="_blank" rel="noopener noreferrer">https://github.com/census-ecosystem/opencensus-microservices-demo</a>  </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="opencensus">OpenCensus<a class="hash-link" href="#opencensus" title="Direct link to heading">â€‹</a></h2><p><a href="https://opencensus.io/" target="_blank" rel="noopener noreferrer">OpenCensus(OC)</a>ëŠ” Microservice ë° Monolith ì„œë¹„ìŠ¤ë¥¼ Tracing ë° Metric Monitoring í•  ìˆ˜ ìˆëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì œê³µí•˜ëŠ” ì˜¤í”ˆì†ŒìŠ¤ì´ë‹¤.</p><p>ì•„ë˜ì™€ ê°™ì´ ë‹¤ì–‘í•œ ì–¸ì–´ë¥¼ ì§€ì› í•œë‹¤.</p><ul><li>Java , Go, Python, C++, Nodejs, Erlang, Ruby, PHP, C#</li></ul><p>ë˜í•œ ìˆ˜ì§‘ëœ ë°ì´í„°ë¥¼ Prometheus, Stackdriver Tracing and Monitoring, DataDog, Graphite, Zipkin, Jaeger, Azure Insights ë“± ê³¼ ê°™ì€ ë°±ì—”ë“œ Applicationìœ¼ë¡œ ë‚´ë³´ë‚¼ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ê°œë°œì, ìš´ì˜ì ì¸¡ë©´ì—ì„œ ì¢‹ì€ ì„ íƒì‚¬í•­ì´ ë  ìˆ˜ ìˆë‹¤.  </p><p>Microserviceì™€ ê°™ì€ ë¶„ì‚° ì‹œìŠ¤í…œì—ì„œ ê°œë°œì/ìš´ì˜ì ê´€ì ì˜ ê°€ì¥ ì¤‘ìš”í•œ ë¯¸ì…˜ì€ ê°ê°ì˜ ìˆ˜í–‰ë˜ëŠ” ì„œë¹„ìŠ¤ë“¤ì˜ ì‹¤í–‰ ì‹œê°„ì„ í™•ì¸í•˜ê³  ìƒí˜¸ APIê°„ í†µì‹ ì´ ì–¼ë§ˆë‚˜ ê±¸ë¦¬ëŠ”ì§€ë¥¼ í™•ì¸í•˜ê³  Span(ì•„ë˜ ê·¸ë¦¼ì°¸ì¡°)ì—ì„œ ê°€ì¥ ì§€ì—°ì´ ë°œìƒí•˜ëŠ” ì„œë¹„ìŠ¤ë¥¼ ë¹¨ë¦¬ ì°¾ì•„ë‚´ í™•ì¸í•˜ê³  ì¡°ì¹˜í•˜ëŠ” ê²ƒì´ë¼ í•  ìˆ˜ ìˆë‹¤.</p><p><img loading="lazy" src="https://www.jaegertracing.io/img/spans-traces.png" alt="span" class="img_E7b_"></p><p>OpenCensusëŠ” ì£¼ë¡œ ë‘ê°€ì§€ ê¸°ëŠ¥ìœ¼ë¡œ í™œìš©ëœë‹¤.<br>
<!-- -->ì²«ë²ˆì§¸ëŠ” Metric ìˆ˜ì§‘ì´ê³  ë‘ë²ˆì§¸ëŠ” Tracing ê¸°ëŠ¥ì´ë‹¤.<br>
<!-- -->Logê°™ì€ ê²½ìš° í˜„ì¬ ë¯¸ì§€ì›ì´ì§€ë§Œ ë‹¤ìŒ ë©”ì´ì € ë¦´ë¦¬ì¦ˆì— ì¶”ê°€ë  ì˜ˆì •ì´ë¼ê³  í•˜ë‹ˆ ì¡°ê¸ˆë” ì§€ì¼œë³´ë©´ ì¢‹ì„ê²ƒ ê°™ë‹¤.</p><ul><li><p>Metrics</p><ul><li>ë°ì´í„°ë² ì´ìŠ¤ ë° APIì˜ ì‘ë‹µì‹œê°„, ìš”ì²­ content length, open file descriptor ìˆ˜ì™€ ê°™ì´ ì¶”ì í•˜ê³ ìí•˜ëŠ” ì •ëŸ‰ ë°ì´í„°ë¥¼ ë§í•œë‹¤. Metric ì„ ì‹œê°í™”í•´ì„œ ë³´ë©´ ì‘ìš© í”„ë¡œê·¸ë¨ ë° ì„œë¹„ìŠ¤ì˜ ì„±ëŠ¥ê³¼ í’ˆì§ˆì„ ì¸¡ì •í•˜ëŠ” ë° ë„ì›€ì´ ë  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ë©´ ìš”ì²­ ì‘ë‹µì‹œê°„ì˜ í‰ê· ê°’ì´ë‚˜ cache hit/miss ìˆ˜ì™€ ê°™ì€ ê²ƒë“¤ì´ ë  ìˆ˜ ìˆë‹¤. </li></ul></li><li><p>Traces</p><ul><li>ì„œë¹„ìŠ¤ ìš”ì²­ì— ëŒ€í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë˜ëŠ” ì„œë¹„ìŠ¤ êµ¬ì¡°ë¥¼ í™•ì¸í• ìˆ˜ ìˆê³  ëª¨ë“  ì„œë¹„ìŠ¤ ê°„ ë°ì´í„° íë¦„ì„ ì‹œê°í™”í•˜ì—¬ ì•„í‚¤í…ì²˜ìƒì˜ ë³‘ëª© í˜„ìƒì„ íŒŒì•…í•˜ëŠ” ë° ë„ì›€ì´ ëœë‹¤.</li></ul></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="hipster-shop-demo">Hipster Shop Demo<a class="hash-link" href="#hipster-shop-demo" title="Direct link to heading">â€‹</a></h2><p>ìœ„ì—ì„œ ì–¸ê¸‰í–ˆë˜ ë‚´ìš©ì²˜ëŸ¼ GCPì—ì„œ ì‘ì„±í•œ <a href="https://github.com/GoogleCloudPlatform/microservices-demo" target="_blank" rel="noopener noreferrer">Hipster Shop Demo</a>ëŠ” minikube ë° GCP ë°ëª¨ë¡œ ë˜ì–´ìˆê³  ì½”ë“œì•ˆì— ê¸°ë³¸ Metric ì„¤ì •ì´ Stackdriverìœ¼ë¡œ ë˜ì–´ìˆì–´ Prometheus Exporter ì ìš©ì„ í•˜ë ¤ë©´ ì½”ë“œ ìˆ˜ì •ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— Prometheusê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ëœ <a href="https://github.com/census-ecosystem/opencensus-microservices-demo" target="_blank" rel="noopener noreferrer">Forked Repo</a>ë¥¼ ì‚´í´ë³´ê¸°ë¡œ í•˜ì˜€ë‹¤.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="requirement">Requirement<a class="hash-link" href="#requirement" title="Direct link to heading">â€‹</a></h3><p>í˜„ì¬ ê°€ì§€ê³  ìˆëŠ” MacOS í™˜ê²½ì—ì„œ êµ¬ë™í•˜ì˜€ë‹¤. ìµœì†Œ ìŠ¤í™ì€ ë”°ë¡œ ê¸°ì¬í•˜ì§€ ì•Šì•˜ìœ¼ë‚˜ K8s 1.11 ì´ìƒì„ ê¶Œì¥í•œë‹¤.</p><ul><li>kubectl : v1.10.7</li><li>Minikube : v0.34.1</li><li>Kubernetes : v1.13.3</li><li><a href="https://github.com/GoogleContainerTools/skaffold/#installation" target="_blank" rel="noopener noreferrer">skaffold</a> : v0.24</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="minikube-ê¸°ë™">minikube ê¸°ë™<a class="hash-link" href="#minikube-ê¸°ë™" title="Direct link to heading">â€‹</a></h3><p>ìµœì†Œ 3 CPU, 6Gb Memoryê°€ í•„ìš”í•˜ë‹¤. ê·¸ëƒ¥ minikubeë¥¼ êµ¬ë™ì‹œê¸°ë©´ 4 CPU, 8Gb ë¡œ êµ¬ë™ì´ ë˜ê¸° ë•Œë¬¸ì— ë³„ë‹¤ë¥¸ ì˜µì…˜ ì—†ì´ defaultë¡œ êµ¬ë™í•˜ë©´ ëœë‹¤. </p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ minikube start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get nodes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME       STATUS    ROLES     AGE       VERSION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">minikube   Ready     master    6h        v1.13.3</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="repository-clone">Repository Clone<a class="hash-link" href="#repository-clone" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/census-ecosystem/opencensus-microservices-demo.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token builtin class-name">cd</span><span class="token plain"> opencensus-microservices-demo</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë‚´ë¶€ êµ¬ì¡°ë¥¼ ì‚´í´ë³´ë©´ ê¸°ë³¸ì ìœ¼ë¡œ <a href="https://github.com/GoogleContainerTools/skaffold" target="_blank" rel="noopener noreferrer">skaffold</a>ë¥¼ í™œìš©í•˜ì—¬ ë°°í¬ë¥¼ ì§„í–‰ì„ í•˜ëŠ” ê²ƒì„ ì•Œìˆ˜ìˆë‹¤.<br>
<code>skaffold</code>ëŠ” ë¡œì»¬ì—ì„œ Kubernetes ê¸°ë°˜ ì–´í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œê³¼ ë°°í¬(CD)ë¥¼ ë¹ ë¥´ê²Œ ë„ì™€ì£¼ëŠ” CLI toolì´ë‹¤. ì†ŒìŠ¤ì½”ë“œì˜ ë³€í™”ë¥¼ ê°ì§€í•˜ì—¬ build, registry push/tagging, deployê¹Œì§€ ìë™ìœ¼ë¡œ í•  ìˆ˜ ìˆëŠ” ë¡œì»¬ ê¸°ë°˜ ë„êµ¬ì´ë‹¤.</p><p><code>skaffold dev</code>ëŠ” ë¡œì»¬ í™˜ê²½ì˜ ë°˜ë³µì ì¸ ê°œë°œì— í™œìš©í•˜ê³  ì‹¤ì œ ë°°í¬ëŠ” CI Processì—ì„œ <code>skaffold run</code>ì„ í†µí•´ ë°°í¬ë¥¼ ì§„í–‰í•  ìˆ˜ ìˆë‹¤.  </p><p><img loading="lazy" src="https://github.com/GoogleContainerTools/skaffold/raw/master/docs/static/img/intro.gif" alt="skaffold demo" class="img_E7b_"></p><p>Kubernetes ë°°í¬íˆ´ì— ëŒ€í•´ ë¹„êµí•œ ê¸€ì€ <a href="https://blog.hasura.io/draft-vs-gitkube-vs-helm-vs-ksonnet-vs-metaparticle-vs-skaffold-f5aa9561f948/" target="_blank" rel="noopener noreferrer">ë¸”ë¡œê·¸ ë§í¬</a>ë¥¼ í†µí•´ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><p>ì•„ë˜ì—ì„œëŠ” <code>skaffold</code>ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ ë¯¸ë¤„ë‘ê³  ë°°í¬í•˜ëŠ” ë„êµ¬ë¡œì„œë§Œ ì„¤ëª…í•œë‹¤.  </p><p>ê¸°ë³¸ì ìœ¼ë¡œ êµ¬ì„±ì„ í•˜ê³ ì í•˜ëŠ” ë‚´ìš©ì€ helmì²˜ëŸ¼ template íŒŒì¼ì„ ì‚¬ìš©í•˜ê²Œ ë˜ëŠ”ë° í”„ë¡œì íŠ¸ rootì— <code>skaffold.yaml</code> ì— buildë¥¼ ìœ„í•œ image name, tag, src ìœ„ì¹˜ë“± ê¸°ë³¸ì ì¸ ë‚´ìš©ì„ ê¸°ì¬í•œë‹¤. íŒŒì¼ë‚´ìš©ì„ ì‚´í´ë³´ë©´ buildì— ê´€ë ¨ëœ ë‚´ìš©ë“¤ì„ ì‘ì„±í•˜ê³  deployí•  manifestsì˜ ìœ„ì¹˜ê¹Œì§€ ì§€ì •í•˜ë„ë¡ ë˜ì–´ìˆë‹¤. ë¡œì»¬í™˜ê²½ì—ì„œ í™•ì¸ì„ ìœ„í•´ grafana, prometheus, jaegerê°€ ì¶”ê°€ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> skaffold/v1alpha2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">build</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">tagPolicy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">gitCommit</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">artifacts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">imageName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gcr.io/opencensus</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">microservices</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo/emailservice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">workspace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> src/emailservice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">imageName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gcr.io/opencensus</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">microservices</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo/productcatalogservice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">workspace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> src/productcatalogservice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">imageName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gcr.io/opencensus</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">microservices</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo/recommendationservice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">workspace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> src/recommendationservice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">imageName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gcr.io/opencensus</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">microservices</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo/shippingservice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">workspace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> src/shippingservice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">imageName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gcr.io/opencensus</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">microservices</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo/checkoutservice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">workspace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> src/checkoutservice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">imageName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gcr.io/opencensus</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">microservices</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo/paymentservice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">workspace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> src/paymentservice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">imageName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gcr.io/opencensus</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">microservices</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo/currencyservice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">workspace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> src/currencyservice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">imageName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gcr.io/opencensus</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">microservices</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo/cartservice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">workspace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> src/cartservice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">imageName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gcr.io/opencensus</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">microservices</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo/frontend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">workspace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> src/frontend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">imageName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gcr.io/opencensus</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">microservices</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo/loadgenerator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">workspace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> src/loadgenerator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">imageName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gcr.io/opencensus</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">microservices</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo/adservice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">workspace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> src/adservice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">imageName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gcr.io/opencensus</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">microservices</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo/grafana</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">workspace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> src/grafana</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">imageName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gcr.io/opencensus</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">microservices</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo/prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">workspace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> src/prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">imageName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gcr.io/opencensus</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">microservices</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo/jaeger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">workspace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> src/jaeger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">deploy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">kubectl</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">manifests</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ./kubernetes</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">manifests/</span><span class="token important">**.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Goë¡œ ì‘ì„±ëœ Frontend microserviceì„ ì‚´í´ë³´ì. <!-- -->[<strong>./src/frontend/main.go</strong>]</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="library-ì¶”ê°€-ë°-http-handler-ì´ˆê¸°í™”">library ì¶”ê°€ ë° http handler ì´ˆê¸°í™”<a class="hash-link" href="#library-ì¶”ê°€-ë°-http-handler-ì´ˆê¸°í™”" title="Direct link to heading">â€‹</a></h3><p>Goê¸°ë°˜ exporter íŒ¨í‚¤ì§€(jaeger,prometheus)ë¥¼ ì¶”ê°€ì ìœ¼ë¡œ import í•˜ê³  http handlerë¥¼ ìœ„í•œ <a href="https://godoc.org/go.opencensus.io/plugin/ochttp" target="_blank" rel="noopener noreferrer">ochttp íŒ¨í‚¤ì§€</a>ë¥¼ ì¶”ê°€í•˜ì˜€ë‹¤. </p><div class="codeBlockContainer_I0IT language-go theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-go codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">"go.opencensus.io/exporter/jaeger"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">"go.opencensus.io/exporter/prometheus"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">"go.opencensus.io/plugin/ochttp"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">"go.opencensus.io/plugin/ochttp/propagation/b3"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> handler http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Handler </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> r</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        handler </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">logHandler</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> log</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> next</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> handler</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        handler </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ensureSessionID</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// add opencensus instrumentation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        handler </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">ochttp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Handler</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Handler</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">     handler</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Propagation</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">b3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">HTTPFormat</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Infof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"starting server on "</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> addr </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">":"</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> srvPort</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Fatal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ListenAndServe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">addr</span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">":"</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">srvPort</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> handler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="exporter-ë“±ë¡jaeger-tracing-ë°-prometheus-exporter">exporter ë“±ë¡(Jaeger Tracing ë° Prometheus exporter)<a class="hash-link" href="#exporter-ë“±ë¡jaeger-tracing-ë°-prometheus-exporter" title="Direct link to heading">â€‹</a></h3><p>ì˜ˆì‹œì²˜ëŸ¼ ê°ê°ì˜ ì„œë¹„ìŠ¤ì— jaegerì™€ prometheus exporter Endpointë¥¼ ì‰½ê²Œ ë“±ë¡í• ìˆ˜ ìˆë‹¤.<br>
<!-- -->ë˜í•œ initTracing() ì—ì„œëŠ” ë°ëª¨ë¥¼ ìœ„í•´ trace.AlwaysSample()ì„ ì‚¬ìš©í•˜ì˜€ë‹¤. ì‹¤ì œ ìš´ì˜í™˜ê²½ì—ì„œëŠ” <a href="https://github.com/census-instrumentation/opencensus-specs/blob/master/trace/Sampling.md" target="_blank" rel="noopener noreferrer">ë‹¤ìŒ ë§í¬</a>ë¥¼ ì°¸ê³ í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œê³ í•˜ê³  ìˆë‹¤. </p><div class="codeBlockContainer_I0IT language-go theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-go codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">initJaegerTracing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log logrus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">FieldLogger</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Register the Jaeger exporter to be able to retrieve</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// the collected spans.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        exporter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> jaeger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewExporter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">jaeger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Options</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Endpoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"http://jaeger:14268"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Process</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> jaeger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Process</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        ServiceName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"frontend"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Fatal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        trace</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">RegisterExporter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">exporter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">initTracing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log logrus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">FieldLogger</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// This is a demo app with low QPS. trace.AlwaysSample() is used here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// to make sure traces are available for observation and analysis.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// In a production environment or high QPS setup please use</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// trace.ProbabilitySampler set at the desired probability.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        trace</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ApplyConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">trace</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Config</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                DefaultSampler</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> trace</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">AlwaysSample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">initJaegerTracing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">initPrometheusStatsExporter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log logrus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">FieldLogger</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">prometheus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Exporter </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exporter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> prometheus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewExporter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prometheus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Options</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Fatal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"error registering prometheus exporter"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    view</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">RegisterExporter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">exporter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> exporter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">startPrometheusExporter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log logrus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">FieldLogger</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> exporter </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">prometheus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Exporter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    addr </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">":9090"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Infof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"starting prometheus server at %s"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> addr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Handle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"/metrics"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> exporter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Fatal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ListenAndServe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">addr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="demo-application-ë°°í¬">Demo Application ë°°í¬<a class="hash-link" href="#demo-application-ë°°í¬" title="Direct link to heading">â€‹</a></h3><p>minikubeì— Hipster Shop Demoë¥¼ ë°°í¬í•œë‹¤. ë‹¨ìˆœí•˜ê²Œ <code>skaffold run</code> ëª…ë ¹ìœ¼ë¡œ ì§„í–‰í•˜ë©´ ëœë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ skaffold run</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í˜„ì¬ ì‚¬ìš©ì¤‘ì¸ 2018 Macbook Pro(3.1 GHz Intel Core i7, 16GB) ìƒì˜ Dockerê¸°ë°˜ minikube í™˜ê²½ìœ¼ë¡œë„ ë°°í¬ë¥¼ í•˜ì˜€ëŠ”ë° ì‹œê°„ì´ ê½¤ ì†Œìš”ë˜ì—ˆë‹¤.(20ë¶„ì´ìƒ)<br>
<!-- -->ì½”ë“œë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ìˆ˜ì •í•˜ê³  ë¹Œë“œ, ë°°í¬ë˜ëŠ” ê²ƒì€ <code>skaffold dev</code> ëª…ë ¹ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì§„í–‰ë˜ëŠ” ê³¼ì •ì„ ë³´ë©´ <a href="https://draft.sh/" target="_blank" rel="noopener noreferrer">draft.sh</a> í”„ë¡œì íŠ¸ì™€ë„ ê½¤ ìœ ì‚¬í•˜ë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤.  </p><p>ì—ëŸ¬ì—†ì´ runì´ ì‹¤í–‰ë˜ê³  ë‚œí›„ minikubeì— ë°°í¬ëœ podì™€ serviceë¥¼ í™•ì¸í•œë‹¤. ì¤‘ê°„ì— loadgeneratorê°€ initì¸ ì´ìœ ëŠ” minikube ìì›ì´ ë¶€ì¡±í•´ì„œ ë°œìƒí•˜ëŠ” í˜„ìƒì´ë‹¤.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                     READY     STATUS     RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adservice-7c7d687dcb-xzr4m               </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1       Running    </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">          4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cartservice-f54bcb9ff-tcfgn              </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1       Running    </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">          4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">checkoutservice-576446687b-95bwj         </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1       Running    </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">          4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">currencyservice-5bd99bf97d-28mtz         </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1       Running    </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">          4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">emailservice-6cb587798d-wwzdh            </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1       Running    </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">          4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">frontend-6bf9796f7b-ch9pl                </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1       Running    </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">          4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grafana-6678c5c5d9-2qx75                 </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1       Running    </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">          4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jaeger-5b66bdf7f7-csdzx                  </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1       Running    </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">          4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">loadgenerator-7c4f446774-68djg           </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">/1       Init:0/1   </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">          4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">paymentservice-fc4c8589-wrfg7            </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1       Running    </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">          4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">productcatalogservice-84878c8b9c-jhgnw   </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1       Running    </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">          4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prometheus-58d98b7578-87td6              </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1       Running    </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">          4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">recommendationservice-8564f9d894-smlpf   </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1       Running    </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">          4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">redis-cart-798bc66d58-xn6ff              </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1       Running    </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">          4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shippingservice-789656f6bc-rgzrp         </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">/1       Running    </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">          4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get svc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                    TYPE           CLUSTER-IP       EXTERNAL-IP   PORT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">S</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                                                            AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adservice               ClusterIP      </span><span class="token number" style="color:#36acaa">10.107</span><span class="token plain">.196.115   </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">9555</span><span class="token plain">/TCP,9090/TCP                                                  4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cartservice             ClusterIP      </span><span class="token number" style="color:#36acaa">10.98</span><span class="token plain">.151.164    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">7070</span><span class="token plain">/TCP                                                           4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">checkoutservice         ClusterIP      </span><span class="token number" style="color:#36acaa">10.97</span><span class="token plain">.9.197      </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">5050</span><span class="token plain">/TCP                                                           4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">currencyservice         ClusterIP      </span><span class="token number" style="color:#36acaa">10.103</span><span class="token plain">.112.225   </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">7000</span><span class="token plain">/TCP                                                           4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">emailservice            ClusterIP      </span><span class="token number" style="color:#36acaa">10.97</span><span class="token plain">.184.174    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">5000</span><span class="token plain">/TCP                                                           4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">frontend                ClusterIP      </span><span class="token number" style="color:#36acaa">10.103</span><span class="token plain">.40.138    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">80</span><span class="token plain">/TCP,9090/TCP                                                    4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">frontend-external       LoadBalancer   </span><span class="token number" style="color:#36acaa">10.108</span><span class="token plain">.170.241   </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">pending</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">80</span><span class="token plain">:31944/TCP                                                       4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grafana                 ClusterIP      </span><span class="token number" style="color:#36acaa">10.104</span><span class="token plain">.141.254   </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">3000</span><span class="token plain">/TCP                                                           4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grafana-external        LoadBalancer   </span><span class="token number" style="color:#36acaa">10.102</span><span class="token plain">.166.138   </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">pending</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">3000</span><span class="token plain">:30459/TCP                                                     4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jaeger                  ClusterIP      </span><span class="token number" style="color:#36acaa">10.98</span><span class="token plain">.71.173     </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">9411</span><span class="token plain">/TCP,5775/UDP,6831/UDP,6832/UDP,5778/TCP,16686/TCP,14268/TCP   4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jaeger-external         LoadBalancer   </span><span class="token number" style="color:#36acaa">10.96</span><span class="token plain">.164.126    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">pending</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">16686</span><span class="token plain">:32362/TCP                                                    4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubernetes              ClusterIP      </span><span class="token number" style="color:#36acaa">10.96</span><span class="token plain">.0.1        </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">443</span><span class="token plain">/TCP                                                            6h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">paymentservice          ClusterIP      </span><span class="token number" style="color:#36acaa">10.109</span><span class="token plain">.31.241    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">50051</span><span class="token plain">/TCP                                                          4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">productcatalogservice   ClusterIP      </span><span class="token number" style="color:#36acaa">10.101</span><span class="token plain">.124.106   </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">3550</span><span class="token plain">/TCP                                                           4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prometheus              ClusterIP      </span><span class="token number" style="color:#36acaa">10.103</span><span class="token plain">.107.213   </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">9090</span><span class="token plain">/TCP                                                           4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">recommendationservice   ClusterIP      </span><span class="token number" style="color:#36acaa">10.104</span><span class="token plain">.225.28    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">8080</span><span class="token plain">/TCP                                                           4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">redis-cart              ClusterIP      </span><span class="token number" style="color:#36acaa">10.101</span><span class="token plain">.24.157    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">6379</span><span class="token plain">/TCP                                                           4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shippingservice         ClusterIP      </span><span class="token number" style="color:#36acaa">10.104</span><span class="token plain">.224.18    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">50051</span><span class="token plain">/TCP                                                          4h</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì„œë¹„ìŠ¤-ì ‘ì†-ë°-metrictracing-í™•ì¸">ì„œë¹„ìŠ¤ ì ‘ì† ë° Metric/Tracing í™•ì¸<a class="hash-link" href="#ì„œë¹„ìŠ¤-ì ‘ì†-ë°-metrictracing-í™•ì¸" title="Direct link to heading">â€‹</a></h3><p>ë¡œì»¬ minikubeí™˜ê²½ì´ê¸° ë•Œë¬¸ì— external serviceê°€ pendingì´ë¯€ë¡œ serviceë¥¼ minikube NAT IPë¡œ expose ì‹œí‚¨ë‹¤.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ minikube </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> frontend-external</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ minikube </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> grafana-external</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ minikube </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> jaeger-external</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ minikube </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">-------------</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">-----------------------</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">-----------------------------</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  NAMESPACE  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">         NAME          </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">             URL             </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">-------------</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">-----------------------</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">-----------------------------</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> default     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> adservice             </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> No </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> port                </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> default     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> cartservice           </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> No </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> port                </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> default     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> checkoutservice       </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> No </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> port                </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> default     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> currencyservice       </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> No </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> port                </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> default     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> emailservice          </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> No </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> port                </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> default     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> frontend              </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> No </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> port                </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> default     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> frontend-external     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> http://192.168.99.101:31944 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> default     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> grafana               </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> No </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> port                </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> default     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> grafana-external      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> http://192.168.99.101:30459 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> default     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> jaeger                </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> No </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> port                </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> default     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> jaeger-external       </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> http://192.168.99.101:32362 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> default     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> kubernetes            </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> No </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> port                </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> default     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> paymentservice        </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> No </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> port                </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> default     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> productcatalogservice </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> No </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> port                </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> default     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> prometheus            </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> No </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> port                </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> default     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> recommendationservice </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> No </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> port                </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> default     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> redis-cart            </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> No </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> port                </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> default     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> shippingservice       </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> No </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> port                </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> kube-system </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> kube-dns              </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> No </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> port                </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">-------------</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">-----------------------</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">-----------------------------</span><span class="token operator" style="color:#393A34">|</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>3ê°œì˜ ì„œë¹„ìŠ¤ë¡œ ê°ê° ì ‘ì†ì´ ë˜ëŠ”ê²ƒì„ í™•ì¸í• ìˆ˜ ìˆë‹¤.
Grafana ëŒ€ì‹œë³´ë“œë¡œ ë“¤ì–´ê°€ë©´ í˜„ì¬ ìˆ˜ì§‘ë˜ëŠ” prometheus source(http://prometheus:9090)ë¥¼ í†µí•´ OpenCensusê¸°ë°˜ Application Metricì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><p><img loading="lazy" alt="hipster_grafana" src="/assets/images/hipster_grafana-13ab198ab40c06a5c6ba6bc61e3725ad.png" width="2878" height="1488" class="img_E7b_"></p><p>ê·¸ë¦¼ì—ì„œ ë³´ë©´ ì „ì²´ ì„œë¹„ìŠ¤ ì‘ë‹µì— ëŒ€í•œ 99% ë°±ë¶„ìœ„ ì§€ì—°ì‹œê°„ì´ 944ms ì¸ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><p>ë˜í•œ Jaegerë¥¼ í†µí•´ DAG(Directed acyclic graph) ë° ì„œë¹„ìŠ¤ê°„ Tracing ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><p><img loading="lazy" alt="DAG" src="/assets/images/dag-0e49356be3f8676a292785832fbc1981.png" width="3146" height="1782" class="img_E7b_"></p><p><img loading="lazy" alt="tracing" src="/assets/images/tracing-b9038c7a3151b467c5f7d4dc08786f75.png" width="3172" height="1442" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>OpenCensus ê¸°ë°˜ìœ¼ë¡œ ê°œë°œìê°€ ì½”ë“œë¥¼ ì‘ì„±í•˜ê³  Microserviceë¥¼ minikubeì—ì„œ ë°°í¬í•˜ê³  Prometheus, Jaeger Exporter ì—°ë™ì„ í†µí•´ ì‹œìŠ¤í…œë¿ë§Œì´ ì•„ë‹Œ Applicationê¸°ë°˜ Metrics/Statsì„ ìˆ˜ì§‘í•˜ê³  ê°œë°œìê°€ ì‘ì„±í•œ ì½”ë“œë¥¼ ì§ì ‘ Tracingí•˜ëŠ” ê°„ë‹¨í•œ ë°ëª¨ë¥¼ ì§„í–‰í•˜ì˜€ë‹¤. (Istioë¥¼ í¬í•¨í•´ì„œ Publicí™˜ê²½ì— ë°°í¬í•´ë´ë„ ì¢‹ì€ ê³µë¶€ê°€ ë  ê²ƒ ê°™ë‹¤)  </p><p>í–¥í›„ <a href="https://openmetrics.io/" target="_blank" rel="noopener noreferrer">OpenMetric</a>ê³¼ <a href="https://opencensus.io/" target="_blank" rel="noopener noreferrer">Opencensus</a>ê°€ ì‹¤ì œ ê°œë°œì ê¸°ë°˜ìœ¼ë¡œ í™œì„±í™”ë˜ê³  ì ìš©ì´ ëœë‹¤ë©´ Telemetric ì¸¡ë©´ì—ì„œ ë§ì€ Use-Caseê°€ ë„ì¶œë  ìˆ˜ ìˆì„ê²ƒ ê°™ë‹¤.  </p><p>ìœ„ì—ì„œ ì–¸ê¸‰í–ˆë“¯ì´ Prometheusê¸°ë°˜ Kubernetes í´ëŸ¬ìŠ¤í„°ë¥¼ ìš´ì˜í•˜ê³  ìˆëŠ” íŒ€ì˜ ê²½ìš° ê°œë°œìì˜ ì‘ì„± ì½”ë“œë¥¼ ìµœì†Œí™”í•  ìˆ˜ ìˆëŠ” ë„êµ¬ë¡œì„œ ì¶©ë¶„íˆ í™œìš©ë  ìˆ˜ ìˆì–´ ë³´ì¸ë‹¤.  </p><p>ê¼­ Cloud Native ê¸°ë°˜ Web ê°œë°œì´ ì•„ë‹ˆë”ë¼ë„ ê¸°ì¡´ ê³µì¥, ê¸ˆìœµ, ë³‘ì› ë“± ì˜ IoTë‚˜ ì„¼ì„œ/ì„¤ë¹„ë¥¼ ìœ„í•œ ë¹„ì¦ˆë‹ˆìŠ¤ì—ë„ Backendë¡œì„œ í™•ì¥ì„±ìˆëŠ” ë„êµ¬ë¡œì„œ í™œìš©ì´ ë  ìˆ˜ ìˆì„ê²ƒ ê°™ë‹¤.</p>]]></content>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="Istio" term="Istio"/>
        <category label="Stackdriver" term="Stackdriver"/>
        <category label="Prometheus" term="Prometheus"/>
        <category label="gRPC" term="gRPC"/>
        <category label="OpenCensus" term="OpenCensus"/>
        <category label="skaffold" term="skaffold"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Knative with Gloo]]></title>
        <id>kubernetes/knative-using-gloo/</id>
        <link href="https://ddii.dev/kubernetes/knative-using-gloo/"/>
        <updated>2019-02-28T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Istioì— ì¢…ì†ë˜ì–´ìˆëŠ” Knativeê°€ ì•„ë‹Œ ê²½ëŸ‰í™”ëœ Ingress ì˜¤í”ˆì†ŒìŠ¤ Glooë¥¼ í™œìš©í•œ Knative ì„¤ì¹˜ ë° í™œìš©]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="knative-routing">Knative Routing<a class="hash-link" href="#knative-routing" title="Direct link to heading">â€‹</a></h2><p>KnativeëŠ” ì•ì—ì„œë„ ëª‡ë²ˆ ì–¸ê¸‰í•˜ì˜€ì§€ë§Œ ê¸°ë³¸ì ìœ¼ë¡œ <code>Routing</code>ì„ ì‚¬ìš©í•˜ì—¬ ì™¸ë¶€ì— ë…¸ì¶œí•  ì„œë¹„ìŠ¤ë“¤ì— ëŒ€í•œ HTTP Endpointë¥¼ ì œê³µí•œë‹¤. ì–´ë–»ê²Œ ë³´ë©´ ê¸°ë³¸ì ìœ¼ë¡œ API Gateway ì—­í• ì„ í•˜ê¸°ë„ í•˜ê³  Ingress ì—­í• ì„ í•˜ê¸°ë„ í•œë‹¤. ë³´í†µ Service meshì¸ <code>Istio</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ ingressë¥¼ êµ¬í˜„í•˜ëŠ”ê²ƒì´ ë‹¹ì—°í•˜ë‹¤ê³  ìƒê°í•˜ê¸°ë„ í•˜ì§€ë§Œ Istioì˜ ëª¨ë“  ê¸°ëŠ¥ì´ Knativeì— í•„ìš”í•˜ì§€ëŠ” ì•Šê³  ì„¤ì¹˜ë˜ëŠ”ê²ƒ ìì²´ê°€ ë¦¬ì†ŒìŠ¤ ì†Œëª¨ê°€ ê½¤ ëœë‹¤ëŠ”ê²ƒì€ ì„¤ì¹˜ í•´ë³¸ì‚¬ëŒì€ ì•Œê³  ìˆì„ê²ƒì´ë‹¤. </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="service">Service<a class="hash-link" href="#service" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kubernetes">Kubernetes<a class="hash-link" href="#kubernetes" title="Direct link to heading">â€‹</a></h3><p><img loading="lazy" src="https://www.nginx.com/wp-content/uploads/2017/09/NGINX-Plus-Features-Kubernetes-Ingress-Controller-644x372@2x.png" alt="ingress" class="img_E7b_"><br>
<!-- -->ì´ë¯¸ì§€ì¶œì²˜ : <a href="https://www.nginx.com/blog/announcing-nginx-ingress-controller-for-kubernetes-release-1-3-0/" target="_blank" rel="noopener noreferrer">https://www.nginx.com/blog/announcing-nginx-ingress-controller-for-kubernetes-release-1-3-0/</a></p><p>Kubernetesì—ì„œëŠ” ì¼ë°˜ì ìœ¼ë¡œ ì„œë¹„ìŠ¤ ì ‘ì†ì„ êµ¬í˜„í•˜ê²Œ ë˜ë©´ ê¸°ë³¸ì ìœ¼ë¡œ Podì™€ Serviceë¥¼ ìƒì„±í•˜ê³  Ingressë¥¼ ì‚¬ìš©í•˜ì—¬ í´ëŸ¬ìŠ¤í„° ë‚´ë¶€ë¡œ ë“¤ì–´ì˜¤ëŠ” íŠ¸ë˜í”½ì„ ì²˜ë¦¬í•˜ê²Œ ëœë‹¤.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="knative">Knative<a class="hash-link" href="#knative" title="Direct link to heading">â€‹</a></h3><p><img loading="lazy" src="https://i1.wp.com/blog.openshift.com/wp-content/uploads/intro.png?w=499&amp;ssl=1" alt="Serving" class="img_E7b_"><br>
<!-- -->ì´ë¯¸ì§€ì¶œì²˜ : <a href="https://blog.openshift.com/knative-serving-your-serverless-services/" target="_blank" rel="noopener noreferrer">https://blog.openshift.com/knative-serving-your-serverless-services/</a></p><p>Knativeì—ì„œëŠ” ì•ì„  Knative ê´€ë ¨ í¬ìŠ¤íŒ…ì—ì„œë„ ì„¤ëª…í–ˆë“¯ì´ <code>Automatic scaling up and down to zero</code> íŠ¹ì„±ì„ ê°€ì§€ê³  ìˆê¸°ì— Podê°€ ìµœì´ˆ ì‹¤í–‰ë˜ì–´ìˆì§€ ì•Šì€ ìƒíƒœì—ì„œ íŠ¸ë˜í”½ì´ ë“¤ì–´ì˜¤ê²Œ ë˜ë©´ <a href="https://github.com/knative/serving/blob/master/docs/scaling/DEVELOPMENT.md" target="_blank" rel="noopener noreferrer">Knative Serving Activator</a>ì— ì˜í•´ì„œ Podê°€ ì—†ëŠ” Revisionì„ í™•ì¸í•˜ê³  Cold Start í˜•íƒœë¡œ í”„ë¡œë¹„ì €ë‹í•˜ê²Œ ëœë‹¤. ë‚˜ëŠ” ì´ê²Œ ì§„ì •í•œ ì„œë²„ë¦¬ìŠ¤ë¼ê³  ìƒê°í•˜ì§€ë§Œ ì£¼ë³€ì— ë°˜ë°•í•˜ì‹œëŠ” ë¶„ë“¤ë„ ê°„í˜¹ ìˆë‹¤.</p><p>ì´í›„ Podê°€ Warm ìƒíƒœê°€ ë˜ê³  ë‚˜ë©´ Istio Route(Ingress Gateway)ë¥¼ í†µí•´ íŠ¸ë˜í”½ì´ Podë¡œ ì „ë‹¬ë˜ì–´ í†µì‹ ì´ ì´ë¤„ì§€ê²Œ ëœë‹¤.</p><p>í˜„ì¬ KnativeëŠ” í˜„ì¬ Ingress Gateway ì˜ì¡´ì„±ì„ ê°€ì§€ê³  ìˆê³  Envoyê¸°ë°˜ Service Meshì¸ <code>Istio</code>, Envoyê¸°ë°˜ API Gatewayì¸ <code>Gloo</code> ë‘ê°€ì§€ ì˜µì…˜ìœ¼ë¡œ Ingress êµ¬í˜„ì´ ê°€ëŠ¥í•˜ë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="istio">Istio<a class="hash-link" href="#istio" title="Direct link to heading">â€‹</a></h2><p>KnativeëŠ” ê¸°ë³¸ì ìœ¼ë¡œ Ingress Gatewayê¸°ëŠ¥ì„ íƒ‘ì¬í•˜ê³  ìˆëŠ”ë° ì´ëŠ” Istioì˜ ê¸°ëŠ¥ì¤‘ í•˜ë‚˜ë‹¤.<br>
<!-- -->IstioëŠ” ë‹¤ìŒê³¼ ê°™ì€ Core Featureë¥¼ ê°€ì§„ë‹¤. ìƒì„¸í•œ ë‚´ìš©ì€ <a href="https://istio.io/docs/concepts/what-is-istio/" target="_blank" rel="noopener noreferrer">https://istio.io/docs/concepts/what-is-istio/</a> ì—ì„œ í™•ì¸í•˜ë©´ ëœë‹¤.</p><ul><li>Traffic management</li><li>Security</li><li>Policies and Telemetry</li><li>Performance and Scalability</li></ul><p>IstioëŠ” 48ê°œì˜ <code>CRDs</code>(CustomResourceDefinition objects)ë¥¼ ê°€ì§€ê³  ìˆëŠ”ë° ì´ì¤‘ Knative Servingì—ì„œ ì‚¬ìš©í•˜ëŠ”ê±´ <code>VirtualService</code> ë‹¨ í•˜ë‚˜ë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="gloo">Gloo<a class="hash-link" href="#gloo" title="Direct link to heading">â€‹</a></h2><p><a href="https://gloo.solo.io/" target="_blank" rel="noopener noreferrer">Gloo</a>ëŠ” Kubernetes-native ingress controllerì´ì <a href="https://medium.com/solo-io/announcing-gloo-the-function-gateway-3f0860ef6600" target="_blank" rel="noopener noreferrer">Next Generation API Gateway</a> ë¥¼ ìœ„í•´ ì‹œì‘ëœ í”„ë¡œì íŠ¸ì´ë‹¤. ì‹¤ì œ Redhatì—ì„œ Openshiftê¸°ë°˜ Microservice ë° Istio ê°œë°œì—…ë¬´ë¥¼ í•˜ë‹¤ê°€ ìµœê·¼ì— solo.ioì˜ CTOë¡œ ì´ì§í•œ <a href="https://blog.christianposta.com/" target="_blank" rel="noopener noreferrer">Christian Posta</a>ê°€ ë°€ê³  ìˆëŠ” í”„ë¡œì íŠ¸ì´ê¸°ë„ í•˜ë‹¤. </p><p><img loading="lazy" src="https://cdn-images-1.medium.com/max/1600/0*Z0Jb5DJFOyeY91sN." alt="gloo" class="img_E7b_"></p><p><code>Gloo</code>ëŠ” Envoy Proxy ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•˜ë©°
ê¸°ì¡´ Legacyë¶€í„° Containerì„œë¹„ìŠ¤, FaaS(AWS Lambda, Azure Functions, GCP Functions)ì˜ì—­ì˜ Applicationë“¤ì„ REST, gRPC, SOAP, Web Sockerê¸°ë°˜ìœ¼ë¡œ Aggregate í•´ì„œ Function ê¸°ë°˜ ì¶”ìƒí™”ë¥¼ êµ¬í˜„í•´ ì£¼ëŠ” ì˜¤í”ˆì†ŒìŠ¤ í”„ë¡œì íŠ¸ë¼ ì •ì˜ í•  ìˆ˜ ìˆë‹¤. </p><p>Istioì˜ Ingressê¸°ëŠ¥ì™¸ì˜ ì—¬ëŸ¬ê°€ì§€ ë¶€ê°€ ê¸°ëŠ¥(Telemetry, Security, Policy Enforcement)ë“¤ì€ Knativeì—ì„œëŠ” í•„ìš”ë¡œ í•˜ì§€ ì•ŠëŠ”ë‹¤. </p><p>Knative API Gateway ë¡œì„œ Istioê°€ ì•„ë‹Œ Glooê°€ ì¡°ê¸ˆë” ê²½ëŸ‰í™”ëœ ëŒ€ì•ˆìœ¼ë¡œ ê²°ì •ë˜ì—ˆê³  Glooë¥¼ í†µí•´ Knative ì„¤ì¹˜ê°€ ê°€ëŠ¥í•˜ê²Œ ë˜ì—ˆë‹¤. ë‹¨, Knative Eventing ì»´í¬ë„ŒíŠ¸ëŠ” í˜„ì¬ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤ê³  í•œë‹¤. </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="install-knative-with-gloo">Install Knative with Gloo<a class="hash-link" href="#install-knative-with-gloo" title="Direct link to heading">â€‹</a></h2><p>ì°¸ê³ : <a href="https://github.com/knative/docs/blob/master/install/Knative-with-Gloo.md" target="_blank" rel="noopener noreferrer">Install with Gloo</a></p><p>ê°„ë‹¨í•˜ê²Œ glooì™€ Knative ì„¤ì¹˜ë¥¼ í•´ë³´ì.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="requirements">Requirements<a class="hash-link" href="#requirements" title="Direct link to heading">â€‹</a></h3><ul><li>Kubernetes cluster v1.11 or newer </li><li>Enable <a href="https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#how-do-i-turn-on-an-admission-controller" target="_blank" rel="noopener noreferrer">MutatingAdmissionWebhook admission controller</a></li><li>kubectl v1.10 or newer</li><li>Bash in Mac or Linux</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="install-glooctl">Install Glooctl<a class="hash-link" href="#install-glooctl" title="Direct link to heading">â€‹</a></h3><p>gloo CLI (glooctl) Download<br>
<a href="https://github.com/solo-io/gloo/releases" target="_blank" rel="noopener noreferrer">https://github.com/solo-io/gloo/releases</a></p><p>ë˜ëŠ” ì§ì ‘ Download</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ curl -sL https://run.solo.io/gloo/install | sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attempting to download glooctl version v0.8.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Downloading glooctl-darwin-amd64...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Download complete!, validating checksum...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Checksum valid.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Gloo was successfully installed ğŸ‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Add the gloo CLI to your path with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  export PATH=$HOME/.gloo/bin:$PATH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Now run:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  glooctl install gateway     # install gloo's function gateway functionality into the 'gloo-system' namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  glooctl install ingress     # install very basic Kubernetes Ingress support with Gloo into namespace gloo-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  glooctl install knative     # install Knative serving with Gloo configured as the default cluster ingress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Please see visit the Gloo Installation guides for more:  https://gloo.solo.io/installation/</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>PATH ë“±ë¡</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ export PATH=$HOME/.gloo/bin:$PATH</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>gloo CLI í™•ì¸</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ glooctl --version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">glooctl version 0.8.1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>GCP ë¬´ë£Œí”Œëœìœ¼ë¡œ 3-node í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ gcloud container clusters create gloo \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --region=asia-east1-a \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --cluster-version=latest \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --machine-type=n1-standard-2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --enable-autorepair \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --num-nodes=3</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>cluster ìƒì„±ëœê²ƒì„ í™•ì¸í•˜ê³  cluster-admin ê¶Œí•œì„ í• ë‹¹í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get nodes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                  STATUS    ROLES     AGE       VERSION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gke-gloo-default-pool-f6bcc479-f8v9   Ready     &lt;none&gt;    9m        v1.11.7-gke.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gke-gloo-default-pool-f6bcc479-fl78   Ready     &lt;none&gt;    9m        v1.11.7-gke.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gke-gloo-default-pool-f6bcc479-gfgw   Ready     &lt;none&gt;    9m        v1.11.7-gke.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create clusterrolebinding cluster-admin-binding \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;   --clusterrole=cluster-admin \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;   --user=$(gcloud config get-value core/account)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Your active configuration is: [cloudshell-25974]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusterrolebinding.rbac.authorization.k8s.io "cluster-admin-binding" created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Glooì™€ Knative ì„¤ì¹˜ë¥¼ í•œë‹¤. ë¯¸ë¦¬ <code>glooctl install knative --dry-run</code> ìœ¼ë¡œ ì „ì²´ manifestë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ glooctl install knative</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ì—ì„œ ì„¤ì¹˜ ê³¼ì •ì€ ìƒëµí–ˆì§€ë§Œ Istioì— ë¹„í•´ CRD ê°œìˆ˜ê°€ ì ì€ ê²ƒì„ ì•Œìˆ˜ìˆë‹¤. ë˜í•œ ì„¤ì¹˜ëœ ì»´í¬ë„ŒíŠ¸ ì—­ì‹œ Istioì— ë¹„í•´ì„œ ê°„ì†Œí™”ëœ ê²ƒì„ ì•Œìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pods --namespace gloo-system                                                                                         </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                   READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusteringress-proxy-59fd6fb56-dmwwm   1/1       Running   0          7m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">discovery-779884d4cc-xlql2             1/1       Running   6          7m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gloo-844fc79445-f4zvg                  1/1       Running   6          7m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ingress-7d75c99874-s4m76               1/1       Running   6          7m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pods --namespace knative-serving</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                          READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">activator-746f6bb684-49tfh    1/1       Running   0          12m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">autoscaler-955f679cd-tx5vw    1/1       Running   0          12m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">controller-7fc84c6584-jbn69   1/1       Running   0          12m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">webhook-7797ffb6bf-6pgsw      1/1       Running   0          12m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´ì „ í¬ìŠ¤íŒ…ì—ì„œë„ ì‚¬ìš©í–ˆë˜ <code>gcr.io/knative-sample/helloworld-go</code> ì´ë¯¸ì§€ë¥¼ í™œìš©í•˜ì—¬ ìƒ˜í”Œì•± Knative Serviceë¥¼ ë§Œë“ ë‹¤.</p><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="serviceyaml">service.yaml<a class="hash-link" href="#serviceyaml" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ vi service.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: serving.knative.dev/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: helloworld-go</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  runLatest:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    configuration:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      revisionTemplate:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          container:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            image: gcr.io/knative-sample/helloworld-go</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              - name: TARGET</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                value: "Go Sample v1"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl apply --filename service.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service.serving.knative.dev "helloworld-go" created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì•ì—ì„œë„ ì„¤ëª…í–ˆì§€ë§Œ <code>Automatic scaling up and down to zero</code> ìœ¼ë¡œ Cold Startê°€ ë˜ê³  ì ì‹œí›„ì— ì•„ë˜ì™€ ê°™ì´ Knative Serviceë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get ksvc helloworld-go -n default  --output=custom-columns=NAME:.metadata.name,DOMAIN:.status.domain]($ kubectl get ksvc helloworld-go -n default  --output=custom-columns=NAME:.metadata.name,DOMAIN:.status.d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">omain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME            DOMAIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helloworld-go   helloworld-go.default.example.com</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Gloo Ingressë¥¼ í™•ì¸í•œë‹¤. GKEì—ì„œ ì„¤ì¹˜í–ˆê¸° ë•Œë¬¸ì— ìë™ìœ¼ë¡œ LoadBalancerê°€ ì—°ë™ë˜ì–´ ìˆëŠ”ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get svc -n gloo-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                   TYPE           CLUSTER-IP     EXTERNAL-IP   PORT(S)                      AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusteringress-proxy   LoadBalancer   10.3.244.54    34.**.**.54   80:30978/TCP,443:32448/TCP   39m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gloo                   ClusterIP      10.3.243.231   &lt;none&gt;        9977/TCP                     39m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ glooctl proxy url --name clusteringress-proxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">http://34.**.**.54:80</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ì—ì„œ ì–»ì€ ë‘ê°€ì§€ ì •ë³´ë¡œ ìƒì„±ëœ appì„ í…ŒìŠ¤íŠ¸í•œë‹¤. Cold Start(default timeout 5ë¶„) ë•Œë¬¸ì— ì‘ë‹µì´ ëŠ¦ì–´ì§ˆ ìˆ˜ë„ ìˆì§€ë§Œ ì ì‹œ ê¸°ë‹¤ë¦¬ë©´ ì‘ë‹µì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ curl -H "Host: helloworld-go.default.example.com" http://34.**.**.54:80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello Go Sample v1!</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë¬¼ë¡  <code>Revision</code>ì´ë‚˜ <code>Route</code>ë¥¼ í™œìš©í•˜ì—¬ Knativeì˜ ê¸°ëŠ¥ì— ëŒ€í•´ì„œë„ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>GlooëŠ” Knative ClusterIngress CRDë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•˜ëŠ” Istioì˜ ëŒ€ì•ˆìœ¼ë¡œì„œ ê°€ëŠ¥ì„±ì„ ë³´ì—¬ì£¼ê³  ìˆë‹¤. ì´ì™¸ì—ë„ The Service Mesh Orchestration Platform <code>SuperGloo</code>, Debugger for microservices <code>Squash</code> ë“± ë‹¤ì–‘í•œ Mesh Layerê¸°ë°˜ì˜ ì˜¤í”ˆì†ŒìŠ¤ë“¤ì„ í™•ì¸í• ìˆ˜ ìˆë‹¤. ë˜ë‹¤ë¥¸ ìŠ¤ì³ì§€ë‚˜ê°ˆìˆ˜ë„ ìˆëŠ” ì˜¤í”ˆì†ŒìŠ¤ì¼ìˆ˜ë„ ìˆê² ì§€ë§Œ í˜„ì¬ ê°œë°œë˜ëŠ” ë¡œë“œë§µ(<a href="https://www.solo.io/)%EC%9D%84" target="_blank" rel="noopener noreferrer">https://www.solo.io/)ì„</a> ë³´ë©´ Knativeê°€ ê³ ë„í™”ë˜ëŠ” ì—¬ì •ì— ê°™ì´ ê°€ëŠ” ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><p>next-generation API Gatewayë¡œì„œ ë‹¤ì–‘í•œ í”„ë¡œí† ì½œì„ ì§€ì›í•˜ê¸° ë•Œë¬¸ì— (HTTP1, HTTP2, gRPC, REST/OpenAPISpec, SOAP, WebSockets, Lambda/Cloud Functions) ë”ìš±ë” Microservices ë° Serverless Workloadë¥¼ ìˆ˜í–‰í•˜ê¸°ì— ë”ìš± ì í•©í•œ ì˜¤í”ˆì†ŒìŠ¤ë¡œ ë³´ì¸ë‹¤. </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ë‹¤ìŒ-ì£¼ì œ">ë‹¤ìŒ ì£¼ì œ<a class="hash-link" href="#ë‹¤ìŒ-ì£¼ì œ" title="Direct link to heading">â€‹</a></h2><p>í˜„ì¬ í•´ë³´ê³  ì‹¶ì€ê²ƒì€ ë² ì–´ë©”íƒˆ Kubernetes Clusterê¸°ë°˜ BGPë¡œ ë™ì‘í•˜ëŠ” <a href="https://metallb.universe.tf/" target="_blank" rel="noopener noreferrer">MetalLB</a>ë‚˜ <a href="https://cilium.io/try-eks/" target="_blank" rel="noopener noreferrer">Cillium on AWS</a> ì¸ë° ì‹œê°„ë‚˜ëŠ” ëŒ€ë¡œ í…ŒìŠ¤íŠ¸ í•´ë´ì•¼ ê² ë‹¤.</p>]]></content>
        <category label="Knative" term="Knative"/>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="FaaS" term="FaaS"/>
        <category label="Serverless" term="Serverless"/>
        <category label="CRDs" term="CRDs"/>
        <category label="CloudEvents" term="CloudEvents"/>
        <category label="Mesh" term="Mesh"/>
        <category label="Gloo" term="Gloo"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Knative CLI - knctl]]></title>
        <id>kubernetes/knative-knctl/</id>
        <link href="https://ddii.dev/kubernetes/knative-knctl/"/>
        <updated>2019-02-18T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Knative CLI tool knctlì— ëŒ€í•´ ì•Œì•„ë³´ì]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="knctl">knctl<a class="hash-link" href="#knctl" title="Direct link to heading">â€‹</a></h2><p><code>knctl</code> ì€ Knative CLI íˆ´ë¡œ ê°„ë‹¨í•˜ê²Œ knative clusterë¥¼ ë§Œë“¤ê³  Knativeë¥¼ ì¶”ìƒí™”í•´ì„œ ì•±ê¹Œì§€ ë°°í¬í•  ìˆ˜ ìˆëŠ” ì˜¤í”ˆì†ŒìŠ¤ì´ë‹¤. </p><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì°¸ê³ ">ì°¸ê³ <a class="hash-link" href="#ì°¸ê³ " title="Direct link to heading">â€‹</a></h4><ul><li><a href="https://github.com/cppforlife/knctl" target="_blank" rel="noopener noreferrer">https://github.com/cppforlife/knctl</a>  </li><li><a href="https://developer.ibm.com/blogs/2018/11/12/knctl-a-simpler-way-to-work-with-knative/" target="_blank" rel="noopener noreferrer">https://developer.ibm.com/blogs/2018/11/12/knctl-a-simpler-way-to-work-with-knative/</a>  </li><li><a href="https://starkandwayne.com/blog/public-traffic-into-knative-on-gke/" target="_blank" rel="noopener noreferrer">https://starkandwayne.com/blog/public-traffic-into-knative-on-gke/</a></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="knative-ë‹¤ì‹œ-ì‚´í´ë³´ê¸°">Knative ë‹¤ì‹œ ì‚´í´ë³´ê¸°<a class="hash-link" href="#knative-ë‹¤ì‹œ-ì‚´í´ë³´ê¸°" title="Direct link to heading">â€‹</a></h3><p><a href="https://ddii.dev/kubernetes/knative/" target="_blank" rel="noopener noreferrer">ì•ì„  í¬ìŠ¤íŒ…ì—ì„œë„ ì´ì•¼ê¸°</a> í–ˆì§€ë§Œ ê¸°ì¡´ FaaS(AWS Lambda, Google Cloud Funtions, Azure Function) ê³¼ëŠ” ë‹¤ë¥¸ Serverless ê°œë…ìœ¼ë¡œ ë°›ì•„ë“¤ì–´ì•¼ í•œë‹¤.</p><p>ë‹¤ì‹œ í•œë²ˆ íŠ¹ì§•ì„ ë‚˜ì—´í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ë‹¤.</p><ul><li>Serverless Containerì˜ ì‹ ì†í•œ ë°°ì¹˜ </li><li>Automatic scaling up and down to zero</li><li>Istioë¥¼ ë°±ì—”ë“œë¡œ í™œìš©í•˜ì—¬ Routing êµ¬í˜„</li><li>ë°°í¬ ëœ ì½”ë“œ ë° configì˜ íŠ¹ì • ì‹œì  ìŠ¤ëƒ… ìƒ·</li></ul><p>ê·¸ë¦¬ê³  ë‹¤ìŒê³¼ ê°™ì€ CRDs(Custom Resource Definitions)ë¡œ êµ¬ì„±ëœ ì˜¤ë¸Œì íŠ¸ë“¤ë¡œ ì •ì˜ëœë‹¤.</p><ul><li><code>Route</code>ëŠ” ì‚¬ìš©ì ì„œë¹„ìŠ¤ì— ëŒ€í•œ HTTP endpointì™€ Routingì„ ì œê³µí•œë‹¤.</li><li><code>Revisions</code>ì€ code(function)ì™€ configë¡œ êµ¬ì„±ëœ ë¶ˆë³€ì˜ ìŠ¤ëƒ…ìƒ·. Routeë¥¼ í†µí•´ endpointë¥¼ í• ë‹¹ë°›ì§€ ëª»í•œ Revisionì€ ìë™ìœ¼ë¡œ kubernetes resourceì—ì„œ ì‚­ì œë¨</li><li><code>Configuration</code>ì€ ìš”êµ¬ë˜ëŠ” Revision ìµœì‹  ìƒíƒœë¥¼ ê¸°ë¡í•˜ê³  ìƒì„±í•˜ê³  ì¶”ì í• ìˆ˜ ìˆìŒ. ì†ŒìŠ¤ íŒ¨í‚¤ì§€(git repoë‚˜ archive)ë¥¼ ì»¨í…Œì´ë„ˆë¡œ ë³€í™˜í•˜ê¸° ìœ„í•œ ë‚´ìš©ì´ë‚˜ ë©”íƒ€ë°ì´í„°ë“±ì„ í¬í•¨ì‹œí‚¬ìˆ˜ ìˆìŒ. </li><li><code>Service</code>ëŠ” <code>Routes</code>ì™€ <code>Configurations</code> ë¦¬ì†ŒìŠ¤ì˜ ì¶”ìƒí™”ëœ ì§‘í•©ì²´. ëª¨ë“  ì›Œí¬ë¡œë“œì˜ lifecycleì„ ê´€ë¦¬í•¨. íŠ¸ë˜í”½ì„ í•­ìƒ ìµœì‹ ì˜ Revisionìœ¼ë¡œ routeë˜ë„ë¡ ì •ì˜í• ìˆ˜ ìˆìŒ</li></ul><p>í•˜ë‚˜ì”© ì¡°ê¸ˆ ìì„¸íˆ ì´ì•¼ê¸° í•˜ë©´ ì•„ë˜ì²˜ëŸ¼ ì •ë¦¬ í• ìˆ˜ ìˆë‹¤.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="route">Route<a class="hash-link" href="#route" title="Direct link to heading">â€‹</a></h3><p><strong>Route</strong>ëŠ” ì‚¬ìš©ì ì„œë¹„ìŠ¤(Codeì™€ Configurationì˜ Revisionì •ë³´)ì˜ ë„¤íŠ¸ì›Œí¬ Endpointë¥¼ ì œê³µí•œë‹¤. kubernetes namespaceëŠ” ì—¬ëŸ¬ê°œì˜ <code>Route</code>ë¥¼ ê°€ì§ˆìˆ˜ ìˆë‹¤. <code>Route</code>ëŠ” í•˜ë‚˜ ì´ìƒì˜ <code>Revisions</code>ì„ ê°€ì§€ë©´ì„œ ìˆ˜ëª…ì´ ê¸¸ê³  ì•ˆì •ì ì¸ HTTP Endpointë¥¼ ì œê³µí•œë‹¤. ê¸°ë³¸êµ¬ì„±ì€ <code>Route</code> ê°ì²´ê°€ <code>Configuration</code>ì— ì˜í•´ ìƒì„±ëœ ìµœì‹ ì˜ Revisionìœ¼ë¡œ íŠ¸ë˜í”½ì„ ìë™ìœ¼ë¡œ ì§€ì •í•œë‹¤. ì¡°ê¸ˆë” ë³µì¡í•œ ê²½ìš°ë¡œëŠ” istioì˜ ê¸°ëŠ¥ì„ í™œìš©í•˜ì—¬ íŠ¸ë˜í”½ì„ ë°±ë¶„ìœ¨ ê¸°ì¤€ìœ¼ë¡œ <code>Route</code>ë¥¼ ì§€ì •í•  ìˆ˜ ìˆë‹¤. </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="revision">Revision<a class="hash-link" href="#revision" title="Direct link to heading">â€‹</a></h3><p><strong>Revision</strong>ì€ Codeì™€ Configurationì˜ ë¶ˆë³€ì˜ ìŠ¤ëƒ…ìƒ·ì´ë‹¤. í•˜ë‚˜ì˜ <code>Revision</code>ì€ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ ì°¸ì¡°í•˜ê³  ì„ íƒì ìœ¼ë¡œ <code>Build</code>ë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆë‹¤. <code>Revision</code>ì€ <strong>Configuration</strong>ì´ ì—…ë°ì´íŠ¸ ì‹œ ìƒì„±ëœë‹¤.<br>
<code>Route</code>ë¥¼ í†µí•´ httpì£¼ì†Œ ì§€ì •ì´ ë¶ˆê°€ëŠ¥í•œ <code>Revision</code>ì€ íê¸° ë˜ê³  ê´€ë ¨ëœ kubernetes ë¦¬ì†ŒìŠ¤ê°€ ì‚­ì œê°€ ëœë‹¤. ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ <code>Configuration</code>ì´ ìƒì„±í•œ <code>Revision</code> íˆìŠ¤í† ë¦¬ê°€ ì œê³µë˜ê³  ì‚¬ìš©ìëŠ” ì´ì „ <code>Revision</code>ë¡œ ì‰½ê²Œ ë¡¤ë°± í•  ìˆ˜ ìˆë‹¤.  </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="configuration">Configuration<a class="hash-link" href="#configuration" title="Direct link to heading">â€‹</a></h3><p><code>Configuration</code>ì€ ìµœì‹ ì˜ <code>Revision</code>ìƒíƒœë¥¼ ì„¤ëª…í•˜ê³ , ìƒì„±í•˜ê³ , ì›í•˜ëŠ” ìƒíƒœê°€ ê°±ì‹ ë ë•Œ <code>Revision</code>ì˜ ìƒíƒœë¥¼ ì¶”ì í•œë‹¤. <code>Configuration</code>ì€ <code>Build</code>ë¥¼ ì°¸ì¡°í•˜ì—¬ ì†ŒìŠ¤(git repo ë˜ëŠ” archive)ë¥¼ ì»¨í…Œì´ë„ˆë¡œ ë³€í™˜í•˜ëŠ” ë°©ë²•ì— ëŒ€í•œ ê°€ì´ë“œê°€ í¬í•¨ë˜ì–´ ìˆê±°ë‚˜ ë‹¨ìˆœíˆ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ë° ìˆ˜ì •ì—ì„œ í•„ìš”í•œ ë©”íƒ€ ë°ì´í„° ë§Œ ì°¸ì¡° í•  ìˆ˜ ìˆë‹¤. </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="product-integration">Product Integration<a class="hash-link" href="#product-integration" title="Direct link to heading">â€‹</a></h3><p>2019ë…„ 2ì›” í˜„ì¬ 0.3ì´ ë¦´ë¦¬ìŠ¤ë˜ê³  ìˆê³  ë²Œì¨ ì—¬ëŸ¬ ì œí’ˆì— í†µí•©ì´ ë˜ê³  ìˆë‹¤. </p><p>ìµœê·¼ IBMthink 2019ì—ì„œ Managed Knative (Experimental)ë¥¼ ë‚´ë†“ê¸°ë„ í•˜ì˜€ë‹¤.<br>
<a href="https://www.ibm.com/blogs/bluemix/2019/02/announcing-managed-knative-on-ibm-cloud-kubernetes-service-experimental/" target="_blank" rel="noopener noreferrer">https://www.ibm.com/blogs/bluemix/2019/02/announcing-managed-knative-on-ibm-cloud-kubernetes-service-experimental/</a> </p><p>Istioë¥¼ í¬í•¨í•œ Knative ë§ˆì €ë„ í’ˆëŠ” ëª¨ìŠµìœ¼ë¡œ managed kubernetes ì˜ì—­ì—ì„œ ê¸€ë¡œë²Œ í”Œë ˆì´ì–´ë“¤ ëª¨ë‘ ì„œë¡œ ì¹˜ê³ ë‚˜ê°€ëŠ” ëª¨ìŠµë“¤ì„ ë³¼ìˆ˜ ìˆë‹¤. </p><p>ì‘ë…„ 11ì›”ì—ëŠ” Gitlab ì œí’ˆì•ˆì— serverlessë¼ëŠ” extensioní˜•íƒœì˜ ì„œë¹„ìŠ¤ê°€ ì¶”ê°€ ë˜ê¸°ë„ í•˜ì˜€ê³ ,<br>
<a href="https://about.gitlab.com/press/releases/2018-12-11-gitlab-and-triggermesh-announce-gitlab-serverless.html" target="_blank" rel="noopener noreferrer">https://about.gitlab.com/press/releases/2018-12-11-gitlab-and-triggermesh-announce-gitlab-serverless.html</a></p><p>triggermesh ë¼ëŠ” ê³³ì—ì„œëŠ” serverless management platformì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ knative ê¸°ë°˜ ë©€í‹° ì„œë²„ë¦¬ìŠ¤ í”Œë«í¼ì„ ì¶œì‹œí•˜ê¸°ë„ í•˜ì˜€ë‹¤.<br>
<a href="https://triggermesh.com/serverless_management_platform/" target="_blank" rel="noopener noreferrer">https://triggermesh.com/serverless_management_platform/</a></p><p>Pivotal Function Service (PFS), Google GKE SERVERLESS ADD-ON ë“±ì€ ì•„ì§ early access ì‹ ì²­ë§Œ ë°›ê³  ìˆëŠ” ìƒíƒœì´ë‹¤.</p><p>ì˜¤ëŠ˜ì€ ê°„ë‹¨í•˜ê²Œ ë°°í¬í• ìˆ˜ ìˆëŠ” íˆ´ knctlê³¼ ê´€ë ¨ use-caseë¥¼ ì†Œê°œí•˜ê³ ì í•œë‹¤.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kubernetes-cluster-ìƒì„±">Kubernetes Cluster ìƒì„±<a class="hash-link" href="#kubernetes-cluster-ìƒì„±" title="Direct link to heading">â€‹</a></h3><p>ì¼ë‹¨ GKE Free tierì—ì„œ Clusterë¥¼ í•˜ë‚˜ ìƒì„±í•˜ì.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">gcloud container clusters create knative \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --region=asia-east1-a \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --cluster-version=latest \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --machine-type=n1-standard-2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --enable-autoscaling --min-nodes=1 --max-nodes=5 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --enable-autorepair \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --scopes=service-control,service-management,compute-rw,storage-ro,cloud-platform,logging-write,monitoring-write,pubsub,datastore \  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --num-nodes=3</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>cluster ìƒì„±ëœê²ƒì„ í™•ì¸í•˜ê³  cluster-admin ê¶Œí•œì„ í• ë‹¹í•œë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get nodes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                     STATUS    ROLES     AGE       VERSION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gke-knative-default-pool-d1a39347-5m5t   Ready     &lt;none&gt;    1m        v1.11.7-gke.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gke-knative-default-pool-d1a39347-l6zh   Ready     &lt;none&gt;    1m        v1.11.7-gke.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gke-knative-default-pool-d1a39347-qv5r   Ready     &lt;none&gt;    1m        v1.11.7-gke.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create clusterrolebinding cluster-admin-binding \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --clusterrole=cluster-admin \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --user=$(gcloud config get-value core/account)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Your active configuration is: [cloudshell-4728]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusterrolebinding.rbac.authorization.k8s.io "cluster-admin-binding" created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="knctl-ì„¤ì¹˜">knctl ì„¤ì¹˜<a class="hash-link" href="#knctl-ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h2><p>ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” Mac OS ì„¤ì¹˜ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±í•˜ì˜€ë‹¤.</p><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="homebrew-ì„¤ì¹˜">homebrew ì„¤ì¹˜<a class="hash-link" href="#homebrew-ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">brew install starkandwayne/kubernetes/knctl</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="binary">binary<a class="hash-link" href="#binary" title="Direct link to heading">â€‹</a></h4><p><a href="https://github.com/cppforlife/knctl/releases" target="_blank" rel="noopener noreferrer">https://github.com/cppforlife/knctl/releases</a> </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ wget https://github.com/cppforlife/knctl/releases/download/v0.1.0/knctl-darwin-amd64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ mv knctl-* /usr/local/bin/knctl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ chmod +x /usr/local/bin/knctl</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="knctl-ë¡œ-knative-ë°°í¬">knctl ë¡œ Knative ë°°í¬<a class="hash-link" href="#knctl-ë¡œ-knative-ë°°í¬" title="Direct link to heading">â€‹</a></h2><p>ì„¤ì¹˜í•œ knctlë¡œ Knative ë°°í¬ë¥¼ ì§„í–‰í•œë‹¤. ì„¤ì¹˜ë˜ëŠ” ë‚´ìš©ì„ ì§€ì¼œë³´ê³  ìˆìœ¼ë©´ <code>istio</code>ë¥¼ ë¨¼ì € ë°°í¬í•˜ê³  ê·¸ë‹¤ìŒì— <code>Knative</code>ë¥¼ ì„¤ì¹˜í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ë°°í¬ë˜ëŠ” ëª¨ë“ˆë“¤ì˜ ìƒíƒœë¥¼ í•˜ë‚˜í•˜ë‚˜ ì²´í¬í•´ì„œ ë°°í¬í•˜ê¸° ë•Œë¬¸ì— ì„¤ì¹˜ìƒì— ê³¼ì •ë“¤ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ knctl install --exclude-monitoring</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ namespace <code>hello-test</code>ë¥¼ ìƒì„±í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create namespace hello-test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namespace "hello-test" created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>knctl deploy ëª…ë ¹ìœ¼ë¡œ ìµœì´ˆ revisionì„ ë°°í¬í•œë‹¤.<br>
<!-- -->ì•„ë˜ ê²°ê³¼ë¥¼ ë³´ë©´ hello-00001 ì´ë¼ê³  í•˜ëŠ” ìµœì´ˆì˜ revisionì„ ì‘ì„±í•˜ê¸° ë•Œë¬¸ì— <code>latest</code> tagë¥¼ ë‹¬ê³  ë°°í¬ë¥¼ í•˜ê²Œ ëœë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ knctl deploy \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --namespace hello-test \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --service hello \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --image gcr.io/knative-samples/helloworld-go \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      --env TARGET=Rev1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name  hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Waiting for new revision to be created...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Tagging new revision 'hello-00001' as 'latest'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Tagging new revision 'hello-00001' as 'previous'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Annotating new revision 'hello-00001'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Waiting for new revision 'hello-00001' to be ready for up to 5m0s (logs below)...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello-00001 &gt; hello-00001-deployment-5cdbfc9bc9-hks6t | 2019/02/17 22:27:50 Hello world sample started.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Revision 'hello-00001' became ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Continuing to watch logs for 5s before exiting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Succeeded</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get svc knative-ingressgateway -n istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                     TYPE           CLUSTER-IP      EXTERNAL-IP    PORT(S)                                                                                                                   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">knative-ingressgateway   LoadBalancer   10.63.253.209   34.***.***.248   80:32380/TCP,443:32390/TCP,31400:32400/TCP,15011:30082/TCP,8060:31125/TCP,853:32009/TCP,15030:31102/TCP,15031:31631/TCP   6h</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ì²˜ëŸ¼ Knativeê°€ í”„ë¡œë¹„ì €ë‹ ë˜ë©´ì„œ ingress-gatewayê°€ í•˜ë‚˜ ìƒì„±ì´ ë˜ì–´ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆê³  knctlë¡œë„ ingressë¥¼ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ knctl ingress list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ingresses</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name                    Addresses     Ports  Age</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">knative-ingressgateway  34.***.***.248  80     6h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        443</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        31400</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        15011</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        8060</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        853</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        15030</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        15031</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1 ingresses</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Succeeded</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="knative-custom-domain-ì—°ê²°">Knative custom domain ì—°ê²°<a class="hash-link" href="#knative-custom-domain-ì—°ê²°" title="Direct link to heading">â€‹</a></h2><p>Domainì´ ë³„ë„ë¡œ ì—†ê¸° ë•Œë¬¸ì— KnativeëŠ” ë‚´ë¶€ì ìœ¼ë¡œ example.comì´ë¼ê³  í•˜ëŠ” ê¸°ë³¸ domainì„ ì‚¬ìš©í•œë‹¤. ê·¸ë˜ì„œ ì‹¤ì œ <code>knctl curl</code> ëª…ë ¹ì€ ë‚´ë¶€ì ìœ¼ë¡œ <code>hello.hello-test.example.com</code>ìœ¼ë¡œ curlì„ ì‹¤í–‰í•˜ê²Œ ë˜ê³  í•´ë‹¹ ê²°ê³¼ë¥¼ ì•„ë˜ì™€ ê°™ì´ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ knctl curl --service hello -n hello-test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running: curl '-sS' '-H' 'Host: hello.hello-test.example.com' 'http://34.***.***.248:80'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello Rev1!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Succeeded</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>kubernetes nodeê°€ 3ê°œì´ë¯€ë¡œ 3ê°œì˜ podê°€ ìƒì„±ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì¼ì •ì‹œê°„(default:5ë¶„)ì´ ì§€ë‚˜ë©´ <code>zero to scale</code> ê´€ì ì—ì„œ podê°€ ì¢…ë£Œë˜ë¯€ë¡œ ë‹¤ì‹œ í™•ì¸í• ë•ŒëŠ” ë‹¤ì‹œ curl ëª…ë ¹ì„ ë‚ ë¦¬ê²Œ ë˜ë©´ ë‹¤ì‹œ podê°€ ì˜¬ë¼ì˜¤ê²Œ ëœë‹¤. í•´ë‹¹ ê°œë…ì€ FaaSë˜ëŠ” AWS Lambdaì—ì„œ Cold-Startì™€ ë™ì¼í•œ ê²ƒì´ë¼ ë³¼ ìˆ˜ ìˆë‹¤.  </p><p>AWS Cold Start ì°¸ê³  : <a href="https://novemberde.github.io/aws/2018/02/02/Lambda_coldStart.html" target="_blank" rel="noopener noreferrer">https://novemberde.github.io/aws/2018/02/02/Lambda_coldStart.html</a></p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get po</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                      READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello-00001-deployment-5cdbfc9bc9-hks6t   3/3       Running   0          4m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê°€ì§€ê³  ìˆëŠ” ë„ë©”ì¸ì´ ìˆë‹¤ë©´ ìœ„ì—ì„œ ë‚˜ì˜¨ <code>34.***.***.248</code> IPë¥¼ domainì— ë§¤í•‘í•´ë³´ì.
ì•„ë˜ì—ì„œëŠ” ê¸°ì¡´ ë³´ìœ ì¤‘ì¸ skcloud.io ë„ë©”ì¸ì„ ì—°ê²°í•˜ì˜€ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ dig knative.skcloud.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">;; ANSWER SECTION:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">knative.skcloud.io.     603     IN      A       34.***.***.248</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>knctl domainì„ ì´ìš©í•˜ì—¬ default domainì„ <code>knative.skcloud.io</code>ë¡œ ë³€ê²½í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ knctl domain create -d knative.skcloud.io --default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Succeeded</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>knctl routes ëª…ë ¹ìœ¼ë¡œ í•´ë‹¹ hello-test appì˜ Endpoint ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ knctl routes list -n hello-test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Routes in namespace 'hello-test'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name   Domain                               Traffic        Annotations  Conditions  Age</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello  hello.hello-test.knative.skcloud.io  100% -&gt; hello  -            3 OK / 3    1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1 routes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Succeeded</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>5ë¶„ì´ìƒ ê¸°ë‹¤ë ¸ë‹¤ê°€ curlë¡œ í™•ì¸í•˜ë©´ Cold-Start ë˜ëŠ” ì‹œê°„(ëª‡ì´ˆ) ì§€ì—°ì´ ë°œìƒí•˜ê³  ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
ì´í›„ì—ëŠ” ë°”ë¡œ ì‘ë‹µì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ curl http://hello.hello-test.knative.skcloud.io/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello Rev1!</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="revision-ì¶”ê°€">revision ì¶”ê°€<a class="hash-link" href="#revision-ì¶”ê°€" title="Direct link to heading">â€‹</a></h2><p>ì´ë²ˆì—ëŠ” revisionì„ ì¶”ê°€í•´ë³´ì. TARGET environment ë³€ìˆ˜ë¥¼ <code>Rev2</code>ë¡œ ìˆ˜ì •í•˜ê³  ë°°í¬ë¥¼ í•œë‹¤.
ê¸°ì¡´ hello-00002 revisionì´ ìµœì‹  revisionìœ¼ë¡œ ê°±ì‹ ë˜ì–´ ë°°í¬ê°€ ë˜ëŠ”ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ knctl deploy --service hello \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --image gcr.io/knative-samples/helloworld-go \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --env TARGET=Rev2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name  hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Waiting for new revision (after revision 'hello-00001') to be created...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Tagging new revision 'hello-00002' as 'latest'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Tagging older revision 'hello-00001' as 'previous'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Annotating new revision 'hello-00002'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Waiting for new revision 'hello-00002' to be ready for up to 5m0s (logs below)...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello-00002 &gt; hello-00002-deployment-6cf86bbfc7-sblz9 | 2019/02/17 23:25:43 Hello world sample started.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Revision 'hello-00002' became ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Continuing to watch logs for 5s before exiting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Succeeded</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì‹ ê·œ <code>revision</code> ì„œë¹„ìŠ¤ë¥¼ ì¶”ê°€ëœê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ë§ˆì°¬ê°€ì§€ë¡œ ëª‡ì´ˆê°„ì˜ Cold-Start delayê°€ ë°œìƒí•  ìˆ˜ë„ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ curl http://hello.hello-test.knative.skcloud.io/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello Rev2!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ knctl curl --service hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running: curl '-sS' '-H' 'Host: hello.hello-test.knative.skcloud.io' 'http://34.***.***.248:80'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello Rev2!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Succeeded</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>revision listë¥¼ í™•ì¸í•´ë³´ë©´ í˜„ì¬ latest, previous TAGì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ knctl revision list --service hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Revisions for service 'hello'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name         Tags      Annotations  Conditions  Age  Traffic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello-00002  latest    -            1 OK / 4    14m  100% -&gt; hello.hello-test.knative.skcloud.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello-00001  previous  -            1 OK / 4    4h   -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2 revisions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Succeeded</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="bluegreen-ë°°í¬">Blue/Green ë°°í¬<a class="hash-link" href="#bluegreen-ë°°í¬" title="Direct link to heading">â€‹</a></h2><p>Blue/Green DeployëŠ” knctl rollout ëª…ë ¹ìœ¼ë¡œ ìˆ˜í–‰í• ìˆ˜ ìˆë‹¤.<br>
<!-- -->rollout í• ë•Œ <code>--managed-route=false</code> ì˜µì…˜ì„ ì¤˜ì•¼ íŠ¹ì • ë¹„ìœ¨ë¡œ routingì´ ê°€ëŠ¥í•˜ë‹¤.<br>
<!-- -->ì•„ë˜ ì˜ˆì‹œëŠ” TARGET environment ë³€ìˆ˜ë¥¼ <code>blue</code>, <code>green</code>ìœ¼ë¡œ ë°”ê¿”ê°€ë©´ì„œ ë°°í¬ë¥¼ ì§„í–‰í•˜ì˜€ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ knctl deploy --service hello \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --image gcr.io/knative-samples/helloworld-go \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --env TARGET=blue \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --managed-route=false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name  hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Waiting for new revision (after revision 'hello-00002') to be created...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Tagging new revision 'hello-00003' as 'latest'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Tagging older revision 'hello-00002' as 'previous'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Annotating new revision 'hello-00003'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Waiting for new revision 'hello-00003' to be ready for up to 5m0s (logs below)...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Revision 'hello-00003' became ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Continuing to watch logs for 5s before exiting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello-00003 &gt; hello-00003-deployment-99478dcc5-jf267 | 2019/02/17 23:48:20 Hello world sample started.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Succeeded</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>revision listë¥¼ í™•ì¸í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ <code>latest</code>ë¡œ Traffic ì „ì²´ê°€ routing ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ knctl revision list --service hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Revisions for service 'hello'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name         Tags      Annotations  Conditions  Age  Traffic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello-00005  latest    -            4 OK / 4    44s  100% -&gt; hello.hello-test.knative.skcloud.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello-00004  previous  -            4 OK / 4    2m   -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello-00003  -         -            1 OK / 4    5m   -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello-00002  -         -            1 OK / 4    28m  -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello-00001  -         -            1 OK / 4    4h   -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5 revisions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Succeeded</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´í›„ì— rolloutì„ í†µí•´ previousë¡œ 90%, latestë¡œ 10%ë¡œ ë³€ê²½ì„ í•˜ë©´ ì¦‰ì‹œ ë°˜ì˜ì´ ë˜ê³  ì‹¤ì œ íŠ¸ë˜í”½ë„ ë¶„ì‚°ë˜ì–´ ë“¤ì–´ì˜¨ë‹¤. %ê°€ ë‚®ì€ ìª½ìœ¼ë¡œ routingì´ ë  ê²½ìš° Cold-Startê°€ ë°œìƒí•˜ê²Œ ë˜ë©´ delayëŠ” ë°œìƒí•˜ê²Œ ëœë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ knctl rollout --route hello -p hello:latest=10% -p hello:previous=90%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Succeeded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ knctl revision list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Revisions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Service  Name         Tags      Annotations  Conditions  Age  Traffic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello    hello-00005  latest    -            2 OK / 4    1h   10% -&gt; hello.hello-test.knative.skcloud.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">~        hello-00004  previous  -            2 OK / 4    1h   90% -&gt; hello.hello-test.knative.skcloud.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">~        hello-00003  -         -            1 OK / 4    1h   -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">~        hello-00002  -         -            1 OK / 4    1h   -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">~        hello-00001  -         -            1 OK / 4    5h   -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5 revisions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Succeeded</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê°„ë‹¨í•˜ê²Œ curl ë°˜ë³µë¬¸ì„ ì‘ì„±í•˜ì—¬ ëŒë ¤ë³´ì. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">while true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -sS --max-time 3 http://hello.hello-test.knative.skcloud.io/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê°„ë‹¨í•˜ê²Œ ìœ„ shì„ ëŒë¦¬ë©´ ì•„ë˜ì™€ ê°™ì´ Cold-Start delayê°€ ë°œìƒí• ë•Œ time outì´ ë°œìƒí•˜ê³  ì´í›„ green revisionìœ¼ë¡œ ì ‘ì†ì´ ë˜ëŠ”ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./test.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl: (28) Operation timed out after 3002 milliseconds with 0 bytes received</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello blue!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello blue!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello blue!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello blue!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello blue!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl: (28) Operation timed out after 3003 milliseconds with 0 bytes received</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello blue!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello blue!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello blue!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello blue!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello blue!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello blue!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello green!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello blue!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello blue!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello blue!</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ì§€ê¸ˆê¹Œì§€ <code>knctl</code>ì„ ì‚¬ìš©í•˜ì—¬ ê°„ë‹¨í•˜ê²Œ knativeë¥¼ ë°°í¬í•˜ê³  custom domainì„ ì—°ê²°í•˜ì—¬ blue-green ë°°í¬ê¹Œì§€ í•´ë´¤ë‹¤.
ì´ì™¸ì—ë„ Knative Buildë¥¼ í™œìš©í•˜ì—¬ Docker image ì‘ì—…ì„ í•˜ê±°ë‚˜ ì„œë¹„ìŠ¤ ì¹´íƒˆë¡œê·¸ ë“±ì„ ì—°ë™í•˜ì—¬ ì™¸ë¶€ DBaaSë¥¼ ì—°ë™í•˜ëŠ” use-caseë“±ì„ ì°¾ì•„ë³¼ìˆ˜ ìˆë‹¤.</p><p>ì•„ì§ ì´ˆê¸° ë‹¨ê³„ì´ì§€ë§Œ KnativeëŠ” istioì™€ í•¨ê»˜ IBM, Google, Pivotalë“± global playerë“¤ì˜ ì°¨ì„¸ëŒ€ ì˜¤í”ˆì†ŒìŠ¤ë¡œ ë¶€ìƒí•˜ê³  ìˆë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤.  </p><p><code>Zero to scale</code> ì´ë¼ëŠ” ìŠ¬ë¡œê±´ì•„ë˜ Serverless, FaaS ì‚¬ìƒì„ ê¸°ë°˜ìœ¼ë¡œ build, serving, event, routingì´ë¼ê³  í•˜ëŠ” Cloud Computing ì¶”ìƒí™”ì˜ ëíŒìœ¼ë¡œ ì§„í™”í•˜ê³  ìˆë‹¤. ì•ìœ¼ë¡œ ì–´ë–¤ ëª¨ìŠµìœ¼ë¡œ ì§„í™”ë ì§€ ê¶ê¸ˆí•˜ê³  ë‹¤ìŒë²ˆì—ëŠ” MQë‚˜ Pub/subë¥¼ ì—°ë™í•˜ê±°ë‚˜ ë©€í‹° í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œ ë™ì‘í•˜ëŠ” ëª¨ìŠµì„ ë³´ì—¬ì£¼ëŠ” ê²ƒë„ ì¢‹ì„ê²ƒ ê°™ë‹¤. í¬ë§ì‚¬í•­ì´ì§€ë§Œ ì˜¬í•´ OpenInfraDayë‚˜ Kubernetes Day Korea í–‰ì‚¬ì—ì„œ Hands-onì„ ì§„í–‰í•´ë³´ëŠ”ê²ƒë„ ì¢‹ì§€ ì•Šì„ê¹Œ?</p>]]></content>
        <category label="Knative" term="Knative"/>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="FaaS" term="FaaS"/>
        <category label="Serverless" term="Serverless"/>
        <category label="CRDs" term="CRDs"/>
        <category label="CloudEvents" term="CloudEvents"/>
        <category label="Mesh" term="Mesh"/>
        <category label="knctl" term="knctl"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Hybrid Cloud]]></title>
        <id>cloud/Hybrid/</id>
        <link href="https://ddii.dev/cloud/Hybrid/"/>
        <updated>2019-02-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Hybrid Cloud]]></summary>
        <content type="html"><![CDATA[<p>ì˜¤ëŠ˜ë„ ê¸°ìˆ ì ì¸ ì´ì•¼ê¸°ë³´ë‹¤ëŠ” í™”ë‘ê°€ ë˜ê³  ìˆëŠ” í•˜ì´ë¸Œë¦¬ë“œ í´ë¼ìš°ë“œ ì´ì•¼ê¸°ë¥¼ í•´ë³´ê³ ì í•œë‹¤.</p><p>ì—…ê³„ ì‚¬ëŒë“¤ë„ í•˜ì´ë¸Œë¦¬ë“œ, ì—£ì§€ í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ë¥¼ ê¸ì •ì ì¸ ì‹œê°ìœ¼ë¡œ ë³´ê³ ìˆì§€ë§Œ ì„±ìˆ™ë„ ì¸¡ë©´ì—ì„œ ë¬¸ì œê°€ ìˆì–´ ë„ì…ì„ êº¼ë ¤ì™”ë˜ê²Œ ì‚¬ì‹¤ì´ë‹¤. ìµœê·¼ ë™í–¥ì„ ë´¤ì„ë•Œ í¼ë¸”ë¦­ í´ë¼ìš°ë“œ ê³µê¸‰ì‚¬ì—ì„œë„ í”„ë¼ì´ë¹— í´ë¼ìš°ë“œë¥¼ í¬ì„­í•´ì•¼í•  ëŒ€ìƒìœ¼ë¡œ ì¸ì •í•˜ê³  ê³µê²©ì ìœ¼ë¡œ í•˜ì´ë¸Œë¦¬ë“œ í´ë¼ìš°ë“œ ì†”ë£¨ì…˜ì„ ê°œë°œí•˜ì—¬ ì œê³µí•˜ë ¤ê³  í•˜ëŠ” ì›€ì§ì„ì„ ë³´ì´ê³  ìˆë‹¤.</p><p>ì—”í„°í”„ë¼ì´ì¦ˆì—ì„œëŠ” ì…ì¥ì—ì„œëŠ” Scale, DRì¸¡ë©´ì—ì„œ On-Prem ì—ì„œ í¼ë¸”ë¦­ìœ¼ë¡œ í™•ì¥ì„ ë„ëª¨í•˜ê³  ìˆê³  ê¸€ë¡œë²Œí”Œë ˆì´ì–´ ì…ì¥ì—ì„œëŠ” í¼ë¸”ë¦­ì—ì„œ On-Premìœ¼ë¡œ ì „ì´í•˜ëŠ” ëª¨ìŠµìœ¼ë¡œ ë¹„ì¦ˆë‹ˆìŠ¤ë¥¼ ì§„í–‰í•˜ê³  ìˆë‹¤. í•˜ì§€ë§Œ êµ¬ê¸€ì€ íŠ¹ë³„í•˜ê²Œ ì»¨í…Œì´ë„ˆ ê¸°ë°˜ìœ¼ë¡œ ì§„í–‰ì¤‘ì´ë‹¤. ëˆ„ê°€ ëê¹Œì§€ ì‚´ì•„ë‚¨ì•„ ìŠ¹ìê°€ ë ì§€ ì•„ë¬´ë„ ëª¨ë¥¸ë‹¤. </p><p>ì•ìœ¼ë¡œ ì—´ë¦´ ì‹œì¥ì€ í™•ì‹¤í•˜ê³  ê¼­ í•„ìš”í•˜ë‹¤ëŠ” ê²ƒì€ ì•Œì§€ë§Œ ê¸°ìˆ ì˜ ì„±ìˆ™ë„ê°€ ë†’ì§€ ì•Šê³  ë„˜ì–´ì•¼í•  í—ˆë“¤ì´ ë§ë‹¤. ì•„ì§ê¹Œì§€ ì—°ê³„ ê¸°ìˆ ì´ë‚˜ ìƒíƒœê³„ê°€ ë¹„ì–´ ìˆëŠ” ë¶€ë¶„ë“¤ì´ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— ì˜¬í•´ ë§ì¯¤ ë˜ë©´ ì—¬ëŸ¬ ìƒí’ˆë“¤ì´ ì¶œì‹œë˜ë©´ì„œ ì •ë¦¬ ë˜ì§€ ì•Šì„ê¹Œ ì‹¶ë‹¤. </p><p><a href="https://wikibon.com/aws-outposts-enables-hybrid-cloud/" target="_blank" rel="noopener noreferrer">https://wikibon.com/aws-outposts-enables-hybrid-cloud/</a></p><p>ìœ„ í¬ìŠ¤íŒ…ì—ì„œë„ 2ê°€ì§€ ì˜ë¬¸ì ì„ ì œê¸°í•œë‹¤.</p><ul><li><p>Will a data egress charge be applied to data resident on the disks to other on-premise workloads?<br>
<code>ì˜ˆì‹œ) S3 â†’ Outpost egress íŠ¸ë˜í”½(private n/w ì´ê¸´ í•˜ì§€ë§Œ awsê°€ ëˆì„ ì•ˆ ë°›ì„ê²ƒì¸ê°€?, ê²°êµ­ direct-linkëŠ” í•„ìˆ˜ì¸ê±´ì§€?)</code></p></li><li><p>Is the data on site under the legal control of AWS or the customer?<br>
<code>ë°ì´í„°ì˜ ì†Œìœ ê¶Œ ë¬¸ì œ(ì´ê²Œ ì‹¬ê°í•œ ë¬¸ì œê°€ ë ìˆ˜ ìˆë‹¤)</code></p></li></ul><p>ê·¸ë˜ì„œ AWSê°€ ì‘ë…„ì— ë‚´ë†“ì€ Outpostì˜ ì²«ê·¸ë¦¼ì€ <a href="https://aws.amazon.com/ko/outposts/features/" target="_blank" rel="noopener noreferrer">VMware on AWS</a>ë¡œ ì‘ë…„ reinventì´í›„ ë§ì€ ê´€ì‹¬ì„ ë°›ì•˜ë˜ í”„ë¡œì íŠ¸ì´ë‹¤. </p><p>ì´ì™¸ì—ë„ ë©”ì´ì € ì‚¬ë“¤ë„ <a href="https://azure.microsoft.com/ko-kr/overview/azure-stack/" target="_blank" rel="noopener noreferrer">Azure Stack</a>, <a href="https://www.ibm.com/kr-ko/cloud/vmware" target="_blank" rel="noopener noreferrer">VMware on IBM Cloud</a>, <a href="https://www.ncloud.com/product/hybridPrivateCloud/vmwareOnNcloud" target="_blank" rel="noopener noreferrer">VMware on Ncloud</a>ì™€ ê°™ì€ í•˜ì´ë¸Œë¦¬ë“œ ì„œë¹„ìŠ¤ë¥¼ ë‚´ë†“ê³  ìˆë‹¤. </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="productë³„-ê¸°ë³¸-ì „ëµ">Productë³„ ê¸°ë³¸ ì „ëµ<a class="hash-link" href="#productë³„-ê¸°ë³¸-ì „ëµ" title="Direct link to heading">â€‹</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="azure-stack">Azure Stack<a class="hash-link" href="#azure-stack" title="Direct link to heading">â€‹</a></h4><ul><li>í˜¸í™˜ì„± ì¸ì¦ë°›ì€ ì„œë²„ë¥¼ On-premì— êµ¬ë§¤/ì„¤ì¹˜í•˜ê³  Azure UI ë° APIì™€ ë™ì¼í•œ UI/UXë¡œ private cloud ì‚¬ìš©</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="aws-outpost">AWS Outpost<a class="hash-link" href="#aws-outpost" title="Direct link to heading">â€‹</a></h4><ul><li>ê³ ê° On-premì— EC2 cloud instances ì œê³µ (ì „ìš© HPC í•˜ë“œì›¨ì–´ - EC2 Nitro Platform)</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="aws-outpostvmware-based">AWS Outpost(VMware based)<a class="hash-link" href="#aws-outpostvmware-based" title="Direct link to heading">â€‹</a></h4><ul><li>baremetal ì „ìš© í”Œë«í¼ìœ¼ë¡œ VMware - software, AWS - hardware ì— ì§‘ì¤‘</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="google-cloud">Google Cloud<a class="hash-link" href="#google-cloud" title="Direct link to heading">â€‹</a></h4><ul><li>K8s On-premì „ëµì„ ê¸°ë³¸ìœ¼ë¡œ Ciscoì™€ í•˜ì´ë¸Œë¦¬ë“œ ì „ëµ (based on Istio)</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ibm-cloud">IBM Cloud<a class="hash-link" href="#ibm-cloud" title="Direct link to heading">â€‹</a></h4><ul><li>êµ¬ê¸€ê³¼ ìœ ì‚¬í•˜ê²Œ Istioë¥¼ ê¸°ë³¸ìœ¼ë¡œ í•˜ì—¬ ë©€í‹°, í•˜ì´ë¸Œë¦¬ë“œ í´ë¼ìš°ë“œ ì œí’ˆ ì¶œì‹œ</li><li>IKS on Vmware on IBM Cloud Baremetal ì™€ ê°™ì€ ìƒí’ˆë„ ì¶œì‹œ</li></ul><p>ëŒ€ë¶€ë¶„ VMware í˜‘ë ¥ì„ ê¸°ë°˜ìœ¼ë¡œ í•˜ì´ë¸Œë¦¬ë“œ í´ë¼ìš°ë“œ ì „ëµì„ ì „ê°œí•˜ê³  ìˆê³  ë‚´ë©´ì„ ë“¤ì—¬ë‹¤ë³´ë©´ ë¬¼ë¦¬ì ìœ¼ë¡œ ë‹¤ë¥¸ê³³ì— ìˆëŠ” Overlay ë„¤íŠ¸ì›Œí¬ì— ëŒ€í•œ í•´ê²°ì´ ê°€ì¥ ë¬¸ì œì´ê¸° ë•Œë¬¸ì— Direct-linkë‚˜ VPNì„ í†µí•´ ì—°ê²°í•˜ëŠ”ê²ƒë„ ê²°êµ­ í´ë¼ìš°ë“œ ì‚¬ì—…ìê°€ ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ ë¹„ìš©ì„ ê°€ì ¸ê°€ì§€ ìœ„í•œ ì „ëµìœ¼ë¡œì„œ ë³´ì¸ë‹¤. </p><p>ì‹¤ì œ í¼ë¸”ë¦­ í´ë¼ìš°ë“œ ë²¤ë”ì˜ Cash CowëŠ” Compute ìì›ë³´ë‹¤ëŠ” ë„¤íŠ¸ì›Œí¬ ë¹„ìš©ê³¼ Blob Storage, APIê³¼ê¸ˆ ë“± ì— ëŒ€í•œ ë§¤ì¶œì´ í° ë¹„ì¤‘ì„ ì°¨ì§€í•œë‹¤ê³  ë´ì•¼ í•œë‹¤. í˜¹ìëŠ” ê¸€ë¡œë²Œ ë„¤íŠ¸ì›Œí¬ ì „ìš©ì„ ì— ëŒ€í•œ íˆ¬ìë‚˜ ê³ ì„±ëŠ¥ HPCë„ì… íˆ¬ì ë¹„ìš©ì— ëŒ€í•œ ë§ë“¤ì„ í•˜ì§€ë§Œ IBMê°™ì€ ê²½ìš° ê¸€ë¡œë²Œ ë„¤íŠ¸ì›Œí¬ ë¬´ë£Œ ì •ì±…ì„ í†µí•´ Market Shareë¥¼ íšë“í•˜ê³ ì í•˜ëŠ” ë¶€ë¶„ë“¤ì„ ë³´ë©´ ë„¤íŠ¸ì›Œí¬ê°€ ê°€ì¥ í•µì‹¬ì´ ì•„ë‹ê¹Œ ì‹¶ë‹¤.  </p><p>í´ë¼ìš°ë“œë¥¼ ì´ì•¼ê¸° í• ë•Œ ê¸°ìˆ  ì„±ìˆ™ë„ë¥¼ ë³´ë©´ Compute &gt; Storage &gt; Network ìˆœìœ¼ë¡œ ì „ì´ê°€ ë˜ëŠ”ë° OpenStackì´ë‚˜ Kubernetes í”„ë¡œì íŠ¸ì™€ ê°™ì€ ì˜¤í”ˆì†ŒìŠ¤ë‚˜ VMware NSX í”Œë«í¼ë§Œ ë´ë„ ì •ë§ ë„¤íŠ¸ì›Œí¬ê°€ ì¤‘ìš”í•œ ì˜ì—­ì´ ë˜ê³  ìˆìŒì„ ì•Œìˆ˜ ìˆë‹¤. </p><p>ê²°êµ­ í•µì‹¬ì ìœ¼ë¡œ ë´ì•¼í•˜ëŠ” ë¶€ë¶„ì€ ë„¤íŠ¸ì›Œí¬ë‹¤. ë„¤íŠ¸ì›Œí¬ ë¶€ë¶„ì—ì„œ ì•„ì£¼ ê°•ë ¥í•œ ì†”ë£¨ì…˜ì´ ë‚˜ì™€ì•¼ í•œë‹¤. ê²°êµ­ íšŒì„  ë¹„ìš©ì´ ë¬¸ì œê³  ìµœê·¼ ë„·í”Œë¦­ìŠ¤ì™€ SKBì˜ ì†ë„ ë¶„ìŸë§Œ ë´ë„ ê²°êµ­ ê°•ìì˜ ë…¼ë¦¬ë¡œ ë„¤íŠ¸ì›Œí¬ ë¬¸ì œê°€ í•´ê²°ë˜ëŠ” ì‹œëŒ€ê°€ ì˜¨ ê²ƒì´ë‹¤.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h3><p>ë‚´ê°€ ìƒê°í•œ ì„œë¹„ìŠ¤ ì‚¬ìš©ì ì¸¡ë©´ì—ì„œ ìš°ë¦¬ê°€ ê³ ë ¤í•´ì•¼í•  í´ë¼ìš°ë“œ ì˜µì…˜ë“¤ì„ ì •ë¦¬í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ë‹¤.</p><ul><li><p>ë©€í‹° í´ë¼ìš°ë“œ : í¼ë¸”ë¦­ í´ë¼ìš°ë“œ to í¼ë¸”ë¦­ í´ë¼ìš°ë“œ ìš´ì˜ ì†”ë£¨ì…˜ìœ¼ë¡œ í”„ë¼ì´ë¹— í´ë¼ìš°ë“œ ì˜ì—­ì—ëŠ” ê±°ì˜ ê´€ì—¬ë¥¼ ì•ˆí•˜ë©°, ì†”ë£¨ì…˜ì— ë”°ë¼ ì¼ë¶€ ê°€ìƒí™”ëœ Computing ìì›ê¹Œì§€ ëª¨ë‹ˆí„°ë§ ì§€ì›í•˜ê¸°ë„ í•¨. ë©€í‹° í´ë¼ìš°ë“œ ìš´ì˜ í”Œë«í¼ì€ ì£¼ë¡œ í´ë¼ìš°ë“œ Brokerage Service í˜•íƒœë¡œ ì œê³µë˜ì–´ì•¼ í•˜ë¯€ë¡œ MSPì—­í• ì´ ì¤‘ìš”í•´ì§ˆ ê²ƒ ê°™ë‹¤. ë©”ê°€ì¡´, ë² ìŠ¤í•€ê¸€ë¡œë²Œê³¼ ê°™ì€ê³³ ë¿ì•„ë‹ˆë¼ ìì²´ì ì¸ í´ë¼ìš°ë“œë¥¼ ìš´ì˜í•˜ëŠ” ëŒ€í˜• SIíšŒì‚¬ë¥¼ í¬í•¨í•œ ê¸°ì¡´ IaaS ìš´ì˜ì¡°ì§ì˜ ë³€í™”ë“¤ë„ ëˆˆì—¬ê²¨ ë´ì•¼í• ê²ƒ ê°™ë‹¤. ë§ˆì§„ìœ¨ì´ ë‚®ì€ ë ˆë“œì˜¤ì…˜ ì‹¸ì›€ì—ì„œ ëˆ„ê°€ ì´ê¸°ëŠëƒê°€ ì¤‘ìš”í•˜ê¸° ë³´ë‹¤ëŠ” ë¯¸ë˜ë¥¼ ë³´ê³  íˆ¬ìí•˜ëŠ” ìì„¸ê°€ í•„ìš”í•˜ë‹¤ê³  ë³¸ë‹¤. </p></li><li><p>í”„ë¼ì´ë¹— í´ë¼ìš°ë“œ : í”„ë¼ì´ë¹— í´ë¼ìš°ë“œ ì „ìš© ì†”ë£¨ì…˜ìœ¼ë¡œ ë²¤ë” ë˜ëŠ” íŠ¹ì • IaaS ì„œë¹„ìŠ¤ì— ìµœì í™”ëœ ê²½ìš°ê°€ ë§ìœ¼ë¯€ë¡œ VMware, OpenShift, OpenStack Managed ì„œë¹„ìŠ¤ë“± ê¸°ì¡´ ì œí’ˆì—ì„œì˜ ì—°ì¥ì„ ì—ì„œ ì–¼ë§ˆë‚˜ ì˜¤í”ˆì†ŒìŠ¤ë¥¼ ì´í•´í•˜ê³  í”„ë¡œë•ì…˜ì— ì ìš©í• ìˆ˜ ìˆëŠ” ì—­ëŸ‰ì„ ê¸°ë¥´ëŠ”ê²ƒì´ ì¤‘ìš”í•˜ë‹¤. </p></li><li><p>í•˜ì´ë¸Œë¦¬ë“œ í´ë¼ìš°ë“œ : í¼ë¸”ë¦­ í´ë¼ìš°ë“œ to í”„ë¼ì´ë¹— í´ë¼ìš°ë“œ ìš´ì˜ ì†”ë£¨ì…˜ìœ¼ë¡œ í”„ë¼ì´ë¹— í´ë¼ìš°ë“œì˜ ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ê¹Œì§€ ê´€ì—¬ë¥¼ í•˜ë©°, í¼ë¸”ë¦­ í´ë¼ìš°ë“œ ì˜ì—­ì€ ì¼ë°˜ì ìœ¼ë¡œ IaaS ì˜ì—­ê³¼ ì¼ë¶€ PaaS / ì»¨í…Œì´ë„ˆê¹Œì§€ êµ¬ì„±, ëª¨ë‹ˆí„°ë§ ì§€ì›í•´ì•¼ í•˜ê³  ì´ë¥¼ ìœ„í•œ 3rd Party ì†”ë£¨ì…˜ë“¤ì´ ë“±ì¥í•˜ê³  ìˆê³  ì ì°¨ ì˜ì—­ì„ í™•ëŒ€í• ê²ƒì´ë‹¤. ì´ì— ìˆì–´ ì»¨í…Œì´ë„ˆ í”Œë«í¼ì„ ë„ì…í•˜ëŠ”ê²ƒì´ ê°€ì¥ ê¸€ë¡œë²Œ í”Œë ˆì´ì–´ì™€ ê²©ì°¨ë¥¼ ì¤„ì´ëŠ”ë° íš¨ê³¼ì ì¸ ë„êµ¬ë¼ ìƒê°í•œë‹¤. ê²°êµ­ í•˜ì´ë¸Œë¦¬ë“œ í´ë¼ìš°ë“œ êµ¬í˜„ì€ ê¸°ì¡´ Publicê³¼ Local Cloudê°„ ë„¤íŠ¸ì›Œí¬ ì—°ê³„ê°€ ì¤‘ìš”í•œ í¬ì¸íŠ¸ì´ë‹¤.</p></li><li><p>ê°„ë‹¨íˆ êµ¬í˜„í•´ ë³¼ìˆ˜ ìˆëŠ” General Hybrid Kubernetes Architectureë¥¼ ê°„ë‹¨íˆ ê·¸ë ¤ë´¤ë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ StrongSwan VPNì„ ê°€ì§€ê³  CI/CDë¥¼ ê³ ë ¤í•œ DevOpsê´€ì ì—ì„œì˜ êµ¬ì„±ë„ì´ë‹¤.
<img loading="lazy" alt="hybrid-cloud" src="/assets/images/hybrid-cloud-b89fa6a20fd326ec117dbdf490a43f37.png" width="791" height="799" class="img_E7b_"></p></li></ul><p>ìœ„ì— ë‚´ìš©ê³¼ í•¨ê»˜ í•˜ì´ë¸Œë¦¬ë“œ í´ë¼ìš°ë“œë¥¼ ê³ ë ¤í• ë•Œ <code>ë°ì´í„° ì†Œìœ ê¶Œ ì¸¡ë©´ì—ì„œì˜ ê±°ë²„ë„ŒìŠ¤</code> ì™€ <code>overlay ë„¤íŠ¸ì›Œí¬</code>ì— ëŒ€í•œ ê³ ë¯¼ì´ ë™í–‰ë˜ì—ˆì„ë•Œ ì„±ê³µì ì¸ í•˜ì´ë¸Œë¦¬ë“œ í´ë¼ìš°ë“œë¥¼ êµ¬ì¶•í• ìˆ˜ ìˆë‹¤ë¼ëŠ” ë‚˜ í˜¼ìë§Œì˜ ìƒê°ì„ ì •ë¦¬í•´ë´¤ë‹¤.</p>]]></content>
        <category label="Hybrid" term="Hybrid"/>
        <category label="Multi" term="Multi"/>
        <category label="Outpost" term="Outpost"/>
        <category label="VMware" term="VMware"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[SRE (Site Reliablity Engineering)]]></title>
        <id>job/SRE/</id>
        <link href="https://ddii.dev/job/SRE/"/>
        <updated>2019-01-30T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[SRE ì†Œê°œ]]></summary>
        <content type="html"><![CDATA[<p>ê·¸ë™ì•ˆ DevOps ë‹´ë‹¹ìë¼ê³  ë¶€ë¥´ì§–ë˜ ì‚¬ëŒë“¤ì˜ Roleì´ ì¸í”„ë¼ ë‹´ë‹¹ìì¸ì§€ í”Œë«í¼ ë‹´ë‹¹ìì¸ì§€ ì•„ë‹ˆë©´ ê°œë°œí•˜ëŠ” ìš´ì˜ìì¸ì§€ í—·ê°ˆë¦´ë•Œê°€ ë§ì•˜ë‹¤.</p><p>ê°‘ìê¸° êµ­ë‚´ì—ì„œë„ SRE ì±„ìš© ê³µê³ ê°€ ë§ì•„ì§€ëŠ”ê²ƒì„ ë³´ë©´ì„œ ë‚´ ìì‹ ë„ í•œë²ˆ ì •ë¦¬ë¥¼ í•˜ê³  ê°€ì•¼í• ê²ƒ ê°™ì€ ìƒê°ì´ ë“¤ì—ˆë‹¤.</p><p><a href="https://docs.microsoft.com/ko-kr/learn/modules/intro-to-site-reliability-engineering/" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/ko-kr/learn/modules/intro-to-site-reliability-engineering/</a></p><p>ê°œë…ì •ë¦¬ ì¸¡ë©´ì—ì„œ ìœ„ MS Azureì˜ ì˜¨ë¼ì¸ êµìœ¡ë‚´ìš©ì„ ì •ë¦¬í•´ë´¤ë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="sre">SRE<a class="hash-link" href="#sre" title="Direct link to heading">â€‹</a></h2><p>SRE(ì‚¬ì´íŠ¸ ì•ˆì •ì„± ì—”ì§€ë‹ˆì–´ë§)ë€ ì¡°ì§ì´ í•´ë‹¹ ì‹œìŠ¤í…œ, ì„œë¹„ìŠ¤ ë° ì œí’ˆì—ì„œ ì ì ˆí•œ ìˆ˜ì¤€ì˜ ì•ˆì •ì„±ì„ ë‹¬ì„±í•˜ë„ë¡ ì§€ì›í•˜ëŠ” ì—”ì§€ë‹ˆì–´ë§ ë¶„ì•¼ì´ë‹¤. </p><p>ì¶œì²˜ : <a href="https://landing.google.com/sre/sre-book/chapters/introduction/" target="_blank" rel="noopener noreferrer">https://landing.google.com/sre/sre-book/chapters/introduction/</a></p><p>ê¸°ë³¸ì ìœ¼ë¡œ ìš´ì˜ê²½í—˜ì´ ìˆëŠ” sysadmin, ITì „ë¬¸ê°€, DevOpsì‹¤í–‰ ë‹´ë‹¹ì ë“±ì´ ëŒ€ìƒì´ ë  ìˆ˜ ìˆë‹¤.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì ì ˆí•œ-ìˆ˜ì¤€ì˜-ì•ˆì •ì„±">ì ì ˆí•œ ìˆ˜ì¤€ì˜ ì•ˆì •ì„±<a class="hash-link" href="#ì ì ˆí•œ-ìˆ˜ì¤€ì˜-ì•ˆì •ì„±" title="Direct link to heading">â€‹</a></h3><p>ê°€ì¥ í•µì‹¬ì´ ë˜ëŠ” ë‹¨ì–´ëŠ” <code>ì•ˆì •ì„±</code>ì´ë‹¤. ì¡°ì§ì—ì„œ ë§Œë“  ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì•ˆì •ì„±ì´ ë¶€ì¡±í•˜ì—¬ ì‘ë™í•˜ì§€ ì•Šê±°ë‚˜ ë¶ˆì•ˆì •í•œ ê²½ìš° ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ì— í”¼í•´ë¥¼ ì¤„ ìˆ˜ ìˆë‹¤ëŠ”ê±´ ëˆ„êµ¬ë‚˜ ì•Œê³  ìˆëŠ” ë‹¹ì—°í•œ ì´ì•¼ê¸°ì´ì§€ë§Œ 100%ì˜ ì•ˆì •ì ì¸ ì‹œìŠ¤í…œì€ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì ì ˆí•œ ìˆ˜ì¤€(ì •ëŸ‰ì ìœ¼ë¡œ ì¸¡ì •í•˜ê¸´ ì–´ë µì§€ë§Œ ì´í•´ê´€ê³„ìë“¤ì´ ë‚©ë“¤í• ë§Œí•œ ìˆ˜ì¤€)ì˜ ì•ˆì •ì„±ì„ ë‹¬ì„±í•˜ê¸° ìœ„í•œ ì¼ë ¨ì˜ ì‘ì—…ë“¤ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì´ SREì˜ ê¸°ë³¸ ì†ì„±ì´ë¼ê³  ë³¼ìˆ˜ ìˆë‹¤. </p><p>SREëŠ” Googleì—ì„œ 2003ë…„ë¶€í„° 7ëª…ì˜ ì†Œí”„íŠ¸ì›¨ì–´ ì—”ì§€ë‹ˆì–´ë¡œ êµ¬ì„±ëœ íŒ€ì—ì„œ ì‹œì‘ëœ ì´í›„ (ìì„¸í•œ ë‚´ìš©ì€ ìœ„ ë§í¬ ebook ì°¸ì¡°) Google ì‚¬ë‚´ì— ë„ë¦¬ í™•ì‚°ë˜ê³  ë‚´ë¶€ì ì¸ ë¬¸í™”ë¡œ ì¡°ì„±ë˜ëŠ” ì¤‘ì— ë°–ì—ì„œëŠ” DevOpsë¼ê³  í•˜ëŠ” ë¬¸í™”ê°€ ë™ì‹œì— í™•ì‚°ë˜ì—ˆë‹¤ í•œë‹¤. ê²°êµ­ ë™ì¼í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ì¸¡ë©´ì—ì„œ ë‘ê°œì˜ ë°©ë²•ë¡ ì€ ë‹¤ë¥´ë‹¤ê³  ë´ì•¼í•œë‹¤. </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì°¨ì´ì ">ì°¨ì´ì <a class="hash-link" href="#ì°¨ì´ì " title="Direct link to heading">â€‹</a></h3><ul><li>SRE - ì•ˆì •ì„±ì„ ìœ„í•œ ì—”ì§€ë‹ˆì–´ë§, DevOps - ê°œë°œê³¼ ìš´ì˜ì¡°ì§ ê°ê°ì˜ ì‚¬ì¼ë¡œë¥¼ í•´ì²´í•˜ê¸° ìœ„í•œ ë¬¸í™”ì ì¸ ì›€ì§ì„</li><li>SRE - ì €ëŠ” SRE ì…ë‹ˆë‹¤, DevOps - ì €ëŠ” DevOpsë¥¼ í•˜ëŠ” ìš´ì˜ì ë˜ëŠ” ê°œë°œì ì…ë‹ˆë‹¤.</li><li>SRE - ê·œë²”ìœ¼ë¡œ ì¸ì‹, DevOps - ë¬¸í™”ë¡œ ì¸ì‹</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ê³µí†µì ">ê³µí†µì <a class="hash-link" href="#ê³µí†µì " title="Direct link to heading">â€‹</a></h3><ul><li>ëª¨ë‹ˆí„°ë§/ì‹ë³„ ê°€ëŠ¥, ìë™í™”</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì£¼ìš”-sreì›ì¹™--ì„ ìˆœí™˜">ì£¼ìš” SREì›ì¹™ : ì„ ìˆœí™˜<a class="hash-link" href="#ì£¼ìš”-sreì›ì¹™--ì„ ìˆœí™˜" title="Direct link to heading">â€‹</a></h2><p>ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ì˜ ìƒíƒœì˜ ì§€í‘œëŠ” ì–´ë–»ê²Œ ì •ì˜í• ê¹Œ? ë³´í†µì€ ë¬´ì—‡ì„ <code>SLI(ì„œë¹„ìŠ¤ ìˆ˜ì¤€ ì§€í‘œ)</code>ë¡œ ì‚¬ìš©í• ì§€ë¥¼ ì •í•˜ëŠ”ê²ƒìœ¼ë¡œ ë³¸ë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì„±ê³µ ë° ì‹¤íŒ¨ ì¸¡ì •ê°’(200 OK,500 Error), ì‘ë‹µì‹œê°„(ms), ì²˜ë¦¬ëŸ‰ ë“±ì˜ ì¡°í•©ìœ¼ë¡œ ê²°ì •ë  ìˆ˜ ìˆë‹¤. ë³´í†µ  ì¹´ë‚˜ë¦¬ì•„ ë¶„ì„ì„ í†µí•´ Scoringì„ í•œ <code>SLI</code>ë¥¼ 200 OKì™€ 500 ë˜ëŠ” ì—ëŸ¬ì½”ë“œì˜ ë¹„ìœ¨ë¡œ ê²°ì •í•˜ëŠ” ë°©ë²•ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ë§ë‹¤.</p><p>ì„œë¹„ìŠ¤ ìƒíƒœë¥¼ ì‹ë³„í•˜ëŠ” ì§€í‘œë¥¼ ì •í•˜ê³  ë‚˜ë©´ ê³ ê°ì´ë‚˜ ìš°ë¦¬ê°€ ì›í•˜ëŠ” ì•ˆì •ì„± ìˆ˜ì¤€ì„ ê²°ì •í•´ì•¼ í•œë‹¤. ê°œë°œíŒ€ê³¼ ìš´ì˜íŒ€ì´ ê°™ì´ ë§Œë“  ì›í•˜ëŠ” ì•ˆì „ì„± ìˆ˜ì¤€ì„ <code>SLO(ì„œë¹„ìŠ¤ ìˆ˜ì¤€ ëª©í‘œ)</code>ë¼ê³  ë§í•˜ë©´ ëœë‹¤. </p><p><code>SLO</code>ëŠ” Prometheusë‚˜ Datadogê³¼ ê°™ì€ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œì„ í™œìš©í•˜ì—¬ ì •í™•í•˜ê²Œ ì¸¡ì •í•˜ê³  í‘œì‹œí•´ì•¼ í•œë‹¤. ì„œë¹„ìŠ¤ì˜ ì•ˆì •ì„±ì— ëŒ€í•´ì„œ ëª…í™•í•˜ê²Œ ì´í•´í• ìˆ˜ ìˆëŠ” ëª©í‘œì´ê¸°ë„ í•˜ë‹¤. ë°˜ë“œì‹œ <code>SLO</code>ë¥¼ ë§Œì¡±í•˜ëŠ”ì§€ ëª»í•˜ëŠ”ì§€ ëª…í™•í•œ ì¸¡ì •ê°’ìœ¼ë¡œ ë°ì´í„°ê°€ ì¡´ì¬í•´ì•¼ í•˜ê³  <code>SLO</code>ë¥¼ ì¶©ì¡±í•˜ì§€ ëª»í•˜ë©´ ë¬¸ì œê°€ ìˆëŠ”ê²ƒìœ¼ë¡œ íŒë‹¨í•˜ê³  ë¬¸ì œë¥¼ í•´ê²°í•´ì•¼ í•œë‹¤. </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì˜¤ë¥˜-ì˜ˆì‚°">ì˜¤ë¥˜ ì˜ˆì‚°<a class="hash-link" href="#ì˜¤ë¥˜-ì˜ˆì‚°" title="Direct link to heading">â€‹</a></h3><p>ì˜¤ë¥˜ ì˜ˆì‚°ì´ë¼ëŠ” ë§ì„ ëª…í™•íˆ ì´í•´í•˜ë ¤ë©´ í”íˆ ê³ ê°ê³¼ ì²´ê²°í•˜ëŠ” ê³„ì•½ì„œ ìƒì˜ ëª…ì‹œëœ ì„œë¹„ìŠ¤ ê°€ë™ìœ¨(SLA)ì„ ìƒê°í•˜ë©´ ë  ê²ƒ ê°™ë‹¤. ë³´í†µ 99.9% ì˜ <code>SLO</code>ë¥¼ ì •í•œë‹¤ê³  í•œë‹¤ë©´ 1ë…„ì— 8ì‹œê°„ 45ë¶„ 57ì´ˆì˜ ì„œë¹„ìŠ¤ ë‹¤ìš´íƒ€ì„ì„ í—ˆìš©í•˜ëŠ” ê²ƒì´ë‹¤. ì˜¤ë¥˜ ì˜ˆì‚°ì€ ì„œë¹„ìŠ¤ì˜ ì™„ë²½í•œ ì•ˆì •ì„±ê³¼ ì›í•˜ëŠ” ì•ˆì •ì„±ì˜ ì°¨ì´(100%-99.9%=0.01%)ë¥¼ ë§í•œë‹¤. 0.01%ë¡œ ì¦‰ 8ì‹œê°„ì •ë„ì˜ ì˜¤ë¥˜ ì˜ˆì‚°ì„ ê°€ì§€ëŠ” ê²ƒì€ ê·¸ ì‹œê°„ì„ ëª¨ë‘ ì‚¬ìš©í•  ë•Œê¹Œì§€ ì¶”ê°€ ë¦´ë¦¬ìŠ¤ë‚˜ íŒ¨ì¹˜ë¥¼ ì§„í–‰í•  ìˆ˜ ìˆë‹¤ëŠ” ì´ì•¼ê¸°ì™€ ê°™ë‹¤. ì–´ë–¤ íŒ€ì€ í•´ë‹¹ ì˜ˆì‚°ì„ ì‹ ê·œ ê¸°ëŠ¥ì„ ë¦´ë¦¬ìŠ¤í•˜ëŠ”ë° ì‚¬ìš©í•˜ê¸°ë„ í•˜ê³  ì¥ì• ê°€ ë°œìƒí–ˆì„ë•Œ ë¬¸ì œì˜ ì›ì¸ì„ ë°œê²¬í•˜ê³  ê°œì„ í•˜ëŠ”ë° ì‚¬ìš©í•˜ê¸°ë„ í•œë‹¤. </p><p>ì¼ë°˜ì ìœ¼ë¡œ ì„œë¹„ìŠ¤ì— ëŒ€í•œ ì˜¤ë¥˜ ì˜ˆì‚°ì´ ëª¨ë‘ ì‚¬ìš©ë˜ë©´ ì„œë¹„ìŠ¤ê°€ ì›í•˜ëŠ” ì•ˆì •ì„± ìˆ˜ì¤€ìœ¼ë¡œ ëŒì•„ê°ˆë•Œ ê¹Œì§€ í•´ë‹¹ ì„œë¹„ìŠ¤ì˜ ì¶”ê°€ì ì¸ ë¦´ë¦¬ìŠ¤ë¥¼ ë³´ë¥˜í•˜ëŠ”ê²Œ ì¼ë°˜ì ì´ê¸´ í•˜ì§€ë§Œ íŠ¹ì •ê¸°ê°„(ì›” ë˜ëŠ” ë¶„ê¸° ë˜ëŠ” ì—°ê°„) ê¸°ì¤€ìœ¼ë¡œ ê³„ì‚°ë˜ê¸° ë•Œë¬¸ì— ì„œë¹„ìŠ¤ ì•ˆì •ì„±ì´ ì •ìƒ ìƒíƒœë¼ë©´ ì˜¤ë¥˜ ì˜ˆì‚°ì€ ë‹¤ì‹œ ì£¼ì–´ì§€ê²Œ ë˜ë¯€ë¡œ <code>ì„ ìˆœí™˜</code> êµ¬ì¡°ë¥¼ ê°€ì§„ë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ë¹„ë‚œ-ì—†ëŠ”-ì¥ì• -íšŒê³ ">ë¹„ë‚œ ì—†ëŠ” ì¥ì•  íšŒê³ <a class="hash-link" href="#ë¹„ë‚œ-ì—†ëŠ”-ì¥ì• -íšŒê³ " title="Direct link to heading">â€‹</a></h3><p>ì¼ë°˜ì ìœ¼ë¡œ ë¹„ì¦ˆë‹ˆìŠ¤ì— í¬ë¦¬í‹°ì»¬í•œ ì¥ì• ê°€ ë°œìƒí–ˆì„ë•Œ ì‚¬í›„ ë¶„ì„(íšŒê³ )ì„ í•˜ê²Œ ë˜ëŠ”ë° ì´ë•ŒëŠ” <code>ë¹„ë‚œ ì—†ëŠ”</code> ë¶„ì„ì„ í•´ì•¼í•œë‹¤. ì˜¤ë˜ì „ ê¸°ì–µì´ì§€ë§Œ ì˜ˆì „ ì§ì¥ íŠ¹ì •íŒ€ì—ì„œëŠ” ì¥ì• ê°€ ë°œìƒí•˜ë©´ ìœ ê´€ìë“¤ì´ ëª¨ë‘ ì—”ì§€ë‹ˆì–´ ì±…ìƒ ë’¤ì— ì„œì„œ ëª¨ë“  í™”ì‚´ê³¼ ëˆˆì´ì„ ì£¼ê¸° ë•Œë¬¸ì— ë„ì €íˆ ì¼ì„ í•  ìˆ˜ ì—†ê²Œ ë§Œë“  ê²½ìš°ê°€ ë§ì•˜ì—ˆë‹¤. </p><p>íŠ¹ì • ìš´ì˜ìì˜ ì‘ì—… ì‹¤ìˆ˜ë¡œ ì¸í•´ ì¥ì• ê°€ ë°œìƒí–ˆë‹¤ í•˜ë”ë¼ë„ í•´ë‹¹ ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ê²Œ ëœ í”„ë¡œì„¸ìŠ¤ë‚˜ ê¸°ìˆ ê¸°ë°˜ì— ì‹¤íŒ¨ ì›ì¸ì„ íŒŒì•…í•˜ëŠ”ë° ì¤‘ì ì„ ë‘ì–´ì•¼ í• ê²ƒì´ë‹¤.</p><p>ì‹œìŠ¤í…œì˜ ì•ˆì •ì„±ì„ ì €í•˜ì‹œí‚¤ê³  ì„œë¹„ìŠ¤ë¥¼ ì¤‘ë‹¨ì‹œí‚¨ ì‘ì—…(ë¦´ë¦¬ìŠ¤, íŒ¨ì¹˜ ë“±)ì„ ì‚¬ìœ ë¡œ ê°œì¸ì—ê²Œ í˜ë„í‹°ë¥¼ ì£¼ê±°ë‚˜ ê³ ê³¼ì— ë°˜ì˜í•˜ëŠ” ë°©ë²•ì€ ì¥ì• ë¡œ ë¶€í„° êµí›ˆì„ ì–»ì„ìˆ˜ê°€ ì—†ê³  í•´ë‹¹ ë‹´ë‹¹ìì˜ ì¶©ì„±ë„ë‚˜ ìƒì‚°ì„± ì €í•˜ë¥¼ ìœ ë°œí•˜ëŠ” ì•ˆì¢‹ì€ ì¥ì¹˜ê°€ ë  ìˆ˜ ìˆë‹¤. ë‚´ ê²½í—˜ì´ê¸°ë„ í•˜ì§€ë§Œ í•œë™ì•ˆ ë‘ë ¤ì›Œì„œ ì•„ë¬´ ë³€ê²½ë„ í•˜ì§€ ëª»í•˜ëŠ” ê²½ìš°ê°€ ì¢…ì¢… ìˆì—ˆë‹¤. </p><p>íšŒì‚¬ë‚˜ ì¡°ì§, íŒ€ì€ ì‹œìŠ¤í…œ ì¤‘ë‹¨ìœ¼ë¡œë¶€í„° êµí›ˆì„ ì–»ê³  ì§€ì†ì ìœ¼ë¡œ ì‹œìŠ¤í…œì„ ê°œì„ í• ìˆ˜ ìˆë‹¤. ì ì ˆí•œ ë¶„ì„ì„ í†µí•´ í›„ì†ì¡°ì¹˜ë¥¼ ìˆ˜í–‰í•¨ìœ¼ë¡œì¨ ì‹¤íŒ¨ë¥¼ ìˆ˜ìš©í•˜ëŠ” ê²ƒì´ SREì˜ í•µì‹¬ ì›ì¹™ì´ë‹¤. ì´ëŸ¬í•œ ë‚´ìš©ì„ ëª¨ë‘ì—ê²Œ ê³µìœ í•˜ê³  íƒ€ ì¡°ì§ì´ë‚˜ íŒ€ì—ê²Œ ì¸ì‚¬ì´íŠ¸ë¥¼ ì œê³µí•˜ëŠ” ì„ ìˆœí™˜ êµ¬ì¡°ë¥¼ ë§Œë“œëŠ”ê²ƒ ë˜í•œ SREì˜ ê¸°ë³¸ ì›ì¹™ì´ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì£¼ìš”-sreì›ì¹™--ì‚¬ëŒì¸¡ë©´">ì£¼ìš” SREì›ì¹™ : ì‚¬ëŒì¸¡ë©´<a class="hash-link" href="#ì£¼ìš”-sreì›ì¹™--ì‚¬ëŒì¸¡ë©´" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="toilìˆ˜ê³ ìŠ¤ëŸ°-ì¼-ë²ˆê±°ë¡œìš´-ì‘ì—…">Toil(ìˆ˜ê³ ìŠ¤ëŸ° ì¼, ë²ˆê±°ë¡œìš´ ì‘ì—…)<a class="hash-link" href="#toilìˆ˜ê³ ìŠ¤ëŸ°-ì¼-ë²ˆê±°ë¡œìš´-ì‘ì—…" title="Direct link to heading">â€‹</a></h3><p>í•­ìƒ SREì—ì„œëŠ” Toilì— ì´ˆì ì„ ë§ì¶°ì•¼ í•œë‹¤. Toilì€ ì‚¬ëŒì´ ìˆ˜í–‰í•˜ëŠ” ìš´ì˜ ì‘ì—… ì¤‘ íŠ¹ì •í•œ íŒ¨í„´ì´ë‚˜ íŠ¹ì„±ì´ ìˆëŠ” ì‘ì—…ì„ ë§í•œë‹¤. ì¢…ì¢… ë°˜ë³µì ì´ê³  ìë™í™” ë  ìˆ˜ ìˆëŠ” ì‘ì—…ì¼ì§€ë¼ë„ ëŒ€ë¶€ë¶„ ìˆ˜ë™ì‘ì—…ìœ¼ë¡œ ì²˜ë¦¬ë¥¼ í•œë‹¤. ì„œë¹„ìŠ¤ì˜ ê·œëª¨ê°€ ì»¤ì§€ê±°ë‚˜ ê³ ê°ì´ ë§ì•„ì§€ê²Œ ë˜ë©´ ë³´í†µ ìš°ë¦¬ê°€ ì´ì•¼ê¸° í•˜ëŠ” í‹°ì¼“(ë˜ëŠ” SR)ì˜ ìˆ˜ê°€ ë§ì•„ì§€ê³  ê³µìˆ˜ê°€ ë§ì´ í•„ìš”í•˜ê²Œ ëœë‹¤. </p><p>ë°°í¬ë•Œë§ˆë‹¤ Configë¥¼ ì ìš©í•˜ê±°ë‚˜ ê³„ì • ë“±ë¡, ë³¼ë¥¨ì´ë‚˜ ë””ìŠ¤í¬ í”„ë¡œë¹„ì €ë‹ ë“± ìˆ˜ë™ìœ¼ë¡œ ì²˜ë¦¬í•´ì•¼í•˜ëŠ” ëª¨ë“  ì‘ì—…ì´ ìš´ì˜ìì—ê²ŒëŠ” ë¶€í•˜ë¡œ ë‹¤ê°€ì˜¬ìˆ˜ ìˆë‹¤. ì´ëŸ¬í•œ ë°˜ë³µì ì¸ ì‘ì—…ì„ í‹°ì¼“ì‹œìŠ¤í…œì„ í†µí•´ ì²˜ë¦¬ë¥¼ í•˜ê²Œ ë˜ë©´ í‹°ì¼“ ìƒì„±, ì‘ì—…ê³„íšì„œ ì‘ì„±, ê²€í† , ìŠ¹ì¸ ë‹¨ê³„ë¥¼ ê·¸ë•Œ ë§ˆë‹¤ í•´ì•¼í•˜ëŠ” ì•„ì£¼ ë²ˆê±°ë¡œìš´ ì‘ì—…(Toil)ì„ í•´ì•¼í•œë‹¤.</p><p>SREëŠ” ìµœëŒ€í•œ ì´ëŸ¬í•œ ë°˜ë³µì ì´ê³  ë²ˆê±°ë¡œìš´ ì‘ì—…ì„ ì œê±°í•˜ê¸° ìœ„í•´ ë…¸ë ¥í•´ì•¼í•˜ê³  ìë™í™”ì™€ Self-Serviceë¡œ ê°œë°œìê°€ í¸í•˜ê²Œ ì§ì ‘ ì‚¬ìš©í• ìˆ˜ ìˆë„ë¡ í™˜ê²½ì„ ì œê³µí•´ ì£¼ì–´ì•¼ í•œë‹¤. ì´ëŸ¬í•œ ìš”ì²­ì´ë‚˜ í‹°ì¼“ì„ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆìœ¼ë©´ ì¡°ê¸ˆ ë” ìƒì‚°ì ì¸ ì¼ì„ ìˆ˜í–‰í• ìˆ˜ ìˆë‹¤. </p><p>ìœ„ì—ì„œ ì´ì•¼ê¸°í•œ ì ì ˆí•œ ì•ˆì •ì„±ê³¼ ë¹„ìŠ·í•œ ë§¥ë½ìœ¼ë¡œ ìƒê°í•˜ë©´ ë  ê²ƒ ê°™ë‹¤. ë²ˆê±°ë¡œìš´ ì‘ì—…ì„ ì—†ì• ëŠ”ê²ƒì´ ë‹¤ë¥¸ ì¤‘ìš”í•œ ì‘ì—…ë³´ë‹¤ ìš°ì„ ìˆœìœ„ê°€ ë–¨ì–´ì§€ê¸°ë„ í•˜ì§€ë§Œ ì„œë¹„ìŠ¤ ìƒì—ì„œ Toilì„ ì œê±°í•˜ëŠ”ê²ƒë„ SREì˜ ì£¼ëœ ì—…ë¬´ì´ë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ìš´ì˜ì‘ì—…ì˜-ë¹„ìœ¨">ìš´ì˜ì‘ì—…ì˜ ë¹„ìœ¨<a class="hash-link" href="#ìš´ì˜ì‘ì—…ì˜-ë¹„ìœ¨" title="Direct link to heading">â€‹</a></h2><p>Toilì„ ì œê±°í•˜ê±°ë‚˜ ì„œë¹„ìŠ¤/ì‹œìŠ¤í…œ ì•ˆì •ì„±ì„ ê°œì„ í•˜ê¸° ìœ„í•´ SREëŠ” ì¥ì• ë¥¼ í•´ê²°í•˜ê³  í‹°ì¼“ì„ ì²˜ë¦¬í•˜ëŠ” ì‹œê°„ ë¹„ì¤‘ì„ 50%ë¥¼ ë„˜ê²¨ì„œëŠ” ì•ˆëœë‹¤. í‹°ì¼“ì´ í•„ìš”í•˜ì§€ ì•Šë„ë¡ ê°œë°œì Self-Serviceë¥¼ êµ¬ì„±/ì œê³µí•˜ê³  íš¨ìœ¨ì„±ì„ ì¦ëŒ€ì‹œí‚¤ê¸° ìœ„í•´ì„œ IaCë“±(Shell, Ansible, Terraform)ê³¼ ê°™ì´ ìë™í™”ë¥¼ ìœ„í•œ ì½”ë“œë¥¼ ë§Œë“œëŠ”ë°ì—ë„ ì§‘ì¤‘ì„ í•´ì•¼í•œë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ì§€ê¸ˆê¹Œì§€ SREì— ëŒ€í•´ì„œ ê°„ë‹¨í•˜ê²Œ ì†Œê°œí•˜ê³  ì´í•´í•˜ëŠ” ì¸¡ë©´ì—ì„œ ì •ë¦¬í•´ ë´¤ë‹¤. </p><p><a href="https://landing.google.com/sre/sre-book/chapters/part3/" target="_blank" rel="noopener noreferrer">Service Reliability Hierarchy</a></p><p><img loading="lazy" src="https://lh3.googleusercontent.com/3gX2qgys2I-9HnEIvXUA10ed3AILvg5MclnKWBquEkJKP3g5_kD6WR7Ptwp3TwAGla1DuSmHv64MdTtACNLlArFVq7BwbTrTVhigsA=s0" alt="hierarchy" class="img_E7b_"></p><p>ê·¸ë¦¼ê³¼ ê°™ì´ ì„œë¹„ìŠ¤ ì•ˆì •ì„± ê³„ì¸µ êµ¬ì¡°ì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë“  ì„œë¹„ìŠ¤ë¥¼ ëª¨ë‹ˆí„°ë§ í•˜ëŠ” ì‹œìŠ¤í…œì„ ê°–ì¶”ì–´ì•¼ í•œë‹¤ê³  ë§í•œë‹¤. ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œì´ ì¤€ë¹„ê°€ ë˜ë©´ ì„œë¹„ìŠ¤ì— ëŒ€í•œ SLI, SLOë¥¼ ë§Œë“¤ê³  ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œì—ì„œ êµ¬í˜„í•˜ëŠ”ê²ƒì´ ì²«ë²ˆì§¸ SREë¥¼ ì ìš©í•˜ëŠ” ë°©ë²•ì´ë¼ê³  í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì°¸ê³ -ì„œì ">ì°¸ê³  ì„œì <a class="hash-link" href="#ì°¸ê³ -ì„œì " title="Direct link to heading">â€‹</a></h2><ul><li><a href="http://shop.oreilly.com/product/0636920041528.do" target="_blank" rel="noopener noreferrer">Site Reliability Engineering: How Google Runs Production Systems(â€œThe SRE Bookâ€)</a></li><li><a href="http://landing.google.com/sre/workbook/toc/" target="_blank" rel="noopener noreferrer">The Site Reliability Workbook: Practical Ways to Implement SRE(â€œThe SRE Workbookâ€)</a></li><li><a href="http://shop.oreilly.com/product/0636920063964.do" target="_blank" rel="noopener noreferrer">Seeking SRE: Conversations About Running Production Systems at Scale</a></li></ul>]]></content>
        <category label="SRE" term="SRE"/>
        <category label="DevOps" term="DevOps"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[2018 Retrospective]]></title>
        <id>retrospective/newyear-plan/</id>
        <link href="https://ddii.dev/retrospective/newyear-plan/"/>
        <updated>2019-01-03T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[18ë…„ë„ë¥¼ ëŒì•„ë³´ë©°...]]></summary>
        <content type="html"><![CDATA[<p>í•œí•´ê°€ ë˜ í›… ê°€ë²„ë ¸ë‹¤. 18ë…„ë„ Retrospective ì‹œì‘í•œë‹¤.</p><ul><li><p>Work</p><ul><li>17ë…„ê¹Œì§€ íŒ€ ë§‰ë‚´ì˜€ì§€ë§Œ ìƒˆë¡œìš´ ë¶€ì„œë¡œ ì´ë™í•˜ì—¬ ì„œë¹„ìŠ¤ê°œë°œ íŒŒíŠ¸ì¥ì„ ë§ê²Œ ë˜ì—ˆìŒ. 17ë…„ë„ì— ê°œë°œì´ë¼ê³ ëŠ” pythonë¥¼ ì‚¬ìš©í•˜ì—¬ vmware vmì„ openstack instanceë¡œ migrationí•˜ëŠ” í”„ë¡œì íŠ¸ ë° kubernetes ê¸°ë°˜ tensorflow í”Œë«í¼ì„ ê°œë°œí•˜ëŠ” ì´ˆë³´ê°œë°œì ìˆ˜ì¤€ì´ì˜€ë˜ ë‚´ê°€ ì¸í”„ë¼ì™€ í´ë¼ìš°ë“œ í”Œë«í¼(openstack, vsphere, kubernetes) ê²½ë ¥ì´ ì¸ì •ë˜ì–´ ì„œë¹„ìŠ¤ ê°œë°œ íŒŒíŠ¸ë¥¼ ë§¡ê²Œ ë˜ì—ˆë‹¤. ì¸ìƒì—ì„œ ê°€ì¥ í° ë³€í˜ì¤‘ í•˜ë‚˜ì˜€ë‹¤ê³  ìƒê°í•˜ê³  í•­ìƒ ê°ì‚¬í•˜ëŠ” ë§ˆìŒìœ¼ë¡œ ì¼ì„ í•˜ê³  ìˆë‹¤.  </li><li>CNCF OpenSourceë“¤ì„ í™œìš©í•˜ì—¬ FaaS(Function as a Service), IaC(Infra as Code) í”Œë«í¼ ê°œë°œì„ ì§„í–‰í•˜ì˜€ë‹¤. ì„œë¹„ìŠ¤ ê¸°íš ë° ë‘ê°œ í”„ë¡œì íŠ¸ì˜ Scrum Master ì—­í• ì„ ìˆ˜í–‰í•˜ì˜€ê³  ë©”ì¸ ì—…ë¬´ëŠ” SREì—­í• ë¡œ Kubernetes ì„¤ê³„ êµ¬ì¶•, í´ëŸ¬ìŠ¤í„° ë° ìŠ¤í† ë¦¬ì§€ ê´€ë¦¬, LB, ì¸ì¦ì„œ ë“± í´ë¼ìš°ë“œ ì¸í”„ë¼ ìì›ê´€ë¦¬ ì •ë„ì˜€ë˜ê²ƒ ê°™ë‹¤. </li></ul></li><li><p>Tech.</p><ul><li>Public Cloud : AWS, DigitalOcean, IBM Cloud, GCP, Azure, nCloud</li><li>Provisioning : Harbor, Ansible, Portus, Clair, Kubicorn, Terraform, Vault</li><li>Runtime : Rook, Minio, OpenEBS, Calico, REX-ray, WeaveNet, Cilium</li><li>Orchestration : Kubernetes, Envoy, etcd, gRPC, Kong, HAProxy, Istio, Kong, NGINX, Traefik</li><li>App : NATS, Helm, Kafka, Docker-compose, Draft, Gitlab, minikube, Operator, Jenkins, JenkisX, Packer, RabbitMQ, Spinnaker</li><li>Serverless : Dispatch, Fission, Knative, Nuclio, OpenWhisk, OpenFaas</li><li>Monitoring, Logging : Prometheus, Fluentd, Elastic, Grafana, influx, WeaveScope</li><li>ê¸°íƒ€ : Cert-Manager, Dex, Agones</li></ul></li><li><p>Speak
ì“°ë‹¤ë³´ë‹ˆ ì‚¬ë‚´ì™¸ ë°œí‘œë¥¼ 10ë²ˆì„ ë„˜ê²Œ í•œê±° ê°™ë‹¤.</p><ul><li>4ì›” ì‚¬ë‚´ Cloud Tech : ì»¨í…Œì´ë„ˆ ê¸°ë°˜ SaaS ê°œë°œì„ ìœ„í•œ ê³ ë ¤ì‚¬í•­</li><li>5ì›” ì‚¬ë‚´ DT ì†”ë£¨ì…˜ í–‰ì‚¬, í´ë¼ìš°ë“œì‚¬ì—…ë¶€ ì„¸ì…˜ : Advanced Cloud (Road to Serverless)</li><li>5ì›” ì‚¬ë‚´ í†µì‹ ì‚¬ì—…ë¶€ë¬¸ Techì„¸ì…˜ : Road to Serverless (Functions as Applications)</li><li>6ì›” Open Infra Days Korea 2018 : <a href="https://www.slideshare.net/JinwoongKim8/provisioning-dedicated-game-server-on-kubernetes-cluster" target="_blank" rel="noopener noreferrer">Provisioning Dedicated Game Server on Kubernetes Cluster</a></li><li>8ì›” SK DNA 2018 : <a href="https://www.slideshare.net/JinwoongKim8/cloud-z-serverless-118143924" target="_blank" rel="noopener noreferrer">Cloud Z ì˜ ì˜¤í”ˆì†ŒìŠ¤ ì„œë¹„ìŠ¤ ì†Œê°œ ë° Serverlessë¡œ ê²Œì„ ê°œë°œí•˜ê¸°</a></li><li>10ì›” DT Labs Meetup : <a href="https://www.slideshare.net/JinwoongKim8/continuous-delivery-with-spinnaker-on-k8skubernetes-cluster-118140930" target="_blank" rel="noopener noreferrer">Continuous Delivery with Spinnaker on K8s(kubernetes) Cluster</a></li><li>10ì›” NCsoft IO : <a href="https://www.slideshare.net/JinwoongKim8/cloud-native-serverless/JinwoongKim8/cloud-native-serverless" target="_blank" rel="noopener noreferrer">Cloud Native ì˜¤í”ˆì†ŒìŠ¤ ì„œë¹„ìŠ¤ ì†Œê°œ ë° Serverlessë¡œ ì‹¤ì œ ê²Œì„ ê°œë°œí•˜ê¸°</a></li><li>11ì›” IBM Developer Day : <a href="http://public.dhe.ibm.com/software/kr/TrackB/B3.pdf" target="_blank" rel="noopener noreferrer">Continuous Delivery using Spinnaker on Kubernetes Multi Cluster</a></li><li>11ì›” "Kubernetes Meetup" 1Day : <a href="https://www.slideshare.net/JinwoongKim8/spinnaker-on-kubernetes-123752186" target="_blank" rel="noopener noreferrer">Spinnaker on Kubernetes</a></li></ul></li></ul><p>ì“°ê³ ë‚˜ì„œ ë³´ë‹ˆ 2018ë…„ë„ íšŒê³ ë¼ê¸° ë³´ë‹¤ ê±°ì˜ ê°œë°œì— í•„ìš”í•œ ì¡ì¼(DevOpsë¼ê³  ë‘ë‘”í•˜ë©´ì„œ)ê³¼ ë°œí‘œë§Œ í•œê±° ê°™ë„¤...
19ë…„ë„ ë¶€í„°ëŠ” ë‹¤ë¥¸ì—…ë¬´ë¥¼ í•˜ê²Œ ë ê±° ê°™ì€ë° ì´ˆì‹¬ì„ ìƒì§€ ë§ì•„ì•¼ í•˜ê² ë‹¤.</p><p>ìµœê·¼ í™”ë‘ê°€ ë˜ì—ˆë˜ <code>ë…¸ë ¥ì¤‘ë…</code> ì´ì˜€ë˜ê²ƒ ê°™ì€ 18ë…„ì€ í„¸ì–´ë²„ë¦¬ê³ 
ë‚´ê°€ ì§„ì§œë¡œ ì¢‹ì•„í•˜ê³  í•˜ê³  ì‹¶ì€ ê³µë¶€ì™€ ì—…ë¬´, ê·¸ë¦¬ê³  ê°€ì¡±ì„ ìœ„í•´ì„œ ë¡œë“œë°¸ëŸ°ì‹± í•˜ë©´ì„œ ì§€ë‚´ì•¼ í•˜ê² ë‹¤. </p><p>2006ë…„ì— ì“´ ë¯¸ë˜ì˜ ë‚´ ëª¨ìŠµê³¼ ì–´ëŠì •ë„ ì¼ì¹˜í•˜ëŠ”ê±° ê°™ì§€ë§Œ ëª©í‘œë¥¼ ì¢€ë” ë†’ì´ ì¡ì•„ì•¼í• ë“¯ í•˜ë‹¤.</p><p>ë²ˆì—­ì— ì°¸ì—¬í•˜ê±°ë‚˜ ì±…ì„ ì¨ë³¸ë‹¤ë˜ì§€ ì»¤ë®¤ë‹ˆí‹° í™œë™ì„ ì¢€ë” ì ê·¹ì ìœ¼ë¡œ í•´ë³´ê³ 
íšŒì‚¬ì—ì„œ ì‹œí‚¤ëŠ” ë°‹ì—…ì´ ì•„ë‹Œ ìë°œì ìœ¼ë¡œ ì°¸ì—¬í•˜ëŠ” ì™¸ë¶€ ê°•ì—°ì´ë‚˜ ë°‹ì—…ì„ ìœ„ì£¼ë¡œ í•´ë´ì•¼ê² ë‹¤. </p><p>ë˜í•œ ì ì  ê°œë°œì˜ì—­ê³¼ ë©€ì–´ì§€ëŠ”ê±° ê°™ì€ ë‚´ëª¨ìŠµì´ ë‚˜ì´ê°€ ë“¤ë©´ì„œ ë” ì‹¬í™”ë ê±° ê°™ì•„ì„œ ì§€ì¸ë“¤ê³¼ ë³„ë„ì˜ ê°œë°œ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•´ë³´ë ¤ê³  í•œë‹¤.</p><p>ë‚´ 13ë…„ê°„ ì§ì¥ ìƒí™œì¤‘ ê°€ì¥ ë°”ì˜ê³  ë‹¤ì´ë‚´ë¯¹í•˜ë©´ì„œ ë°”ë¹´ë˜ í•œí•´ì´ì ë§ì€ ê²½í—˜ê³¼ ê³µë¶€ê°€ ë˜ì—ˆë˜ ì¼ë…„ì´ì˜€ë˜ê²ƒ ê°™ë‹¤.</p><p>ë‚˜ë¥¼ ë•¡ê²¨ì£¼ì…¨ë˜ <code>June</code>, í•­ìƒ ë¶„ìœ„ê¸°ë¥¼ ë¦¬ë“œí–ˆë˜ <code>Joonbum</code>, ì–¸ì œë‚˜ ì—´ì •ê°€ë“í•˜ê³  ìµœê³ ì˜ DevOps í”Œë ˆì´ì–´ <code>Jeongho</code>, ë“ ë“ í•œ Backender <code>Donghun</code>, Excellent/Free/Kind(a.k.a EFK)í•œ <code>Minyoung</code>, ë‚´ê°€ ì¸ì •í•˜ëŠ” Frontier <code>Sanghun</code>, Best Rookie <code>Minsoo</code>, sorry because the hy <code>HyunSang</code>, Moontoring <code>Jinsoo</code>, Forever Mentor <code>Jaemoon</code>, Guru of CNI <code>Youngchae</code> ëª¨ë‘ì—ê²Œ ê°ì‚¬ì˜ ë§ì”€ì„ ì „í•˜ê³  ì‹¶ë‹¤. (ë¬´ìŠ¨ ìˆ˜ìƒì†Œê°ë„ ì•„ë‹ˆê³  ã…‹ã…‹)</p><p>19ë…„ì—ë„ ë‚¨ë“¤ì—ê²Œ ì¡´ê²½ì„ ë°›ëŠ” ì‚¬ëŒë³´ë‹¤ëŠ” ë¬´ìŠ¨ì¼ì„ í•˜ë“ ì§€ ëŒ€ì¤‘ì—ê²Œ ìš•ë¨¹ì§€ ì•Šê³  í•„ìš”í• ë•Œ ë„ì›€ì„ ìš”ì²­ì„ í• ìˆ˜ ìˆëŠ” ê·¸ëŸ° í¸í•œ ì‚¬ëŒì´ ë˜ì–´ì•¼ ê² ë‹¤.</p>]]></content>
        <category label="Retrospective" term="Retrospective"/>
        <category label="2018" term="2018"/>
        <category label="Planning" term="Planning"/>
        <category label="Change" term="Change"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Cloud Enginner]]></title>
        <id>cloud/cloud/</id>
        <link href="https://ddii.dev/cloud/cloud/"/>
        <updated>2018-12-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Cloud Enginner]]></summary>
        <content type="html"><![CDATA[<p>ì˜¤ëŠ˜ì€ ì“¸ë°ì—†ëŠ” ì´ì•¼ê¸°ë¥¼ ì£¼ì €ë¦¬ ì ì–´ë³¸ë‹¤. </p><p>í˜ì¹œí•œë¶„ì´ ë§ì”€í•˜ì‹  êµ¬ì ˆì´ ë– ì˜¤ë¥¸ë‹¤.
<code>"ì—”ì§€ë‹ˆì–´ë¼ê³  í•´ì„œ ì •ì¹˜ë ¥ì´ í•„ìš”ì—†ëŠ”ê²ƒì´ ì•„ë‹ˆë‹¤. ì˜¤íˆë ¤ í˜ì‹ ì ì¸ ê¸°ìˆ ì€ ì •ì¹˜ë ¥, ê¶Œë ¥ì´ ì—†ìœ¼ë©´ ì ìš©ë  ìˆ˜ ì—†ë‹¤"</code> - ì œí”„ë¦¬ í˜í¼êµìˆ˜ì˜ "ê¶Œë ¥ì˜ ê¸°ìˆ "</p><p>ë‚˜ì´ 40ì„ ë„˜ê¸´ ì—”ì§€ë‹ˆì–´ë¡œì„œ ë‚˜ëŠ” ì–´ë–¤ ìœ„ì¹˜ì¸ê°€?</p><p>Cloud ê´€ë ¨ ì˜¤í”ˆì†ŒìŠ¤ë¡œ ë¹„ì¦ˆë‹ˆìŠ¤ë¥¼ ì§„í–‰í•˜ë©´ì„œ í˜„ ì§ì¥ì—ì„œ 2ë…„ì„ ë³´ëƒˆë‹¤.
ë³´ëŒë„ ìˆì—ˆê³  ì‹¤íŒ¨ë„ ìˆì—ˆë‹¤.<br>
<!-- -->ì˜¬í•´ëŠ” ê¸°íší•œ ì˜¤í”ˆì†ŒìŠ¤ ê¸°ë°˜ í”„ë¡œì íŠ¸ë¡œ ì—¬ëŸ¬ì‚¬ëŒì˜ í˜ì„ í•©ì³ì„œ ì„œë¹„ìŠ¤ë¥¼ ëŸ°ì¹­í•˜ê¸°ë„ í•˜ì˜€ì§€ë§Œ ëª‡ë…„ê°„ ê¸€ë¡œë²Œ í”Œë ˆì´ì–´ë“¤ì„ ë³´ë©´ì„œ ëŠë‚€ì ì€  </p><p>íšŒì‚¬ê°€ ê¸€ë¡œë²Œ í”Œë ˆì´ì–´ê°€ ë˜ê¸°ìœ„í•´ ë…¸ë ¥í•˜ëŠ” ë°©ë²•ì€ ë‹¤ì–‘í•˜ì§€ë§Œ<br>
<!-- -->ê²°êµ­ ì´ìœ¤ì„ ëª©ì ìœ¼ë¡œ íšŒì‚¬ì—ì„œ í—ˆìš©í•˜ê³  íˆ¬ìí•˜ëŠ”ê²ƒì´ê³ <br>
<!-- -->ê·¸ê±¸ë¡œ ëˆì„ ëª»ë²Œë©´ ë°”ë¡œ ì³ë‚¼ìˆ˜ ìˆë‹¤ëŠ” ê²½ì˜ì¸µì˜ ìƒê°ì€ ë³€í•¨ì´ ì—†ì„ê²ƒì´ë‹¤. </p><p>ì´ëŸ° ë§ˆìŒê°€ì§ì„ ë³€í™”ì‹œí‚¤ì§€ ì•ŠëŠ”ë‹¤ë©´ í›Œë¥­í•œ í”„ë¡œì íŠ¸ë¼ë„ ì„±ê³µì´ë“  ì‹¤íŒ¨ë“  ëê¹Œì§€ ê°€ëŠ”ê²ƒì€ ì–´ë µë‹¤ê³  ìƒê°í•œë‹¤. </p><p>ì²˜ìŒ í´ë¼ìš°ë“œ ê´€ë ¨ ì—…ë¬´ë¥¼ ì‹œì‘í• ë•Œë¥¼ ìƒê°í•´ë³¸ë‹¤.</p><ul><li><p>2010ë…„<br>
<!-- -->íŒ€ì¥: ë„ˆ í´ë¼ìš°ë“œ í• ë˜?<br>
<!-- -->ë‚˜ : ë¬´ìŠ¨ì¼í•˜ëŠ”ë°ìš”?<br>
<!-- -->íŒ€ì¥: ê°€ìƒí™” í”„ë¡œì íŠ¸í•˜ëŠ”ë° ê°™ì´ í•œë²ˆ ë¹„ì¦ˆë‹ˆìŠ¤ ë§Œë“¤ì–´ë³´ì, ë„ˆê°€ í•˜ê³  ì‹¶ì€ëŒ€ë¡œ ê¸°íší•˜ê³  í•´ë´~<br>
<!-- -->ë‚˜ : ë„¤^^ ì—´ì‹¬íˆ í•˜ê² ìŠµë‹ˆë‹¤.  </p></li><li><p><code>ê°œì¸ ì„±ê³¼ ë° íŒ€ì˜ ëª©í‘œëŠ” ì–´ëŠì •ë„ ë‹¬ì„±í•˜ì˜€ìœ¼ë‚˜ ROI ë‹¬ì„±ì€ ì‰½ì§€ ì•Šì•˜ìŒ</code></p></li><li><p>2016ë…„<br>
<!-- -->íŒ€ì¥: ë„ˆ ì£¼ê°„ë³´ê³  ë˜‘ë°”ë¡œ ì•ˆí•´?, ì§€ë‚œë²ˆ ì¥ì• ë³´ê³ ëŠ” ì–´ë–»ê²Œ ëœê±°ì•¼?<br>
<!-- -->ë‚˜: ã… ã… <br>
<!-- -->íŒ€ì¥: ìš°ë¦¬ íŒ€ ìˆ˜ì¹˜ê°€ ì´ê²Œ ë­ëƒ... ì¢€ ì˜ì¢€ í•´ë´<br>
<!-- -->ë‚˜: ã… ã… <br>
</p></li><li><p><code>ê²°êµ­ í‡´ì‚¬</code></p></li><li><p>2017ë…„<br>
<!-- -->íŒ€ì¥: í•˜ê³  ì‹¶ì€ëŒ€ë¡œ í•´ë´
ë‚˜: ì§„ì§œìš”? ëšë”±ëšë”±<br>
<!-- -->íšŒì‚¬: ìˆ˜ìµëª¨ë¸ì´ ë­ì§€?<br>
<!-- -->ë‚˜: ...  </p></li><li><p><code>ì¶œì‹œí•˜ê¸°ë„ ì „ì— ì„œë¹„ìŠ¤ ì¢…ë£Œ</code></p></li><li><p>2018ë…„<br>
<!-- -->íŒ€ì¥: í•˜ê³  ì‹¶ì€ê±° í•´ë´ìš”. ëŒ€ì‹  ëˆë²Œì–´ì™€ì•¼í•´<br>
<!-- -->ë‚˜: ì§„ì§œìš”? ëšë”±ëšë”±<br>
<!-- -->íšŒì‚¬: í  ì¢€ ë¶€ì¡±í•˜ì§€ë§Œ ì•ìœ¼ë¡œ ì¢€ë” ì˜í•´ì£¼ì„¸ìš”. ë ˆí¼ëŸ°ìŠ¤ í™•ë³´ì— í˜ì¨ì£¼ì„¸ìš”.<br>
<!-- -->ë‚˜: ì„œë¹„ìŠ¤ ê¸°íšìê°€ í•„ìš”í•©ë‹ˆë‹¤.<br>
<!-- -->íšŒì‚¬: ... ë³¸ì¸ì´ í•´ì•¼í•˜ëŠ”ê±° ì•„ë‹Œê°€ìš”?<br>
<!-- -->ë‚˜: ...<br>
</p></li><li><p><code>ê¸°íšì„ í•´ì•¼í•˜ë‚˜ ì•„ì§ ê¸°ìˆ ë ¥ë„ ë¶€ì¡±í•œë°...</code>  </p></li></ul><p>ë²Œì¨ ì§ì¥ìƒí™œ 13ë…„ì°¨ì— ë§ˆí”ì‚´ì´ ë„˜ì–´ê°€ê³  ìˆë‹¤. </p><p>ì—”ì§€ë‹ˆì–´ë¡œ ì‚´ì•„ì˜¨ë‚ ë³´ë‹¤ ì‚´ì•„ê°€ì•¼í• ë‚ ì´ ì ê²Œ ë‚¨ì•˜ê³  ì–¼ë§ˆ ë‚¨ì§€ ì•Šì•˜ë‹¤ëŠ” ìƒê°ì´ ë“œëŠ” ìš°ìš¸í•œ í•˜ë£¨ë‹¤.
10ë…„ê°„ ê³µë¶€í•´ì™”ë˜ ê²ƒë“¤ë³´ë‹¤ 2ë…„ë™ì•ˆ ê³µë¶€í•œê²Œ ë” íŒŒê²©ì ì´ê³  ë‹¤ì–‘í•˜ê³  ë³µì¡í–ˆë‹¤.</p><p>ì—¬ëŸ¬ëª¨ë¡œ ì•„ì‰¬ìš´ í•œí•´ì˜€ë‹¤...</p><p>ì•ìœ¼ë¡œ ë‚´ê°€ ë¶€ì¡±í•œ ë¶€ë¶„ì„ ê¸°ìˆ ë ¥ìœ¼ë¡œ ë©”ê¿€ê²ƒì´ëƒ? í˜‘ìƒê³¼ ì •ì¹˜ë ¥ìœ¼ë¡œ ë©”ê¿€ê²ƒì´ëƒ?</p><p>ì ì´ ì•ˆì˜¤ëŠ” 12ì›”ì´ë‹¤.</p>]]></content>
        <category label="Cloud" term="Cloud"/>
        <category label="Enginner" term="Enginner"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Spinnaker on Kubernetes #3 (Kayenta)]]></title>
        <id>kubernetes/spinnaker-advanced-3/</id>
        <link href="https://ddii.dev/kubernetes/spinnaker-advanced-3/"/>
        <updated>2018-12-04T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Spinnakerì— ëŒ€í•´ ì•Œì•„ë´…ë‹ˆë‹¤ #3 (Kayenta)]]></summary>
        <content type="html"><![CDATA[<p>3ë²ˆì§¸ í¬ìŠ¤íŒ…ì´ë‹¤.</p><p>11/23 "Kubernetes Meetup" 1Dayì—ì„œ ë°œí‘œí•œ ì´ì•¼ê¸° ì—°ì¥ì„ ìœ¼ë¡œ ì‘ì„±í•œë‹¤.</p><p>ê³ ê°ì—ê²Œ ì˜¤í¼ë§ì„ ìœ„í•´ ì¤€ë¹„í•œ ë‚´ìš©ê³¼ Kubernetes monitoringê³¼ ì—°ê³„í•œ ë‚´ìš©ì— ëŒ€í•´ì„œ ì ì–´ë³´ë ¤ê³  í•œë‹¤.
ìµœê·¼ ë°œí‘œë¥¼ ë‹¤ë‹ˆë©´ì„œ ë§ì´ ë°›ëŠ” ì§ˆë¬¸ì´ ì‹¤ì œ ì‚¬ìš©í• ë§Œ í•œê°€?ë¼ëŠ” ì§ˆë¬¸ê³¼ ì–´ë–»ê²Œ í™œìš©í•´ì•¼ í•˜ëŠ”ì§€ì— ëŒ€í•œ ì§ˆë¬¸ë“¤ì„ ë§ì´ ë°›ëŠ”ë‹¤.
ì˜¤ëŠ˜ ìµœê·¼ Spinnaker Summit 2018ì—ì„œ ì¤‘ìš”í•˜ê²Œ ë‹¤ë¤˜ë˜ Kayenta í”„ë¡œì íŠ¸ë¥¼ ê°€ì§€ê³  ì´ì•¼ê¸° í•´ë³´ë ¤ê³  í•œë‹¤. </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kayenta">Kayenta<a class="hash-link" href="#kayenta" title="Direct link to heading">â€‹</a></h2><p>KayentaëŠ” ìë™ Canary ë¶„ì„ ì˜¤í”ˆì†ŒìŠ¤(Automated Canary Service(ACA))ë¡œ Spinnakerì˜ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì¤‘ í•˜ë‚˜ë¡œ ë™ì‘í•œë‹¤.<br>
<!-- -->Automated Canary Deploymentsì— ì‚¬ìš©ë˜ê³  ìì„¸í•œ ë‚´ìš©ì€ <a href="https://www.spinnaker.io/guides/user/canary/stage/" target="_blank" rel="noopener noreferrer">canary documentation</a>ì„ í™•ì¸í•˜ë©´ ëœë‹¤.  </p><p>ìƒˆ ì¢…ë¥˜ì˜ í•˜ë‚˜ì¸ CanaryëŠ” 1ì°¨ ì„¸ê³„ëŒ€ì „ì¤‘ì— ì¸ê°„ì´ í•´ë¥¼ ì…ê¸° ì „ì— ë…ì„±ê°€ìŠ¤ë¥¼ íƒì§€í•˜ëŠ” ìš©ë„ë¡œ ì‚¬ìš©ë˜ì—ˆë‹¤ê³  í•œë‹¤.
DevOpsì—ì„œëŠ” CD(Continuous Deployment) í”„ë¡œì„¸ìŠ¤ì˜ ì¼ë¶€ë¡œ ì‚¬ìš©ë˜ë©° Canary ë¦´ë¦¬ì¦ˆëŠ” ìƒˆë¡œìš´ ë²„ì „ì˜ Softwareë¥¼ Productionì— ë°°í¬í•˜ëŠ” ìœ„í—˜ì„ ì¤„ì—¬ì£¼ëŠ” ê¸°ìˆ ì´ë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤.</p><p>Canary ì‹ ê·œ ë²„ì „ì˜ Softwareë¥¼ ì•ˆì •ì ì¸ ê¸°ì¡´ ë²„ì „ê³¼ í•¨ê»˜ ë°°í¬í•˜ê³  íŠ¹ì •ì‚¬ìš©ìë‚˜ ì¼ë¶€ ëŒ€ìƒì—ê²Œ íŠ¸ë˜í”½ ì¼ë¶€ë¥¼ í˜ë ¤ ê¸°ì¡´ ì‚¬ìš©ìì—ê²Œ ì˜í–¥ì„ ìµœì†Œí•˜í•˜ê³  ìƒˆë¡œìš´ ë²„ì „ì˜ ë¬¸ì œë¥¼ ì‹ ì†í•˜ê²Œ ë°œê²¬í•˜ê³  ì´ì „ì˜ ì•ˆì •ëœ ë²„ì „ìœ¼ë¡œ íŠ¸ë˜í”½ì„ ë‹¤ì‹œ ë¼ìš°íŒ…ì‹œí‚¤ëŠ”ê²ƒì´ ì£¼ìš” ê¸°ëŠ¥ì´ë¼ê³  ë³´ë©´ ëœë‹¤.  </p><p>ë³´í†µ í’ˆì§ˆ í…ŒìŠ¤íŠ¸ ìš©ë„ë¡œ í˜„ì¬ ìš´ì˜ ë²„ì „ê³¼ ì‹ ê·œ ë²„ì „ì˜ ì£¼ìš”í•œ ì§€í‘œ(ì£¼ë¡œ Prometheus Metric)ë¥¼ ë¹„êµí•˜ì—¬ í‰ê°€ë¥¼ ì§„í–‰í•˜ëŠ”ë° ì´ë¥¼ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë‚˜ í†µí•© í…ŒìŠ¤íŠ¸ë¥¼ ëŒ€ì²´í•˜ì—¬ ì‚¬ìš©í•´ì„œëŠ” ì ˆëŒ€ ì•ˆëœë‹¤.<br>
<!-- -->ìœ„ì—ì„œ ì–¸ê¸‰í•˜ì˜€ë“¯ì´ ì˜ˆê¸°ì¹˜ ì•Šì€ ìœ„í—˜ì„ ìµœì†Œí™” í•˜ê±°ë‚˜ ë¬¸ì œë¥¼ ì‹ ì†í•˜ê²Œ ë°œê²¬í•˜ëŠ” ê²ƒì„ ì£¼ ëª©ì ìœ¼ë¡œ í•˜ê¸° ë•Œë¬¸ì´ë‹¤.</p><p>Spinnakerì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ 3ê°€ì§€ Cluster(Logical Application Group)ë¥¼ ì‚¬ìš©í•œë‹¤.</p><ul><li>Production Cluster - í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ ìš´ì˜ ë²„ì „ìœ¼ë¡œ ReplicaëŠ” ì„ì˜ë¡œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤. </li><li>Baseline Cluster - Production Clusterì™€ ë™ì¼í•œ ë²„ì „ìœ¼ë¡œ ì‹¤í–‰ë¨</li><li>Canary Cluster - ë³€ê²½ëœ ì‹ ê·œ ë²„ì „ì˜ Softwareë¡œ ì‹¤í–‰ë¨</li></ul><p>ê¸°ë³¸ì ìœ¼ë¡œ ìˆ˜ë™ìœ¼ë¡œ ì§„í–‰í•  ê²½ìš°ì—ëŠ” ë¡œê·¸ì™€ ìˆ˜ì§‘ëœ ë©”íŠ¸ë¦­ì„ ë¶„ì„í•˜ê³  ê°ê´€ì ì¸ ì§€í‘œë¡œ í‰ê°€ë¥¼ ì§„í–‰í•˜ëŠ”ê²Œ ê¸°ë³¸ì´ë‹¤.
í•˜ì§€ë§Œ ì§ì ‘ ì‚¬ëŒì´ í•˜ëŠ” ì¼ì´ë¼ ë©”íŠ¸ë¦­ ë°ì´í„°ë¥¼ ë³´ë‹¤ ë³´ë©´ í¸ê²¬ê³¼ ì°©ì˜¤ê°€ ë°œìƒí•  ìˆ˜ ë°–ì— ì—†ë‹¤.</p><p>ê·¸ë˜ì„œ NetflixëŠ” ACA(Automated Canary Service)ë¼ê³  í•˜ëŠ” ìë™í™”ëœ ì ‘ê·¼ ë°©ì‹ì„ í†µí•´ ì¹´ë‚˜ë¦¬ ë¶„ì„ì„ ì§„í–‰í•˜ê³  ìˆë‹¤.
ìˆ˜ë™ìœ¼ë¡œ ê³„ì‚°ëœ ì—¬ëŸ¬ê°€ì§€ ì§€í‘œë¥¼ ê°€ì¤‘ì¹˜ ê¸°ë°˜ìœ¼ë¡œ ì ìˆ˜ë¥¼ ë‚´ë¦¬ê³  ì›í•˜ëŠ” ì ìˆ˜ì— ë„ë‹¬í•˜ë©´ ë°°í¬í•˜ëŠ” ìë™í™”ëœ ë°©ì‹ì´ë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="requirements">Requirements<a class="hash-link" href="#requirements" title="Direct link to heading">â€‹</a></h2><ul><li>spinnaker cluster - 1.8+ (1.9.3 ì´ìƒ ì¶”ì²œ)</li><li>halyard - 1.0+</li><li>kubernetes cluster - 1.9+</li><li>metric services - datadog, prometheus, stackdriver, signalfx</li><li>persistent storage - S3(or compatible S3), minio, GCS</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kayenta-service-ì¶”ê°€í•˜ê¸°">Kayenta Service ì¶”ê°€í•˜ê¸°<a class="hash-link" href="#kayenta-service-ì¶”ê°€í•˜ê¸°" title="Direct link to heading">â€‹</a></h2><p>ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì•„ë˜ í™˜ê²½ìœ¼ë¡œ ì‘ì„±í•˜ì˜€ë‹¤.</p><ul><li>spinnaker cluster - 1.10.5</li><li>halyard - 1.11</li><li>kubernetes cluster - 1.9.7</li><li>metric services - prometheus</li><li>persistent storage - compatible S3(IBM Object Storage)</li></ul><p>ì¼ë‹¨ ê¸°ì¡´ halyard configë¥¼ ë°±ì—…í•˜ì. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ hal backup create</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+ Create backup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Success</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+ Successfully created a backup at location:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/Users/ddii/halbackup-Wed_Nov_28_13-35-31_KST_2018.tar</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë‚˜ì¤‘ì— ë³µêµ¬ëŠ” ì•„ë˜ì™€ ê°™ì´ í•˜ë©´ ëœë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ hal backup restore --backup-path &lt;backup-name&gt;.tar</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê¸°ì¡´ halyard configë¥¼ ì‚´í´ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ canary.enabled=false ë¡œ ë˜ì–´ìˆëŠ” ê²ƒì„ í™•ì¸ í• ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">currentDeployment: default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deploymentConfigurations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- name: default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  canary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    enabled: false</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>canary analysisì„ í™œì„±í™” í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ hal config canary enable</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê·¸ë¦¬ê³  default judgement algorithmì€ <code>NetflixACAJudge-v1.0</code> ë¡œ ë˜ì–´ìˆë‹¤ ë‹¤ë¥¸ ê±¸ ì´ìš©í•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì •í• ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ hal config canary edit --default-judge CUSTOM_JUDGE</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë©”íŠ¸ë¦­ ì†ŒìŠ¤ë¡œ prometheusë¥¼ ì„¤ì •í•œë‹¤. ë¬¼ë¡  ê¸°ì¡´ì— ì‚¬ìš©ì¤‘ì¸ prometheus endpoint urlì´ í•„ìš”í•˜ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">hal config canary prometheus enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hal config canary prometheus account add my-prometheus --base-url http://YOUR_PROMETHEUS_SERVER:PORT</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì—¬ê¸°ì„œëŠ” IBM Cloud Object Storage(S3 Compatible)ì„ ì‚¬ìš©í•˜ì˜€ì§€ë§Œ awsë¡œ ì„¤ì •í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ hal config canary aws enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ hal config canary aws account add my-s3 --bucket spin-bucket --endpoint \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    s3.seo-ap-geo.objectstorage.service.networklayer.com --access-key-id ACCESS_ID \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --secret-access-key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ hal config canary aws edit --s3-enabled=true</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì—¬ëŸ¬ê°œì˜ ë©”íŠ¸ë¦­ì„ ë™ì‹œì— ì„¤ì • ë° ìˆ˜ì§‘ì´ ê°€ëŠ¥í•˜ë¯€ë¡œ ê·¸ì¤‘ prometheus ë° ê´€ë ¨ accountë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì„¤ì •í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ hal config canary edit --default-metrics-store prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ hal config canary edit --default-metrics-account my-prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ hal config canary edit --default-storage-account my-s3</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ëª¨ë“  spinnaker clusterê°€ ì¤€ë¹„ëœ ìƒíƒœì˜ ì»¨í”¼ê·¸ëŠ” ì•„ë˜ì™€ ê°™ë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">currentDeployment: default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deploymentConfigurations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- name: default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  canary:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    enabled: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    serviceIntegrations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: google</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      enabled: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      accounts: []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      gcsEnabled: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      stackdriverEnabled: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      enabled: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      accounts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: my-prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        endpoint:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          baseUrl: http://YOUR_PROMETHEUS_SERVER:PORT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        supportedTypes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - METRICS_STORE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: datadog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      enabled: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      accounts: []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: aws</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      enabled: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      accounts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: my-s3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bucket: spin-bucket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rootFolder: kayenta</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        endpoint: s3.seo-ap-geo.objectstorage.service.networklayer.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        accessKeyId: ACCESS_ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        secretAccessKey: ACCESS_KEY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        supportedTypes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - OBJECT_STORE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - CONFIGURATION_STORE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      s3Enabled: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    reduxLoggerEnabled: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    defaultMetricsAccount: my-prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    defaultStorageAccount: my-s3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    defaultJudge: NetflixACAJudge-v1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    defaultMetricsStore: prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stagesEnabled: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    templatesEnabled: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    showAllConfigsEnabled: true</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Spinnaker Clusterë¥¼ ì¬ë°°í¬í•˜ê²Œ ë˜ë©´ ì•„ë˜ì™€ ê°™ì´ spin-kayenta deploymentsê°€ ì¶”ê°€ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ hal deploy apply</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spin-clouddriver-555cfc9765-kvnl8   1/1       Running   0          6d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spin-deck-85845b5b48-49ncm          1/1       Running   0          6d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spin-echo-5f9dd4d8ff-mvt7g          1/1       Running   0          6d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spin-fiat-5b945645d8-s2qcq          1/1       Running   0          6d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spin-front50-5c57fcf587-tqz28       1/1       Running   0          6d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spin-gate-57576b8c45-w5v6r          1/1       Running   0          6d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spin-kayenta-6dcd7767d6-rgb9w       1/1       Running   0          6d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spin-orca-788df6b9cc-tk6lk          1/1       Running   0          6d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spin-redis-6c87c456fc-6qbl2         1/1       Running   0          6d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spin-rosco-f6f845d49-btjnd          1/1       Running   0          6d</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´í›„ Dashboardì— ì ‘ì†í•˜ê³  applicationì¤‘ í•˜ë‚˜ì˜ Configì— ë“¤ì–´ê°€ë©´ Featuresì— Canaryë©”ë‰´ê°€ ìƒê¸´ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì‚¬ìš©ì„¤ì •í•˜ê³  ìºì‹±í•˜ëŠ”ë° ì‹œê°„ì´ ë‹¤ì†Œ í•„ìš”í•˜ê³  Tasks ë©”ë‰´ì—ì„œ í•´ë‹¹ jobì— ëŒ€í•œ ë‚´ìš©ì„ í™•ì¸í• ìˆ˜ ìˆë‹¤. </p><p><img loading="lazy" alt="canary" src="/assets/images/canary_config-57ef01bd86dbbbe0b3463b2bb83c0243.png" width="1045" height="603" class="img_E7b_"></p><p>ì´í›„ application delivery ë©”ë‰´ë¥¼ ë³´ë©´ pipelines, canary configs, canary reportsë¼ëŠ” ë©”ë‰´ê°€ ìƒê¸°ê²Œ ëœë‹¤. </p><p><img loading="lazy" alt="delivery" src="/assets/images/delivery-eef9175b5a136e62f7cd72a689bcefde.png" width="766" height="169" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="simple-deploy-pipeline-ì¶”ê°€">simple deploy pipeline ì¶”ê°€<a class="hash-link" href="#simple-deploy-pipeline-ì¶”ê°€" title="Direct link to heading">â€‹</a></h2><p><a href="https://cloud.google.com/solutions/automated-canary-analysis-kubernetes-engine-spinnaker" target="_blank" rel="noopener noreferrer">https://cloud.google.com/solutions/automated-canary-analysis-kubernetes-engine-spinnaker</a> ê°€ì´ë“œ ì²˜ëŸ¼ êµ¬ì„±í•´ë´ë„ ë˜ë‚˜ <code>stackdriver</code>ë¥¼ ì¨ì•¼í•˜ê³  <code>prometheus metric</code>ì„ í™œìš©í•œ ê°€ì´ë“œê°€ í•„ìš”í•´ì„œ ì ì–´ë³´ê³ ì í•œë‹¤.</p><p>ìƒˆë¡œ íŒŒì´í”„ë¼ì¸ì„ ì¶”ê°€í•œ ë‹¤ìŒ </p><p><img loading="lazy" alt="newpipe" src="/assets/images/newpipe-d4e9f69e18fde50d33ae018234d68016.png" width="595" height="261" class="img_E7b_"></p><p>Pipeline Actions - Edit Pipeline JSON ì—ì„œ
<a href="https://raw.githubusercontent.com/ddiiwoong/canary-demo-spinnaker/master/simple-deploy.json" target="_blank" rel="noopener noreferrer">https://raw.githubusercontent.com/ddiiwoong/canary-demo-spinnaker/master/simple-deploy.json</a> ì„ ì¶”ê°€í•´ì¤€ë‹¤.  </p><p>í•´ë‹¹ json pipelineì„ ì¶”ê°€í•˜ê³  ë‚˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ í™”ë©´ì„ í™•ì¸í• ìˆ˜ ìˆë‹¤.
<img loading="lazy" alt="pipe1" src="/assets/images/samplepipe1-fb6117126a3a4c5b9d9f314a19f0aad9.png" width="1151" height="1314" class="img_E7b_">
<img loading="lazy" alt="pipe2" src="/assets/images/samplepipe2-8387265c6cb69906e7cb8adc4c304432.png" width="1058" height="871" class="img_E7b_"></p><p>ë°˜ë“œì‹œ Deploy Config, Deploy Stageì—ì„œ ë°°í¬í•  Account ì§€ì •ì„ í•´ì•¼í•œë‹¤. </p><p><code>sampleapp image - ddiiwoong/canary-demo-spinnaker:latest</code></p><p>í•´ë‹¹ pipelineë‚´ì˜ sampleappì€ python flask ê¸°ë°˜ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ê°„ë‹¨íˆ internal 500 errorë¥¼ ì›í•˜ëŠ” ë¹„ìœ¨ì„ configmap ë³€ìˆ˜ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤. <a href="https://github.com/prometheus/client_python#counter" target="_blank" rel="noopener noreferrer">prometheus python client</a>ë¥¼ ì‚¬ìš©í•˜ì—¬ Gauge, Counter, Metric ì„œë²„ë¥¼ ê°„ë‹¨í•˜ê²Œ êµ¬ì„±ì„ í•´ë³´ì•˜ë‹¤. ê·¸ë¦¬ê³  ì½”ë“œë‚´ì—ì„œ 500 error rateë¥¼ êµ¬í•œ ì´ìœ ëŠ” 18ë…„ 11ì›” ê¸°ì¤€ spinnaker kayenta ë²„ì „ì—ì„œëŠ” PromQL(rate,irateì™€ ê°™ì€ í•¨ìˆ˜) ì§€ì›ì´ ë˜ì§€ ì•ŠëŠ”ë‹¤. ê°œë°œì¤‘ì¸ ì½”ë“œì— í¬í•¨ì´ ëœê²ƒì„ í™•ì¸í•˜ì˜€ê³  12ì›” kubeconë•Œ ì •ì‹ ë¦´ë¦¬ì¦ˆì— í¬í•¨ë ê±°ë¼ ìƒê°í•œë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#!/usr/bin/env python</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from random import randrange</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from flask import Flask</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from prometheus_client import start_http_server, Gauge, Counter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app = Flask('kayenta-tester')</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c = Counter('requests', 'Number of requests served, by http code', ['http_code'])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">g = Gauge('rate_requests', 'Rate of success requests')</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">responce_500 = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">responce_200 = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rate_responce = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route('/')</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def hello():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    global responce_500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    global responce_200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    global rate_responce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if randrange(1, 100) &gt; int(os.environ['SUCCESS_RATE']):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        c.labels(http_code='500').inc()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        responce_500 = responce_500 + 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rate_responce = responce_500 / (responce_500+responce_200) * 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        g.set(rate_responce)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return "Internal Server Error\n", 500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        c.labels(http_code = '200').inc()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        responce_200 = responce_200 + 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rate_responce = responce_500 / (responce_500+responce_200) * 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        g.set(rate_responce)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return "Hello World!\n"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start_http_server(8000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.run(host = '0.0.0.0', port = 8080)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í•´ë‹¹ì•±ì„ Start Manual Execuctionì„ í†µí•´ ë°°í¬í•œë‹¤. Comfirm Executionì°½ì—ì„œ SUCCESS_RATEë¥¼ ì›í•˜ëŠ” ê°’(ì˜ˆ:70%)ìœ¼ë¡œ ì„ íƒí•˜ê³  ë°°í¬ë¥¼ í•˜ê³  ë‚˜ë©´ Infrastructure - Clusters ë©”ë‰´ì—ì„œ í•´ë‹¹ ìƒ˜í”Œì•±ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><p><img loading="lazy" alt="manaul deploy" src="/assets/images/manual-e2292b9d8cb972b8689b76e151c51dae.png" width="1199" height="389" class="img_E7b_">
<img loading="lazy" alt="success rate" src="/assets/images/successrate-85ead10953b6d655a150d6471669df12.png" width="1212" height="483" class="img_E7b_">
<img loading="lazy" alt="manaul deploy2" src="/assets/images/manual2-7342db27f311edd70cc2d1b07d7c8500.png" width="938" height="383" class="img_E7b_"></p><p>ì‹¤ì œ í•´ë‹¹ ì„œë¹„ìŠ¤ë¥¼ ì ‘ì†í•´ë³´ë©´ ìœ„ì— ì„¤ì •í•œ SUCCESS_RATE ë¹„ìœ¨ë¡œ 200í™”ë©´ê³¼ 500ì—ëŸ¬ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><p><img loading="lazy" alt="flaskweb" src="/assets/images/flaskweb-99e15d6c7aaf0a8305fd3fad53916d95.png" width="606" height="176" class="img_E7b_">
<img loading="lazy" alt="flaskweb2" src="/assets/images/flaskweb2-ca32501038173b934174ce58ecea90a5.png" width="614" height="162" class="img_E7b_"></p><p>í•´ë‹¹ ë©”íŠ¸ë¦­ì˜ í†µê³„ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ curlì„ ë°˜ë³µì ìœ¼ë¡œ ì‹¤í–‰í•˜ëŠ” injection container ë¥¼ ì‹¤í–‰í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl -n default run injector --image=alpine -- \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /bin/sh -c "apk add --no-cache --yes curl; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    while true; do curl -sS --max-time 3 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    http://sampleapp:8080/; done"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>5ë¶„ì •ë„ í›„ì— Prometheusë¡œ ì ‘ì†í•˜ì—¬ ì½”ë“œë‚´ ì‘ì„±í•œ rate_requests ë©”íŠ¸ë¦­ì„ í™•ì¸í•´ë³¸ë‹¤.<br>
<!-- -->PromQLì€ ì•„ë˜ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ì˜€ë‹¤.  </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">rate_requests{app="sampleapp",version="prod"}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ 4ê°œì˜ podì—ì„œ 70% ì •ë„ 200 OK, 30% ì •ë„ 500 Errorê°€ ë°œìƒí•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><p><img loading="lazy" alt="500rate" src="/assets/images/500rate-09760c0ab86a09095865edd35592cec8.png" width="1215" height="837" class="img_E7b_"></p><p>ì´ ë©”íŠ¸ë¦­ì„ Spinnaker ì—ì„œ í™•ì¸í•˜ê¸° ìœ„í•´ Canary Pipelineì„ ë§Œë“¤ì.</p><p><a href="https://raw.githubusercontent.com/ddiiwoong/canary-demo-spinnaker/master/automated-canary.json" target="_blank" rel="noopener noreferrer">https://raw.githubusercontent.com/ddiiwoong/canary-demo-spinnaker/master/automated-canary.json</a>ë¥¼ JSONìœ¼ë¡œ Pipelineì„ ìƒì„±í•œë‹¤. </p><p><img loading="lazy" alt="canary_auto" src="/assets/images/canary_auto-b1920304073dfe8192b4b35af39902ad.png" width="996" height="471" class="img_E7b_"></p><p>Stageë³„ë¡œ ì‚´í´ ë³´ê¸°ì „ì— </p><ul><li>Prerequisite<br>Canary Config êµ¬ì„±ì´ ë¨¼ì € í•„ìš”í•˜ë‹¤. Delivery - Canary Configs ë©”ë‰´ì—ì„œ ì‹ ê·œ ì»¨í”¼ê·¸ë¥¼ ì‘ì„±í•œë‹¤. <ul><li>Configuration Name - <code>kayenta-test</code></li><li>Filter Templates ë©”ë‰´ë¥¼ ë¨¼ì € ìƒì„±í•œë‹¤. Canary, Baselineêµ¬ë¶„ì„ ìœ„í•´ version ì •ë³´ë¥¼ ì„ íƒí•˜ì˜€ë‹¤. </li><li>Metrics - Add Metric ì€ ë¶„ì„ì„ ìœ„í•œ Prometheus Metricì„ ì„¤ì •í•˜ëŠ” ë‹¨ê³„ë¡œ <code>error_rate</code>ê°€ ì¦ê°€(increase)í•˜ë©´ Pipelineì„ ì¤‘ë‹¨ì‹œí‚¤ê³  Metricì€ ì•ì—ì„œ í™•ì¸í•œ <code>rate_requests</code>ë¥¼ ì§€ì •í•œë‹¤. Filter Templateì€ ìœ„ì—ì„œ ì§€ì •í•œ versionì„ ì„ íƒí•œë‹¤. <img loading="lazy" alt="metric config" src="/assets/images/metric_config-cf291dbd8899fdbbbc5c6ccad0f45988.png" width="894" height="663" class="img_E7b_"></li><li>SCORING - ì–´ì§œí”¼ ì˜ˆì œëŠ” í•œê°€ì§€ Metricë¶„ì„ìœ¼ë¡œ 0ì  ì•„ë‹ˆë©´ 100ì ìœ¼ë¡œ ë‚˜ì˜¬ê²ƒì´ë¯€ë¡œ Maginal 75, Pass 95ë¥¼ ì„¤ì •í•œë‹¤.</li></ul></li></ul><ol><li>1st Stage<ul><li>Configuration - Pipeline ì‹¤í–‰ì‹œ ì´ˆê¸° ì…ë ¥ê°’(0-100, 10ë‹¨ìœ„)ìœ¼ë¡œ ì„¤ì •ê°€ëŠ¥í•œ successRate ë¼ëŠ” Parameterë¥¼ ì„¤ì •í•œë‹¤. </li></ul></li><li>2nd Stage<ul><li>Find Baseline - ìœ„ì—ì„œ ì‘ì„±í•œ ê¸°ë³¸ Deploy Pipelineì´ ì„ íƒë˜ì—ˆëŠ”ì§€ì™€ í™•ì¸í•œë‹¤.</li><li>Deploy Canary Config - ì•ì—ì„œ ì„ íƒí•œ ìƒˆë¡œìš´ Parameter(successRate)ë¥¼ ì‹ ê·œ ë°°í¬í•  Canary Pod ConfigMapìœ¼ë¡œ ì„¤ì •í•˜ëŠ” ë‹¨ê³„ì´ë‹¤.</li></ul></li><li>3rd Stage<ul><li>Deploy Canary - yaml manifestë¡œ Canary ë²„ì „ì„ ë°°í¬í•œë‹¤. ReplicasëŠ” 1ë¡œ ì„¤ì •í•˜ì˜€ê³  ë°°í¬ë  Account(K8s Cluster)ë¥¼ ì§€ì •í•œë‹¤. </li><li>Deploy Baseline - yaml manifestë¡œ Baseline ë²„ì „ì„ ë°°í¬í•œë‹¤. ìœ„ì™€ ë™ì¼í•˜ê²Œ ReplicasëŠ” 1ë¡œ ì„¤ì •í•˜ì˜€ê³  ë°°í¬ë  Account(K8s Cluster)ë¥¼ ì§€ì •í•œë‹¤. </li></ul></li><li>4th Stage<ul><li>Canary Analysis - ì¤‘ìš”í•œ Canary ë¶„ì„ ë‹¨ê³„ë¡œ ì•„ë˜ì™€ ê°™ì´ ì„¤ì •ì„ í™•ì¸í•œë‹¤. Prerequisiteì—ì„œ ì„¤ì •í•œ Config(<code>kayenta-test</code>)ë¥¼ ì„ íƒí•˜ê³  ì§§ì€ ë¶„ì„ì„ ìœ„í•´ 1ë¶„(60ì´ˆ) ê°„ê²©ìœ¼ë¡œ 3ë²ˆ ìˆ˜í–‰ì„ í•˜ë„ë¡ í•œë‹¤.   Filter Templateì—ì„œ ì§€ì •í•œ version(<code>version="${scope}"</code>) ë¶„ì„ì„ ìœ„í•´ Baseline, Canary ì„¤ì •ì„ í•˜ê³  Locationì€ Namespacesë¡œ ìƒê°í•˜ë©´ ëœë‹¤. <img loading="lazy" alt="aca config" src="/assets/images/aca_config-a0aaf5a5c7a7867a01913ee1d9cca704.png" width="720" height="947" class="img_E7b_"></li></ul></li><li>5th Stage<ul><li>Deploy to Production - Canary ë¶„ì„ì´ í†µê³¼í•˜ì˜€ì„ ê²½ìš° ìš´ì˜ì— ë°°í¬</li><li>Delete Canary, Delete Baseline - ì„±ê³µì´ë˜ ì‹¤íŒ¨ì´ë˜ Canary, Baseline ë°°í¬ë³¸ì„ ì‚­ì œ </li></ul></li><li>6th Stage<ul><li>Successful deployment - Canary ë¶„ì„ì´ í†µê³¼í•˜ì˜€ì„ ê²½ìš° ìµœì¢… ì™„ë£Œ í‘œê¸°í•˜ëŠ” ë‹¨ê³„</li></ul></li></ol><p>ì„¤ì •ì´ ë§ˆë¬´ë¦¬ê°€ ë˜ë©´ ì €ì¥ì„ í•˜ê³  Canary ë¶„ì„ì— ë“¤ì–´ê°„ë‹¤.
ìµœì´ˆì— <code>successRate</code>ì„ 70ìœ¼ë¡œ ë°°í¬í–ˆë‹¤ë©´ ê·¸ ì´í•˜ë¡œ ì„¤ì •í–ˆì„ ê²½ìš°ì—ëŠ” ì•„ë˜ì™€ ê°™ì´ Score 0ì ìœ¼ë¡œ ë°°í¬ê°€ ì‹¤íŒ¨í•˜ê³  Pipelineì´ ì¢…ë£Œëœë‹¤.   </p><p><img loading="lazy" alt="fail" src="/assets/images/canary_fail-6eb5d2e8dc82e42f62b21d41acce9f6f.png" width="853" height="1001" class="img_E7b_">  </p><p>70 ì´ìƒìœ¼ë¡œ ì„¤ì •í•˜ê²Œ ë˜ë©´ Score 100ì ìœ¼ë¡œ ì •ìƒ ë°°í¬ë¨ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><p><img loading="lazy" alt="success" src="/assets/images/canary_success-27d5394bff7c7d0c7e17dd2697c2d267.png" width="865" height="793" class="img_E7b_">  </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ê°„ë‹¨í•˜ê²Œ Spinnaker ì™€ Prometheus Metricì„ í™œìš©í•˜ì—¬ Kayenta ê¸°ë°˜ Canary ë°°í¬ë¥¼ í•´ë´¤ë‹¤. í˜„ì¬ Spinnaker 1.10ì—ì„œ istioê°€ ì§€ì›ëœë‹¤ê³  í•˜ë‹ˆ ë‹¤ì‹œ í•œë²ˆ í™•ì¸í•˜ê³  istio ê¸°ë°˜ canary ë°°í¬ì™€ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ë” ì—°êµ¬í•´ë´ì•¼ í•  ê²ƒ ê°™ë‹¤.  </p><p>ì˜¬í•´ AWS re:invent ëë‚˜ê³  ì‘ë…„ë³´ë‹¤ í° í˜„ìíƒ€ì„ì´ ì™”ë‹¤. ì˜¤í”ˆì†ŒìŠ¤ë¡œ ë¨¹ê³ ì‚¬ëŠ” ì‚¬ëŒë“¤ì˜ ê¸°ë¶„ì€ ë‹¤ ë¹„ìŠ·í• ê±° ê°™ë‹¤ê³  ìƒê°ì´ ë“ ë‹¤. 12ì›” 11ì¼ ë¶€í„° Kubeconì´ ì—´ë¦°ë‹¤ê³  í•˜ë‹ˆ Kubernetes ê´€ë ¨í•œ ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ì™€ ê¸°ëŠ¥ë“¤ì— ì§‘ì¤‘í•´ì„œ ë‚¨ë“¤ë³´ë‹¤ í•œë°œ ë‚˜ì•„ê°€ì•¼í•˜ì§€ ì•Šì„ê¹Œ? ì˜¤í”ˆì†ŒìŠ¤ë¡œ ë¨¹ê³ ì‚¬ì‹œëŠ” ë¶„ë“¤ ë‹¤ë“¤ í˜ëƒˆìœ¼ë©´ ì¢‹ê² ë‹¤.</p>]]></content>
        <category label="CI/CD" term="CI/CD"/>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="Spinnaker" term="Spinnaker"/>
        <category label="Continuous Delivery" term="Continuous Delivery"/>
        <category label="Continuous Deployment" term="Continuous Deployment"/>
        <category label="Pipeline" term="Pipeline"/>
        <category label="Canary" term="Canary"/>
        <category label="Canary analysis" term="Canary analysis"/>
        <category label="Kayenta" term="Kayenta"/>
        <category label="Automated Canary Service" term="Automated Canary Service"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Spinnaker on Kubernetes #2]]></title>
        <id>kubernetes/spinnaker-advanced-2/</id>
        <link href="https://ddii.dev/kubernetes/spinnaker-advanced-2/"/>
        <updated>2018-09-27T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Spinnakerì— ëŒ€í•´ ì•Œì•„ë´…ë‹ˆë‹¤ #2]]></summary>
        <content type="html"><![CDATA[<p>ì´ì „ í¬ìŠ¤íŒ… <a href="https://ddii.dev/kubernetes/spinnaker-advanced-1/" target="_blank" rel="noopener noreferrer">Spinnaker on Kubernetes #1</a>ì—ì„œ ê²€í† í• ë•ŒëŠ” ë§ì´ ê°œë…ì„ ì´í•´í•˜ê¸° ì–´ë ¤ì› ë˜ê²ƒ ê°™ì§€ë§Œ ì–´ëŠì •ë„ ì‹œê°„ì´ ì§€ë‚¬ê³  ë˜ ëª‡ì¼ í›„ì— ë°œí‘œë„ ìˆì–´ì„œ ë‹¤ë¥¸ ì´ì•¼ê¸°ë¥¼ í•´ë³´ê³ ì í•œë‹¤.  </p><p>ì§€ë‚œ í¬ìŠ¤íŒ…ì— ëŒ€ì¶© ì§‘ê³  ë„˜ì–´ê°„ ìš©ì–´ë“¤ì— ëŒ€í•œ ì •ë¦¬ë¥¼ ë‹¤ì‹œ í•˜ê³  ê¸°ë³¸ì ì¸ ì‚¬ìƒë“¤ì„ ì •ë¦¬í•´ë³´ê³ ì í•œë‹¤. í—ˆì ‘í•œ í”Œë«í¼ ì—”ì§€ë‹ˆì–´ ìƒê°ì´ë‹ˆ ì–¸ì œë“  ë‹¤ë¥¸ ì˜ê²¬ì„ í™˜ì˜í•˜ëŠ” ë°”ì´ë‹¤. </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="what-is-spinnaker-history">What is spinnaker? (+History)<a class="hash-link" href="#what-is-spinnaker-history" title="Direct link to heading">â€‹</a></h2><p>ìµœê·¼ íŠ¸ë Œë“œì¸ ë©€í‹° í´ë¼ìš°ë“œë¥¼ ì§€í–¥í•˜ëŠ” ì˜¤í”ˆì†ŒìŠ¤ í”Œë«í¼ì´ë‹¤.<br>
<!-- -->2014ë…„ Netflixì˜ Asgardë¡œ ì‹œì‘ë˜ì–´ 2015ë…„ì— ì˜¤í”ˆì†ŒìŠ¤í™” ë˜ì—ˆë‹¤.<br>
<!-- -->ë¹ ë¥¸ ì†ë„ì™€ ì‹ ë¢°ë„ìˆëŠ” ì†Œí”„íŠ¸ì›¨ì–´ ë¦´ë¦¬ì¦ˆë¥¼ ìœ„í•´ ë§Œë“¤ì–´ì¡Œìœ¼ë©° ëŒ€ë¶€ë¶„ì˜ ë©”ì´ì € í´ë¼ìš°ë“œ í”„ë¡œë°”ì´ë”ë“¤ì„ ì§€ì›í•œë‹¤.(AWS,GCP,Azure,openstack..)<br>
<!-- -->í˜„ì¬ Netflix, Google, MS, Veritasë“±ì´ Contributionì„ í•˜ê³  ìˆë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì™œ-spinnakerë¥¼-ì¨ì•¼í•˜ì§€">ì™œ Spinnakerë¥¼ ì¨ì•¼í•˜ì§€?<a class="hash-link" href="#ì™œ-spinnakerë¥¼-ì¨ì•¼í•˜ì§€" title="Direct link to heading">â€‹</a></h2><p>ì—¬ëŸ¬ê°€ì§€ ì´ìœ ê°€ ìˆê² ì§€ë§Œ</p><ul><li>Multi-Cloudìš© Continuous Delivery/Deployment Platform ìœ¼ë¡œ ëŒ€ì²´ê°€ ê°€ëŠ¥</li><li>ë‹¤ì–‘í•œ pipeline í˜•íƒœë¡œ ë°°í¬ê°€ ê°€ëŠ¥í•˜ê³  Rollbackì´ ì‰¬ì›€</li><li>ë¹ ë¥¸ ë°°í¬ê°€ ê°€ëŠ¥í•˜ê³  ì—¬ëŸ¬ë²ˆ ë°°í¬ê°€ ìš©ì´í•¨</li><li>ìœ ì—°í•œ pipeline management systemì„ ê°€ì§€ê³  ìˆìŒ</li><li>ë‹¤ì–‘í•œ ë°°í¬ì „ëµì„ ê°€ì§„ë‹¤(Blue-Green, Rolling Red/Black, Canary)</li><li>community í™œë™ í™œë°œ (github, slack) - ë‹µì€ ì˜ ì•ˆí•´ì¤Œ ã… ã… </li><li>VMê³¼ Container ë™ì‹œì— í†µí•©ê´€ë¦¬ ê°€ëŠ¥</li><li>CIí†µí•© ìš©ì´(Jenkins)</li><li>CLIë¥¼ í†µí•œ ì„¤ì¹˜ ë° ê´€ë¦¬(halyard)</li><li>VM, Helm Packaging ê°€ëŠ¥</li><li>RBAC ì§€ì›</li><li>Notification - Email, Slack, Hipchatë“±</li><li>Safe Deployment - Judgement (ìŠ¹ì¸ê¸°ëŠ¥)</li><li>Chaos Monkey Built-in</li></ul><p>ì´ì •ë„ë©´ ë¬´ì¡°ê±´ ì¨ì•¼í•˜ì§€ ì•Šì„ê¹Œ?</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="jenkins-vs-spinnaker">Jenkins vs Spinnaker<a class="hash-link" href="#jenkins-vs-spinnaker" title="Direct link to heading">â€‹</a></h2><table><thead><tr><th align="center">Jenkins</th><th align="center">Spinnaker</th></tr></thead><tbody><tr><td align="center">ê°•ë ¥í•œ ë¹Œë“œì„œë²„</td><td align="center">í´ë¼ìš°ë“œ ìì›ì˜ 1ì°¨ ì—°ë™</td></tr><tr><td align="center">ì™„ì „í•œ deployment toolì´ ì•„ë‹˜</td><td align="center">vm &amp; deployments ì•ˆì— ë¹Œë“œë˜ì–´ ìˆìŒ</td></tr><tr><td align="center">ìŠ¤í¬ë¦½íŒ…ì´ ë§ì´ í•„ìš”í•¨</td><td align="center">ë³„ë„ì˜ ìŠ¤í¬ë¦½íŒ…ì´ ë§ì´ í•„ìš”ì—†ìŒ</td></tr><tr><td align="center">ê¸°ëŠ¥ë“¤ì´ ëª¨ë‘ í”ŒëŸ¬ê·¸ì¸ í˜•íƒœ</td><td align="center">CI toolì´ ì•„ë‹˜(CI toolsì´ ë°±ì—”ë“œë¡œ)</td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kubernetes-vs-spinnaker">Kubernetes vs Spinnaker<a class="hash-link" href="#kubernetes-vs-spinnaker" title="Direct link to heading">â€‹</a></h2><table><thead><tr><th align="center">Kubernetes</th><th align="center">Spinnaker</th></tr></thead><tbody><tr><td align="center">ë¦¬ì†ŒìŠ¤ ì‚¬ìš© ì œí•œ</td><td align="center">ì •ì˜í•œ í¼ì„¼íŠ¸ë¡œ rollout</td></tr><tr><td align="center">slow rollout</td><td align="center">ê° ë‹¨ê³„ë³„ ê²€ì¦ ê°€ëŠ¥</td></tr><tr><td align="center">High rollback cost</td><td align="center">Fast rollbacks</td></tr><tr><td align="center">Linear rollouts</td><td align="center">resource ì‚¬ìš©ëŸ‰ì´ í¼</td></tr><tr><td align="center">ê²€ì¦ë‹¨ê³„ê°€ ì—†ìŒ</td><td align="center"></td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="deploy-pipeline">Deploy Pipeline<a class="hash-link" href="#deploy-pipeline" title="Direct link to heading">â€‹</a></h2><p>Spinnakerë¥¼ ì‚¬ìš©í• ë•Œ ê¸°ë³¸ì ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì€ íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ êµ¬ì„±í•œë‹¤.<br>
<!-- -->ìˆ˜ë™ìœ¼ë¡œ UIë‚˜ APIë¡œ íŠ¸ë¦¬ê±°ë§í• ìˆ˜ ìˆê³ , ìë™ìœ¼ë¡œ Jenkins ë“±ê³¼ íŠ¸ë¦¬ê±° ì—°ë™í•˜ì—¬ ë¹Œë“œì™„ë£Œì‹œ ë°°í¬ë˜ë„ë¡ í• ìˆ˜ ìˆë‹¤.</p><p><img loading="lazy" alt="spinnaker-pipeline" src="/assets/images/spinnaker-pipeline-7b27fbf5bddf6d0c506c5f20a8a9f36a.png" width="942" height="399" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="deployment-strategies">Deployment Strategies<a class="hash-link" href="#deployment-strategies" title="Direct link to heading">â€‹</a></h2><p>Spinnakerì—ì„œì˜ ë°°í¬ì „ëµì€ ë‹¤ìŒê³¼ ê°™ì´ ì œê³µëœë‹¤.</p><p><img loading="lazy" src="https://www.spinnaker.io/concepts/deployment-strategies.png" alt="deployment-strategies" class="img_E7b_"></p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="red--black-same-as-blue--green">Red / Black (same as Blue / Green)<a class="hash-link" href="#red--black-same-as-blue--green" title="Direct link to heading">â€‹</a></h3><ul><li>ë™ì¼í•œ ì–‘ì˜ instanceë¡œ ì´ë£¨ì–´ì§„ ìƒˆë¡œìš´ Server Groupì„ ìƒì„±í•œë‹¤</li><li>ì‹ ê·œ Server Groupì´ ì •ìƒìƒíƒœê°€ ë˜ë©´ LBëŠ” ì‹ ê·œ Server Groupì— íŠ¸ë˜í”½ì„ ë¶„ì‚°í•œë‹¤. </li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="rolling-redblack">Rolling red/black<a class="hash-link" href="#rolling-redblack" title="Direct link to heading">â€‹</a></h3><ul><li>ì´ì „ê³¼ ë™ì¼í•˜ì§€ë§Œ ì¸ìŠ¤í„´ìŠ¤ë³„ ë˜ëŠ” ê·¸ë£¹ë³„ë¡œ rolling</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="canary">Canary<a class="hash-link" href="#canary" title="Direct link to heading">â€‹</a></h3><ul><li>ê°€ì¥ ì‘ì€ ê°œìˆ˜ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ êµì²´ì‹œí‚¤ê³ </li><li>ìƒˆë¡œìš´ ë²„ì „ìœ¼ë¡œ íŠ¸ë˜í”½ì„ ë¶„ì‚°ì‹œí‚¨ë‹¤ (1~5í”„ë¡œ)</li><li>ìƒˆë¡œìš´ ë²„ì „ì— ì´ìŠˆê°€ ì—†ì„ë•Œê¹Œì§€ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ê³ </li><li>íŠ¹ì •ì‹œê°„ê¹Œì§€ ì´ìŠˆê°€ ì—†ìœ¼ë©´ ë°°í¬ë¥¼ ëŠ˜ë ¤ê°„ë‹¤. </li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ìš©ì–´ì •ë¦¬-2íƒ„">ìš©ì–´ì •ë¦¬ 2íƒ„<a class="hash-link" href="#ìš©ì–´ì •ë¦¬-2íƒ„" title="Direct link to heading">â€‹</a></h2><p>ì´ì „ <a href="https://ddiiwoong.github.io/2018/spinnaker-advanced-1/" target="_blank" rel="noopener noreferrer">post</a>ì—ì„œ ì •ë¦¬í•œê±¸ ë‹¤ì‹œ ë³µê¸°í•˜ê³  ì¶”ê°€ì ì¸ ë‚´ìš©ì„ë“¤ ì ì–´ë´¤ë‹¤.</p><p>ì‚¬ìš©í•˜ë©´ì„œ í˜¼ëˆì´ ë§ì´ ìƒê¸°ëŠ” ë¶€ë¶„ì´ë‹¤ ì´ê²Œ GCEë‚˜ EC2ë¥¼ ì“°ë©´ ìš©ì–´ ë§¤ì¹­ì´ ì‰¬ìš´ë° k8së¥¼ ìœ„í•œ ë³„ë„ì˜ ë©”ë‰´ê°€ ì•„ë‹Œ ê¸°ëŠ¥ì„ í†µí•©í•˜ë‹¤ë³´ë‹ˆ ìš©ì–´ê°€ ì¡°ê¸ˆ í˜¼ë™ìŠ¤ëŸ½ê²Œ êµ¬ì„±ì´ ë˜ì—ˆë‹¤.<br>
<!-- -->íŠ¹íˆ Load Balancer ë¶€ë¶„ì€ Serviceë¡œ ë§¤í•‘ë˜ê³  í¼ë¸”ë¦­ k8sì—ì„œ ì œê³µí•˜ëŠ” Type LoadBalancerëŠ” ë¯¸ì§€ì›í•œë‹¤.<br>
<!-- -->ê·¸ë¦¬ê³  ëª¨ë“  Resourceë“¤ì€ Deploy, Delete, Scale, Rollout(Undo, Pause, Resume)ì„ ì§€ì›í•˜ë©° Versioningì´ ì§€ì›ëœë‹¤.  Versioningì€ <a href="https://www.spinnaker.io/reference/providers/kubernetes-v2/#strategy" target="_blank" rel="noopener noreferrer">ì—¬ê¸°</a>ì— ì„¤ëª…ëœ ëŒ€ë¡œ <code>strategy.spinnaker.io/versioned</code> annotationì„ í†µí•´ manifestë³„ë¡œ ì¬ì •ì˜ê°€ ê°€ëŠ¥í•˜ë‹¤.</p><table><thead><tr><th align="center">Spinnaker</th><th align="center">Kubernetes</th><th align="center">ë¹„ê³ </th></tr></thead><tbody><tr><td align="center">Server Group</td><td align="center"><a href="https://www.spinnaker.io/reference/providers/kubernetes-v2/#workloads" target="_blank" rel="noopener noreferrer">Workloads</a></td><td align="center"><a href="https://www.spinnaker.io/guides/developer/crd-extensions/" target="_blank" rel="noopener noreferrer">CRDì˜ ê²½ìš° ë³„ë„ Build</a></td></tr><tr><td align="center">Clusters</td><td align="center">Logical Server Group</td><td align="center"></td></tr><tr><td align="center">Load Balancer</td><td align="center">Services</td><td align="center">LoadBalancer(k8s) ë¯¸ì§€ì›</td></tr><tr><td align="center">Firewall</td><td align="center">NetworkPolicies</td><td align="center"></td></tr></tbody></table><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="application-management">Application Management<a class="hash-link" href="#application-management" title="Direct link to heading">â€‹</a></h3><p>Spinnakerì—ì„œ Application ì´ë€ ë°°í¬í•˜ë ¤ëŠ” ì„œë¹„ìŠ¤ë¥¼ ë‚˜íƒ€ë‚´ëŠ” êµ¬ì¡°ë¼ ìƒê°í•˜ë©´ ëœë‹¤.  </p><ul><li>pipeline</li><li>Clusters, Server Groupì˜ ì§‘í•©ì´ë©°, firewallê³¼ loadbalancerë¥¼ í¬í•¨í•œë‹¤.</li><li>Canary Config</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="cluster">Cluster<a class="hash-link" href="#cluster" title="Direct link to heading">â€‹</a></h3><p>Kubernetesì˜ Clusterê°€ ì•„ë‹ˆë¼ Spinnakerì—ì„œ Server Groupì˜ ë…¼ë¦¬ì ì¸ ê·¸ë£¹</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="server-group">Server Group<a class="hash-link" href="#server-group" title="Direct link to heading">â€‹</a></h3><p>ê¸°ë³¸ìì›ì¸ ì„œë²„ê·¸ë£¹ì€ ë°°í¬í• ìˆ˜ ìˆëŠ” artifacts(vm image, docker image, source)ì™€ ì¸ìŠ¤í„´ìŠ¤(pod) ìˆ˜, Auto-Scaling, metadata ë“± ê¸°ë³¸ êµ¬ì„±ë“±ì„ ê°€ì§€ê³  ìˆë‹¤.<br>
<!-- -->ì„œë²„ê·¸ë£¹ì€ LoadBalacerë‚˜ Firewall ë„ ì„ íƒì ìœ¼ë¡œ ì—°ê²°ë˜ê³ , vmì´ë‚˜ pod í˜•íƒœë¡œ ë°°í¬ëœ applicationì˜ ì§‘í•©ì²´ë¼ ë³¼ìˆ˜ ìˆë‹¤.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="cloud-provider">Cloud Provider<a class="hash-link" href="#cloud-provider" title="Direct link to heading">â€‹</a></h3><ul><li>IaaS - AWS, GCP, Azure, Oracle, Openstack</li><li>PaaS -  Google App Engine</li><li>Orchestrator - K8s, DC/OS</li><li>Docker v2 Registry</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="account">Account<a class="hash-link" href="#account" title="Direct link to heading">â€‹</a></h3><p>Cloud Providerì— ì¸ì¦í•˜ê¸° ìœ„í•œ Spinnakerì—ì„œë§Œ ì‚¬ìš©í•˜ëŠ” Account Name</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="pipeline">Pipeline<a class="hash-link" href="#pipeline" title="Direct link to heading">â€‹</a></h3><p>Pipelineì€ ì£¼ìš” ë°°í¬ ê´€ë¦¬ë„êµ¬ë¡œ ì‚¬ìš©ëœë‹¤.
Stageë¼ê³ í•˜ëŠ” ì¼ë ¨ì˜ Actionìœ¼ë¡œ êµ¬ì„±ë˜ë©° íŒŒì´í”„ë¼ì¸ì„ ë”°ë¼ Stageê°„ ë§¤ê°œë³€ìˆ˜ ì „ë‹¬ì´ ê°€ëŠ¥í•˜ë‹¤.<br>
<!-- -->ìˆ˜ë™ìœ¼ë¡œ ì‹œì‘í•˜ê±°ë‚˜, Jenkins ì‘ì—…ì™„ë£Œ, Docker Registry ì‹ ê·œ Docker ì´ë¯¸ì§€, Cronì¼ì • ë˜ëŠ” ë‹¤ë¥¸ Stageì™€ ê°™ì€ ì´ë²¤íŠ¸ì— ì˜í•´ ìë™ìœ¼ë¡œ íŠ¸ë¦¬ê±°ë§ë˜ë„ë¡ êµ¬ì„±í• ìˆ˜ ìˆë‹¤.<br>
<!-- -->Pipeline ì‹¤í–‰ì¤‘ì—(ì‹œì‘/ì™„ë£Œ/ì‹¤íŒ¨) mail, slack, hipchat(ì‚¬ë¼ì§)ì„ í†µí•´ Alertê°€ ê°€ëŠ¥í•˜ë‹¤.</p><p><img loading="lazy" src="https://www.spinnaker.io/concepts/pipelines.png" alt="pipeline" class="img_E7b_"></p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="stage-atomic-building-block">Stage (atomic building block)<a class="hash-link" href="#stage-atomic-building-block" title="Direct link to heading">â€‹</a></h3><p>Pipelineì´ ìˆ˜í–‰í•  ë™ì‘ì„ ë§í•œë‹¤.<br>
<!-- -->Deploy, Resize, Disable, Manual Judgement ë“±ì„ ìˆ˜í–‰í• ìˆ˜ ìˆë‹¤.</p><p><img loading="lazy" src="https://www.spinnaker.io/concepts/pipelines/pipeline-tasks.png" alt="stage" class="img_E7b_"></p><ul><li>Stage - Multiple steps</li><li>Step - ì§„í–‰ë˜ê¸°ì „ì— êµì •/í´ë§ì´ í•„ìš”í•œ tasks</li><li>Task - íŠ¹ì • Cloud Platformìœ¼ë¡œ ë™ì‹œì— ì—¬ëŸ¬ APIí˜¸ì¶œ</li><li>Operation - ë‹¨ìœ„ API</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ìš©ì–´ë‚˜ ê°œë…ì€ ì–´ëŠì •ë„ ì •ë¦¬ëœë“¯ í•˜ê³  ë‹¤ìŒ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì‹¤ì œ multi cluster í™˜ê²½ì—ì„œ deployí•˜ê³  pipelineì„ ì‚¬ìš©í•˜ëŠ” ë‚´ìš©ì„ ì ì–´ë³¼ ì˜ˆì •ì´ë‹¤.</p>]]></content>
        <category label="CI/CD" term="CI/CD"/>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="Spinnaker" term="Spinnaker"/>
        <category label="Continuous Delivery" term="Continuous Delivery"/>
        <category label="Continuous Deployment" term="Continuous Deployment"/>
        <category label="Pipeline" term="Pipeline"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[knative]]></title>
        <id>kubernetes/knative/</id>
        <link href="https://ddii.dev/kubernetes/knative/"/>
        <updated>2018-08-01T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[knative ëŒ€í•´ ì•Œì•„ë´…ë‹ˆë‹¤]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="knative">Knative<a class="hash-link" href="#knative" title="Direct link to heading">â€‹</a></h2><p>ë¯¸ì¹œë†ˆë“¤ ëª¨ì—¬ì„œ ë¯¸ì¹œê²ƒì„ ë§Œë“¤ì—ˆêµ°.. ã…ã…
ì˜ˆìƒí–ˆë˜ ë‚´ìš©ë“¤ì„ í˜„ì‹¤ë¡œ ë§Œë“œëŠ” í´ë¼ìŠ¤</p><p>Kubernetes ê´€ë ¨ ë¹„ì§€ë‹ˆìŠ¤ë¥¼ í•˜ê³  ìˆëŠ” ì…ì¥ì—ì„œ ë´ë„ ë†€ë„ì¼ì´ì§€ë§Œ
ì¸í”„ë¼ ì˜ì—­ë¶€í„° ê°œë°œì ì˜ì—­ê¹Œì§€ ëª¨ë‘ë¥¼ ì¶”ìƒí™”ì‹œí‚¤ëŠ” í´ë¼ìš°ë“œ ë„¤ì´í‹°ë¸Œì˜ í˜ì´ë€ ì°¸ ëŒ€ë‹¨í•˜ë‹¤.</p><p>ì˜¤ëŠ˜ì€ knativeì—ì„œ ì£¼ìš”ê¸°ëŠ¥ë“¤ì„ ë‘˜ëŸ¬ë³´ê³ ì í•œë‹¤.</p><p>ê°œì¸ì ì¸ ìƒê°ì€ Kubernetes ì§„ì˜ì´ë¼ê³  í•´ì•¼í•˜ë‚˜ CNCF ì§„ì˜ì´ë¼ê³  í•´ì•¼í•˜ë‚˜..
ê·¸ë™ì•ˆ ë…¸ë˜ë¥¼ ë¶€ë¥´ê³  ì£¼ëª©í–ˆë˜ CRDs, Operators, Serverless Workload, CloudEvents, Mesh Layer ê°œë…ê³¼ ì˜ì—­ì„ í¡ìˆ˜í•´ì„œ ê·¸ ê¸°ë°˜ìœ¼ë¡œ í™•ì¥ì‹œí‚¤ê³  ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f https://storage.googleapis.com/knative-releases/serving/latest/release.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ ì½”ë“œ ë‚´ìš©ì„ ìƒì„¸í•˜ê²Œ ë³´ê³ ìˆì§€ë§Œ ë‹´ì€ê²ƒë“¤ì´ ì •ë§ ë§ë‹¤. ê·¸ë˜ë„ ë‹¤ ì´í•´í•˜ë ¤ë©´ í•˜ë‚˜í•˜ë‚˜ ì±™ê²¨ë´ì•¼ í•œë‹¤.</p><p>ì˜¤ëŠ˜ì€ ì¼ë‹¨ ì½”ì–´ ê¸°ëŠ¥ë§Œ ì‚´í´ë³¸ë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="build">Build<a class="hash-link" href="#build" title="Direct link to heading">â€‹</a></h2><p><code>build</code>ëŠ” Knativeì˜ ì£¼ìš” <code>custom resource</code>ì´ê³  ì´ë¥¼ ì´ìš©í•˜ì—¬ fetch, build, packageë¥¼ ìˆ˜í–‰í•œë‹¤. repoì˜ ì†ŒìŠ¤ë¥¼ ë¹Œë“œí•˜ê³  ì»¨í…Œì´ë„ˆë¡œ ì´ë¯¸ì§€ë¡œ ë§Œë“¤ê³  ê·¸ë‹¤ìŒì— Knative <code>Serving</code>ìœ¼ë¡œ ë³´ë‚¸ë‹¤ê³  í•œë‹¤. </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="build-ìš©ì–´">Build ìš©ì–´<a class="hash-link" href="#build-ìš©ì–´" title="Direct link to heading">â€‹</a></h3><ul><li><code>Build</code>ëŠ” ì—¬ëŸ¬ <code>steps</code>ì„ í¬í•¨í•˜ê³  <code>Builder</code>ë¡œ êµ¬ì²´í™”ëœë‹¤</li><li><code>Builder</code>ëŠ” ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ìœ í˜•</li><li><code>Build</code>ë‚´ <code>steps</code>ì€ repositoryì— pushë¥¼ í•  ìˆ˜ ìˆìŒ</li><li><code>BuildTemplate</code> ëŠ” ì¬í™œìš©ê°€ëŠ¥í•œ í…œí”Œë¦¿</li><li><code>Build</code>ë‚´ <code>source</code>ëŠ” kubernetes Volumeìœ¼ë¡œ mountë˜ëŠ” ë°ì´í„°ë¥¼ ì •ì˜í• ìˆ˜ ìˆê³  git, Google Cloud Storage, ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ ì§€ì›í•¨.</li><li>kubernetes Secretì„ ì‚¬ìš©í•˜ì—¬ <code>ServiceAccount</code>ë¡œ ì¸ì¦í•¨</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="serving">Serving<a class="hash-link" href="#serving" title="Direct link to heading">â€‹</a></h2><p>Knative <code>Serving</code>ì€ Kubernetesì™€ Istioë¥¼ ê¸°ë°˜ìœ¼ë¡œ Serverless Workloadê°€ í´ëŸ¬ìŠ¤í„°ì—ì„œ ì‘ë™í•˜ëŠ” ë°©ì‹ì„ ì •ì˜í•˜ê³  ì œì–´í•˜ëŠ”ë° ì‚¬ìš©ëœë‹¤ê³  í•˜ì§€ë§Œ ì—„ì—°íˆ Public FaaS(AWS Lambdaë“±)ì™€ëŠ” êµ¬ë³„ë˜ì–´ì•¼ í•œë‹¤ê³  ìƒê°í•œë‹¤.</p><p>Serverless ë¼ê³  í•˜ëŠ” ìš©ì–´ë¥¼ ì‰½ê²Œ ìƒê°í•˜ëŠ” ì‚¬ëŒë“¤ì´ ë§ì€ë° ê²°êµ­ ë‚˜ì¤‘ì—ëŠ” ê°„ë‹¨í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ë“¤ì€ ë‹¤ Serverless ìŠ¤íƒ€ì¼ë¡œ ì „í™˜ë ê²ƒì´ë¼ëŠ” ì‚¬ìƒì„ ì„œë¹„ìŠ¤ë‚˜ í”Œë«í¼ì— ë„£ê³  ìˆëŠ” ì¶”ì„¸ë‹¤. </p><p>CNCF ì§„í˜•ì˜ Cloud Eventë¼ê³  í•˜ëŠ” ì´ë²¤íŠ¸ ê·¸ë¦¬ë“œë°©ì‹ì˜ í‘œì¤€í™”ë¥¼ ë”°ë¼ ê°€ëŠ”ê²ƒì¸ì§€ ì•„ë‹ˆë©´ ìƒˆë¡œìš´ ìŠ¤íƒ€ì¼ì„ ì •ì˜í•˜ë ¤ê³  í•˜ëŠ”ê²ƒì¸ì§€ëŠ” ê·¸ë“¤ì˜ í–¥í›„ Cloud Native ë¡œë“œë§µì— ë‹¬ë ¤ìˆë‹¤ í•´ë„ ë¬´ë°©í• ê²ƒ ê°™ë‹¤. </p><ul><li>Serverless Containerì˜ ì‹ ì†í•œ ë°°ì¹˜ê°€ ê°€ëŠ¥</li><li>Automatic scaling up and down to zero</li><li>Istio Component</li><li>ë°°í¬ ëœ ì½”ë“œ ë° configì˜ íŠ¹ì • ì‹œì  ìŠ¤ëƒ… ìƒ·</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="serving-resources"><code>Serving</code> Resources<a class="hash-link" href="#serving-resources" title="Direct link to heading">â€‹</a></h3><p>CRDsë¡œ ì •ì˜í•œ Objects ì§‘í•©ì²´, ì´ëŸ¬í•œ Objectë“¤ì€ Serverless ì›Œí¬ë¡œë“œ í˜•íƒœë¡œ ì •ì˜ë˜ê³  ì‚¬ìš©ëœë‹¤.
ê°€ì¥ ì¸ìƒê¹Šê³  ì¤‘ìš”í•œ ë¬¸êµ¬ëŠ” <code>Request-driven compute that can scale to zero</code> ì¸ ê²ƒ ê°™ë‹¤.</p><p>í•œë™ì•ˆ ìœ í–‰í–ˆë˜ OpenPaaS, CFê¸°ë°˜ì˜ PaaS í”Œë«í¼ì„ ë›°ì–´ë„˜ëŠ” êµ¬ì¶•í˜• ê·¸ê²ƒë„ ìŠ¤í”„ë§ë¶€íŠ¸ ì˜ì—­ê¹Œì§€ë„ kubernetes ê¸°ë°˜ ì´ë²¤íŠ¸ ë“œë¦¬ë¸ ì„œë²„ë¦¬ìŠ¤ë¡œ ê°„ë‹¤ëŠ” ì´ì•¼ê¸°...</p><p>ì´ë¯¸ í¼ë¸”ë¦­ìœ¼ë¡œëŠ” <a href="https://cloud.spring.io/spring-cloud-function/" target="_blank" rel="noopener noreferrer">GA</a>ë„ ë˜ì—ˆë‹¤.</p><p>ìš°ë¦¬ íŒ€ì›ë“¤ê³¼ í•¨ê»˜ ì—´ì‹¬íˆ vmware dispatch frameworkìœ¼ë¡œ ê°œë°œí•˜ê³  ìˆì§€ë§Œ ê²°êµ­ pivotalê³¼ vmwareëŠ” ê±°ì˜ í•œëª¸ì´ê¸°ì— ë”ìš± ë” ë³€í™”ê°€ í•„ìš”í•œ ìˆœê°„ì´ë‹¤.</p><p><img loading="lazy" src="https://github.com/knative/serving/raw/master/docs/spec/img/object_model.png" alt="serving" class="img_E7b_"></p><ul><li><code>Route</code>ëŠ” ì‚¬ìš©ì ì„œë¹„ìŠ¤ì— ëŒ€í•œ HTTP endpointë¥¼ ì œê³µ.</li><li><code>Revisions</code>ì€ code(function)ì™€ configë¡œ êµ¬ì„±ëœ ë¶ˆë³€ì˜ ìŠ¤ëƒ…ìƒ·. Routeë¥¼ í†µí•´ endpointë¥¼ í• ë‹¹ë°›ì§€ ëª»í•œ Revisionì€ ìë™ìœ¼ë¡œ kubernetes resourceì—ì„œ ì‚­ì œë¨</li><li><code>Configuration</code>ì€ ìš”êµ¬ë˜ëŠ” Revision ìµœì‹  ìƒíƒœë¥¼ ê¸°ë¡í•˜ê³  ìƒì„±í•˜ê³  ì¶”ì í• ìˆ˜ ìˆìŒ. ì†ŒìŠ¤ íŒ¨í‚¤ì§€(git repoë‚˜ archive)ë¥¼ ì»¨í…Œì´ë„ˆë¡œ ë³€í™˜í•˜ê¸° ìœ„í•œ ë‚´ìš©ì´ë‚˜ ë©”íƒ€ë°ì´í„°ë“±ì„ í¬í•¨ì‹œí‚¬ìˆ˜ ìˆìŒ. </li><li><code>Service</code>ëŠ” <code>Routes</code>ì™€ <code>Configurations</code> ë¦¬ì†ŒìŠ¤ì˜ ì¶”ìƒí™”ëœ ì§‘í•©ì²´. ëª¨ë“  ì›Œí¬ë¡œë“œì˜ lifecycleì„ ê´€ë¦¬í•¨. íŠ¸ë˜í”½ì„ í•­ìƒ ìµœì‹ ì˜ revisionìœ¼ë¡œ routeë˜ë„ë¡ ì •ì˜í• ìˆ˜ ìˆìŒ</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="events">Events<a class="hash-link" href="#events" title="Direct link to heading">â€‹</a></h2><p>CNCFì˜ <a href="https://www.cncf.io/events/" target="_blank" rel="noopener noreferrer">CloudEvent Spec.</a> ê¸°ë°˜ìœ¼ë¡œ í•˜ëŠ” ì´ë²¤íŠ¸ë¥¼ produce/comsume í•˜ëŠ” ë°©ë²•ì„ ì œê³µí•œë‹¤. í”ŒëŸ¬ê·¸ì¸ í˜•íƒœë¡œ ì´ë²¤íŠ¸ë¥¼ ìˆ˜ì‹ í• ìˆ˜ ìˆê³  ë‹¤ì–‘í•œ pub/sub ìŠ¤íƒ€ì¼ì˜ broker serviceë¥¼ í†µí•´ ì œê³µë ìˆ˜ ìˆë‹¤. </p><p>AzureëŠ” ì´ë¯¸ <a href="https://azure.microsoft.com/ko-kr/services/event-grid/" target="_blank" rel="noopener noreferrer">EventGridì„œë¹„ìŠ¤</a>ë¥¼ GAë¥¼ í•œ ìƒí™©ì´ê³  <a href="https://pivotal.io/kr/knative" target="_blank" rel="noopener noreferrer">Pivotal</a> ì§„ì˜ë„ Serverless WorkloadëŠ” <code>Knative</code>ê¸°ë°˜ìœ¼ë¡œ ë„˜ì–´ê°„ë‹¤ê³  í–ˆìœ¼ë‹ˆ <a href="https://github.com/vmware/dispatch" target="_blank" rel="noopener noreferrer">Dispatch</a> ë„ ê²°êµ­ ë”°ë¼ê°€ì§€ ì•Šì„ê¹Œ ìƒê°í•´ë³¸ë‹¤. </p><p><img loading="lazy" src="https://github.com/knative/docs/raw/master/eventing/concepts.png" alt="eventing_concept" class="img_E7b_"></p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="bus">Bus<a class="hash-link" href="#bus" title="Direct link to heading">â€‹</a></h3><p>Kafkaë‚˜ Natsì™€ ê°™ì€ ë©”ì‹œì§€ Busë¥¼ í†µí•´ K8sê¸°ë°˜ì˜ pub/subì„ ì œê³µí•˜ëŠ” ê°œë…. ì´ë²¤íŠ¸ëŠ” Channelì— ì˜í•´ ê²Œì‹œë˜ê³  ê´€ì‹¬ìˆëŠ” ì‚¬ëŒì—ê²Œ ë¼ìš°íŒ…ë¨.</p><ul><li>Channel : ì—¬ê¸°ì„œ ì´ì•¼ê¸° í•˜ëŠ” ì±„ë„ì€ íŠ¹ì • busì— ì‚¬ìš©ë˜ëŠ” ì´ë²¤íŠ¸ë¥¼ ë°›ê¸° ìœ„í•œ ë„¤íŠ¸ì›Œí¬ ê¸°ë°˜ ì—”ë“œí¬ì¸íŠ¸</li><li>Subscription : Channelì—ì„œ ìˆ˜ì‹ í•œ ì´ë²¤íŠ¸ë¥¼ ê´€ì‹¬ìˆëŠ” target, DNSì´ë¦„ìœ¼ë¡œ í‘œí˜„ë˜ëŠ” ì´ë²¤íŠ¸ì— ì—°ê²°í•¨</li><li>Bus : (kafka topicì— ì´ë²¤íŠ¸ê°€ ì „ë‹¬ë˜ëŠ”ê²ƒ ì²˜ëŸ¼) íŠ¹ì • ì§€ì†ì„± ì „ëµì„ ì‚¬ìš©í•˜ì—¬ Channelê³¼ Subscriptionì„ êµ¬í˜„í•˜ëŠ”ë° í•„ìš”í•œ ì ìš© ê³„ì¸µì„ ì •ì˜í•¨</li></ul><p>í˜„ì¬ 3ê°€ì§€ì˜ Busê°€ ì œê³µë¨ (<a href="https://github.com/knative/eventing/tree/master/pkg/buses/kafka" target="_blank" rel="noopener noreferrer">Kafka</a>, <a href="https://github.com/knative/eventing/tree/master/pkg/buses/stub" target="_blank" rel="noopener noreferrer">Stub</a>, <a href="https://github.com/knative/eventing/tree/master/pkg/buses/gcppubsub" target="_blank" rel="noopener noreferrer">GCP PubSub</a>)</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="sources">Sources<a class="hash-link" href="#sources" title="Direct link to heading">â€‹</a></h3><p>SourceëŠ” K8s ì™¸ë¶€ì˜ ë°ì´í„° ì†ŒìŠ¤ë¥¼ í”„ë¡œë¹„ì €ë‹í•˜ê³  ì´ë¥¼ í´ëŸ¬ìŠ¤í„°ë¡œ ë¼ìš°íŒ…í•˜ê¸° ìœ„í•œ ì¶”ìƒí™” ë ˆì´ì–´ë¥¼ ì œê³µí•¨. ì•„ë˜ì™€ ê°™ì€ ì†ŒìŠ¤ë“¤ì„ ì œê³µí•˜ê³  ìˆìŒ</p><ul><li>Feed : EventTypeê³¼ Action (CloudEvents í˜¸í™˜ HTTP endpoint)ê°„ì˜ ì—°ê²°ì„ ì •ì˜í•˜ëŠ” ê¸°ë³¸ ê°ì²´</li><li>EventType and ClusterEventType : EventSourceì—ì„œ ë¶„ë¦¬ë˜ëŠ” ê³µí†µìŠ¤í‚¤ë§ˆë¡œ íŠ¹ì • ì´ë²¤íŠ¸ì˜ ì§‘í•©, EventTypeì€ Namespace ë²”ìœ„ë‚´ì—ì„œ ì‚¬ìš©ë˜ê³  ClusterEventTypeì€ ëª¨ë“  Namespaceì—ì„œ ì‚¬ìš©ë ìˆ˜ ìˆë„ë¡ ê´€ë¦¬ìì— ì˜í•´ ì„¤ì¹˜ë¨</li><li>EventSource and ClusterEventSource : í•˜ë‚˜ ì´ìƒì˜ EventTypesë¥¼ ìƒì„± í•  ìˆ˜ìˆëŠ” ì™¸ë¶€ ì‹œìŠ¤í…œì„ ê¸°ìˆ í•¨</li></ul><p>í˜„ì¬ 3ê°€ì§€ Sourcesë¥¼ ì œê³µí•¨</p><ul><li>K8sevents : <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.10/#event-v1-core" target="_blank" rel="noopener noreferrer">Kubernetes Events</a>ë¥¼ ìˆ˜ì§‘í•˜ê³  CloudEvents íƒ€ì…ìœ¼ë¡œ í‘œì‹œí•¨</li><li>Github : PR(pull request) notificationì„ ìˆ˜ì§‘í•˜ê³  CloudEvents íƒ€ì…ìœ¼ë¡œ í‘œì‹œí•¨</li><li>GCP PubSub : GCP PubSub topicìœ¼ë¡œ publishëœ ì´ë²¤íŠ¸ë¥¼ ìˆ˜ì§‘í•˜ê³  CloudEvents íƒ€ì…ìœ¼ë¡œ í‘œì‹œí•¨</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="flows">Flows<a class="hash-link" href="#flows" title="Direct link to heading">â€‹</a></h3><p>ë§ˆì§€ë§‰ìœ¼ë¡œ Sourceì—ì„œ Endpointê¹Œì§€ ë¬¶ì–´ì£¼ëŠ” Flowë¼ê³  ë¶€ë¥´ëŠ” ë†’ì€ ìˆ˜ì¤€ì˜ ì¶”ìƒí™”ê°€ ìˆë‹¤.
Specìœ¼ë¡œ ì´ë²¤íŠ¸ê°€ ë¼ìš°íŒ…ëœ Channelê³¼ Busë¥¼ ê¸°ì¬í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
FlowëŠ” Eventingì—ì„œ ìµœìƒìœ„ ê°œë…ìœ¼ë¡œ ì‚¬ìš©ìê°€ ì„ íƒí• ìˆ˜ ìˆê³ , ì™¸ë¶€ Source ì´ë²¤íŠ¸ì—ì„œ ëª©ì ì§€ê¹Œì§€ ì›í•˜ëŠ” ê²½ë¡œë¥¼ ê¸°ìˆ í• ìˆ˜ ìˆë‹¤.</p><h1>ì •ë¦¬</h1><p>ì›Œë‚™ ë°©ëŒ€í•œ ì–‘ì„ ê°€ì§€ê³  ìˆê³  ì´í•´í•˜ë ¤ê³  ë…¸ë ¥í•˜ë©´ì„œ ì ë‹¤ë³´ë‹ˆ ë²ˆì—­ìœ„ì£¼ë¡œ ë˜ì–´ë²„ë ¸ë‹¤.
ì›ë˜ ë‹¤ìŒë²ˆì— Nats Streamingì„ ë‹¤ë£° ì˜ˆì •ì´ì˜€ìœ¼ë‚˜,
ë‹¹ë¶„ê°„ì€ knative êµ¬ì„±ìš”ì†Œë¥¼ ì´í•´í•˜ê³  ì ìš©í•˜ëŠ” ìœ„ì£¼ë¡œ í¬ìŠ¤íŒ…ì„ í•  ì˜ˆì •ì´ë‹¤. ì•„ë§ˆë„ ëª¨ë“ˆë³„(Serving, Building, Eventing) ì‹œë¦¬ì¦ˆê°€ ë  ë“¯ í•˜ë‹¤.</p>]]></content>
        <category label="Knative" term="Knative"/>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="FaaS" term="FaaS"/>
        <category label="Serverless" term="Serverless"/>
        <category label="CRDs" term="CRDs"/>
        <category label="CloudEvents" term="CloudEvents"/>
        <category label="Mesh" term="Mesh"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Dex]]></title>
        <id>kubernetes/dex/</id>
        <link href="https://ddii.dev/kubernetes/dex/"/>
        <updated>2018-07-26T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Dex ëŒ€í•´ ì•Œì•„ë´…ë‹ˆë‹¤]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="dex---a-federated-openid-connect-provider">Dex - A federated OpenID Connect provider<a class="hash-link" href="#dex---a-federated-openid-connect-provider" title="Direct link to heading">â€‹</a></h2><hr><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="dexëŠ”-ê¸°ë³¸ì ìœ¼ë¡œ-openid-connectë¥¼-ì‚¬ìš©í•˜ì—¬-ë‹¤ë¥¸-ì• í”Œë¦¬ì¼€ì´ì…˜ì˜-ì¸ì¦ì„-í•˜ê²Œ-í•´ì£¼ëŠ”-identity-ì„œë¹„ìŠ¤ë‹¤">dexëŠ” ê¸°ë³¸ì ìœ¼ë¡œ OpenID Connectë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì¸ì¦ì„ í•˜ê²Œ í•´ì£¼ëŠ” identity ì„œë¹„ìŠ¤ë‹¤.<a class="hash-link" href="#dexëŠ”-ê¸°ë³¸ì ìœ¼ë¡œ-openid-connectë¥¼-ì‚¬ìš©í•˜ì—¬-ë‹¤ë¥¸-ì• í”Œë¦¬ì¼€ì´ì…˜ì˜-ì¸ì¦ì„-í•˜ê²Œ-í•´ì£¼ëŠ”-identity-ì„œë¹„ìŠ¤ë‹¤" title="Direct link to heading">â€‹</a></h3><p><a href="https://github.com/coreos/dex" target="_blank" rel="noopener noreferrer">https://github.com/coreos/dex</a></p><p>DexëŠ” "connectors"ë¥¼ í†µí•´ ë‹¤ë¥¸ identity providerì˜ í¬í„¸(ê²Œì´íŠ¸ì›¨ì´, ì¤‘ê³„ì) ì—­í• ì„ í•œë‹¤. ì´ë¥¼ í†µí•´ LDAP, SAMLë˜ëŠ” GitHub, Google, AD(Active Directory)ì™€ ê°™ì€ ê¸°ì¡´ ì¸ì¦ì„ dexì—ê²Œ ìœ„ì„í•  ìˆ˜ ìˆë‹¤. í´ë¼ì´ì–¸íŠ¸ëŠ” ì¼ë‹¨ ì¸ì¦ ë¡œì§ì„ ì‘ì„±í•˜ì—¬ dexì™€ í†µì‹ í•˜ë©´ dexëŠ” ì£¼ì–´ì§„ ë°±ì—”ë“œ(ì—¬ê¸°ì„œëŠ” ì˜ˆì‹œë¡œ kubernetes í´ëŸ¬ìŠ¤í„°)ì— ëŒ€í•œ í”„ë¡œí† ì½œì„ ì²˜ë¦¬í•˜ê²Œ ëœë‹¤. </p><p>í•˜ì§€ë§Œ í–¥í›„ Cloud Native ì¸ì¦ ì¹´íƒˆë¡œê·¸ ì¤‘ í•˜ë‚˜ë¡œì„œ ìƒê°í•˜ê³  ìˆëŠ” ì˜¤í”ˆì†ŒìŠ¤ì´ë‹¤ ë³´ë‹ˆ í…ŒìŠ¤íŠ¸ëŠ” ì§„í–‰í•´ë´ì•¼ í•  ê²ƒ ê°™ë‹¤.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="openid-connect">OpenID Connect<a class="hash-link" href="#openid-connect" title="Direct link to heading">â€‹</a></h3><p>ê¸°ë³¸ì ìœ¼ë¡œ DexëŠ” OIDC(OpenID Connect)ë¥¼ ì‚¬ìš©í•œë‹¤.<br>
<!-- -->ê·¸ëŸ¬ë¯€ë¡œ <a href="https://kubernetes.io/docs/reference/access-authn-authz/authentication/#using-kubectl" target="_blank" rel="noopener noreferrer">kubernetes í´ëŸ¬ìŠ¤í„° ì‚¬ìš©ì ì¸ì¦ìš©ë„</a>ë¡œ Dexë¥¼ ë¶™ì¼ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.<br>
<!-- -->ë˜í•œ ìœ„ì—ì„œ ë§í•œê²ƒê³¼ ê°™ì´ ë‹¤ë¥¸ identity providerë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìë¥¼ ì¸ì¦í•˜ëŠ”ë° ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ <a href="https://github.com/coreos/dex#connectors" target="_blank" rel="noopener noreferrer">connectors</a>ë¥¼ ì‚¬ìš©í•œë‹¤. </p><p><img loading="lazy" alt="dex_image" src="/assets/images/dex-flow-1eef87ca6cace19b3f458729579af0bd.png" width="760" height="460" class="img_E7b_"></p><p>ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ "connectors"ëŠ” ë‹¤ë¥¸ identity providerë¥¼ í†µí•´ ì‚¬ìš©ìë¥¼ ì¸ì¦í•˜ê¸° ìœ„í•´ dexì—ì„œ ì‚¬ìš©í•˜ëŠ” ê¸°ë³¸ ë„êµ¬ë‹¤. ê²°êµ­ DexëŠ” ê¸°ì¡´ì— í™œìš©í•˜ë˜ GitHub, LinkedIn ë° Microsoft ADì™€ ê°™ì€ ë²¤ë” í”Œë«í¼ì´ë‚˜ LDAP ë° SAMLê³¼ ê°™ì€ ê¸°ì¡´ í”„ë¡œí† ì½œ ë°©ì‹ì„ ì‚¬ìš©í•˜ì—¬ kubernetes í´ëŸ¬ìŠ¤í„° ì‚¬ìš©ì ì¸ì¦ì„ ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤. í° íšŒì‚¬??ë“¤ì€ OpenLDAPì´ë‚˜ Microsoft Active Directoryì™€ ê°™ì€ ì‚¬ë‚´ ë””ë ‰í† ë¦¬ ì„œë¹„ìŠ¤ë¥¼ ìš´ìš©í•˜ê±°ë‚˜ ë‚´ê°€ ìˆëŠ” ì‘ì€ ê·œëª¨ì˜ íŒ€ë“¤ì€ ëŒ€ë¶€ë¶„ Githubì´ë‚˜ Google ê³„ì •ì€ ê°€ì§€ê³  ìˆì„ ê²ƒì´ê¸° ë•Œë¬¸ì— Dexì™€ ê°™ì€ ì˜¤í”ˆì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ê¸°ì¡´ identity provider ì™€ kubernetesë¥¼ ì‰½ê²Œ í†µí•©í•  ìˆ˜ ìˆë‹¤ê³  ë³¸ë‹¤.</p><p><img loading="lazy" alt="dex_kube" src="/assets/images/dex_architect-a6de41c76b10157ce30883eb12fec059.png" width="561" height="321" class="img_E7b_"></p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kubernetes-oidc">Kubernetes OIDC<a class="hash-link" href="#kubernetes-oidc" title="Direct link to heading">â€‹</a></h3><p>ì•„ë˜ ê·¸ë¦¼ì²˜ëŸ¼ Identity Provider ìœ„ì¹˜ì— Dexë¥¼ êµ¬ì„±í•˜ë©´ ëœë‹¤.</p><p><img loading="lazy" src="https://d33wubrfki0l68.cloudfront.net/d65bee40cabcf886c89d1015334555540d38f12e/c6a46/img/docs/admin/k8s_oidc_login.svg" alt="kube_openid" class="img_E7b_"></p><p>public managed kubernetes í™˜ê²½ì—ì„œëŠ” í˜„ì‹¤ì ìœ¼ë¡œ kubeapi-serverë¥¼ ì»¨íŠ¸ë¡¤í•˜ê¸° ì–´ë µê¸° ë•Œë¬¸ì— ì¼ë‹¨ Native í´ëŸ¬ìŠ¤í„°ì— êµ¬ì„±ì„ í•˜ë„ë¡ í•œë‹¤.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="github-ì—°ë™í•˜ê¸°">Github ì—°ë™í•˜ê¸°<a class="hash-link" href="#github-ì—°ë™í•˜ê¸°" title="Direct link to heading">â€‹</a></h3><p>í…ŒìŠ¤íŠ¸ë¡œ Githubì„ ì—°ë™í•´ë³´ì. ì¼ë‹¨ ì•„ë˜ì™€ ê°™ì´ ì¸ì¦ì„œë¥¼ ìƒì„±í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ í•˜ë‚˜ë§Œë“ ë‹¤.<br>
<!-- -->ì•„ë˜ì—ì„œ DNS.1 ë¶€ë¶„ì€ /etc/hostsë¡œ í…ŒìŠ¤íŠ¸ë¡œ ë“±ë¡í•  ë„ë©”ì¸ìœ¼ë¡œ ê°€ìƒìœ¼ë¡œ ë§Œë“¤ì—ˆë‹¤. (generator.sh)</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p ssl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &lt;&lt; EOF &gt; ssl/req.cnf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[req]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">req_extensions = v3_req</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">distinguished_name = req_distinguished_name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[req_distinguished_name]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ v3_req ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basicConstraints = CA:FALSE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">keyUsage = nonRepudiation, digitalSignature, keyEncipherment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subjectAltName = @alt_names</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[alt_names]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DNS.1 = dex.newtech.academy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa -out ssl/ca-key.pem 2048</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl req -x509 -new -nodes -key ssl/ca-key.pem -days 10 -out ssl/ca.pem -subj "/CN=kube-ca"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa -out ssl/key.pem 2048</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl req -new -key ssl/key.pem -out ssl/csr.pem -subj "/CN=kube-ca" -config ssl/req.cnf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 -req -in ssl/csr.pem -CA ssl/ca.pem -CAkey ssl/ca-key.pem -CAcreateserial -out ssl/cert.pem -days 10 -extensions v3_req -extfile ssl/req.cnf</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Namespaceë„ í•˜ë‚˜ ë§Œë“¤ì. (dex-ns.yaml)</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: dex</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>kubernetest í´ëŸ¬ìŠ¤í„°ìš© ì¸ì¦ì„œë¥¼ ìƒì„±í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./generator.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create -f dex-ns.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create secret tls dex.newtech.academy.tls -n dex --cert=ssl/cert.pem --key=ssl/key.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ mkdir pki</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ cp ssl/ca.pem pki/openid-ca.pem</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Githubì— ê°€ì„œ ì•„ë˜ì™€ ê°™ì´ Org OAuth App.ì„ ì‹ ê·œë¡œ ìƒì„±í•œë‹¤.  </p><p><img loading="lazy" alt="github" src="/assets/images/dex_github-1ed6b600c442333faa787c6ced1743ff.png" width="556" height="407" class="img_E7b_"></p><p>ë§Œë“  ìœ„ ì•±ì •ë³´ë¡œ Github-Client Secretì„ ë§Œë“ ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ export GITHUB_CLIENT_ID=&lt;Client ID&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ export GITHUB_CLIENT_SECRET=&lt;Client Secret&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create secret \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    generic github-client \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -n dex \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --from-literal=client-id=$GITHUB_CLIENT_ID \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --from-literal=client-secret=$GITHUB_CLIENT_SECRET</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                  TYPE                                  DATA      AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default-token-f29fb   kubernetes.io/service-account-token   3         27m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dex.newtech.academy.tls    kubernetes.io/tls                     2         27m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">github-client         Opaque                                2         6s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get secret github-client -o yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  client-id: xxxxx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  client-secret: xxxxxxx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  creationTimestamp: 2018-07-24T15:14:29Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: github-client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: dex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  resourceVersion: "7044721"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  selfLink: /api/v1/namespaces/dex/secrets/github-client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  uid: 42dfa0e9-8f54-11e8-8d6d-2aaad36eb114</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">type: Opaque</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ì—ì„œ ì´ì•¼ê¸° í–ˆì§€ë§Œ ì—¬ê¸°ê¹Œì§€ ì•„ë¬´ìƒê°ì—†ì´ í¼ë¸”ë¦­ì—ì„œ êµ¬ì„±í•˜ë‹¤ê°€ ìƒê°í•´ë³´ë‹ˆ kube-apiserverë¥¼ ë³€ê²½í•˜ë ¤ë©´ ì§ì ‘ í´ëŸ¬ìŠ¤í„°ë¥¼ ì¨ì•¼í•œë‹¤ëŠ” ì´ëŸ° ë°”ë³´ê°™ì€ ì‹¤ìˆ˜ë¥¼ ë˜ ì €ì§€ë¥´ê³  ë§ì•˜ë‹¤. ê·¸ë˜ì„œ ë‹¤ì‹œ VMì— ì¬êµ¬ì„±ì„ ã…œã…œ</p><p>ê·¸ë¦¬ê³  kube-apiserver manifest íŒŒì¼ì— ì•„ë˜ ë‚´ìš©ì„ ì¶”ê°€í•œë‹¤.<br>
<!-- -->/etc/kubernetes/manifests/kube-apiserver.manifest</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    - --oidc-issuer-url=https://dex.newtech.academy:32000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - --oidc-client-id=example-app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - --oidc-ca-file=/pki/openid-ca.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - --oidc-username-claim=email</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - --oidc-groups-claim=groups</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê·¸ë¦¬ê³  kubelet ì¬ì‹œì‘ì„ í•œë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ systemctl restart kubelet</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ dex sample appì„ ë¹Œë“œí•˜ê³  ë§Œë“  ì¸ì¦ì„œì™€ í•¨ê»˜ ì‹¤í–‰í•˜ê²Œ ë˜ë©´ ì•„ë˜ì™€ ê°™ì´ ìƒ˜í”Œí˜ì´ì§€ë¥¼ ë³¼ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo apt-get install make golang-1.9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git clone https://github.com/coreos/dex.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ cd dex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git checkout v2.10.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ export PATH=$PATH:/usr/lib/go-1.9/bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ go get github.com/coreos/dex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ make bin/example-app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ export MY_IP=$(curl -s ifconfig.co)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./bin/example-app --issuer https://dex.newtech.academy:32000 --issuer-root-ca /pki/openid-ca.pem --listen http://${MY_IP}:5555 --redirect-uri http://${MY_IP}:5555/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2018/07/25 14:37:52 listening on http://169.56.94.55:5555</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><img loading="lazy" alt="dex_sample" src="/assets/images/dex_sample-9a5c8b5247b98ec2212ebe08f1643d4b.png" width="334" height="181" class="img_E7b_"></p><p>ê·¸ë¦¬ê³  ë¡œê·¸ì¸ì„ í•˜ê²Œ ë˜ë©´ ì•„ë˜ì™€ ê°™ì´ Github ì¸ì¦ì„ í†µí•´ kubernetes í´ëŸ¬ìŠ¤í„°ì—ì„œ ì‚¬ìš©í•˜ë ¤ê³  í•˜ëŠ” Tokenì„ íšë“í•  ìˆ˜ ìˆë‹¤.</p><p><img loading="lazy" alt="kube_dex" src="/assets/images/kube_dex-ccd37f6afcbbc44fd31782cf20991954.png" width="538" height="657" class="img_E7b_"></p><p><img loading="lazy" alt="dex_token" src="/assets/images/dex_token-4c8c3ec72343e5a92fc01a139b4e03e2.png" width="686" height="462" class="img_E7b_"></p><p>ë‹¤ìŒìœ¼ë¡œ ìœ„ì—ì„œ ë§Œë“  tokenì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ Role, RoleBindingê³¼ ì‹¤ì œ ë¡œê·¸ì¸í•  github ê³„ì •ì„ Userë¡œ ì‚¬ìš©í•˜ë„ë¡ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: rbac.authorization.k8s.io/v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Role</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: exampleUser</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rules:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- apiGroups: [""] # "" indicates the core API group</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  resources: ["pods"]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  verbs: ["get", "watch", "list"]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: rbac.authorization.k8s.io/v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: RoleBinding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: exampleUser</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">roleRef:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  apiGroup: rbac.authorization.k8s.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  kind: Role</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: exampleUser</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subjects:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- kind: User</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: ddiiwoong@gmail.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: default</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê³„ì •ìƒì„±ì„ í•˜ê³  ìœ„ì—ì„œ ë§Œë“  tokenì„ ê°€ì§€ê³  developer ì‚¬ìš©ìë¥¼ ì„¤ì •í•˜ê³  contextì„¤ì •ë¡œ dev-defaultë¡œ ìƒì„±í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create -f user.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">role.rbac.authorization.k8s.io "exampleUser" created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rolebinding.rbac.authorization.k8s.io "exampleUser" created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ export TOKEN=&lt;dex_sample_app_token&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl config set-credentials developer --auth-provider=oidc --auth-provider-arg=idp-issuer-url=https://dex.newtech.academy:32000 --auth-provider-arg=client-id=example-app --auth-provider-arg=idp-certificate-authority=/pki/openid-ca.pem  --auth-provider-arg=id-token=${TOKEN}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">User "developer" set.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl config set-context dev-default --cluster=kubernetes --namespace=default --user=developer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Context "dev-default" created.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ì²˜ëŸ¼ ë§Œë“¤ê³  ë‚˜ë©´ í˜„ì¬ í´ëŸ¬ìŠ¤í„°ì˜ contextë“¤ì„ í™•ì¸í• ìˆ˜ ìˆë‹¤. í™•ì¸í›„ì— contextë¥¼ dev-defaultë¡œ ë°”ê¿”ë³´ì.<br>
<!-- -->ìƒˆë¡œìš´ contextë¥¼ í™•ì¸í• ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl config get-contexts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CURRENT   NAME                  CLUSTER         AUTHINFO              NAMESPACE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*         admin-cluster.local   cluster.local   admin-cluster.local   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          dev-default           kubernetes      developer             default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl config use-context dev-default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Switched to context "dev-default".</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl config get-contexts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CURRENT   NAME                  CLUSTER         AUTHINFO              NAMESPACE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          admin-cluster.local   cluster.local   admin-cluster.local   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*         dev-default           kubernetes      developer             default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod --all-namespaces</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAMESPACE     NAME                                    READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dex           dex-64c4fb5b44-42d44                    1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dex           dex-64c4fb5b44-r9p9d                    1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dex           dex-64c4fb5b44-w5s2m                    1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   calico-node-2bqll                       1/1       Running   0          13h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   calico-node-cljb2                       1/1       Running   0          13h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   calico-node-svh5n                       1/1       Running   0          13h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-apiserver-node1                    1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-controller-manager-node1           1/1       Running   2          13h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-dns-7bd4d5fbb6-7bb2j               3/3       Running   0          13h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-dns-7bd4d5fbb6-g8lz8               3/3       Running   0          13h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-proxy-node1                        1/1       Running   0          13h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-proxy-node2                        1/1       Running   0          13h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-proxy-node3                        1/1       Running   0          13h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-scheduler-node1                    1/1       Running   2          13h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kubedns-autoscaler-679b8b455-qxlvw      1/1       Running   0          13h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kubernetes-dashboard-55fdfd74b4-mbkm8   1/1       Running   0          13h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   nginx-proxy-node2                       1/1       Running   0          13h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   nginx-proxy-node3                       1/1       Running   0          13h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   tiller-deploy-5c688d5f9b-52tls          1/1       Running   0          13h</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h3><p>ì²˜ìŒì—ë„ ì–¸ê¸‰í–ˆë“¯ì´ kubernetes ì¸ì¦ì„ ìœ„í•´ ë¬´ê±°ìš´ keycloakì„ ì‚¬ìš©ì„ í•˜ëŠ” ê²½ìš°ë“¤ì´ ë§ì€ë° ê°„ë‹¨í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” dexë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ê°€ì§€ identity providerì˜ connector ì—­í• ë¡œ ì‚¬ìš©í•˜ê¸°ì—ëŠ” ë¬´ë‚œí•œê²ƒ ê°™ë‹¤.<br>
<!-- -->ê²°êµ­ Dexë¥¼ ì´ìš©í•˜ë©´ GitHubë¥¼ ë¹„ë¡¯í•´ ë‹¤ì–‘í•œ OpenID, OAuth 2.0 ì¸ì¦ ì„œë¹„ìŠ¤ì™€ Kubernetes í´ëŸ¬ìŠ¤í„°ë¥¼ ì—®ê¸° ì‰¬ìš¸ìˆ˜ ìˆë‹¤.<br>
<!-- -->ë‹¨, ìµœê·¼ commitì´ 3-4ë‹¬ì „ì´ë¼ëŠ”ê²ƒê³¼ ì²˜ìŒ stable helmì— ë“±ë¡ëœ í›„ ì—…ë°ì´íŠ¸ê°€ ì—†ì—ˆë‹¤ëŠ” ì ì´ ê±±ì •ë˜ëŠ” ë¶€ë¶„ì´ê¸´ í•˜ë‹¤. (ë¬˜í•˜ê²Œ Redhatê³¼ í•©ë³‘ ì¼ì •ì´ ì˜¤ë²„ë© ë˜ê¸´í•œë‹¤...)</p><p>ê±°ì˜ 2ì£¼ë§Œì— í¬ìŠ¤íŒ…ì¸ë° '18 Google Next í‚¤ë…¸íŠ¸ì—ì„œ <a href="https://github.com/knative/" target="_blank" rel="noopener noreferrer">knative</a>ë¼ëŠ” í˜„ì¬ ê°œë°œì¤‘ì¸ í”„ë¡œì íŠ¸ì™€ ìœ ì‚¬í•œ ì˜¤í”ˆì†ŒìŠ¤ê°€ ê³µê°œë˜ì—ˆë‹¤. ë‹¤ìŒë²ˆì—” knativeë„ í•œë²ˆ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë´ì•¼ í• ë“¯ í•˜ë‹¤. </p><p>í¼ë¸”ë¦­ê³¼ í”„ë¼ì´ë¹— í´ëŸ¬ìŠ¤í„°ì— ëŒ€í•œ ê³ ë¯¼ì´ ìƒê¸°ê¸° ì‹œì‘í•œë‹¤. ë‹¤ì‹œê¸ˆ ì˜¤í”ˆì†ŒìŠ¤ í”Œë«í¼ì— ì§‘ì¤‘í•˜ê¸° ìœ„í•´ í”„ë¼ì´ë¹—ìœ¼ë¡œ ëŒì•„ê°€ì•¼ í•˜ë‚˜ë¼ëŠ” ê³ ë¯¼ì—ë„ ë¹ ì ¸ìˆëŠ” ìƒíƒœì—ì„œ knative, GKE on Premise ê°™ì€ ì—”í„°í”„ë¼ì´ì¦ˆì—ì„œ í”„ë¼ì´ë¹— êµ¬ì¶•ì„ ìœ„í•œ ê²ƒë“¤ë„ ë‚˜ì˜¤ê³  ìˆì–´ì„œ ë”ë”ìš± ê³ ë¯¼ì— ë¹ ì§„ ìš”ì¦˜ì´ë‹¤...</p>]]></content>
        <category label="dex" term="dex"/>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="identity service" term="identity service"/>
        <category label="OIDC" term="OIDC"/>
        <category label="connectors" term="connectors"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Cert-manager]]></title>
        <id>kubernetes/cert-manager/</id>
        <link href="https://ddii.dev/kubernetes/cert-manager/"/>
        <updated>2018-07-13T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Cert-managerì— ëŒ€í•´ ì•Œì•„ë´…ë‹ˆë‹¤]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="tls-ì¸ì¦ì„œ">TLS ì¸ì¦ì„œ<a class="hash-link" href="#tls-ì¸ì¦ì„œ" title="Direct link to heading">â€‹</a></h2><p>ì œí•œëœ ì˜ˆì‚°ê³¼ ì‹œê°„, ì¸ë ¥ìœ¼ë¡œ ì„œë¹„ìŠ¤ë¥¼ ë§Œë“¤ë‹¤ ë³´ë‹ˆ ì–´ë ¤ìš´ ì ë“¤ì´ ì°¸ ë§ë‹¤. íŠ¹íˆë‚˜ TLS ì¸ì¦ì„œ ê°™ì€ ê²½ìš° ê´€ë¦¬í•˜ëŠ”ê²ƒì´ ì€ê·¼íˆ ê·€ì°®ë‹¤. ì¸ì¦ì„œ ë§Œë£Œì¼ ê´€ë¦¬í•˜ëŠ”ê²ƒ ë¶€í„° ì–´ëŠ í˜ì´ì§€ê¹Œì§€ë¥¼ í‰ë¬¸ìœ¼ë¡œë§Œ ë‘ì–´ì•¼ í•˜ëŠ”ì§€ë„... ê·¸ëŸ°ë° ë°”ë³´ê°™ì€ ì´ìŠˆë¥¼ ì €ì§€ë¥´ê³  ë§ì•˜ë‹¤. ë„ë©”ì¸ì„ ì‹ ì²­í•˜ê³  fanout, Name based virtual hosting ë°©ì‹ì¤‘ì— ê³ ë¯¼í•˜ë‹¤ê°€ ì„¤ê³„ë¥¼ virtual hostë¡œ í•˜ì˜€ë‹¤.  </p><p>ê·¸ëŸ°ë° ë¬¸ì œëŠ” ì–´ì´ì—†ëŠ”ê³³ì—ì„œ ë‚˜ì™”ë‹¤. *.xxxxx.io ë¼ê³  wildcard SSL ì¸ì¦ì„œë¥¼ ì‹ ì²­í•˜ì˜€ëŠ”ë° virtual hostë°©ì‹ìœ¼ë¡œ 2ì°¨ subdomin (ì˜ˆ, api.stg.xxxxx.io)ìœ¼ë¡œ ingressë¥¼ ë§ˆêµ¬ì¡ì´ë¡œ ìƒì„±í•˜ê³  ì¸ì¦ì„œë¥¼ ì ìš©ì„ í–ˆë‹¤. í•˜ì§€ë§Œ ì¸ì¦ì„œ ì˜¤ë¥˜ ã…‹ã…‹</p><p>ì¸í„°ë„· ë¹„ì§€ë‹ˆìŠ¤ë¥¼ ê±°ì˜ í•´ë³´ì§€ ì•Šì•„ì„œ ì¸ì§€, ì´ëŸ° ê¸°ë³¸ì ì¸ ë‚´ìš©ë„ ê°„ê³¼í•˜ê³  ì„œë¹„ìŠ¤ë¥¼ êµ¬ìƒí•œ ë‚´ê°€ ëª¨ë“ ê±¸ ì±…ì„ì ¸ì•¼í•˜ëŠ” ìƒí™©ì´ ì™€ë²„ë ¸ë‹¤. </p><p>ì„¤ê³„ë¥¼ ì´ìƒí•˜ê²Œ í•´ì„œ wildcard ë„ë©”ì¸ì„ ëª‡ì‹­ê°œë¥¼ ì‹ ê·œë¡œ ê³„ì•½í•´ì•¼í•˜ëŠ” ì“¸ë°ì—†ëŠ” ë¹„ìš©ì„ ë“¤ì–´ì•¼í•˜ëŠ” ì²˜ì§€ê°€ ë˜ì—ˆë‹¤. í•˜ì§€ë§Œ ê·¸ëƒ¥ ì£½ìœ¼ë€ ë²•ì€ ì—†ëŠ”ê²Œ ì‚¬ëŒì‚¬ëŠ” ì„¸ìƒì´ê³  ì´ëŸ° ê³ ë¯¼ë“¤ì„ ë¶„ëª… ë‹¤ë¥¸ì‚¬ëŒë“¤ë„ í–ˆì„ê±°ì•¼ë¼ê³  ìƒê°í•˜ë©´ì„œ ë– ì˜¤ë¥¸ê²Œ let's encrypt ì˜€ê³  ì°¾ì•„ë³´ë‹ˆ ì´ê±¸ ë˜ kubernetesì—ì„œ ë°œê¸‰ë¶€í„° ê°±ì‹ ê¹Œì§€ í•´ì£¼ëŠ” ì˜¤í”ˆì†ŒìŠ¤ë¥¼ ì°¾ì•„ ì ìš©ê¹Œì§€ í•˜ê³  ì´ë ‡ê²Œ í¬ìŠ¤íŒ…ì„ í•œë‹¤. </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="cert-manager">Cert-manager<a class="hash-link" href="#cert-manager" title="Direct link to heading">â€‹</a></h3><p>ì¸ì¦ì„œ ì—†ì´ êµ¬ì„±í• ìˆ˜ë„ ìˆì§€ë§Œ ê¸°ë³¸ì ìœ¼ë¡œ kubernetes ëŠ” secretê³¼ ingressì˜ ê°„ë‹¨í•œ ì„¤ì •ë§Œìœ¼ë¡œ TLSë¥¼ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤.  </p><ul><li>Cert-manager : K8s í´ëŸ¬ìŠ¤í„°ë‚´ì—ì„œ TLSì¸ì¦ì„œë¥¼ ìë™ìœ¼ë¡œ í”„ë¡œë¹„ì €ë‹ ë° ê´€ë¦¬í•˜ëŠ” ì˜¤í”ˆì†ŒìŠ¤</li><li>Letâ€™s Encrypt :  ììœ¨ì ìœ¼ë¡œ ì‘ë™í•˜ëŠ” ê°œë°©ëœ CA(Certificate authority-ì¸ì¦ê¸°ê´€)ìœ¼ë¡œ ê³µê³µì„±(ê³µê³µì˜ ì´ìµ)ì„ ìœ„í•´ì„œ ìš´ì˜ë˜ëŠ” ì˜¤í”ˆì†ŒìŠ¤</li></ul><p><a href="http://docs.cert-manager.io/en/latest/" target="_blank" rel="noopener noreferrer">Cert-manager</a>ëŠ” AWSì˜ Certificate Managerì™€ ìœ ì‚¬í•˜ê²Œ ì¸ì¦ì„œë¥¼ ë°œê¸‰í•˜ê³  ì„¤ì •í• ìˆ˜ ìˆë‹¤. 3ê°œì›” ìœ íš¨ê¸°ê°„ì„ ê°€ì§€ëŠ” <a href="https://letsencrypt.org/" target="_blank" rel="noopener noreferrer">let's encrypt</a>ë¥¼ ì‚¬ìš©í•˜ê¸°ì— ì¸ì¦ì„œ ë§Œë£Œì‹œ ë¬¸ì œê°€ ë ê±°ë¼ ìƒê°í–ˆì§€ë§Œ ì´ê²ƒë„ ìë™ìœ¼ë¡œ ê°±ì‹ ì„ í•´ì£¼ëŠ” ê´€ë¦¬ app.ì„ ê°™ì´ ë°°í¬í•˜ê¸° ë•Œë¬¸ì— ì¸ì¦ì„œ ê´€ë¦¬ì— ëŒ€í•œ ë¶€ë‹´ì„ ëœìˆ˜ ìˆë‹¤.  </p><p>ê¸°ë³¸ì ìœ¼ë¡œ Cert-managerëŠ” <a href="https://letsencrypt.org/" target="_blank" rel="noopener noreferrer">let's encrypt</a>, <a href="https://www.vaultproject.io/" target="_blank" rel="noopener noreferrer">Vault</a> ê°™ì€ ê²ƒì„ë“¤ ì‚¬ìš©í•˜ì—¬ ì¸ì¦ì„œ ë°œê¸‰ì„ í•  ìˆ˜ ìˆë‹¤. ì¸ì¦ì„œ ë°œê¸‰í›„ì—ë„ ë§Œë£Œê°€ ë˜ê¸° ì „ì— ë°”ë¡œ ê°±ì‹ ì„ ìë™ìœ¼ë¡œ í•œë‹¤. </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="êµ¬ì„±">êµ¬ì„±<a class="hash-link" href="#êµ¬ì„±" title="Direct link to heading">â€‹</a></h3><p><img loading="lazy" src="http://docs.cert-manager.io/en/latest/_images/high-level-overview.png" alt="certmanager" class="img_E7b_"></p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì‚¬ì „ì¤€ë¹„ì‚¬í•­">ì‚¬ì „ì¤€ë¹„ì‚¬í•­<a class="hash-link" href="#ì‚¬ì „ì¤€ë¹„ì‚¬í•­" title="Direct link to heading">â€‹</a></h3><ul><li><a href="https://docs.helm.sh/using_helm/#installing-helm-client" target="_blank" rel="noopener noreferrer">helm</a></li><li>k8s cluster (1.7+) - CRD ì‚¬ìš©ì´ ê°€ëŠ¥í•´ì•¼í•¨</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì„¤ì¹˜">ì„¤ì¹˜<a class="hash-link" href="#ì„¤ì¹˜" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ helm install --name cert-manager --version v0.3.1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --namespace kube-system stable/cert-manager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ helm status cert-manager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LAST DEPLOYED: Fri Jun 15 10:02:45 2018</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAMESPACE: kube-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">STATUS: DEPLOYED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RESOURCES:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==&gt; v1/Pod(related)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                        READY  STATUS   RESTARTS  AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cert-manager-cert-manager-5f76b676b4-5tdh8  1/1    Running  0         2d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==&gt; v1/ServiceAccount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                       SECRETS  AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cert-manager-cert-manager  1        28d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==&gt; v1beta1/CustomResourceDefinition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                               AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">certificates.certmanager.k8s.io    28d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusterissuers.certmanager.k8s.io  28d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">issuers.certmanager.k8s.io         28d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==&gt; v1beta1/ClusterRole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cert-manager-cert-manager  28d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==&gt; v1beta1/ClusterRoleBinding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                       AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cert-manager-cert-manager  28d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==&gt; v1beta1/Deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                       DESIRED  CURRENT  UP-TO-DATE  AVAILABLE  AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cert-manager-cert-manager  1        1        1           1          28d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTES:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cert-manager has been deployed successfully!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In order to begin issuing certificates, you will need to set up a ClusterIssuer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">or Issuer resource (for example, by creating a 'letsencrypt-staging' issuer).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">More information on the different types of issuers and how to configure them</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">can be found in our documentation:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https://cert-manager.readthedocs.io/en/latest/reference/issuers.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">For information on how to configure cert-manager to automatically provision</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Certificates for Ingress resources, take a look at the `ingress-shim`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">documentation:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https://cert-manager.readthedocs.io/en/latest/reference/ingress-shim.html</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì¸ì¦ì„œ-ì„¤ì •-ë°-ë°°í¬">ì¸ì¦ì„œ ì„¤ì • ë° ë°°í¬<a class="hash-link" href="#ì¸ì¦ì„œ-ì„¤ì •-ë°-ë°°í¬" title="Direct link to heading">â€‹</a></h3><p>ì¸ì¦ì„œ ë“±ë¡ ë° ë§Œë£Œì‹œ notië¥¼ ë°›ê¸° ìœ„í•œ ë³€ìˆ˜ ì„¤ì •ì„ í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ export EMAIL=zaction@sk.com</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê·¸ë¦¬ê³  issuer manifestë¥¼ ë°°í¬í•œë‹¤.<br>
<!-- -->(letsencrypt-issuer.yaml)</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain"># Copyright 2018 Google Inc.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Licensed under the Apache License, Version 2.0 (the "License");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># you may not use this file except in compliance with the License.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># You may obtain a copy of the License at</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#     https://www.apache.org/licenses/LICENSE-2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Unless required by applicable law or agreed to in writing, software</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># distributed under the License is distributed on an "AS IS" BASIS,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># See the License for the specific language governing permissions and</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># limitations under the License.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: certmanager.k8s.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: ClusterIssuer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: letsencrypt-staging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  acme:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    server: https://acme-staging-v02.api.letsencrypt.org/directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    email: ''</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    privateKeySecretRef:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      name: letsencrypt-staging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    http01: {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: certmanager.k8s.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: ClusterIssuer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: letsencrypt-prod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  acme:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    server: https://acme-v02.api.letsencrypt.org/directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    email: ''</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    privateKeySecretRef:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      name: letsencrypt-prod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    http01: {}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë‘ê°œì˜ endpointë¥¼ ìƒì„±í•œë‹¤. (Staging, Prod)</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ sed -e "s/email: ''/email: $EMAIL/g" letsencrypt-issuer.yaml | \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kubectl apply -f-</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusterissuer "letsencrypt-staging" created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusterissuer "letsencrypt-prod" created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Web Appì„ HTTP Ingress í˜•íƒœë¡œ ë°°í¬í•œë‹¤. TLSë°œê¸‰ì „ì— ë¯¸ë¦¬ HTTP(80) Ingressë¥¼ ë°°í¬í•´ì•¼ í•œë‹¤. ì´í›„ Let's encrypt TLSë°°í¬ í›„ TLS specì„ ì¶”ê°€í•˜ê³  ì¬ë°°í¬ë¥¼ í•´ì•¼í•œë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: extensions/v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Ingress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: auth-ingress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  rules:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - host: auth.dev.action.cloudz.co.kr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    http:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      paths:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - backend:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          serviceName: faas-auth-service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          servicePort: 8081</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        path: /</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="tls-ì¸ì¦ì„œ-ë°œê¸‰">TLS ì¸ì¦ì„œ ë°œê¸‰<a class="hash-link" href="#tls-ì¸ì¦ì„œ-ë°œê¸‰" title="Direct link to heading">â€‹</a></h3><p>ì¸ì¦ì„œë¥¼ ë°œê¸‰í• ë•ŒëŠ” ìœ„ì—ì„œ ë§Œë“  Ingressë¡œ ìƒì„±í•˜ê³ namespaceë³„ ìƒì„±ì´ í•„ìš”í•˜ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: certmanager.k8s.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Certificate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: auth-dev-tls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: auth #### namespaceë³„ ìƒì„±</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  secretName: auth-dev-tls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  issuerRef:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name: letsencrypt-prod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kind: ClusterIssuer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  commonName: auth.dev.action.cloudz.co.kr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dnsNames:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - auth.dev.action.cloudz.co.kr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  acme:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    config:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - http01:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ingress: auth-ingress ### ê¸°ì¡´ì— ë§Œë“  HTTP ingress ëª…</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      domains:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - auth.dev.action.cloudz.co.kr</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl apply -f auth-dev-tls.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">certificate "auth-dev-tls" created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´í›„ TLS ìƒì„± ìƒíƒœë¥¼ í™•ì¸í•œë‹¤. ì´ë•Œ Messageì—ì„œ <code>Normal   CeritifcateIssued     Certificated issued successfully</code> ë¬¸êµ¬ê°€ í™•ì¸ë˜ë©´ ì¸ì¦ì„œ ë°œê¸‰ì´ ì •ìƒì ìœ¼ë¡œ ë˜ì—ˆë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤.<br>
<!-- -->ì´ë•Œ ë°œê¸‰ë˜ëŠ” ì‹œê°„ì´ ë„¤íŠ¸ì›Œí¬ í™˜ê²½ì— ë”°ë¼ 1~5ë¶„ì •ë„ ì†Œìš”ë ë•Œë¡œ ìˆëŠ”ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl describe -f auth-dev-tls.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Type     Reason                Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">----     ------                -------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Warning  ErrorCheckCertificate Error checking existing TLS certificate: secret "auth-dev-tls" not found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Normal   PrepareCertificate    Preparing certificate with issuer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Normal   PresentChallenge      Presenting http-01 challenge for domain foo.kubernetes.tips</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Normal   SelfCheck             Performing self-check for domain auth.dev.action.cloudz.co.kr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Normal   ObtainAuthorization   Obtained authorization for domain auth.dev.action.cloudz.co.kr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Normal   IssueCertificate      Issuing certificate...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Normal   CeritifcateIssued     Certificated issued successfully</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>secretì´ ìƒì„±ëœê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get secret | grep tls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth-dev-tls                 kubernetes.io/tls                     2         3h</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´í›„ ìœ„ì—ì„œ ë§Œë“  Ingressì— TLSë¥¼ ì ìš©í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: extensions/v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Ingress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: auth-ingress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  annotations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ingress.bluemix.net/hsts: enabled=true maxAge=&lt;31536000&gt; includeSubdomains=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ingress.bluemix.net/redirect-to-https: "True"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  rules:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - host: auth.dev.action.cloudz.co.kr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    http:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      paths:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - backend:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          serviceName: faas-auth-service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          servicePort: 8081</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        path: /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  tls:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - hosts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - auth.dev.action.cloudz.co.kr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    secretName: auth-dev-tls</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ ì„¤ì •ì„ ì ìš©í•˜ê³  ìƒíƒœë¥¼ í™•ì¸í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl apply -f auth-tls-ingress.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get ing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME           HOSTS                          ADDRESS         PORTS     AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth-ingress   auth.dev.action.cloudz.co.kr   10.1.1.182   80, 443   14h</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><img loading="lazy" alt="cert-tls" src="/assets/images/cert-tls-44f1bafbb8d04958c83803b445548083.png" width="1174" height="1022" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ì„¤ê³„ì˜ ì‹¤ìˆ˜ë¡œ ì‹œì‘ë˜ì—ˆì§€ë§Œ ì •ë¦¬í•˜ë‹¤ë³´ë‹ˆ ì¸ì¦ì„œ ê°±ì‹ ì´ ìë™ì„ ëœë‹¤ëŠ” ì ê³¼ ë˜í•œ Kubernetesí™˜ê²½ì—ì„œ TLSê´€ë¦¬ê°€ ê°„í¸í•˜ë‹¤ëŠ”ê²ƒì„ ì•Œê²Œ ë˜ì—ˆë‹¤. ì¸ì¦ì„œ ë¹„ìš©ì„ ì•„ë‚€ê²ƒë„ í•˜ë‚˜ì˜ ì„±ê³¼ì´ê¸°ë„ í•˜ë‹¤. ì¸ì¦ì„œëŠ” ì¨ì•¼í•˜ê² ê³  ì •ë§ ë§ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ë“¤ì„ ìƒì„±/ì‚­ì œë¥¼ ìƒì‹œ í•´ì•¼í•˜ëŠ” í™˜ê²½ì´ë¼ë©´ í•œë²ˆ ì ìš©í•´ë³¼ë§Œí•œ ê°€ì¹˜ê°€ ìˆëŠ”ê²ƒ ê°™ë‹¤.</p>]]></content>
        <category label="Cert-manager" term="Cert-manager"/>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="TLS" term="TLS"/>
        <category label="Manage TLS Certificates" term="Manage TLS Certificates"/>
        <category label="Security" term="Security"/>
        <category label="HTTPS" term="HTTPS"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Operators & CRDs(CustomResourceDefinitions) on Kubernetes]]></title>
        <id>kubernetes/operator/</id>
        <link href="https://ddii.dev/kubernetes/operator/"/>
        <updated>2018-07-09T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Operators, CRD(Custom Resource Definitions)ì— ëŒ€í•´ì„œ ì•Œ ìˆ˜ ìˆë‹¤.]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="operators-in-kubernetes">Operators in Kubernetes<a class="hash-link" href="#operators-in-kubernetes" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="operators-ë€">Operators ë€?<a class="hash-link" href="#operators-ë€" title="Direct link to heading">â€‹</a></h3><p>ì •ì˜(<a href="https://coreos.com/operators/" target="_blank" rel="noopener noreferrer">Definition</a>) : Kubernetes Application ì„ íŒ¨í‚¤ì§•, ë°°í¬, ê´€ë¦¬í•˜ëŠ” ë°©ë²•. Helmê³¼ëŠ” ì¡°ê¸ˆ ë‹¬ë¼ ë”°ë¡œ ì´ì•¼ê¸° í•´ë³´ê³ ì í•œë‹¤.</p><p>ê¸°ë³¸ì ìœ¼ë¡œ Kubernetest Applicationì€ kubernetesì— ì˜í•´ ë°°í¬ë˜ê³  kubectê³¼ kube-APIë¥¼ ì‚¬ìš©í•˜ì—¬ ê´€ë¦¬í•œë‹¤.</p><p>ê²°ë¡ ì ìœ¼ë¡œ ë§í•˜ë©´ Kubernetesì— ë‚´ê°€ ë§Œë“  applicationì„ ì„œë¹„ìŠ¤í•˜ê³  ê´€ë¦¬í•˜ë ¤ë©´ ê²°êµ­ Kubernetesì˜ APIë“¤ì„ ëª¨ë‘ ì´í•´í•˜ê³  ì‚¬ìš©í• ìˆ˜ ìˆì–´ì•¼ í•œë‹¤. ì¼ë°˜ì ì¸ ê°œë°œìì—ê²Œ ì§„ì…ì¥ë²½ì´ ì–´ëŠì •ë„ ìˆë‹¤ê³  ë³´ì—¬ì§€ë©° ì´ë¥¼ ëª¨ë‘ ì´í•´ì‹œí‚¤ëŠ”ê²ƒë„ ì¡°ì§ì ì¸ ì¸¡ë©´ì—ì„œëŠ” ë‚­ë¹„ì¼ìˆ˜ ë„ ìˆë‹¤. ê·¸ë˜ì„œ Helmë“±ì„ í†µí•œ applicationë°°í¬ ì „ëµì„ ì„¸ìš°ê¸°ë„ í•˜ì§€ë§Œ ì´ê²ƒë„ í•œê³„ê°€ ìˆì„ìˆ˜ ìˆë‹¤. ê·¸ë˜ì„œ OperatorëŠ” Kubernetesìƒì—ì„œ applicationì„ ê´€ë¦¬í•˜ëŠ” ëŸ°íƒ€ì„ì´ë¼ê³  ìƒê°í•˜ëŠ”ê²Œ ë§ëŠ”ê²ƒ ê°™ë‹¤.</p><p><img loading="lazy" src="https://coreos.com/sites/default/files/inline-images/Overview-etcd_0.png" alt="etcd" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="operators">Operators<a class="hash-link" href="#operators" title="Direct link to heading">â€‹</a></h2><p>OperatorsëŠ” applicationë§ˆë‹¤ ìš´ì˜ì •ë³´ë¥¼ ë„£ì„ìˆ˜ ìˆë‹¤.</p><p>Kubernetes ì— ë°°í¬ëœ ì‘ìš©í”„ë¡œê·¸ë¨ì˜ ëª¨ë“  íŠ¹ì„±ì„ ì•Œ í•„ìš”ê°€ ì—†ê³  ì´ë¥¼ í†µí•´ ì‚¬ìš©ìëŠ” ë§¤ë‹ˆì§€ë“œ í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ ê²½í—˜(ê¸°ì¡´ IaaS/PaaSê´€ë¦¬ì™€ ìœ ì‚¬)ê³¼ ìœ ì‚¬í•˜ê²Œ ìš´ì˜ì´ ê°€ëŠ¥í•˜ë‹¤.  </p><p>Operatorê°€ ë°°í¬ë˜ë©´ Kubernetes APIí™•ì¥ ê°œë…ì¸ CRDs(Custom
Resource Definitions)ì„ ì‚¬ìš©í•˜ì—¬ ê´€ë¦¬í• ìˆ˜ ìˆë‹¤.
Kubernetesì— Stateful ì„œë¹„ìŠ¤ë¥¼ ë°°í¬í•˜ëŠ” ë‹¨ìˆœí•˜ê³  ì¢‹ì€ ë°©ë²•ì´ ë ìˆ˜ ìˆë‹¤.  </p><p>ì˜ˆë¥¼ ë“¤ë©´, Postgres í´ëŸ¬ìŠ¤í„°, Prometheus í´ëŸ¬ìŠ¤í„°, Etcd í´ëŸ¬ìŠ¤í„° ê°™ì´ ìš´ì˜ì¸¡ë©´ì˜ applicationë“¤ì„ ìœ ì§€, ìš´ì˜í•˜ëŠ”ë° ì“°ì¼ìˆ˜ ìˆë‹¤. (ìì„¸í•œê±´ ë’¤ìª½ ì˜ˆì‹œë¡œ ì„¤ëª…í•˜ê² ë‹¤)</p><p>ê·¸ëŸ¬ë©´ ë¨¼ì € CRDs(Custom Resource Definitions)ì— ëŒ€í•´ì„œ ë¨¼ì € ì•Œì•„ë³¸ë‹¤. CRDsì— ëŒ€í•´ì„œëŠ” ë³„ë„ë¡œ ì •ë¦¬í•˜ë ¤ í•˜ë‹¤ê°€ ë‚´ìš©ì´ ë§ì´ ì•Šì•„ í•µì‹¬ì ì¸ ë‚´ìš©ë§Œ ê°™ì´ ì ì–´ë³¸ë‹¤.</p><ul><li>Custom Resource Definitions(a.k.a CRDs)</li><li>k8s Objectë¥¼ í™•ì¥í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê°€ì¥ ê°„ë‹¨í•œ ë°©ë²•</li><li>CRDsëŠ” Kubernetesì˜ í™•ì¥ ê¸°ëŠ¥</li><li>Kubernetes ì‚¬ìš©ìê°€ í´ëŸ¬ìŠ¤í„°ë‚´ì—ì„œ ì§ì ‘ custom Objectë¥¼ yamlí˜•íƒœë¡œ ìƒì„±, ìˆ˜ì •, ì‚­ì œ, ì‚¬ìš©í• ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê¸°ëŠ¥  <ul><li>K8s database(etcd)ì™€ APIë¥¼ ê·¸ëŒ€ë¡œ í™œìš©í•  ìˆ˜ ìˆìŒ)</li><li>CRUD ê°€ëŠ¥ (Create, Read, Update, Delete)</li></ul></li><li>ëª¨ë“  í´ëŸ¬ìŠ¤í„°ì— ë™ì ìœ¼ë¡œ resource ë“±ë¡/ì‚­ì œ ê°€ëŠ¥</li><li>OperatorsëŠ” CRDsë¥¼ í¬í•¨í•˜ê³  ìˆìŒ<ul><li>Operatorë¥¼ ì¶”ê°€í•˜ë©´ CRDsê°€ ë“±ë¡ë¨</li></ul></li><li>Resource ë‹¹ í•˜ë‚˜ì˜ API ë²„ì „ë§Œ ì§€ì›(~1.10ë²„ì „, 1.11ë²„ì „ ì´í›„ ê°œìˆ˜ ì œí•œ ì—†ì–´ì§)</li><li>1.8+ ì´í›„ë¶€í„° JSON ìŠ¤í‚¤ë§ˆ ìœ íš¨ì„± ê²€ì¦ ê°€ëŠ¥
<strong> *ì£¼ì˜ì‚¬í•­ : etcdê°€ ë³„ë„ ë¶„ë¦¬ëœ managedì„œë¹„ìŠ¤ë‚˜ etcd ì¸ìŠ¤í„´ìŠ¤ê°€ ë¶„ë¦¬ëœ í™˜ê²½ì—ì„œ ì‚¬ìš©ê¶Œê³ </strong></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì£¼ìš”-í™œìš©ìš©ë„">ì£¼ìš” í™œìš©ìš©ë„<a class="hash-link" href="#ì£¼ìš”-í™œìš©ìš©ë„" title="Direct link to heading">â€‹</a></h3><ul><li>Operators</li><li>Application ì •ë³´ ì €ì¥</li><li>RouteRule on istio</li><li>GameServer on Agones</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="crds-ê´€ë ¨-ë°œí‘œìë£Œ">CRDs ê´€ë ¨ ë°œí‘œìë£Œ<a class="hash-link" href="#crds-ê´€ë ¨-ë°œí‘œìë£Œ" title="Direct link to heading">â€‹</a></h2><p><a href="https://ddiiwoong.github.io/2018/openinfraday18/" target="_blank" rel="noopener noreferrer">https://ddiiwoong.github.io/2018/openinfraday18/</a></p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="operators-example">Operators example<a class="hash-link" href="#operators-example" title="Direct link to heading">â€‹</a></h3><p><a href="https://coreos.com/operators/etcd/docs/latest" target="_blank" rel="noopener noreferrer">etcd</a>, <a href="https://github.com/rook/rook" target="_blank" rel="noopener noreferrer">Rook</a>, <a href="https://coreos.com/operators/prometheus/docs/latest" target="_blank" rel="noopener noreferrer">Prometheus</a>, <a href="https://www.vaultproject.io/" target="_blank" rel="noopener noreferrer">Vault</a>, <a href="https://github.com/oracle/mysql-operator" target="_blank" rel="noopener noreferrer">MySQL</a>, <a href="https://github.com/CrunchyData/postgres-operator" target="_blank" rel="noopener noreferrer">Postgres</a>, <a href="https://github.com/spotahome/redis-operator" target="_blank" rel="noopener noreferrer">Redis</a>, <a href="https://github.com/nbogojevic/kafka-operator" target="_blank" rel="noopener noreferrer">kafka-ë¹„ê³µì‹</a> ë“± Operatorë¡œ ë°°í¬ë ìˆ˜ ìˆëŠ” ì˜ˆì‹œë“¤ì€ í•´ë‹¹ ë§í¬ë¥¼ ë³´ë©´ ìì„¸íˆ í™•ì¸í•  ìˆ˜ ìˆë‹¤. (ì˜¤ë¼í´ì´ ê³µê²©ì ìœ¼ë¡œ K8së¹„ì§€ë‹ˆìŠ¤ë¡œ ë›°ì–´ë“œëŠ”ë“¯í•œ ê·¸ë¦¼ì´ë‹¤â€¦)  </p><p>ì£¼ë¡œ ì €ì¥ì†Œë‚˜ í‚¤-ë°¸ë¥˜ ìŠ¤í† ì–´, RDBë“±ì˜ ìš´ì˜ì•ˆì •ì„±ì„ ìœ„í•œ í´ëŸ¬ìŠ¤í„° êµ¬ì„±ì„ ìœ„í•œê²ƒë“¤ì´ ëŒ€ë¶€ë¶„ì´ë©° ì ì  ë„ì…ì„ í•´ë‚˜ê°€ëŠ” ì¶”ì„¸ì´ê¸´ê²ƒ ê°™ê¸´ í•˜ë‹¤. ì´ë²ˆì— ì§„í–‰í•´ë³´ê³ ì í•˜ëŠ”ê±´ ë¶„ì‚° í‚¤-ë°¸ë¥˜ ìŠ¤í† ì–´ì´ì kubernetesì˜ ë©”ì¸ì €ì¥ì†Œë¡œ ì“°ì´ëŠ” etcd ì´ë‹¤.</p><p>ê¸°ë³¸ì ìœ¼ë¡œ etcd cluster objectsëŠ” CRDsë¡œ ìƒì„±í•œë‹¤. Kubernetes ê¸°ë³¸ resourceê°€ ì•„ë‹Œ CRDs ì´ê¸° ë•Œë¬¸ì— ì•ˆì •ì„± ì¸¡ë©´ì—ì„œ ë¶ˆì•ˆí•˜ë‹¤ê³  ìƒê°í• ìˆ˜ë„ ìˆë‹¤. í•˜ì§€ë§Œ <a href="https://github.com/kubernetes/community/blob/master/contributors/design-proposals/api-machinery/aggregated-api-servers.md" target="_blank" rel="noopener noreferrer">User Aggregated API Servers</a> ë¥¼ ì ìš©í•˜ì—¬ ì•ˆì •ì„±, ìœ íš¨ì„± ê²€ì‚¬ ë° ë²„ì „ ê´€ë¦¬ê°€ ê°œì„ ë˜ì—ˆë‹¤ê³  í•œë‹¤. Aggregated APIë¥¼ ì‚¬ìš©í•˜ë©´ ì‚¬ìš©ìì—ê²Œ ìµœì†Œí•œì˜ ì˜í–¥ì„ ì£¼ë©´ì„œ Kubernetes objectsê°€ ìƒì„±ë˜ê±°ë‚˜ ì‚¬ìš©ìê°€ etcd operatorë¥¼ ë°°í¬,ê´€ë¦¬í• ìˆ˜ ìˆë‹¤. (ë§ì´ ê¸¸ì–´ì„œ ê·¸ë ‡ì§€ ê·¸ëƒ¥ etcd í´ëŸ¬ìŠ¤í„° êµ¬ì„±)</p><p>í˜„ì¬ í”„ë¡œì íŠ¸ëŠ” ë² íƒ€ë¡œ 0.9.2ê¹Œì§€ ë‚˜ì™€ ìˆìœ¼ë©° RedHatì´ CoreOSë¥¼ í•©ë³‘í•˜ëŠ” ë°”ëŒì— ë¬¸ì„œë“¤ì´ ì—…ë°ì´íŠ¸ê°€ ëŠ¦ì–´ì§€ëŠ”ê²ƒ ê°™ê¸´í•˜ì§€ë§Œ ì¡°ë§Œê°„ì— 1.0ì´ ë‚˜ì˜¬ê²ƒ ê°™ê¸´ í•˜ë‹¤.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="etcd-operator"><a href="https://github.com/coreos/etcd-operator/#overview" target="_blank" rel="noopener noreferrer">etcd-operator</a><a class="hash-link" href="#etcd-operator" title="Direct link to heading">â€‹</a></h3><p>etcd operatorëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ê¸°ëŠ¥ì„ í•œë‹¤.</p><ul><li>Create and Destroy</li><li>Resize</li><li>Failover</li><li>Rolling upgrade</li><li>Backup and Restore</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="requirements">Requirements<a class="hash-link" href="#requirements" title="Direct link to heading">â€‹</a></h4><ul><li>Kubernetes 1.8+</li><li>etcd 3.2.13+</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="installation-guide">Installation guide<a class="hash-link" href="#installation-guide" title="Direct link to heading">â€‹</a></h3><p>ì„¤ì¹˜ëŠ” ë‹¨ìˆœí•˜ë‹¤. ë¨¼ì € RBACì„¤ì •ì„ í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ git clone https://github.com/coreos/etcd-operator.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ cd etcd-operator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ example/rbac/create_role.sh</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê·¸ë¦¬ê³  etcd-operator ë°°í¬</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create -f example/deployment.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: extensions/v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: etcd-operator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  replicas: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  template:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        name: etcd-operator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: etcd-operator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        image: quay.io/coreos/etcd-operator:v0.9.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        command:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - etcd-operator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # Uncomment to act for resources in all namespaces. More information in doc/clusterwide.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #- -cluster-wide</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - name: MY_POD_NAMESPACE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          valueFrom:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fieldRef:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              fieldPath: metadata.namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - name: MY_POD_NAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          valueFrom:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fieldRef:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              fieldPath: metadata.name</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>deployment.yaml ë‚´ìš©ì„ ë³´ë©´ CustomResourceDefinitionì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤.
etcd-operatorê°€ ìë™ìœ¼ë¡œ CRDë¥¼ ìƒì„±í•˜ê¸° ë•Œë¬¸ì— ì•„ë˜ì™€ ê°™ì´ CRDë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get customresourcedefinitions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                    KIND</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">etcdclusters.etcd.database.coreos.com   CustomResourceDefinition.v1beta1.apiextensions.k8s.io</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="etcd-cluster-createresizefailoverupgrade">etcd cluster create/resize/failover/upgrade<a class="hash-link" href="#etcd-cluster-createresizefailoverupgrade" title="Direct link to heading">â€‹</a></h3><p>operatorë¥¼ ì´ìš©í•˜ì—¬ etc clusterë¥¼ êµ¬ì„±í•œë‹¤. operatorë¥¼ í†µí•œ í´ëŸ¬ìŠ¤í„° êµ¬ì„±ë‚´ìš©ì„ í™•ì¸í•˜ë©´ ì•„ì£¼ ë‹¨ìˆœí•˜ë‹¤. ë²„ì „ê³¼ ì‚¬ì´ì¦ˆë¿ì´ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ cat example/example-etcd-cluster.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: "etcd.database.coreos.com/v1beta2"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: "EtcdCluster"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: "example-etcd-cluster"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ## Adding this annotation make this cluster managed by clusterwide operators</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ## namespaced operators ignore it</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # annotations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #   etcd.database.coreos.com/scope: clusterwide</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  size: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  version: "3.2.13"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create -f example/example-etcd-cluster.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">etcdcluster.etcd.database.coreos.com/example-etcd-cluster created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìˆœì°¨ì ìœ¼ë¡œ etcd clusterê°€ êµ¬ì„±ë˜ëŠ”ê²ƒì„ ë³¼ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pods</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                              READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">etcd-operator-69b559656f-wrhxz    1/1       Running   0          3h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-2kd4t667j5   1/1       Running   0          1m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-k4lxm96v7h   1/1       Running   0          1m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-lm7mkhvldw   1/1       Running   0          1m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´ë²ˆì—ëŠ” scale-out í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•œë‹¤.<br>
<!-- -->example/example-etcd-cluster.yaml ë‚´ìš©ì—ì„œ <code>size: 3</code> ì„ <code>size: 5</code> ë¡œ ë³€ê²½í•˜ê³  ë‹¤ì‹œ ì ìš©í•˜ë©´ 2 nodeê°€ ì¶”ê°€ë¡œ ìƒì„±ëœë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl apply -f example/example-etcd-cluster.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pods</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                              READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">etcd-operator-69b559656f-wrhxz    1/1       Running   0          3h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-2kd4t667j5   1/1       Running   0          9m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-2pwm84lrf4   1/1       Running   0          34s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-97qk6gs4sp   1/1       Running   0          50s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-k4lxm96v7h   1/1       Running   0          9m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-lm7mkhvldw   1/1       Running   0          8m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë°˜ëŒ€ë¡œ ì¤„ì´ëŠ”ê²ƒë„ ë™ì¼í•˜ë‹¤.</p><p>failover í…ŒìŠ¤íŠ¸ì˜ ê²½ìš°ì—ë„ ê·¸ëƒ¥ podë¥¼ ì‚­ì œí•˜ê±°ë‚˜ workerë¥¼ ë‚ ë¦¬ëŠ”ê²ƒìœ¼ë¡œë„ ë™ì¼í•˜ê²Œ specì„ ìœ ì§€í•˜ëŠ” kubernetes resource íŠ¹ì„±ìœ¼ë¡œ ì¸í•´ ë°”ë¡œ ìƒì„±ì´ ë˜ëŠ”ê²ƒì„ í™•ì¸í• ìˆ˜ ìˆë‹¤.</p><p>ì´ë²ˆì—ëŠ” operatorë§Œ ë‚ ë ¤ë³´ê² ë‹¤. ì•„ë˜ì²˜ëŸ¼ operator deploymentë§Œ ì‚­ì œë¥¼ í•´ë„ podsëŠ” ë‚¨ì•„ìˆëŠ”ê²ƒì„ ë³¼ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl delete -f example/deployment.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment "etcd-operator" deleted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment.extensions "etcd-operator" deleted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                              READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-2kd4t667j5   1/1       Running   0          14m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-2pwm84lrf4   1/1       Running   0          5m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-97qk6gs4sp   1/1       Running   0          5m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-k4lxm96v7h   1/1       Running   0          14m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-lm7mkhvldw   1/1       Running   0          13m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>etcd pod í•˜ë‚˜ë¥¼ ë‚ ë ¤ë³¸ë‹¤. 4ê°œ podë§Œ ë‚¨ì€ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl delete pod example-etcd-cluster-2kd4t667j5 --now</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod "example-etcd-cluster-2kd4t667j5" deleted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                              READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-2pwm84lrf4   1/1       Running   0          9m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-97qk6gs4sp   1/1       Running   0          9m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-k4lxm96v7h   1/1       Running   0          18m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-lm7mkhvldw   1/1       Running   0          17m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë‹¤ì‹œí•œë²ˆ operatorë¥¼ ë°°í¬í•˜ê²Œ ë˜ë©´ ì ì‹œí›„ì— 5ê°œë¡œ ë‹¤ì‹œ podê°€ ë³µì›ëœê²ƒì„ í™•ì¸í• ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create -f example/deployment.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment.extensions/etcd-operator created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                              READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">etcd-operator-69b559656f-8ks8m    1/1       Running   0          44s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-2pwm84lrf4   1/1       Running   0          11m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-97qk6gs4sp   1/1       Running   0          11m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-k4lxm96v7h   1/1       Running   0          20m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-kskgvlbsm9   1/1       Running   0          10s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example-etcd-cluster-lm7mkhvldw   1/1       Running   0          19m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì—…ê·¸ë ˆì´ë“œì˜ ê²½ìš°ë„ ë‹¤ë¥¸ resourceì™€ ë™ì¼í•˜ê²Œ version ë¶€ë¶„ì„ ë³€ê²½í•˜ì—¬ rolloutì´ ê°€ëŠ¥í•˜ë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ë‹¤ìŒ ì†ŒìŠ¤ë¥¼ í†µí•´ ì§ì ‘ operatorë¥¼ ê°œë°œì´ ê°€ëŠ¥í•˜ë‹¤.<br>
<!-- -->(Source: <a href="https://coreos.com/operators/" target="_blank" rel="noopener noreferrer">https://coreos.com/operators/</a>)</p><p>Operator SDKë¥¼ ì‚¬ìš©í•˜ë©´ Kubernetes API ìƒì„¸ìŠ¤í™ì„ ë°°ìš°ì§€ ì•Šê³ ë„ ì‰½ê²Œ operator ë¹Œë“œê°€ ê°€ëŠ¥í•˜ë‹¤.
ë˜í•œ ê´€ë¦¬ë¥¼ ìœ„í•œ Operator Lifecycle Managerë‚˜ Operator Metering ê°™ì€ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ ì¢€ë” ê´€ë¦¬ì¸¡ë©´ì—ì„œ ê°•í™”í•˜ê³ ì í•˜ëŠ” CoreOSì§„ì˜ì˜ ë…¸ë ¥ì´ ë³´ì´ëŠ”ë“¯ í•˜ë‹¤.</p><p>ì•„ì§ alpha, betaë‹¨ê³„ì˜ operator í”„ë¡œì íŠ¸ë“¤ì´ ëŒ€ë¶€ë¶„ì´ì§€ë§Œ helmì°¨íŠ¸ì™€ ê°™ì´ kubernetes API ìŠ¤í™ì„ ì´í•´í•˜ê³  ì‚¬ìš©í•˜ì§€ ì•Šê³ ë„ ì‰½ê²Œ ìš´ì˜ìê°€ ê¸°ë°˜ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ê´€ë¦¬ í• ìˆ˜ ìˆë‹¤ëŠ”ê²ƒìœ¼ë¡œ ë³´ì•„ í–¥í›„ RedHatì´ë‚˜ Oracle ì§„ì˜ì—ì„œ ë³¸ì¸ë“¤ kubernetes ê´€ë ¨ ì œí’ˆë“¤ì„ í™ë³´í•˜ê³  ì„œë¹„ìŠ¤ë¼ì¸ì— í¬í•¨ì‹œí‚¤ëŠ” ë°©í–¥ìœ¼ë¡œ ì ê·¹ì ìœ¼ë¡œ ê°œë°œì„ í•˜ê³  ìˆëŠ”ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤. ì•ìœ¼ë¡œ mysql, redis, kakfa ë“±ì„ operatorë¡œ ë°°í¬í•˜ê³  ê´€ë¦¬í•˜ëŠ” ì¼ì´ ë” ë§ì•„ ì§ˆê²ƒ ê°™ë‹¤.</p>]]></content>
        <category label="Operators" term="Operators"/>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="CRDs" term="CRDs"/>
        <category label="CustomResourceDefinitions" term="CustomResourceDefinitions"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Cilium]]></title>
        <id>kubernetes/cilium-1/</id>
        <link href="https://ddii.dev/kubernetes/cilium-1/"/>
        <updated>2018-07-06T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Ciliumì— ëŒ€í•´ ì•Œì•„ë´…ë‹ˆë‹¤]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="cilium-ëˆ„êµ¬ëƒ-ë„Œ">Cilium ëˆ„êµ¬ëƒ ë„Œ?<a class="hash-link" href="#cilium-ëˆ„êµ¬ëƒ-ë„Œ" title="Direct link to heading">â€‹</a></h2><p>ì²˜ìŒì— ë†€ëë‹¤. ë²ˆì—­í•˜ë©´ 'ìê¶', 'ì„¬ëª¨', 'ì†ëˆˆì¹'ë“± ìµìˆ™ì¹˜ ì•Šì€ ë‹¨ì–´ë¼ì„œ ë†€ëì§€ë§Œ ì°¨ê·¼íˆ ë³´ë‹¤ë³´ë‹ˆ ê²°êµ­ OSë‚´ë¶€(ë¦¬ëˆ…ìŠ¤ ì»¤ë„)ì—ì„œë¶€í„° ì»¨í…Œì´ë„ˆê°„ ë˜ëŠ” ì™¸ë¶€ì™€ì˜ ì—°ê²°ì„ ë³´í˜¸í•˜ëŠ” ì—­í• ì´ë¼ê³  í•˜ë‹ˆ ì´í•´ê°€ ë˜ëŠ” ê²ƒ ê°™ë‹¤.</p><p>í™ˆí˜ì´ì§€ì— ì •ì˜ëœ ë‚´ìš©ì„ ë³´ë©´ ì•„ë˜ ë‚´ìš©ê³¼ ê°™ë‹¤. </p><blockquote><p><a href="https://cilium.readthedocs.io/en/v1.1/intro/#what-is-cilium" target="_blank" rel="noopener noreferrer">Cilium</a> - Docker ë° Kubernetesì™€ ê°™ì€ Linux ì»¨í…Œì´ë„ˆ ê´€ë¦¬ í”Œë«í¼ì„ ì‚¬ìš©í•˜ì—¬ ë°°í¬ëœ ì‘ìš© í”„ë¡œê·¸ë¨ ì„œë¹„ìŠ¤ ê°„ì˜ ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ ë³´í˜¸í•˜ëŠ” ì˜¤í”ˆ ì†ŒìŠ¤ ì†Œí”„íŠ¸ì›¨ì–´</p></blockquote><p>í˜ë¶ì— <a href="https://www.facebook.com/groups/korelnxuser/" target="_blank" rel="noopener noreferrer">í•œêµ­ ë¦¬ëˆ…ìŠ¤ ì‚¬ìš©ì ê·¸ë£¹</a>ì—ì„œë„ <a href="https://www.facebook.com/tommy.lee.98229" target="_blank" rel="noopener noreferrer">Tommy Lee</a>ë‹˜ì´ë‚˜ <a href="https://www.facebook.com/changan.song" target="_blank" rel="noopener noreferrer">ì†¡ì°½ì•ˆ</a>ë‹˜ì´ ëª‡ëª‡ ê²Œì‹œë¬¼ì„ ì˜¬ë ¤ì£¼ì…”ì„œ ê´€ì‹¬ìˆê²Œ ë³´ë˜ì¤‘ì— ì•„ë˜ì™€ ê°™ì€ ë‚´ìš©ì„ ë³´ê³  ì´ê±°ë‹¤ í•˜ê³  íŒŒë³´ê¸° ì‹œì‘í–ˆë‹¤.</p><blockquote><p>Ciliumì€ Docker ë° Kubernetesì™€ ê°™ì€ ë¦¬ëˆ…ìŠ¤ ì»¨í…Œì´ë„ˆ í”„ë ˆì„ ì›Œí¬ì— API ê¸°ë°˜ì˜ ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ í•„í„°ë§ì„ ì œê³µí•˜ë©°,
ë˜í•œ, BPFë¼ëŠ” ìƒˆë¡œìš´ Linux ì»¤ë„ ê¸°ìˆ ì„ ì‚¬ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆ/POD IDë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë„¤íŠ¸ì›Œí¬ ê³„ì¸µ ë° ì‘ìš© í”„ë¡œê·¸ë¨ ê³„ì¸µ ë³´ì•ˆ ì •ì±…ì„ ì •ì˜ ë° ì ìš©í•˜ëŠ” ê²ƒì— ìˆì–´ì„œ ê°„ë‹¨í•˜ë©´ì„œ íš¨ìœ¨ì ì¸ ë°©ë²•ì„ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤.</p></blockquote><p>ìœ—ë¶„ë“¤ì²˜ëŸ¼ ì»¤ë„ ìì²´ë¥¼ ë¶„ì„í•˜ê³  ê³µë¶€í•˜ê³  ê¸°ì—¬í•˜ë ¤ë©´ ì†Œìš”ë˜ëŠ” ì‹œê°„ì´ ë” ê±¸ë¦´ê±° ê°™ê³  ì„œë¹„ìŠ¤ë¥¼ ìš´ì˜í•˜ê³  ê°œë°œí•˜ëŠ” ì…ì¥ì—ì„œëŠ” ë‚´ í”„ë¡œì íŠ¸ì— ì ìš© ê°€ëŠ¥ì„±ì„ ê²€ì¦í•˜ëŠ”ê²ƒì´ ë‚˜ì„ê²ƒ ê°™ì•„ ì •ë¦¬ë¥¼ í•´ë³¸ë‹¤.</p><p>iptablesì„ ê¸°ë°˜ìœ¼ë¡œ IPì™€ Portê¸°ë°˜ì˜ ì „í†µì ì¸ í¬ì›Œë”© ê¸°ìˆ ì€ ë²Œì¨ 20ë…„ì´ë¼ëŠ” ì„¸ì›”ë™ì•ˆ ë„ë¦¬ ì‚¬ìš©ë˜ì–´ ì™”ë‹¤. íŠ¹íˆ í¼ë¸”ë¦­/í”„ë¼ì´ë¹— í´ë¼ìš°ë“œ ì œí’ˆêµ°ë“¤ ëª¨ë‘ iptablesê¸°ë°˜ì˜ Security Groupë“±ì„ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ê³  ìˆê³  Kubernetes ë§ˆì €ë„ CNI í•µì‹¬ìœ¼ë¡œ iptablesì„ í™œìš©í•˜ê³  ìˆë‹¤.  </p><p>ë™ì ìœ¼ë¡œ ë³€í™”í•˜ê³  ë§¤ìš° ë³µì¡í•œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ì‹œëŒ€ì— ì „í†µì ì¸ ë°©ì‹ì˜ IP, Portê´€ë¦¬ëŠ” ë¹„íš¨ìœ¨ì ì¸ ì¸¡ë©´ì´ ì—†ì§€ ì•Šë‹¤. BPF(ì•„ë˜ì¸ìš©)ì„ í™œìš©í•˜ì—¬ ë¦¬ëˆ…ìŠ¤ ì»¤ë„ë‚´ì—ì„œ ë°ì´í„° í¬ì›Œë”©ì„ í•  ìˆ˜ ìˆê³  Kubernetes Serviceê¸°ë°˜ Load Balancingì´ë‚˜ istioì™€ ê°™ì€ Service Meshë¥¼ ìœ„í•œ Proxy Injection ì„ í†µí•´ ì—¬ëŸ¬ í™œìš©ì„ í•  ìˆ˜ ìˆì„ê±°ë¼ê³  Cilium í”„ë¡œì íŠ¸ëŠ” ì´ì•¼ê¸° í•˜ê³  ìˆë‹¤. </p><blockquote><p>ë²„í´ë¦¬ íŒ¨í‚· í•„í„°(Berkeley Packet Filter, BPF)</p><p>BPFëŠ” ë²„í´ë¦¬ íŒ¨í‚· í•„í„°(Berkeley Packet Filter)ì˜ ì¤„ì„ë§ì´ë‹¤. ì´ë¦„ ê·¸ëŒ€ë¡œ íŒ¨í‚·ì„ ê±¸ëŸ¬ë‚´ëŠ” í•„í„°ì´ë‹¤. ê·¸ëŸ°ë° BSDì—ì„œì˜ BPFëŠ” ë„¤íŠ¸ì›Œí¬ íƒ­(ë¦¬ëˆ…ìŠ¤ì˜ PF_PACKET)ê¹Œì§€ ì•„ìš°ë¥´ëŠ” ê°œë…ì´ë‹¤. ì˜›ë‚  ì˜›ì ì— ìœ ë‹‰ìŠ¤ì—ëŠ” CSPF(CMU/Stanford Packet Filter)ë¼ëŠ” ê²Œ ìˆì—ˆëŠ”ë° BPFë¼ëŠ” ìƒˆ êµ¬ì¡°ê°€ ì´ë¥¼ ëŒ€ì²´í–ˆë‹¤. ì´í›„ ë¦¬ëˆ…ìŠ¤ì—ì„œëŠ” ë„¤íŠ¸ì›Œí¬ íƒ­ì„ ë‚˜ë¦„ì˜ ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•˜ê³  íŒ¨í‚· í•„í„° ë¶€ë¶„ë§Œ ê°€ì ¸ì™”ë‹¤. ë¦¬ëˆ…ìŠ¤ì˜ íŒ¨í‚· í•„í„°ë¥¼ ë¦¬ëˆ…ìŠ¤ ì†Œì¼“ í•„í„°ë§(LSF: Linux Socket Filtering)ì´ë¼ê³ ë„ í•œë‹¤.<br>
<!-- -->(ë°œì·Œ) <a href="https://wariua.github.io/facility/extended-bpf.html" target="_blank" rel="noopener noreferrer">https://wariua.github.io/facility/extended-bpf.html</a> </p></blockquote><p>Ciliumì€ Dockercon 2017ì—ì„œ ìµœì´ˆ <a href="https://www.youtube.com/watch?v=ilKlmTDdFgk" target="_blank" rel="noopener noreferrer">announce</a>ë¥¼ í•˜ì˜€ê³  2018ë…„ 4ì›” 24ì¼ì— 1.0ì´ ì •ì‹ Releaseëœ ì´í›„ ë§ì€ ê´€ì‹¬ì„ ë°›ì„ê²ƒìœ¼ë¡œ ì˜ˆìƒë˜ì–´ ì‹¤ì œ ì„œë¹„ìŠ¤ì— ì ìš©í•´ë³¼ í•„ìš”ê°€ ìˆì„ê±° ê°™ì•„ minikubeë¡œ í…ŒìŠ¤íŠ¸í•œ ë‚´ìš©ì„ ë„ì ¹ì—¬ ë³¸ë‹¤. </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="cilium-architecture">Cilium Architecture<a class="hash-link" href="#cilium-architecture" title="Direct link to heading">â€‹</a></h2><p><img loading="lazy" alt="Cilium Architecture" src="/assets/images/cilium_arch-96f6efd4a70465e9cbfd890e9da1f159.png" width="700" height="624" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="main-feature">Main Feature<a class="hash-link" href="#main-feature" title="Direct link to heading">â€‹</a></h2><ul><li>ê³ íš¨ìœ¨ BPF Datapath  <ul><li>ëª¨ë“  ë°ì´í„° ê²½ë¡œê°€ í´ëŸ¬ìŠ¤í„° ì „ì²´ì— ì™„ì „ ë¶„ì‚°</li><li>Envoyê°™ì€ proxy injection ì œê³µ, ì¶”í›„ sidecar proxy í˜•íƒœ ì œê³µì˜ˆì •</li></ul></li><li>CNI, CMM plugins  <ul><li>Kubernetes, Mesos, Dockerì— ì‰½ê²Œ í†µí•©ê°€ëŠ¥</li></ul></li><li>Packet, API ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ<br>íŒ¨í‚·ê¸°ë°˜ ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆê³¼ API ì¸ì¦ì„ ê²°í•©í•˜ì—¬ ì „í†µì ì¸ íŒ¨í‚·ê¸°ë°˜ ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆê³¼ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ ëª¨ë‘ì—ê²Œ ë³´ì•ˆ ì œê³µê°€ëŠ¥  <ul><li><a href="http://docs.cilium.io/en/doc-1.0/concepts/#arch-id-security" target="_blank" rel="noopener noreferrer">IDê¸°ë°˜</a> - Source IPì—ë§Œ ì˜ì¡´í•˜ì§€ ì•Šê³  ëª¨ë“ íŒ¨í‚·ì— workload identityë¥¼ encodingí•˜ì—¬ ì‹ë³„ì„± ê°•í™”  </li><li><a href="http://docs.cilium.io/en/doc-1.0/policy/language/#ip-cidr-based" target="_blank" rel="noopener noreferrer">IP/CIDRê¸°ë°˜</a>ì´ì™¸ì—ë„ <a href="http://docs.cilium.io/en/doc-1.0/policy/language/#services-based" target="_blank" rel="noopener noreferrer">Kubernetes Serviceê¸°ë°˜</a>ìœ¼ë¡œ ì •ì±… ì„¤ì •ê°€ëŠ¥</li><li>L7ê¸°ë°˜ <a href="http://docs.cilium.io/en/doc-1.0/policy/language/#layer-7-examples" target="_blank" rel="noopener noreferrer">APIë³´ì•ˆ</a> ì ìš©ê°€ëŠ¥</li></ul></li><li>ë¶„ì‚°,í™•ì¥ê°€ëŠ¥í•œ Load Balacing
BPFë¥¼ ì‚¬ìš©í•œ ê³ ì„±ëŠ¥ L3,L4 Load Balancer ì œê³µ
(Hasing, Weighted round-robin)<ul><li>kube-proxy ëŒ€ì²´ - Kubernetes ClusterIPê°€ ìƒì„±ë ë•Œ BPFê¸°ë°˜ìœ¼ë¡œ ìë™ìœ¼ë¡œ ì ìš©ë¨ </li><li><a href="http://docs.cilium.io/en/doc-1.0/api/" target="_blank" rel="noopener noreferrer">API driven</a> - ì§ì ‘ APIë¥¼ í™œìš©í•˜ì—¬ í™•ì¥ê°€ëŠ¥</li></ul></li><li>ë‹¨ìˆœí™”ëœ ë„¤íŠ¸ì›Œí¬ ëª¨ë¸<br>Overlay/VXLAN, Direct/Native Routing ì§€ì›</li><li>ê°€ì‹œì„±  <ul><li><a href="https://github.com/cilium/microscope" target="_blank" rel="noopener noreferrer">Microscope</a> - í´ëŸ¬ìŠ¤í„° ë ˆë²¨ì—ì„œ ëª¨ë“  ì´ë²¤íŠ¸ í•„í„°ë§ ê°€ëŠ¥</li><li>APIê¸°ë°˜ ê°€ì‹œì„± ì œê³µ</li></ul></li><li>ìš´ì˜<ul><li>í´ëŸ¬ìŠ¤í„° í—¬ìŠ¤ì²´í¬ - HTTP, ICMPê¸°ì¤€ í´ëŸ¬ìŠ¤í„° latency ì²´í¬ê°€ëŠ¥</li><li>Prometheus í†µí•© - ëª¨ë“  ë©”íŠ¸ë¦­ì„ Prometheusë¡œ ì „ë‹¬ê°€ëŠ¥</li><li>í´ëŸ¬ìŠ¤í„° ë¶„ì„ ë° <a href="http://docs.cilium.io/en/doc-1.0/troubleshooting/#cluster-diagnosis-tool" target="_blank" rel="noopener noreferrer">ë¦¬í¬íŠ¸íˆ´</a> </li></ul></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="requirement">Requirement<a class="hash-link" href="#requirement" title="Direct link to heading">â€‹</a></h2><ul><li>kubectl &gt;= 1.7.0</li><li>minikube &gt;= 0.22.3</li></ul><p><a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/" target="_blank" rel="noopener noreferrer">kubectl</a> ì„¤ì¹˜ì™€ <a href="https://github.com/kubernetes/minikube/releases" target="_blank" rel="noopener noreferrer">minikube</a> êµ¬ì„±ì€ ë³„ë„ë¡œ í•´ì•¼í•œë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="start-minikube">Start minikube<a class="hash-link" href="#start-minikube" title="Direct link to heading">â€‹</a></h2><p>ë„‰ë„‰í•˜ê²Œ 4GB ì´ìƒ ë©”ëª¨ë¦¬ë¡œ minikubeë¥¼ êµ¬ë™í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ minikube start --kubernetes-version v1.9.0 --network-plugin=cni --extra-config=kubelet.network-plugin=cni --memory=5120 </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="check-minikube-cluster-status">Check minikube cluster status<a class="hash-link" href="#check-minikube-cluster-status" title="Direct link to heading">â€‹</a></h2><p>minikubeêµ¬ì„±ì´ ì™„ë£Œë˜ë©´ ì•„ë˜ì™€ ê°™ì´ í´ëŸ¬ìŠ¤í„° ìƒíƒœë¥¼ í™•ì¸í• ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get cs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                 STATUS    MESSAGE              ERROR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">controller-manager   Healthy   ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scheduler            Healthy   ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">etcd-0               Healthy   {"health": "true"}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="install-etcd-dependency-of-cilium">Install etcd (dependency of cilium)<a class="hash-link" href="#install-etcd-dependency-of-cilium" title="Direct link to heading">â€‹</a></h2><p>cilium ì˜ì¡´ì„±ì„ ìœ„í•´ etcdë¥¼ ë³„ë„ë¡œ ë°°í¬í•œë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create -n kube-system -f https://raw.githubusercontent.com/cilium/cilium/v1.1/examples/kubernetes/addons/etcd/standalone-etcd.yaml  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service "etcd-cilium" created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">statefulset.apps "etcd-cilium" created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="check-all-pods-etcd">Check all pods (etcd)<a class="hash-link" href="#check-all-pods-etcd" title="Direct link to heading">â€‹</a></h2><p>ëª¨ë“  podê°€ <code>Running</code> ìƒíƒœì¸ì§€ í™•ì¸í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pods --all-namespaces</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAMESPACE     NAME                               READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   etcd-cilium-0                      1/1       Running   0          1m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   etcd-minikube                      1/1       Running   0          3m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-addon-manager-minikube        1/1       Running   0          4m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-apiserver-minikube            1/1       Running   0          3m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-controller-manager-minikube   1/1       Running   0          3m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-dns-86f4d74b45-lhzfv          3/3       Running   0          4m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-proxy-tcd7h                   1/1       Running   0          4m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-scheduler-minikube            1/1       Running   0          4m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   storage-provisioner                1/1       Running   0          4m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="install-cilium">Install Cilium<a class="hash-link" href="#install-cilium" title="Direct link to heading">â€‹</a></h2><p>Kubernetes í´ëŸ¬ìŠ¤í„°ì— Ciliumì„ ì¸ìŠ¤í†¨í•œë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ DaemonSet í˜•íƒœë¡œ ë°°í¬ë˜ê¸° ë•Œë¬¸ì— Nodeë‹¹ í•œê°œì˜ Cilium Podë¥¼ ë³¼ ìˆ˜ ìˆë‹¤. Ciliumì€ <code>kube-system</code> namespaceì—ì„œ ì‹¤í–‰ëœë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create -f https://raw.githubusercontent.com/cilium/cilium/v1.1/examples/kubernetes/1.9/cilium.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">configmap "cilium-config" created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">secret "cilium-etcd-secrets" created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">daemonset.extensions "cilium" created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusterrolebinding.rbac.authorization.k8s.io "cilium" created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusterrole.rbac.authorization.k8s.io "cilium" created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">serviceaccount "cilium" created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>kube-system namespaceì— RBACì„¤ì •ê³¼ í•¨ê»˜ Ciliumì´ ë°°í¬ë˜ê³ , ConfigMap, DaemonSet í˜•íƒœë¡œ ë°°í¬ê°€ ëœë‹¤. </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="check-deployment">Check deployment<a class="hash-link" href="#check-deployment" title="Direct link to heading">â€‹</a></h2><p>Cilium Deploymentê°€ <code>READY</code> ìƒíƒœë¡œ ë°”ë€”ë•Œê¹Œì§€ ê¸°ë‹¤ë¦°ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get daemonsets -n kube-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME      DESIRED   CURRENT   READY     UP-TO-DATE   AVAILABLE   NODE SELECTOR   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cilium    1         1         1         1            0           &lt;none&gt;          2m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="deploy-demo-app">Deploy Demo App.<a class="hash-link" href="#deploy-demo-app" title="Direct link to heading">â€‹</a></h2><p>ì•„ë˜ ë°ëª¨ê·¸ë¦¼ì„ ë³´ë©´ ìŠ¤íƒ€ì›Œì¦ˆì˜ ì˜ê°ì„ ë°›ì•„ì„œì¸ì§€ deathstar, xwing ë“±ìœ¼ë¡œ êµ¬ë¶„í•œê²ƒì„ í™•ì¸í• ìˆ˜ ìˆë‹¤. deathstar deploymentsì˜ ê²½ìš° 80í¬íŠ¸ë¡œ http ì›¹ì„œë²„ê°€ 2ê°œì˜ pod replicaë¡œ Load Balancingë˜ê³  ìˆë‹¤. deathstar ì„œë¹„ìŠ¤ëŠ” ìš°ì£¼ì„ ì´ ì°©ë¥™í• ìˆ˜ ìˆë„ë¡ í™œì£¼ë¡œë¥¼ ì„œë¹„ìŠ¤í•˜ê³  ìˆë‹¤. í•˜ì§€ë§Œ ì œêµ­êµ°ì˜ tiefighter ë§Œ ì°©ë¥™í•˜ë„ë¡ í•´ì•¼í•˜ë¯€ë¡œ ë³´ì•ˆì„¤ì •ì„ í•´ì•¼í•˜ëŠ” ìƒí™©ì´ë‹¤. </p><p><img loading="lazy" src="https://cilium.readthedocs.io/en/v1.1/_images/cilium_http_gsg.png" alt="starwars" class="img_E7b_"></p><p>ì•„ë˜ <code>http-sw-app.yaml</code> ì€ ì„¸ê°€ì§€ deploymentë¥¼ ê°€ì§€ê³  ìˆê³  ê°ê°ì˜ deploymentëŠ” <code>(org=empire, class=deathstar)</code>, <code>(org=empire, class=tiefighter)</code>, <code>(org=alliance, class=xwing)</code>ì™€ ê°™ì´ label ì •ë³´ë¥¼ ê°€ì§„ë‹¤. deathstar ServiceëŠ” <code>(org=empire, class=deathstar)</code> labelì„ ê°€ì§€ê³  Load Balancingì„ í•œë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create -f https://raw.githubusercontent.com/cilium/cilium/v1.1/examples/minikube/http-sw-app.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service "deathstar" created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment "deathstar" created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment "tiefighter" created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment "xwing" created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´ 4ê°œì˜ podì™€ 1ê°œì˜ ì„œë¹„ìŠ¤ë¥¼ í™•ì¸í• ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pods,svc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                             READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/deathstar-566c89f458-mqgfs   1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/deathstar-566c89f458-wlc4c   1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/tiefighter                   1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pod/xwing                        1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                 TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service/deathstar    ClusterIP   10.109.80.174   &lt;none&gt;        80/TCP    1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service/kubernetes   ClusterIP   10.96.0.1       &lt;none&gt;        443/TCP   4h</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê°ê°ì˜ podëŠ” Ciliumì—ì„œëŠ” <a href="https://cilium.readthedocs.io/en/v1.1/concepts/#endpoint" target="_blank" rel="noopener noreferrer">Endpoints</a>í˜•íƒœë¡œ í‘œí˜„ëœë‹¤. ì•„ë˜ì™€ ê°™ì´ ingress, egress policyë¥¼ í™•ì¸í• ìˆ˜ ìˆê³  ì•„ì§ ì•„ë¬´ëŸ° network policy ì ìš©ì„ í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ëª¨ë‘ <code>Disabled</code> ìƒíƒœë¡œ ë³´ì¸ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl -n kube-system get pods -l k8s-app=cilium</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME           READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cilium-jmxk2   1/1       Running   0          4h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl -n kube-system exec cilium-jmxk2 -- cilium endpoint list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENDPOINT   POLICY (ingress)   POLICY (egress)   IDENTITY   LABELS (source:key[=value])                                                    IPv6                 IPv4            STATUS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           ENFORCEMENT        ENFORCEMENT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5023       Disabled           Disabled          2008       k8s:io.cilium.k8s.policy.serviceaccount=istio-ingress-service-account          f00d::a0f:0:0:139f   10.15.170.241   ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:istio=ingress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">7415       Disabled           Disabled          9270       k8s:class=deathstar                                                            f00d::a0f:0:0:1cf7   10.15.16.224    ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.cilium.k8s.policy.serviceaccount=default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:org=empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">7979       Disabled           Disabled          4          reserved:health                                                                f00d::a0f:0:0:1f2b   10.15.96.215    ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">17917      Disabled           Disabled          60941      k8s:class=tiefighter                                                           f00d::a0f:0:0:45fd   10.15.58.61     ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.cilium.k8s.policy.serviceaccount=default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:org=empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22602      Disabled           Disabled          53004      k8s:io.cilium.k8s.policy.serviceaccount=istio-mixer-service-account            f00d::a0f:0:0:584a   10.15.190.2     ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:istio-mixer-type=telemetry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:istio=mixer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">31992      Disabled           Disabled          33709      k8s:io.cilium.k8s.policy.serviceaccount=istio-egressgateway-service-account    f00d::a0f:0:0:7cf8   10.15.85.192    ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:istio=egressgateway</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">33958      Disabled           Disabled          64389      k8s:io.cilium.k8s.policy.serviceaccount=istio-citadel-service-account          f00d::a0f:0:0:84a6   10.15.59.151    ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:istio=citadel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">49215      Disabled           Disabled          40629      k8s:io.cilium.k8s.policy.serviceaccount=istio-mixer-service-account            f00d::a0f:0:0:c03f   10.15.48.171    ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:istio-mixer-type=policy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:istio=mixer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">55129      Disabled           Disabled          9270       k8s:class=deathstar                                                            f00d::a0f:0:0:d759   10.15.17.253    ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.cilium.k8s.policy.serviceaccount=default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:org=empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">55930      Disabled           Disabled          46893      k8s:app=prometheus                                                             f00d::a0f:0:0:da7a   10.15.196.220   ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.cilium.k8s.policy.serviceaccount=prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">57491      Disabled           Disabled          775        k8s:io.cilium.k8s.policy.serviceaccount=istio-mixer-service-account            f00d::a0f:0:0:e093   10.15.253.210   ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:istio=statsd-prom-bridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">57651      Disabled           Disabled          44171      k8s:io.cilium.k8s.policy.serviceaccount=istio-ingressgateway-service-account   f00d::a0f:0:0:e133   10.15.74.164    ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:istio=ingressgateway</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">61352      Disabled           Disabled          888        k8s:io.cilium.k8s.policy.serviceaccount=istio-pilot-service-account            f00d::a0f:0:0:efa8   10.15.118.68    ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=istio-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:istio=pilot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">61355      Disabled           Disabled          36797      k8s:class=xwing                                                                f00d::a0f:0:0:efab   10.15.56.79     ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.cilium.k8s.policy.serviceaccount=default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:io.kubernetes.pod.namespace=default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           k8s:org=alliance</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>í˜„ì¬ ìƒíƒœì—ì„œëŠ” ëª¨ë“  ìš°ì£¼ì„ ì´ deathstarì— ì°©ë¥™ì´ ê°€ëŠ¥í•˜ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl exec xwing -- curl -s -XPOST deathstar.default.svc.cluster.local/v1/request-landing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ship landed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl exec tiefighter -- curl -s -XPOST deathstar.default.svc.cluster.local/v1/request-landing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ship landed</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="l3l4-policy-ì ìš©">L3/L4 Policy ì ìš©<a class="hash-link" href="#l3l4-policy-ì ìš©" title="Direct link to heading">â€‹</a></h2><p>ê²°êµ­ í•˜ê³  ì‹¶ì€ê±´ ì œêµ­êµ° ìš°ì£¼ì„  ì¦‰, tiefighterë§Œ ì ‘ê·¼ì´ ê°€ëŠ¥í•´ì•¼ í•˜ë¯€ë¡œ ì•„ë˜ì²˜ëŸ¼ ì •ì±…ì„ ì„¤ì •í•œë‹¤. </p><p>ì •ì±…ì€ ì§ê´€ì ìœ¼ë¡œ ì„¤ì •ì´ ê°€ëŠ¥í•˜ë‹¤.</p><p><code>org=empire, class=deathstar</code> labelì„ ê°€ì§„ endpointë¡œì˜ ingress ë°©í–¥ì˜ 80í¬íŠ¸ ì ‘ê·¼ì€ <code>org=empire</code> labelì„ ê°€ì§„ podë§Œ ê°€ëŠ¥í•˜ë„ë¡ í•œë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: "cilium.io/v2"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: CiliumNetworkPolicy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">description: "L3-L4 policy to restrict deathstar access to empire ships only"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: "rule1"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  endpointSelector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    matchLabels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      org: empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      class: deathstar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ingress:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - fromEndpoints:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - matchLabels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        org: empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    toPorts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - port: "80"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        protocol: TCP</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë˜ëŠ” </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create -f https://raw.githubusercontent.com/cilium/cilium/v1.1/examples/minikube/sw_l3_l4_policy.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ì™€ ê°™ì´ ì„¤ì •í•˜ê³  ë‚˜ì„œ tiefighterë¥¼ ì°©ë¥™ì‹œì¼œë³´ì.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl exec tiefighter -- curl -s -XPOST deathstar.default.svc.cluster.local/v1/request-landing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ship landed</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì •ìƒì°©ë¥™!<br>
<!-- -->ì´ë²ˆì—ëŠ” xwing ì°¨ë¡€</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl exec xwing -- curl -s -XPOST deathstar.default.svc.cluster.local/v1/request-landing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì°©ë¥™ì‹¤íŒ¨!</p><p>ì´ì–´ì„œ ì •ì±…ì„ ë‹¤ì‹œ í™•ì¸í•´ë³´ë©´ Enabledë¡œ ë³€í•œ ì •ì±… 2ê°œë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br>
<!-- -->(podê°€ 2ê°œì´ë¯€ë¡œ 2ê°œì˜ ì •ì±…ì„ ë³¼ ìˆ˜ ìˆë‹¤)</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl -n kube-system exec cilium-jmxk2 -- cilium endpoint list</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìƒì„¸ ì •ì±… í™•ì¸ (Very Simple!!)</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get cnp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME            AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">istio-sidecar   2h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rule1           5m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$  kubectl describe cnp rule1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name:         rule1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Namespace:    default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Labels:       &lt;none&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Annotations:  &lt;none&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">API Version:  cilium.io/v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Kind:         CiliumNetworkPolicy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Cluster Name:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Creation Timestamp:  2018-07-06T07:25:15Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Generation:          0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Resource Version:    30312</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Self Link:           /apis/cilium.io/v2/namespaces/default/ciliumnetworkpolicies/rule1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UID:                 ba0d7964-80ed-11e8-8077-080027b1075c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Endpoint Selector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Match Labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Any : Class:  deathstar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Any : Org:    empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Ingress:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    From Endpoints:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Match Labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Any : Org:  empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    To Ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Port:      80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Protocol:  TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Status:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Nodes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Minikube:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Enforcing:              true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Last Updated:           0001-01-01T00:00:00Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Local Policy Revision:  65</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Ok:                     true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Events:                       &lt;none&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="l7-ì •ì±…-ì ìš©">L7 ì •ì±… ì ìš©<a class="hash-link" href="#l7-ì •ì±…-ì ìš©" title="Direct link to heading">â€‹</a></h2><p>ë§ˆì§€ë§‰ìœ¼ë¡œ deathstar APIë¥¼ í˜¸ì¶œí•˜ëŠ” ì„œë¹„ìŠ¤ì— ëŒ€í•œ ì •ì±…ì„ ì œì–´í•˜ëŠ”ê²ƒì„ í…ŒìŠ¤íŠ¸í•´ë³¸ë‹¤.</p><p>ì•„ë˜ ì˜ˆì‹œì²˜ëŸ¼ exhaust-port API(í¬íŠ¸ë¥¼ ì†Œì§„ì‹œí‚¤ëŠ” API)ë¥¼ ìˆ˜í–‰í•˜ë©´ íŠ¹ì • podê°€ ì—ëŸ¬ê°€ ë‚˜ê³  ì¬ê¸°ë™ ë˜ëŠ”ê²ƒì„ í™•ì¸í• ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl exec tiefighter -- curl -s -XPUT deathstar.default.svc.cluster.local/v1/exhaust-port</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Panic: deathstar exploded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">goroutine 1 [running]:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">main.HandleGarbage(0x2080c3f50, 0x2, 0x4, 0x425c0, 0x5, 0xa)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /code/src/github.com/empire/deathstar/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        temp/main.go:9 +0x64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">main.main()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /code/src/github.com/empire/deathstar/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        temp/main.go:5 +0x85</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                         READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deathstar-566c89f458-mqgfs   0/1       Error     0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deathstar-566c89f458-wlc4c   1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tiefighter                   1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xwing                        1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                         READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deathstar-566c89f458-mqgfs   1/1       Running   1          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deathstar-566c89f458-wlc4c   1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tiefighter                   1/1       Running   0          1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xwing                        1/1       Running   0          1h</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ê·¸ë˜ì„œ ì´ë²ˆì—ëŠ” exhaust-port APIëŠ” ì°¨ë‹¨í•˜ê³  request-landing APIë§Œ í—ˆìš©í•˜ëŠ” ì •ì±…ì„ í…ŒìŠ¤íŠ¸í•´ë³¸ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: "cilium.io/v2"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: CiliumNetworkPolicy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">description: "L7 policy to restrict access to specific HTTP call"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: "rule1"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  endpointSelector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    matchLabels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      org: empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      class: deathstar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ingress:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - fromEndpoints:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - matchLabels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        org: empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    toPorts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - port: "80"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        protocol: TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      rules:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        http:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - method: "POST"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          path: "/v1/request-landing"</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë˜ëŠ”</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl apply -f https://raw.githubusercontent.com/cilium/cilium/v1.1/examples/minikube/sw_l3_l4_l7_policy.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ciliumnetworkpolicy.cilium.io/rule1 configured</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´í›„ ë™ì¼í•œ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ë©´ ë‹¤ë¥¸ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl exec tiefighter -- curl -s -XPOST deathstar.default.svc.cluster.local/v1/request-landing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ship landed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl exec tiefighter -- curl -s -XPUT deathstar.default.svc.cluster.local/v1/exhaust-port</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Access denied</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ë‹¤ì‹œí•œë²ˆ ìƒì„¸ ì •ì±… í™•ì¸ì„ í•´ë³´ë©´ ingress POST í—ˆìš©ì •ì±…ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl describe ciliumnetworkpolicies rule1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name:         rule1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Namespace:    default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Labels:       &lt;none&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Annotations:  kubectl.kubernetes.io/last-applied-configuration={"apiVersion":"cilium.io/v2","description":"L7 policy to restrict access to specific HTTP call","kind":"CiliumNetworkPolicy","metadata":{"annotations":...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">API Version:  cilium.io/v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Kind:         CiliumNetworkPolicy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Cluster Name:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Creation Timestamp:  2018-07-06T07:25:15Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Generation:          0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Resource Version:    32814</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Self Link:           /apis/cilium.io/v2/namespaces/default/ciliumnetworkpolicies/rule1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UID:                 ba0d7964-80ed-11e8-8077-080027b1075c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Endpoint Selector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Match Labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Any : Class:  deathstar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Any : Org:    empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Ingress:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    From Endpoints:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Match Labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Any : Org:  empire</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    To Ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Port:      80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Protocol:  TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Rules:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Http:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          Method:  POST</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          Path:    /v1/request-landing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Status:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Nodes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Minikube:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Annotations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Kubectl . Kubernetes . Io / Last - Applied - Configuration:  {"apiVersion":"cilium.io/v2","description":"L7 policy to restrict access to specific HTTP call","kind":"CiliumNetworkPolicy","metadata":{"annotations":{},"name":"rule1","namespace":"default"},"spec":{"endpointSelector":{"matchLabels":{"class":"deathstar","org":"empire"}},"ingress":[{"fromEndpoints":[{"matchLabels":{"org":"empire"}}],"toPorts":[{"ports":[{"port":"80","protocol":"TCP"}],"rules":{"http":[{"method":"POST","path":"/v1/request-landing"}]}}]}]}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Enforcing:              true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Last Updated:           0001-01-01T00:00:00Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Local Policy Revision:  70</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Ok:                     true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Events:                       &lt;none&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>cilium CLIë¡œë„ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">î‚° kubectl -n kube-system exec cilium-jmxk2 cilium policy get</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "endpointSelector": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "matchLabels": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "reserved:init": ""</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "ingress": [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "fromEntities": [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "host"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "egress": [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "toPorts": [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "ports": [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "port": "53",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "protocol": "UDP"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "toEntities": [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          "all"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "toEndpoints": [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "matchLabels": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "k8s:io.kubernetes.pod.namespace": "istio-system"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "labels": [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "key": "io.cilium.k8s.policy.name",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "value": "istio-sidecar",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "source": "k8s"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "key": "io.cilium.k8s.policy.namespace",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "value": "default",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "source": "k8s"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "endpointSelector": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      "matchLabels": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "any:class": "deathstar",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "any:org": "empire",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "k8s:io.kubernetes.pod.namespace": "default"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "ingress": [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "fromEndpoints": [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "matchLabels": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "any:org": "empire",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "k8s:io.kubernetes.pod.namespace": "default"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "toPorts": [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "ports": [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "port": "80",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                "protocol": "TCP"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "rules": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              "http": [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  "path": "/v1/request-landing",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  "method": "POST"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "labels": [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "key": "io.cilium.k8s.policy.name",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "value": "rule1",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "source": "k8s"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "key": "io.cilium.k8s.policy.namespace",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "value": "default",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        "source": "k8s"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Revision: 71</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´ì™¸ì—ë„ Cilium Metricì„ Prometheusì—ì„œ í™•ì¸í•˜ëŠ”ê²ƒë„ ê°„ë‹¨í•˜ê²Œ í• ìˆ˜ ìˆë‹¤ê³  í•œë‹¤. </p><p>ì—¬ê¸°ê¹Œì§€ê°€ ê¸°ë³¸ì ìœ¼ë¡œ L3/L4, L7 ê¸°ë°˜ network policyë¥¼ ì ìš©í•´ë³¸ê²ƒì´ê³  ë‹¤ìŒë²ˆì—ëŠ” istioì™€ ì—°ê³„ ë¶€ë¶„ì´ë‚˜ ì‹¤ì œ Cluster êµ¬ì„±ë°©ë²•ì— ëŒ€í•´ì„œ ë‹¤ë¤„ë³´ë„ë¡ í•˜ê² ë‹¤.</p>]]></content>
        <category label="Cilium" term="Cilium"/>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="network policy" term="network policy"/>
        <category label="Istio" term="Istio"/>
        <category label="BPF" term="BPF"/>
        <category label="CNI" term="CNI"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Spinnaker on Kubernetes #1]]></title>
        <id>kubernetes/spinnaker-advanced-1/</id>
        <link href="https://ddii.dev/kubernetes/spinnaker-advanced-1/"/>
        <updated>2018-07-03T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Spinnakerì— ëŒ€í•´ ì•Œì•„ë´…ë‹ˆë‹¤ #1]]></summary>
        <content type="html"><![CDATA[<p>ì§€ë‚œë²ˆ <a href="https://www.slideshare.net/openstack_kr/openinfra-days-korea-2018-track-4-provisioning-dedicated-game-server-on-kubernetes-cluster" target="_blank" rel="noopener noreferrer">OpenInfraDayë°œí‘œ</a>ë•Œ ì§ˆë¬¸ì„ í•´ì£¼ì…¨ëŠ”ë° ìš”ì¦˜ Spinnakerë¥¼ ë§ì´ë“¤ ì“°ê±°ë‚˜ ê²€í† ë¥¼ ë§ì´ í•˜ëŠ”ê²ƒìœ¼ë¡œ ì•Œê³  ìˆë‹¤.  </p><p>Spinnakerë¥¼ ì„¤ì¹˜í•˜ëŠ” ë‚´ìš©ì€ ë§ì´ ìˆìœ¼ë‹ˆ ì•„ë˜ halyardë¡œ ì„¤ì¹˜í•˜ëŠ” í¬ìŠ¤íŠ¸ë¥¼ ì°¸ê³ í•˜ë©´ ëœë‹¤.</p><p><a href="https://yunsangjun.github.io/blog/spinnaker/2018/06/03/installing-spinnaker.html" target="_blank" rel="noopener noreferrer">ìœ¤ìƒì¤€ì˜ ê¸°ìˆ  ë¸”ë¡œê·¸ - Spinnaker ì„¤ì¹˜í•˜ê¸°</a></p><p>ì´ë²ˆì— ì´ì•¼ê¸°í•˜ê³ ì í•˜ëŠ” ë¶€ë¶„ì€ ì‹¤ì œ Spinnakerë¥¼ ì„¤ì¹˜í•˜ê³  ë‚œ í›„ ìš´ì˜ìƒì— ê³ ë ¤í•´ì•¼í•  ë¶€ë¶„ë“¤ê³¼ íŒë“¤ì„ ê³µìœ í•´ë³´ë ¤ê³  í•œë‹¤.</p><p>ì‚¬ì‹¤ Spinnakerë¥¼ êµ¬ì„±í•˜ë©´ì„œ ê°€ì¥ ì–´ë ¤ì› ë˜ ë¶€ë¶„ë“¤ì€ ìš©ì–´, halyard config ê´€ë¦¬ì™€ custom resourse ì¸ì‹ë¶€ë¶„ ì´ì˜€ë‹¤. ë‚˜ë¨¸ì§€ë“¤ì€ ë­ íŠœí† ë¦¬ì–¼ì„ ë”°ë¼ê°€ë©´ ë³„ë¡œ ì–´ë µì§„ ì•Šìœ¼ë‹ˆ ì•„ë˜ ë‚´ìš©ì„ ì°¨ê·¼ì°¨ê·¼ ë”°ë¼ê°€ë©´ì„œ ì´í•´í•˜ë©´ ë ê²ƒ ê°™ë‹¤. </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ìš©ì–´ë“¤">ìš©ì–´ë“¤<a class="hash-link" href="#ìš©ì–´ë“¤" title="Direct link to heading">â€‹</a></h2><p>ì‚¬ìš©í•˜ë©´ì„œ í˜¼ëˆì´ ë§ì´ ìƒê¸°ëŠ” ë¶€ë¶„ì´ë‹¤ ì´ê²Œ GCEë‚˜ EC2ë¥¼ ì“°ë©´ ìš©ì–´ ë§¤ì¹­ì´ ì‰¬ìš´ë° k8së¥¼ ìœ„í•œ ë³„ë„ì˜ ë©”ë‰´ê°€ ì•„ë‹Œ ê¸°ëŠ¥ì„ í†µí•©í•˜ë‹¤ë³´ë‹ˆ ìš©ì–´ê°€ ì¡°ê¸ˆ í˜¼ë™ìŠ¤ëŸ½ê²Œ êµ¬ì„±ì´ ë˜ì—ˆë‹¤.<br>
<!-- -->íŠ¹íˆ Load Balancer ë¶€ë¶„ì€ Serviceë¡œ ë§¤í•‘ë˜ê³  í¼ë¸”ë¦­ k8sì—ì„œ ì œê³µí•˜ëŠ” Type LoadBalancerëŠ” ë¯¸ì§€ì›í•œë‹¤.<br>
<!-- -->ê·¸ë¦¬ê³  ëª¨ë“  Resourceë“¤ì€ Deploy, Delete, Scale, Rollout(Undo, Pause, Resume)ì„ ì§€ì›í•˜ë©° Versioningì´ ì§€ì›ëœë‹¤.  Versioningì€ <a href="https://www.spinnaker.io/reference/providers/kubernetes-v2/#strategy" target="_blank" rel="noopener noreferrer">ì—¬ê¸°</a>ì— ì„¤ëª…ëœ ëŒ€ë¡œ <code>strategy.spinnaker.io/versioned</code> annotationì„ í†µí•´ manifestë³„ë¡œ ì¬ì •ì˜ê°€ ê°€ëŠ¥í•˜ë‹¤.</p><table><thead><tr><th align="center">Spinnaker</th><th align="center">Kubernetes</th><th align="center">ë¹„ê³ </th></tr></thead><tbody><tr><td align="center">Server Group</td><td align="center"><a href="https://www.spinnaker.io/reference/providers/kubernetes-v2/#workloads" target="_blank" rel="noopener noreferrer">Workloads</a></td><td align="center"><a href="https://www.spinnaker.io/guides/developer/crd-extensions/" target="_blank" rel="noopener noreferrer">CRDì˜ ê²½ìš° ë³„ë„ Build</a></td></tr><tr><td align="center">Clusters</td><td align="center">Logical Server Group</td><td align="center"></td></tr><tr><td align="center">Load Balancer</td><td align="center">Services</td><td align="center">LoadBalancer(k8s) ë¯¸ì§€ì›</td></tr><tr><td align="center">Firewall</td><td align="center">NetworkPolicies</td><td align="center"></td></tr></tbody></table><p>Spinnaker Server Groupìœ¼ë¡œ ë¶„ë¥˜ ëœ í•­ëª©ì€ ëª¨ë‘ Spinnakerì˜ í´ëŸ¬ìŠ¤í„° íƒ­ì— í‘œì‹œê°€ ëœë‹¤. ê°€ëŠ¥í•œ ê²½ìš° ëª¨ë“  í¬ë“œê°€ í‘œê¸°ë˜ì§€ë§Œ, í•´ë‹¹ <a href="https://www.spinnaker.io/reference/providers/kubernetes-v2/#workloads" target="_blank" rel="noopener noreferrer">Workloads</a> ì´ì™¸ì˜ CRD(Custom Resource Definition)ëŠ” halconfigì—ì„œ ì•„ë˜ì™€ ê°™ì´ customResources configë¥¼ ì¶”ê°€í•˜ë©´ deployëŠ” ê°€ëŠ¥í•˜ë‚˜ Spinnaker UIì—ì„œ ë³´ì´ì§€ëŠ” ì•ŠëŠ”ë‹¤.  </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubernetes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      enabled: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      accounts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: my-k8s-account</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        customResources:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - kubernetesKind: GameServer</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì´ìœ ëŠ” ë°”ë¡œ ë‹¤ìŒ ë§í¬ì²˜ëŸ¼ <a href="https://www.spinnaker.io/guides/developer/crd-extensions/" target="_blank" rel="noopener noreferrer">(CRDì˜ ê²½ìš° ë³„ë„ Buildí•„ìš”)</a>
ë³„ë„ë¡œ Javaë¥¼ ë¹Œë“œí•´ì•¼ í•œë‹¤. Spinnaker Slackì— ë¬¸ì˜ë¥¼ ëª‡ë²ˆí–ˆëŠ”ë° ì§ˆë¬¸í•˜ëŠ” ì‚¬ëŒë§Œ ìˆê³  ë‹µì€ ì•„ë¬´ë„ ì•ˆí•´ì¤€ë‹¤ëŠ”...<br>
<a href="https://spinnakerteam.slack.com/" target="_blank" rel="noopener noreferrer">https://spinnakerteam.slack.com/</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="jenkins-ì—°ë™">Jenkins ì—°ë™<a class="hash-link" href="#jenkins-ì—°ë™" title="Direct link to heading">â€‹</a></h2><p><a href="https://www.spinnaker.io/setup/ci/jenkins/" target="_blank" rel="noopener noreferrer">Spinnaker, Jenkins integration ìƒì„¸ë‚´ìš© ê³µì‹ë¬¸ì„œ </a></p><p>Jenkinsì™€ ì—°ë™í•˜ë©´ì„œ ê°€ì¥ ì–´ì´ì—†ì´ í—¤ë§¨ë¶€ë¶„ì€ ì•„ë˜ ê·¸ë¦¼ì²˜ëŸ¼ ë˜ì–´ìˆì–´ì•¼ í•˜ëŠ”ë° Security Realmì„ Jenkins Default admin ê³„ì •ë§Œì„ ê°€ì§€ê³  integration í•˜ë ¤ë‹¤ê°€ ê³„ì† ì‹¤íŒ¨í•˜ì˜€ë‹¤. Delegate to servlet container ë§ê³  Jenkins ìì²´ ì‚¬ìš©ì DBë¡œ ë³„ë„ ê³„ì •ì„ ìƒì„±í•˜ê³  ì•„ë˜ ê·¸ë¦¼ì²˜ëŸ¼ ì„¤ì •ì„ í•´ì•¼í•œë‹¤.</p><p><img loading="lazy" alt="Jenkins Config" src="/assets/images/jenkins_config-ebc060e294614bf3e83967c95b1cb527.png" width="896" height="778" class="img_E7b_"></p><p>ìœ„ ì„¤ì • ì´í›„ ì•„ë˜ì™€ ê°™ì´ Spinnaker UIì—ì„œ Jenkins APIì—°ë™ì´ ê°€ëŠ¥í•˜ë‹¤.  </p><p><img loading="lazy" alt="Spinnaker Jenkins" src="/assets/images/spin_jenkins-dd2e9b5ec5faf44637c141dba0020e45.png" width="1176" height="888" class="img_E7b_"></p><p>ì˜¤ëŠ˜ì€ ì—¬ê¸°ê¹Œì§€ë§Œ í•˜ê³  ë‹¤ìŒê¸€ì—ì„œëŠ” ë°°í¬ì „ëµì´ë‚˜ Network Policy ì—°ë™ë“±ì„ ìƒì„¸íˆ ì ì–´ë³¼ ì˜ˆì •ì´ë‹¤.</p>]]></content>
        <category label="CI/CD" term="CI/CD"/>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="Spinnaker" term="Spinnaker"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Provisioning Dedicated Game Server on Kubernetes Cluster]]></title>
        <id>kubernetes/openinfraday18/</id>
        <link href="https://ddii.dev/kubernetes/openinfraday18/"/>
        <updated>2018-07-01T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Provisioning Dedicated Game Server on Kubernetes Cluster]]></summary>
        <content type="html"><![CDATA[<p>6ì›” 28ì¼ì— Openinfradayì—ì„œ ë°œí‘œí•œ ë‚´ìš©</p><p><a href="https://www.slideshare.net/openstack_kr/openinfra-days-korea-2018-track-4-provisioning-dedicated-game-server-on-kubernetes-cluster" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="https://image.slidesharecdn.com/43dgs06270307-180628163517/95/openinfra-days-korea-2018-track-4-provisioning-dedicated-game-server-on-kubernetes-cluster-1-638.jpg?cb=1530203766" alt="Slideshare" class="img_E7b_"></a></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ë°œí‘œ-ì˜ìƒ">ë°œí‘œ ì˜ìƒ<a class="hash-link" href="#ë°œí‘œ-ì˜ìƒ" title="Direct link to heading">â€‹</a></h2><p><a href="https://youtu.be/LtGGzKBoVZQ?t=0s" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="http://img.youtube.com/vi/LtGGzKBoVZQ/0.jpg" alt="Video" class="img_E7b_"></a></p><p>Custom Resource ì— ëŒ€í•œ ë‚´ìš©ì€ ìƒì„¸í•˜ê²Œ ë” ì •ë¦¬í•´ì•¼ê² ë‹¤.</p>]]></content>
        <category label="CI/CD" term="CI/CD"/>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="Agones" term="Agones"/>
        <category label="Spinnaker" term="Spinnaker"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Mutating Webhook]]></title>
        <id>kubernetes/mutating-web-hook/</id>
        <link href="https://ddii.dev/kubernetes/mutating-web-hook/"/>
        <updated>2018-06-27T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Mutating Webhookì— ëŒ€í•´ ì•Œì•„ë´…ë‹ˆë‹¤]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="admission-controller-í™•ì¥">Admission controller í™•ì¥<a class="hash-link" href="#admission-controller-í™•ì¥" title="Direct link to heading">â€‹</a></h2><p>Kubernetes(ì´í•˜ k8s)ê¸°ë°˜ ê°œë°œ ê³¼ì œë¥¼ ìˆ˜í–‰í•˜ë‹¤ë³´ë‹ˆ Custom Resourceë¥¼ ì‚¬ìš©í• ìˆ˜ ë°–ì— ì—†ëŠ” ìƒí™©ë“¤ì´ ë°œìƒí•˜ì˜€ë‹¤.<br>
<!-- -->ê·¸ëŸ° ì™€ì¤‘ì— istioì™€ ê°™ì€ Service Mesh Layerë¥¼ ë¦¬ì„œì¹˜í•˜ë˜ ì¤‘ì— íŠ€ì–´ë‚˜ì˜¨ MutatingAdmissionWebhook ìš©ì–´ë¥¼ ì´í•´í•˜ê¸° ìœ„ì— ì¡°ì‚¬í•œ ë‚´ìš©ì„ ì •ë¦¬í•´ë³¸ë‹¤.</p><p><a href="https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/</a></p><p>Admission controllerëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ api-serverì˜ ì˜¤ë¸Œì íŠ¸(Pod,ë“±) ìƒì„± ìš”ì²­ì„ ê°€ë¡œì²´ì–´ ì œì–´ë¥¼ í•  ìˆ˜ ìˆëŠ” í™•ì¥ ê¸°ëŠ¥ìœ¼ë¡œ í”ŒëŸ¬ê·¸ì¸ í˜•íƒœë¡œ ì‚¬ìš©ìê°€ ì¶”ê°€ í•  ìˆ˜ ìˆë‹¤.<br>
<!-- -->ì¢€ë” ìì„¸íˆ í™•ì¸í•´ë³´ì </p><ul><li>í´ëŸ¬ìŠ¤í„° ê´€ë¦¬ìê°€ kube-apië¥¼ ì§ì ‘ ì»´íŒŒì¼ í•˜ê³  êµ¬ì„±í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ìœ ì—°í•˜ê²Œ ì‚¬ìš©í•˜ê¸° ì–´ë ¤ì›€</li><li>1.7 ë²„ì „ ì´í›„ë¶€í„°ëŠ” ì´ëŸ¬í•œ ì œí•œì‚¬í•­ì„ í•´ê²°í•˜ê¸° ìœ„í•´ alpha featureë¡œ  <a href="https://v1-9.docs.kubernetes.io/docs/admin/extensible-admission-controllers/#initializers" target="_blank" rel="noopener noreferrer">Initializers</a> ì™€ <a href="https://v1-9.docs.kubernetes.io/docs/admin/extensible-admission-controllers/#external-admission-webhooks" target="_blank" rel="noopener noreferrer">External Admission Webhooks</a> ê¸°ëŠ¥ì´ ë„ì…ë¨</li><li>External Admission Webhooks ëŠ” k8s ë¦¬ì†ŒìŠ¤ì˜ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í•˜ëŠ”ë° í™œìš©, ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í†µê³¼ í•˜ì§€ ëª»í•˜ë©´ í•´ ë‹¹ ë¦¬ì†ŒìŠ¤ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œ ìƒì„±ë˜ì§ˆ ì•Šê²Œ í•  ìˆ˜ ìˆìŒ.</li><li>1.9 ë²„ì „ì—ì„œëŠ” External Admission Webhooks ì€ betaë¡œ ìŠ¹ê²©ë˜ì–´ MutatingAdmissionWebhook ë° ValidatingAdmissionWebhookìœ¼ë¡œ ë‚˜ëˆ ì¡Œì§€ë§Œ Initializers ëŠ” alpha ë¡œ ìœ ì§€ë¨</li><li>MutatingAdmissionWebhook ì€ ìœ íš¨ì„± ê²€ì‚¬ ì´ì™¸ì—ë„ ìŠ¹ì¸ ê³¼ì •ì‹œ k8s objectì— ë³€ê²½ì„ í• ìˆ˜ ìˆìŒ<ul><li>ì˜ˆë¥¼ ë“¤ë©´ resource quotaë¥¼ ë³€ê²½í•œë‹¤ë˜ì§€  Agones ë° istioì™€ ê°™ì€ Custom Resource ë¥¼ ìˆ˜ì •í•˜ì—¬ objectë¥¼ ìƒì„±ì´ ê°€ëŠ¥í•¨</li><li>Webhook ë°©ì‹ì€ gRPC í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ëŠ” ë° ê°œë°œì–¸ì–´ì— êµ¬ì•  ë°›ì§€ ì•Šê³  í™•ì¥ì„ í•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆìŒ</li></ul></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="webhookì„-ì–¸ì œ-ì“°ëŠ”ê°€">Webhookì„ ì–¸ì œ ì“°ëŠ”ê°€?<a class="hash-link" href="#webhookì„-ì–¸ì œ-ì“°ëŠ”ê°€" title="Direct link to heading">â€‹</a></h2><p>Webhookì„ ì‚¬ìš©í•˜ì—¬ k8s cluster-adminì´ api-serverë¥¼ ë‹¤ì‹œ ì»´íŒŒì¼í•˜ì§€ ì•Šê³ ë„ objectìƒì„± ìš”ì²­ì‹œ mutating(ë³€ê²½) ë° validation(ìœ íš¨ì„±ê²€ì¦) ì„ í•˜ëŠ” í”ŒëŸ¬ê·¸ì¸ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤. </p><p>ì´ë¥¼ í†µí•´ ê°œë°œìëŠ” ëª¨ë“  resource ì—ì„œ ì—¬ëŸ¬ ì‘ì—… ( "CREATE", "UPDATE", "DELETE"...)ì— ëŒ€í•œ ìŠ¹ì¸ ë¡œì§ì— ëŒ€í•´ ì‚¬ìš©ì ì •ì˜ í•  ìˆ˜ìˆëŠ” ìœ ì—°ì„±ì„ ì œê³µë°›ëŠ”ë‹¤.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="use-case">Use-Case<a class="hash-link" href="#use-case" title="Direct link to heading">â€‹</a></h2><ul><li><p>resourceë¥¼ ìƒì„±í•˜ê¸° ì „ì— ë³€ê²½<br>
<!-- -->(ì˜ˆ, Istio ì—ì„œ ì²˜ëŸ¼ traffic management ì™€ policy enforcement ì„ ìœ„í•´ Envoy sidecar containerë¥¼ injection)</p></li><li><p>StorageClass Provisioning ìë™í™”<br>
<!-- -->(PersistentVolumeClaim object ìƒì„±ì„ ëª¨ë‹ˆí„°ë§í•˜ê³  ë¯¸ë¦¬ ì •ì˜ ëœ ì •ì±…ì— ë”°ë¼ ê°ì²´ì— storageë¥¼ ìë™ìœ¼ë¡œ ì¶”ê°€. ì‚¬ìš©ìëŠ” StorageClass ìƒì„± ì— ì‹ ê²½ ì“¸ í•„ìš”ê°€ ì—†ìŒ)</p></li><li><p>ë³µì¡í•œ custom resource ê²€ì¦ (Agonesì™€ ê°™ì€)namespace ì œí•œ<br>
<!-- -->ë©€í‹° í…Œë„ŒíŠ¸ ì‹œìŠ¤í…œì—ì„œëŠ” reserved namespaceì— resourceìƒì„±ì„ ê¸ˆì§€ì‹œí‚¬ë•Œ ì‚¬ìš©í• ìˆ˜ ìˆìŒ</p></li><li><p>ì°¸ê³  ì˜ˆì‹œ<br>
<a href="https://github.com/kelseyhightower/denyenv-validating-admission-webhook" target="_blank" rel="noopener noreferrer">https://github.com/kelseyhightower/denyenv-validating-admission-webhook</a></p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì–´ë–»ê²Œ-ë™ì‘í•˜ëŠ”ê°€">ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ê°€?<a class="hash-link" href="#ì–´ë–»ê²Œ-ë™ì‘í•˜ëŠ”ê°€" title="Direct link to heading">â€‹</a></h2><p>MutatingWebhookConfiguration ë‚´ì— ì •ì˜ëœ ë£°ì— ë”°ë¼ etcdë¡œ ì „ë‹¬ë˜ê¸° ì „ì— requestë¥¼ interceptí•œë‹¤.<br>
<!-- -->webhook ì„œë²„ì— ìŠ¹ì¸ ìš”ì²­ì„ ì „ì†¡í•˜ì—¬ ë³€ì´ë¥¼ ì‹¤í–‰í•œë‹¤.<br>
<!-- -->webhook ì„œë²„ëŠ” APIë¥¼ ì¤€ìˆ˜í•˜ëŠ” ë‹¨ìˆœí•œ httpì„œë²„.</p><p><img loading="lazy" alt="Alt text" src="/assets/images/mutating-b4b8965d675e621d8560c81accf497c7.jpg" width="1600" height="1643" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="íŠœí† ë¦¬ì–¼">íŠœí† ë¦¬ì–¼<a class="hash-link" href="#íŠœí† ë¦¬ì–¼" title="Direct link to heading">â€‹</a></h2><p><a href="https://github.com/morvencao/kube-mutating-webhook-tutorial" target="_blank" rel="noopener noreferrer">https://github.com/morvencao/kube-mutating-webhook-tutorial</a>  </p><p>ìœ„ íŠœí† ë¦¬ì–¼ì€ objectê°€ ìƒì„±ë˜ê¸° ì „ì— podì— nginx sidecar containerë¥¼ injectí•˜ëŠ” MutatingAdmissionWebhookì„ ë°°í¬í•˜ëŠ” ë‚´ìš©ì„ ë‹´ê³  ìˆë‹¤.</p><p>ìš°ì„  admissionregistration.k8s.io/v1beta1 APIë¥¼ ì‚¬ìš©í• ìˆ˜ ìˆëŠ” k8s 1.9+ ì´ìƒì˜ í´ëŸ¬ìŠ¤í„°ê°€ í•„ìš”í•˜ë‹¤.  </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="í™•ì¸ë°©ë²•">í™•ì¸ë°©ë²•<a class="hash-link" href="#í™•ì¸ë°©ë²•" title="Direct link to heading">â€‹</a></h2><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl api-versions | grep admissionregistration.k8s.io/v1beta1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì™€ì•¼í•¨</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">admissionregistration.k8s.io/v1beta1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="buildí•˜ê¸°">Buildí•˜ê¸°<a class="hash-link" href="#buildí•˜ê¸°" title="Direct link to heading">â€‹</a></h2><p>ì¼ë‹¨ Goê°€ ì„¤ì¹˜ë˜ì–´ ìˆì–´ì•¼ í•œë‹¤.
<code>~/go/src</code> ì•„ë˜ì— cloneì„ í•˜ì˜€ìŒ.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ cd ~/go/src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git clone https://github.com/morvencao/kube-mutating-webhook-tutorial.git</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ì˜ì¡´ì„± ê´€ë¦¬ë¥¼ ìœ„í•´ repoëŠ” depë¥¼ ì‚¬ìš©í•¨</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ cd kube-mutating-webhook-tutorial</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ go get -u github.com/golang/dep/cmd/dep</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>build íŒŒì¼ í™•ì¸í•˜ê³  registry ìœ„ì¹˜ë¥¼ ë°”ê¿ˆ</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">dep ensure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -o kube-mutating-webhook-tutorial .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker build --no-cache -t registry.*****.io/agones/sidecar-injector:v1 .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rm -rf kube-mutating-webhook-tutorial</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker push registry.*****.io/agones/sidecar-injector:v1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>buildí•˜ê³  docker image push</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sending build context to Docker daemon  44.29MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Step 1/3 : FROM alpine:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ---&gt; 3fd9065eaf02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Step 2/3 : ADD kube-mutating-webhook-tutorial /kube-mutating-webhook-tutorial</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ---&gt; 8679ccbab536</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Step 3/3 : ENTRYPOINT ["./kube-mutating-webhook-tutorial"]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ---&gt; Running in 7699ff5c0885</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Removing intermediate container 7699ff5c0885</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ---&gt; 2014100d460e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Successfully built 2014100d460e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Successfully tagged registry.*****.io/agones/sidecar-injector:v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The push refers to repository [registry.*****.io/agones/sidecar-injector]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2456c1309a51: Pushed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd7100a72410: Layer already exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">v1: digest: sha256:15c335daeba40ddcbfbc3631ab6daa7cf623b63420f0ae8b657755322ef0582d size: 739</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>sidecar deploymentì— ì‚¬ìš©ë˜ëŠ” secret(cert/key)ì„ ìƒì„±í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">./deployment/webhook-create-signed-cert.sh \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --service sidecar-injector-webhook-svc \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --secret sidecar-injector-webhook-certs \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --namespace default</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìœ„ì—ì„œ ìƒì„±ëœ í´ëŸ¬ìŠ¤í„°ì˜ caBundleê°’ì„ ê°€ì§€ê³  MutatingWebhookConfiguration ìƒì„±í•œë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cat deployment/mutatingwebhook.yaml | \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    deployment/webhook-patch-ca-bundle.sh &gt; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    deployment/mutatingwebhook-ca-bundle.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>resourceë“¤ deploy</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create -f deployment/nginxconfigmap.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create -f deployment/configmap.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create -f deployment/deployment.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create -f deployment/service.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create -f deployment/mutatingwebhook-ca-bundle.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">configmap "nginx-configmap" created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">configmap "sidecar-injector-webhook-configmap" created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment.extensions "sidecar-injector-webhook-deployment" created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service "sidecar-injector-webhook-svc" created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mutatingwebhookconfiguration.admissionregistration.k8s.io "sidecar-injector-webhook-cfg" created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>webhook deployment í™•ì¸</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pods</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                                   READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sidecar-injector-webhook-deployment-796955558f-js6bb   1/1       Running   0          3m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                  DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sidecar-injector-webhook-deployment   1         1         1            1           3m</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>default ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— sidecar-injector ë¼ë²¨ë§ì„ í•œë‹¤. ì´ë ‡ê²Œ í•˜ë©´ í•´ë‹¹ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ìƒì„±ë˜ëŠ” ëª¨ë“  appì— ìë™ìœ¼ë¡œ injectioní•˜ê²Œ ë¨</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get namespace -L sidecar-injector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME             STATUS    AGE       SIDECAR-INJECTOR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">agones-system    Active    1d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default          Active    19d       enabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ibm-cert-store   Active    19d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ibm-system       Active    19d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ingress-test     Active    6d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-public      Active    19d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system      Active    19d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spinnaker        Active    12d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xonotic          Active    1d</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>ìƒ˜í”Œì•±ì„ ë””í”Œë¡œì´ í•´ë³´ì</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ cat &lt;&lt;EOF | kubectl create -f -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: extensions/v1beta1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: sleep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  replicas: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  template:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      annotations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sidecar-injector-webhook.morven.me/inject: "yes"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        app: sleep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: sleep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        image: tutum/curl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        command: ["/bin/sleep","infinity"]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        imagePullPolicy:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deployment.extensions "sleep" created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>sidecar container injection í™•ì¸<br>
<!-- -->ì•„ë˜ ê²°ê³¼ë¥¼ ë³´ë©´ í•˜ë‚˜ì˜ deployment í•˜ë‚˜ì˜ container ìƒì„±ì„ ìš”ì²­í–ˆì§€ë§Œ nginx sidecar ì»¨í…Œì´ë„ˆê°€ injection ëœê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                                   READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sidecar-injector-webhook-deployment-796955558f-js6bb   1/1       Running   0          2h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sleep-74b46f8bd7-r9l7f                                 2/2       Running   0          42s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl describe pod sleep-74b46f8bd7-r9l7f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name:           sleep-74b46f8bd7-r9l7f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Namespace:      default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Node:           10.178.188.16/10.178.188.16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Start Time:     Wed, 27 Jun 2018 13:12:47 +0900</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Labels:         app=sleep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                pod-template-hash=3060294683</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Annotations:    kubernetes.io/psp=ibm-privileged-psp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                sidecar-injector-webhook.morven.me/inject=yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                sidecar-injector-webhook.morven.me/status=injected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Status:         Running</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IP:             172.30.169.30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Controlled By:  ReplicaSet/sleep-74b46f8bd7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  sleep:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Container ID:  docker://728ca7f8e741ad29369312bc006c79683e7e605f3b04586df2477e233f93e451</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Image:         tutum/curl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Image ID:      docker-pullable://tutum/curl@sha256:b6f16e88387acd4e6326176b212b3dae63f5b2134e69560d0b0673cfb0fb976f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Port:          &lt;none&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Host Port:     &lt;none&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Command:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      /bin/sleep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      infinity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    State:          Running</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Started:      Wed, 27 Jun 2018 13:13:01 +0900</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Ready:          True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Restart Count:  0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Environment:    &lt;none&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Mounts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      /var/run/secrets/kubernetes.io/serviceaccount from default-token-czzpj (ro)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  sidecar-nginx:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Container ID:   docker://94fd41a0e153de6d5639873ccbd6b6325cee1ea8351dd02ab4a48ab4004d0b58</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Image:          nginx:1.12.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Image ID:       docker-pullable://nginx@sha256:72daaf46f11cc753c4eab981cbf869919bd1fee3d2170a2adeac12400f494728</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Port:           80/TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Host Port:      0/TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    State:          Running</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Started:      Wed, 27 Jun 2018 13:13:08 +0900</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Ready:          True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Restart Count:  0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Environment:    &lt;none&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Mounts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      /etc/nginx from nginx-conf (rw)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Conditions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Type           Status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Initialized    True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Ready          True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  PodScheduled   True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  default-token-czzpj:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Type:        Secret (a volume populated by a Secret)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SecretName:  default-token-czzpj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Optional:    false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  nginx-conf:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Type:        ConfigMap (a volume populated by a ConfigMap)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Name:        nginx-configmap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Optional:    false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">QoS Class:       BestEffort</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Node-Selectors:  &lt;none&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Tolerations:     node.kubernetes.io/not-ready:NoExecute for 300s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 node.kubernetes.io/unreachable:NoExecute for 300s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Events:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Type    Reason                 Age   From                    Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ----    ------                 ----  ----                    -------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal  Scheduled              1m    default-scheduler       Successfully assigned sleep-74b46f8bd7-r9l7f to 10.178.188.16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal  SuccessfulMountVolume  1m    kubelet, 10.178.188.16  MountVolume.SetUp succeeded for volume "nginx-conf"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal  SuccessfulMountVolume  1m    kubelet, 10.178.188.16  MountVolume.SetUp succeeded for volume "default-token-czzpj"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal  Pulling                1m    kubelet, 10.178.188.16  pulling image "tutum/curl"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal  Pulled                 55s   kubelet, 10.178.188.16  Successfully pulled image "tutum/curl"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal  Created                55s   kubelet, 10.178.188.16  Created container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal  Started                55s   kubelet, 10.178.188.16  Started container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal  Pulling                55s   kubelet, 10.178.188.16  pulling image "nginx:1.12.2"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal  Pulled                 48s   kubelet, 10.178.188.16  Successfully pulled image "nginx:1.12.2"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal  Created                48s   kubelet, 10.178.188.16  Created container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal  Started                48s   kubelet, 10.178.188.16  Started container</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ì •ë¦¬">ì •ë¦¬<a class="hash-link" href="#ì •ë¦¬" title="Direct link to heading">â€‹</a></h2><p>ê²°êµ­ ìœ„ì—ì„œ ì–¸ê¸‰í•œê²ƒ ì²˜ëŸ¼ MutationWebhookì€ istio RouteRuleê°™ì€ ë³„ë„ì˜ CustomResourceë“±ì„ injection í•˜ê±°ë‚˜ agones ë“±ê³¼ ê°™ì´ ê²Œì„ì„œë²„ì™¸ì— client sdk í†µì‹ ì„ ìœ„í•œ injection í˜•íƒœë¡œ ê¸°ì¡´ resourceì— ì¶”ê°€ì ì¸ ë³€ê²½(mutation) ë˜ëŠ” ê²€ì¦(validation)ë“±ì˜ ì¶”ê°€ì ì¸ ì‘ì—…ì„ kube-apiì˜ ì»´íŒŒì¼ì—†ì´ ê°€ëŠ¥í•˜ë‹¤ëŠ”ë° ëª©ì ì´ ìˆë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤. ì¶”ê°€ì ìœ¼ë¡œ ê¸°ëŠ¥ì— ëŒ€í•œ ë‚´ìš©ì€ ì´í›„ ë‹¤ì‹œ ì •ë¦¬í•´ë³¼ ì˜ˆì •ì´ë‹¤.</p>]]></content>
        <category label="Mutating Webhook" term="Mutating Webhook"/>
        <category label="Kubernetes" term="Kubernetes"/>
        <category label="Admission Controller" term="Admission Controller"/>
        <category label="Istio" term="Istio"/>
        <category label="Agones" term="Agones"/>
    </entry>
</feed>