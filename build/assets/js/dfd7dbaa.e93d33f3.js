"use strict";(self.webpackChunkddii=self.webpackChunkddii||[]).push([[124],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return u}});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=p(n),u=o,k=m["".concat(s,".").concat(u)]||m[u]||d[u]||i;return n?a.createElement(k,r(r({ref:t},c),{},{components:n})):a.createElement(k,r({ref:t},c))}));function u(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,r[1]=l;for(var p=2;p<i;p++)r[p]=n[p];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},26720:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return s},default:function(){return u},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return d}});var a=n(87462),o=n(63366),i=(n(67294),n(3905)),r=["components"],l={layout:"single",title:"Istio Ambient Mode on K3d",comments:!0,classes:"wide",description:"K3d \ud074\ub7ec\uc2a4\ud130\uc5d0\uc11c Istio Ambient \ubaa8\ub4dc \uad6c\uc131",authors:"jinwoong",toc:!0,toc_label:"Table of Contents",slug:"kubernetes/istio-ambient",date:new Date("2024-10-20T00:00:00.000Z"),categories:["Kubernetes"],tags:["Istio","Ambient","Service-Mesh","Sidecarless"]},s="Istio Ambient \ubaa8\ub4dc\uc5d0\uc11c telemetry \ubd84\uc11d",p={permalink:"/kubernetes/istio-ambient",editUrl:"https://github.com/ddiiwoong/newblog/tree/main/blog/2024-10-20-istio-\bambient-mode.md",source:"@site/blog/2024-10-20-istio-\bambient-mode.md",title:"Istio Ambient Mode on K3d",description:"K3d \ud074\ub7ec\uc2a4\ud130\uc5d0\uc11c Istio Ambient \ubaa8\ub4dc \uad6c\uc131",date:"2024-10-20T00:00:00.000Z",formattedDate:"October 20, 2024",tags:[{label:"Istio",permalink:"/tags/istio"},{label:"Ambient",permalink:"/tags/ambient"},{label:"Service-Mesh",permalink:"/tags/service-mesh"},{label:"Sidecarless",permalink:"/tags/sidecarless"}],readingTime:24.11,truncated:!0,authors:[{name:"Jinwoong Kim",title:"Technologist and Cloud Consultant",url:"https://www.linkedin.com/in/ddiiwoong/",imageURL:"https://s.gravatar.com/avatar/e8bfebcbeacb5b9a0c90614e792febf2?s=80",key:"jinwoong"}],frontMatter:{layout:"single",title:"Istio Ambient Mode on K3d",comments:!0,classes:"wide",description:"K3d \ud074\ub7ec\uc2a4\ud130\uc5d0\uc11c Istio Ambient \ubaa8\ub4dc \uad6c\uc131",authors:"jinwoong",toc:!0,toc_label:"Table of Contents",slug:"kubernetes/istio-ambient",date:"2024-10-20T00:00:00.000Z",categories:["Kubernetes"],tags:["Istio","Ambient","Service-Mesh","Sidecarless"]},prevItem:{title:"Tetragon",permalink:"/kubernetes/tetragon"},nextItem:{title:"AWS Gateway API Controller",permalink:"/kubernetes/gatewayapi"}},c={authorsImageUrls:[void 0]},d=[{value:"Istio Ambient Mesh",id:"istio-ambient-mesh",level:2},{value:"Ztunnel",id:"ztunnel",level:3},{value:"Waypoint Proxy",id:"waypoint-proxy",level:3},{value:"Install Istio Ambient",id:"install-istio-ambient",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"K3d \uae30\ubc18 Istion Ambient \uc124\uce58",id:"k3d-\uae30\ubc18-istion-ambient-\uc124\uce58",level:3},{value:"Sample App Rollout \ubc30\ud3ec",id:"sample-app-rollout-\ubc30\ud3ec",level:3},{value:"0\ubc88 \ub178\ub4dc foo \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 sleep \ubc30\ud3ec",id:"0\ubc88-\ub178\ub4dc-foo-\ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0-sleep-\ubc30\ud3ec",level:4},{value:"1\ubc88 \ub178\ub4dc bar-1 \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 httpbin \ubc30\ud3ec",id:"1\ubc88-\ub178\ub4dc-bar-1-\ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0-httpbin-\ubc30\ud3ec",level:4},{value:"2\ubc88 \ub178\ub4dc waypoint proxy \ubc30\ud3ec",id:"2\ubc88-\ub178\ub4dc-waypoint-proxy-\ubc30\ud3ec",level:4},{value:"3\ubc88 \ub178\ub4dc helloworld Application \ubc30\ud3ec",id:"3\ubc88-\ub178\ub4dc-helloworld-application-\ubc30\ud3ec",level:4},{value:"\ub124\ud2b8\uc6cc\ud06c \ud2b8\ub798\ud53d \ud750\ub984 \uccb4\ud06c (sleep -&gt; httpbin)",id:"\ub124\ud2b8\uc6cc\ud06c-\ud2b8\ub798\ud53d-\ud750\ub984-\uccb4\ud06c-sleep---httpbin",level:3},{value:"\ub124\ud2b8\uc6cc\ud06c \ud2b8\ub798\ud53d \ud750\ub984 \uccb4\ud06c (sleep -&gt; helloworld)",id:"\ub124\ud2b8\uc6cc\ud06c-\ud2b8\ub798\ud53d-\ud750\ub984-\uccb4\ud06c-sleep---helloworld",level:3},{value:"helloworld \ub85c\uadf8 \ud655\uc778 \uc815\ub9ac\uc911",id:"helloworld-\ub85c\uadf8-\ud655\uc778-\uc815\ub9ac\uc911",level:4},{value:"\uc815\ub9ac",id:"\uc815\ub9ac",level:2},{value:"Reference",id:"reference",level:2}],m={toc:d};function u(e){var t=e.components,l=(0,o.Z)(e,r);return(0,i.kt)("wrapper",(0,a.Z)({},m,l,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"\ud574\ub2f9 \ud3ec\uc2a4\ud305\uc740 \ud604\uc7ac \uc7ac\uc9c1\uc911\uc778 \ud68c\uc0ac\uc5d0 \uad00\ub828\uc774 \uc5c6\uace0, \uac1c\uc778 \uc5ed\ub7c9 \uac1c\ubc1c\uc744 \uc704\ud55c \uc2a4\ud130\ub514 \uc790\ub8cc\ub85c \ud65c\uc6a9\ud560 \uc608\uc815\uc785\ub2c8\ub2e4.")),(0,i.kt)("p",null,"\uc774\ubc88 \ud3ec\uc2a4\ud305\uc758 \ubaa9\uc801\uc740 K3d \ud074\ub7ec\uc2a4\ud130\uc5d0 Istio Ambient \ubaa8\ub4dc\ub97c \uad6c\uc131\ud558\uace0 \uae30\ubcf8 \uac1c\ub150\uc744 \uc774\ud574\ud558\ub294 \uac83\uc774\ub2e4."),(0,i.kt)("h2",{id:"istio-ambient-mesh"},"Istio Ambient Mesh"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://istio.io/latest/blog/2022/introducing-ambient-mesh/traditional-istio.png",alt:"https://istio.io/latest/blog/2022/introducing-ambient-mesh/traditional-istio.png"})),(0,i.kt)("p",null,"\uc704 \uadf8\ub9bc\ucc98\ub7fc Istio\uc758 \uae30\ubcf8 \uad6c\uc131\uc73c\ub85c \ub3d9\uc791\ud558\ub294 \uc0ac\uc774\ub4dc\uce74(",(0,i.kt)("inlineCode",{parentName:"p"},"sidecar"),") \ubc29\uc2dd\ub294 \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc744 \uc9c1\uc811 \ub9ac\ud329\ud1a0\ub9c1\uc5d0 \ud558\ub294 \uac83\uc5d0 \ube44\ud574 \uc0c1\ub2f9\ud55c \uc774\uc810\uc774 \uc788\uc9c0\ub9cc, \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uacfc Istio \ub370\uc774\ud130 \ud50c\ub808\uc778\uc744 \uc644\ubcbd\ud558\uac8c \ubd84\ub9ac\ud558\uc9c0\ub294 \ubabb\ud55c\ub2e4. \uc0ac\uc774\ub4dc\uce74\ub97c \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc5d0 ",(0,i.kt)("inlineCode",{parentName:"p"},"inject"),"\ud558\ub824\uba74 \ud574\ub2f9 Kubernetes \ud30c\ub4dc \uc2a4\ud399\uc744 \uc218\uc815\ud558\uace0 \ud30c\ub4dc \ub0b4\uc5d0\uc11c \ud2b8\ub798\ud53d\uc744 \ub9ac\ub514\ub809\uc158(Redirect)\ud574\uc57c \ud55c\ub2e4. \ub530\ub77c\uc11c \uc0ac\uc774\ub4dc\uce74\ub97c \uc124\uce58\ud558\uac70\ub098 \uc5c5\uadf8\ub808\uc774\ub4dc\ud558\ub824\uba74 \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \ud30c\ub4dc\ub97c \ub2e4\uc2dc \uc2dc\uc791\ud574\uc57c \ud558\ubbc0\ub85c \uc6cc\ud06c\ub85c\ub4dc\uc5d0 \uc9c0\uc7a5\uc744 \uc904 \uc218 \uc788\ub2e4. \uadf8\ub9ac\uace0, \uc0ac\uc774\ub4dc\uce74 \ud504\ub85d\uc2dc\ub294 \uad00\ub828 \uc6cc\ud06c\ub85c\ub4dc \uc804\uc6a9\uc774\ubbc0\ub85c \uac01 \uac1c\ubcc4 \ud30c\ub4dc\uc758 \uc0ac\uc6a9\ub7c9\uc5d0 \ub300\ube44\ud558\uc5ec CPU \ubc0f \uba54\ubaa8\ub9ac \ub9ac\uc18c\uc2a4\ub97c \ud504\ub85c\ube44\uc800\ub2dd\ud574\uc57c \ud55c\ub2e4. \uc774\ub85c \uc778\ud574 \ub300\uaddc\ubaa8 \ub9ac\uc18c\uc2a4 \uc608\uc57d(reservation)\uc774 \ucd94\uac00\ub418\uc5b4 \ud074\ub7ec\uc2a4\ud130 \uc804\uccb4\uc5d0\uc11c \ub9ac\uc18c\uc2a4 \ud65c\uc6a9\ub3c4\uac00 \ub0ae\uc544\uc9c8 \uc218 \uc788\ub2e4. \uc77c\ubc18\uc801\uc73c\ub85c Istio\uc758 \uc0ac\uc774\ub4dc\uce74\uac00 \uc218\ud589\ud558\ub294 \ud2b8\ub798\ud53d \ucea1\ucc98 \ubc0f HTTP \ucc98\ub9ac\ub294 \uacc4\uc0b0 \ube44\uc6a9\uc774 \ub9ce\uc774 \ubc1c\uc0dd\ud558\uae30\ub3c4 \ud558\uba70 \ud45c\uc900 \ud615\ud0dc\uac00 \uc544\ub2cc HTTP \uad6c\ud604\uc744 \uc0ac\uc6a9\ud558\ub294 \uc77c\ubd80 \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc744 \uc911\ub2e8\uc2dc\ud0ac \uc218 \uc788\ub2e4."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"Istio"),"\ub294 \uae30\uc874\uc5d0 \uc0ac\uc774\ub4dc\uce74\ub97c \uc0ac\uc6a9\ud558\uc5ec \ubaa8\ub4e0 \ub370\uc774\ud130 \ud50c\ub808\uc778 \uae30\ub2a5\uc744 \uad6c\ud604\ud588\uc9c0\ub9cc, \uc774\ub294 \ubaa8\ub4e0 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud574\uc57c \ud558\ub294 \ubd80\ub2f4\uc774 \uc788\uc5c8\ub2e4. Istio\ub294 \uac01 \ud30c\ub4dc\uc5d0 \uc0ac\uc774\ub4dc\uce74\ub97c \ubc30\ud3ec\ud558\uc9c0 \uc54a\ub3c4\ub85d \ud5c8\uc6a9\ud558\ub294 ",(0,i.kt)("inlineCode",{parentName:"p"},"Ambient")," \uae30\ub2a5\uc744 22\ub144\uc5d0 \uc18c\uac1c\ud588\ub2e4. Ambient \ubaa8\ub4dc\uc5d0\uc11c Istio\ub294 CNI \uc5ed\ud560\uc744 \ud558\uba70 \ud30c\ub4dc\uc5d0\uc11c \ub4e4\uc5b4\uc624\uace0 \ub098\uac00\ub294 \ub124\ud2b8\uc6cc\ud06c \ud2b8\ub798\ud53d\uc744 \uac00\ub85c\ucc44 \uc5ec\ub7ec\uac00\uc9c0 \uaddc\uce59\uc744 \uc801\uc6a9\ud558\uac8c \ub41c\ub2e4. Istio\uc758 \uae30\ub2a5\uc744 \ub450 \uac1c\uc758 \uacc4\uce35\uc73c\ub85c \ubd84\ub9ac\ud558\uc5ec \ud544\uc694\uc5d0 \ub530\ub77c \uae30\ub2a5\uc744 \uc120\ud0dd\uc801\uc73c\ub85c \uc0ac\uc6a9\ud560 \uc218 \uc788\ub3c4\ub85d \ud55c\ub2e4. \uc774\ub97c \ud1b5\ud574 \uc0ac\uc6a9\uc790\ub294 Istio\ub97c \uc810\uc9c4\uc801\uc73c\ub85c \ub3c4\uc785\ud558\uace0, \ud544\uc694\uc5d0 \ub530\ub77c \ubcf4\uc548 \uc624\ubc84\ub808\uc774(overlay) \ub124\ud2b8\uc6cc\ud06c\uc5d0\uc11c L7 \ucc98\ub9ac \ubc29\uc2dd\uc73c\ub85c \uc804\ud658\ud560 \uc218 \uc788\ub2e4. ",(0,i.kt)("inlineCode",{parentName:"p"},"\ubcf4\uc548 \uc624\ubc84\ub808\uc774"),"\ub77c\ub294 \uc6a9\uc5b4\ub294 ztunnel \ud504\ub85d\uc2dc\ub97c \ud1b5\ud574 Ambient \uba54\uc2dc\uc5d0\uc11c \uad6c\ud604\ub418\ub294 \uc77c\ub828\uc758 L4 \ub124\ud2b8\uc6cc\ud0b9 \uae30\ub2a5\uc744 \ucd1d\uce6d\ud558\uc5ec \uc124\uba85\ud558\ub294 \ub370 \uc0ac\uc6a9\ub41c\ub2e4. \uc0ac\uc774\ub4dc\uce74\uc758 \uc218\ub97c \uc904\uc5ec \uac01 \uc694\uccad\uc5d0 \ub300\ud55c L7 \ucc98\ub9ac \ub2e8\uacc4 \uc218\ub97c \uc904\uc784\uc73c\ub85c\uc368 \ub9ac\uc18c\uc2a4 \uc18c\ube44(CPU, \uba54\ubaa8\ub9ac)\ub97c \uc904\uc774\uace0 Istio\uc758 \uc131\ub2a5\uc744 \ud5a5\uc0c1\uc2dc\ud0a4\ub294 \uac83\uc774 \uc8fc\uc694 \ubaa9\uc801\uc774\ub2e4."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://istio.io/latest/blog/2022/introducing-ambient-mesh/ambient-secure-overlay.png",alt:"https://istio.io/latest/blog/2022/introducing-ambient-mesh/ambient-secure-overlay.png"})),(0,i.kt)("h3",{id:"ztunnel"},"Ztunnel"),(0,i.kt)("p",null,"Ambient \uba54\uc2dc\ub294 \ucfe0\ubc84\ub124\ud2f0\uc2a4 \ud074\ub7ec\uc2a4\ud130\uc758 \uac01 \ub178\ub4dc\uc5d0 \ubc30\ud3ec\ub418\uc5b4 \uc2e4\ud589\ub418\ub294 \ub370\ubaac\uc14b \uae30\ubc18\uc758 \uacf5\uc720 \uc5d0\uc774\uc804\ud2b8\uc778 ",(0,i.kt)("inlineCode",{parentName:"p"},"Ztunnel"),"\uc744 \uc0ac\uc6a9\ud55c\ub2e4. Ztunnel\uc740 Ambient \uba54\uc2dc\uc5d0\uc11c \ub178\ub4dc \ud504\ub85d\uc2dc\ub97c \uad6c\ud604\ud558\uae30 \uc704\ud55c \ubaa9\uc801\uc73c\ub85c \uae30\ub2a5 \uc138\ud2b8\ub97c \ucd5c\uc18c\ub85c\ud558\uc5ec Ambient\uc5d0 \ud544\uc694\ud55c \ucd5c\uc18c\ud55c\uc758 \uc694\uad6c \uc0ac\ud56d\ub9cc \uad6c\ud604\ud558\ub294 \uac83\uc774\ub2e4. ztunnel \ud504\ub85d\uc2dc\ub294 Rust\ub85c \uc791\uc131\ub418\uc5c8\uc73c\uba70 mTLS, \uc778\uc99d, L4 \uad8c\ud55c \ubd80\uc5ec, \uc6d0\uaca9 \uce21\uc815\uacfc \uac19\uc740 L3 \ubc0f L4 \uae30\ub2a5\uc744 \ucc98\ub9ac\ud558\ub3c4\ub85d \uc758\ub3c4\uc801\uc73c\ub85c \ubc94\uc704\uac00 \uc124\uc815\ub418\uc5b4 \uc788\ub2e4. ztunnel\uc740 L3 \ubc0f L4 \ud2b8\ub798\ud53d\uc774 \uc6cc\ud06c\ub85c\ub4dc, \ub2e4\ub978 ztunnel \ud504\ub85d\uc2dc \ub610\ub294 \uc6e8\uc774\ud3ec\uc778\ud2b8 \ud504\ub85d\uc2dc\ub85c \uc9c1\uc811 \ud6a8\uc728\uc801\uc774\uace0 \uc548\uc804\ud558\uac8c \uc804\uc1a1\ub418\ub3c4\ub85d \ubcf4\uc7a5\ud55c\ub2e4."),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/istio/ztunnel?tab=readme-ov-file#feature-scope"},"ztunnel\uc758 \ubc94\uc704\ub97c \uba85\uc2dc\uc801\uc73c\ub85c \ubc97\uc5b4\ub09c \uae30\ub2a5"),"\uc740 \ub2e4\uc74c\uacfc \uac19\ub2e4."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\uc0ac\uc6a9\uc790 HTTP \ud2b8\ub798\ud53d \uc885\ub8cc"),(0,i.kt)("li",{parentName:"ul"},"\ubc18\ubcf5\ud560 \uac00\uce58\uac00 \uc788\ub294 \uc0ac\uc6a9\uc790 HTTP \ud2b8\ub798\ud53d \uc885\ub8cc"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ext_authz"),", WASM, \uc5f0\ub3d9 \ud655\uc7a5(linked-in extensions), Lua \ub4f1\uacfc \uac19\uc740 \uc77c\ubc18\uc801\uc778 \ud655\uc7a5\uc131")),(0,i.kt)("p",null,"\uc77c\ubc18\uc801\uc73c\ub85c ztunnel\uc740 \uc77c\ubc18\uc801\uc778 \ud655\uc7a5\uc131 \ud504\ub85d\uc2dc\ub97c \ubaa9\ud45c\ub85c \ud558\uc9c0 \uc54a\uc73c\uba70, \uc774\ub7ec\ud55c \uc791\uc5c5\uc5d0\ub294 ",(0,i.kt)("inlineCode",{parentName:"p"},"Envoy"),"\uac00 \ub354 \uc801\ud569\ud558\ub2e4. "),(0,i.kt)("p",null,"\uc804\uc1a1 \uacc4\uce35\uc5d0\uc11c\ub294 ",(0,i.kt)("a",{parentName:"p",href:"https://istio.io/latest/docs/ambient/architecture/hbone/"},"HBONE"),"\uc774\ub77c\ub294 HTTP CONNECT \uae30\ubc18 \ud2b8\ub798\ud53d \ud130\ub110\ub9c1 \ud504\ub85c\ud1a0\ucf5c\uc744 \ud1b5\ud574 \uad6c\ud604\ub41c\ub2e4."),(0,i.kt)("h3",{id:"waypoint-proxy"},"Waypoint Proxy"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://istio.io/latest/blog/2022/introducing-ambient-mesh/ambient-waypoint.png",alt:"https://istio.io/latest/blog/2022/introducing-ambient-mesh/ambient-waypoint.png"})),(0,i.kt)("p",null,"\uc704\uc5d0\uc11c \uc774\uc57c\uae30\ud588\ub4ef\uc774 L7 \ucc98\ub9ac\ub294 ztunnel\uc5d0\uc11c \uad6c\ud604\ub418\uc9c0 \uc54a\uace0 \ubcc4\ub3c4\uc758 ",(0,i.kt)("inlineCode",{parentName:"p"},"Waypoint Proxy")," \ud30c\ub4dc\ub97c \ud1b5\ud574 \uc9c4\ud589\ub41c\ub2e4. ",(0,i.kt)("inlineCode",{parentName:"p"},"Waypoint Proxy"),"\ub294 \uc0ac\uc774\ub4dc\uce74 \ub370\uc774\ud130 \ud50c\ub808\uc778 \ubaa8\ub4dc\uc5d0 \uc0ac\uc6a9\ud558\ub294 \uac83\uacfc \ub3d9\uc77c\ud55c \uc5d4\uc9c4\uc778 Envoy \ud504\ub85d\uc2dc\ub97c \uc0ac\uc6a9\ud55c\ub2e4. ",(0,i.kt)("inlineCode",{parentName:"p"},"Waypoint Proxy"),"\ub294 \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \ud30c\ub4dc \uc678\ubd80\uc5d0\uc11c \ub3c5\ub9bd\uc801\uc73c\ub85c \uc124\uce58, \uc2e4\ud589, \uc5c5\uadf8\ub808\uc774\ub4dc \ub41c\ub2e4. \uc570\ube44\uc5b8\ud2b8 \ubaa8\ub4dc\uc5d0\uc11c Istio\uc758 \uc77c\ubd80 \uc0ac\uc6a9 \uc0ac\ub840\ub294 L4 \ubcf4\uc548 \uc624\ubc84\ub808\uc774 \uae30\ub2a5\ub9cc\uc73c\ub85c \ud574\uacb0\ub420 \uc218 \uc788\uc73c\uba70, L7 \uae30\ub2a5\uc774 \ud544\uc694\ud558\uc9c0 \uc54a\uc73c\ubbc0\ub85c ",(0,i.kt)("inlineCode",{parentName:"p"},"Waypoint Proxy"),"\ub97c \ubc30\ud3ec\ud560 \ud544\uc694\uac00 \uc5c6\ub2e4. \uace0\uae09 \ud2b8\ub798\ud53d \uad00\ub9ac \ubc0f L7 \ub124\ud2b8\uc6cc\ud0b9 \uae30\ub2a5\uc774 \ud544\uc694\ud55c \uacbd\uc6b0\ub294 ",(0,i.kt)("inlineCode",{parentName:"p"},"Waypoint Proxy")," \ubc30\ud3ec\uac00 \ud544\uc694\ud558\ub2e4."),(0,i.kt)("h2",{id:"install-istio-ambient"},"Install Istio Ambient"),(0,i.kt)("p",null,"\uac04\ub2e8\ud558\uac8c Istio Ambient \ud14c\uc2a4\ud2b8\ub97c \uc9c4\ud589\ud558\uae30 \uc704\ud574\uc11c K3d \ud074\ub7ec\uc2a4\ud130\uc5d0\uc11c ArgoCD\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc0d8\ud50c \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \ubc30\ud3ec\ub97c \uc9c4\ud589\ud55c\ub2e4. \ucd5c\uc885\uc801\uc73c\ub85c \uad6c\uc131\ud558\uace0\uc790 \ud558\ub294 \uadf8\ub9bc\uc740 \ub2e4\uc74c\uacfc \uac19\uc774 4\uac1c\uc758 \ub178\ub4dc\uc5d0 \uac01 \ucef4\ud3ec\ub10c\ud2b8\ub97c \ubc30\uce58\ud558\ub294 \uac83\uc774\ub2e4. (\uadf8\ub9bc \ucd9c\ucc98: ",(0,i.kt)("a",{parentName:"p",href:"https://istio.io/latest/blog/2023/traffic-for-ambient-and-sidecar/"},"https://istio.io/latest/blog/2023/traffic-for-ambient-and-sidecar/"),")"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://istio.io/latest/blog/2023/traffic-for-ambient-and-sidecar/sidecar-to-ambient.png",alt:"demo"})),(0,i.kt)("h3",{id:"prerequisites"},"Prerequisites"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://k3d.io/"},"K3d Cluster")," 4 nodes(agents)"),(0,i.kt)("li",{parentName:"ul"},"kubectl"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/argoproj/argo-cd/releases"},"ArgoCD")," Non-HA"),(0,i.kt)("li",{parentName:"ul"},"Docker \ub610\ub294 Rancher Desktop")),(0,i.kt)("h3",{id:"k3d-\uae30\ubc18-istion-ambient-\uc124\uce58"},"K3d \uae30\ubc18 Istion Ambient \uc124\uce58"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"k3d"),"\ub294 \uae30\ubcf8\uc801\uc73c\ub85c ",(0,i.kt)("inlineCode",{parentName:"p"},"Treaefik")," \ud504\ub85d\uc2dc\ub97c \uc124\uce58\ud558\uac8c \ub418\uc5b4 \uc788\uc9c0\ub9cc  Istio\ub294 \uc790\uccb4\uc801\uc73c\ub85c Ingress Gateway\uc640 \uac19\uc740 \ud504\ub85d\uc2dc \uae30\ub2a5\uc744 \uc81c\uacf5\ud558\uae30 \ub54c\ubb38\uc5d0 \ucda9\ub3cc\uc744 \ubc29\uc9c0\ud558\uae30 \uc704\ud574 \uc124\uce58\uc2dc ",(0,i.kt)("inlineCode",{parentName:"p"},'--k3s-arg "--disable=traefik@server:*"')," \uc635\uc158\uc744 \uc0ac\uc6a9\ud558\uc5ec Traefik\uc744 \ube44\ud65c\uc131\ud654\ud560 \uc218 \uc788\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ k3d cluster create --api-port 6550 -p '9080:80@loadbalancer' -p '9443:443@loadbalancer' --agents 4 --k3s-arg '--disable=traefik@server:*'\nINFO[0000] portmapping '9080:80' targets the loadbalancer: defaulting to [servers:*:proxy agents:*:proxy]\nINFO[0000] portmapping '9443:443' targets the loadbalancer: defaulting to [servers:*:proxy agents:*:proxy]\nINFO[0000] Prep: Network\nINFO[0000] Created network 'k3d-k3s-default'\nINFO[0000] Created image volume k3d-k3s-default-images\nINFO[0000] Starting new tools node...\nINFO[0000] Starting node 'k3d-k3s-default-tools'\nINFO[0001] Creating node 'k3d-k3s-default-server-0'\nINFO[0001] Creating node 'k3d-k3s-default-agent-0'\nINFO[0001] Creating node 'k3d-k3s-default-agent-1'\nINFO[0001] Creating node 'k3d-k3s-default-agent-2'\nINFO[0001] Creating node 'k3d-k3s-default-agent-3'\nINFO[0001] Creating LoadBalancer 'k3d-k3s-default-serverlb'\nINFO[0001] Using the k3d-tools node to gather environment information\nINFO[0001] HostIP: using network gateway 172.22.0.1 address\nINFO[0001] Starting cluster 'k3s-default'\nINFO[0001] Starting servers...\nINFO[0001] Starting node 'k3d-k3s-default-server-0'\nINFO[0004] Starting agents...\nINFO[0004] Starting node 'k3d-k3s-default-agent-2'\nINFO[0004] Starting node 'k3d-k3s-default-agent-0'\nINFO[0004] Starting node 'k3d-k3s-default-agent-1'\nINFO[0004] Starting node 'k3d-k3s-default-agent-3'\nINFO[0013] Starting helpers...\nINFO[0013] Starting node 'k3d-k3s-default-serverlb'\nINFO[0020] Injecting records for hostAliases (incl. host.k3d.internal) and for 6 network members into CoreDNS configmap...\nINFO[0022] Cluster 'k3s-default' created successfully!\nINFO[0022] You can now use it like this:\nkubectl cluster-info\n")),(0,i.kt)("p",null,"Istio\ub97c \uc124\uce58\ud560 \ub54c \uae30\ubcf8 Flannel CNI\uc640 \ud568\uaed8 k3d\ub97c \uc0ac\uc6a9\ud558\ub294 \uacbd\uc6b0\uc5d0\ub294, CNI \uad6c\uc131 \ubc0f \ubc14\uc774\ub108\ub9ac\uc5d0 \ud45c\uc900\uc774 \uc544\ub2cc \uc704\uce58\ub97c \uc0ac\uc6a9\ud558\uae30 \ub54c\ubb38\uc5d0 \uc124\uce58 \uba85\ub839\uc5d0 \uba87 \uac00\uc9c0 \uac12\uc744 \ucd94\uac00\ud574\uc57c \ud55c\ub2e4. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'$ istioctl install --set profile=ambient --set values.cni.cniConfDir=/var/lib/rancher/k3s/agent/etc/cni/net.d --set values.cni.cniBinDir=/bin\n\n        |\\\n        | \\\n        |  \\\n        |   \\\n      /||    \\\n     / ||     \\\n    /  ||      \\\n   /   ||       \\\n  /    ||        \\\n /     ||         \\\n/______||__________\\\n____________________\n  \\__       _____/\n     \\_____/\n\nThis will install the Istio 1.23.2 "ambient" profile (with components: Istio core, Istiod, CNI, and Ztunnel) into the cluster. Proceed? (y/N) y\n\u2714 Istio core installed \u26f5\ufe0f\n\u2714 Istiod installed \ud83e\udde0\n\u2714 CNI installed \ud83e\udea2\n\u2714 Ztunnel installed \ud83d\udd12\n\u2714 Installation complete                                                                                                                                                  \nMade this installation the default for cluster-wide operations.\nThe ambient profile has been installed successfully, enjoy Istio without sidecars!\n')),(0,i.kt)("p",null,"\uc124\uce58\uac00 \uc644\ub8cc\ub41c \uc774\ud6c4\uc758 \ud074\ub7ec\uc2a4\ud130\uc758 ",(0,i.kt)("inlineCode",{parentName:"p"},"istio")," \ucef4\ud3ec\ub10c\ud2b8 \uc810\uac80 ",(0,i.kt)("inlineCode",{parentName:"p"},"istioctl verify-install")," \uba85\ub839\uc744 \ud1b5\ud574 \ud655\uc778\ud560 \uc218 \uc788\ub2e4. \uae30\ubcf8\uc73c\ub85c \ubc30\ud3ec\uac00 \ub418\uc5c8\uae30 \ub54c\ubb38\uc5d0 \ud2b9\ubcc4\ud55c \uc635\uc158\uc5c6\uc774 \uc810\uac80\uc744 \uc218\ud589\ud558\uba74 ",(0,i.kt)("inlineCode",{parentName:"p"},"default")," \ub9ac\ube44\uc804\ub9cc \uc810\uac80\uc744 \uc218\ud589\ud55c\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'$ istioctl verify-install\n1 Istio control planes detected, checking --revision "default" only\n\u2714 Deployment: istiod.istio-system checked successfully\n... ## \uc911\ub7b5\n\u2714 CustomResourceDefinition: workloadgroups.networking.istio.io.istio-system checked successfully\nChecked 14 custom resource definitions\nChecked 1 Istio Deployments\nChecked 2 Istio Daemonsets\n\u2714 Istio is installed and verified successfully\n')),(0,i.kt)("p",null,"ArgoCD \ubc30\ud3ec\ub97c \uc9c4\ud589\ud55c\ub2e4. Non-HA YAML \ub9e4\ub2c8\ud398\uc2a4\ud2b8\ub97c \uc0ac\uc6a9\ud558\uc5ec ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/argoproj/argo-cd/releases"},"ArgoCD \ucd5c\uc2e0\ubc84\uc804"),"(\uc124\uce58\ub2f9\uc2dc 2.12.6 \ubc84\uc804)\uc73c\ub85c \ubc30\ud3ec\ub97c \uc9c4\ud589\ud55c\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"kubectl create namespace argocd\nkubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/v2.12.6/manifests/install.yaml\n")),(0,i.kt)("p",null,"\uc124\uce58\uac00 \uc644\ub8cc\ub418\uace0 ArgoCD \ucef4\ud3ec\ub10c\ud2b8\ub97c \ud655\uc778\ud574\ubcf4\uba74 \ub2e4\uc74c\uacfc \ube44\uc2b7\ud558\uac8c \ubcf4\uc77c \uac83\uc774\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ kubectl get pods -n argocd\nNAME                                               READY   STATUS    RESTARTS      AGE\nargocd-application-controller-0                    1/1     Running   0             12m\nargocd-applicationset-controller-75d8c9495-fpd69   1/1     Running   0             12m\nargocd-dex-server-7c9b44b9f9-wcmth                 1/1     Running   1 (10m ago)   12m\nargocd-notifications-controller-77f49c7745-jdq4p   1/1     Running   0             12m\nargocd-redis-575c96bc4f-xvwrk                      1/1     Running   0             12m\nargocd-repo-server-7f44b474d7-r8n5m                1/1     Running   0             12m\nargocd-server-5f4dd5d648-brghh                     1/1     Running   0             12m\n")),(0,i.kt)("p",null,"ArgoCD \ud328\uc2a4\uc6cc\ub4dc\ub97c \ubcc0\uacbd\ud558\uae30 \uc704\ud574 ",(0,i.kt)("inlineCode",{parentName:"p"},"bcrypt"),"\ub85c ",(0,i.kt)("inlineCode",{parentName:"p"},"KANS"),"\ub85c \uc554\ud638\ud654\ud558\uace0 ",(0,i.kt)("inlineCode",{parentName:"p"},"argocd-secret")," \ub9ac\uc18c\uc2a4\ub97c patch\ud55c\ub2e4. \ucc38\uace0\ub85c encrypt\ub294 ",(0,i.kt)("a",{parentName:"p",href:"https://bcrypt-generator.com/"},"https://bcrypt-generator.com/"),"\uc5d0\uc11c \uc9c4\ud589\ud588\ub2e4. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'$ kubectl -n argocd patch secret argocd-secret \\\n  -p \'{"stringData": {\n    "admin.password": "$2a$12$PFnmDf/NBL4PQTe5x/oqT.DKtkmc2stvPdvrDaeaYwu.nwq4izE6G",\n    "admin.passwordMtime": "\'$(date +%FT%T%Z)\'"\n  }}\'\nsecret/argocd-secret patched\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"kubectl port-forward svc/argocd-server -n argocd 9999:443\n")),(0,i.kt)("h3",{id:"sample-app-rollout-\ubc30\ud3ec"},"Sample App Rollout \ubc30\ud3ec"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://istio.io/latest/docs/ambient/getting-started/deploy-sample-app/bookinfo.svg",alt:"https://istio.io/latest/docs/ambient/getting-started/deploy-sample-app/bookinfo.svg"})),(0,i.kt)("p",null,"\ud574\ub2f9 \uadf8\ub9bc\uacfc \uac19\uc740 \uc0d8\ud50c \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc744 \ubc30\ud3ec\ud558\uae30 \uc704\ud574\uc11c Argo Rollout \ucd5c\uc2e0 \ubc84\uc804\ub3c4 \ubc30\ud3ec\ud55c\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ kubectl create namespace argo-rollouts\nkubectl apply -n argo-rollouts -f https://github.com/argoproj/argo-rollouts/releases/latest/download/install.yaml\nnamespace/argo-rollouts created\ncustomresourcedefinition.apiextensions.k8s.io/analysisruns.argoproj.io created\ncustomresourcedefinition.apiextensions.k8s.io/analysistemplates.argoproj.io created\ncustomresourcedefinition.apiextensions.k8s.io/clusteranalysistemplates.argoproj.io created\ncustomresourcedefinition.apiextensions.k8s.io/experiments.argoproj.io created\ncustomresourcedefinition.apiextensions.k8s.io/rollouts.argoproj.io created\nserviceaccount/argo-rollouts created\nclusterrole.rbac.authorization.k8s.io/argo-rollouts created\nclusterrole.rbac.authorization.k8s.io/argo-rollouts-aggregate-to-admin created\nclusterrole.rbac.authorization.k8s.io/argo-rollouts-aggregate-to-edit created\nclusterrole.rbac.authorization.k8s.io/argo-rollouts-aggregate-to-view created\nclusterrolebinding.rbac.authorization.k8s.io/argo-rollouts created\nconfigmap/argo-rollouts-config created\nsecret/argo-rollouts-notification-secret created\nservice/argo-rollouts-metrics created\ndeployment.apps/argo-rollouts created\n")),(0,i.kt)("h4",{id:"0\ubc88-\ub178\ub4dc-foo-\ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0-sleep-\ubc30\ud3ec"},"0\ubc88 \ub178\ub4dc foo \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 sleep \ubc30\ud3ec"),(0,i.kt)("p",null,"foo \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0\uc11c ",(0,i.kt)("inlineCode",{parentName:"p"},"sleep")," \uc11c\ube44\uc2a4\ub97c \uc2e4\ud589\ud558\uace0 \ud574\ub2f9 \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 \ub300\ud574 Istio \uc0ac\uc774\ub4dc\uce74 \uc778\uc81d\uc158\uc744 \uc0ac\uc6a9\ud558\ub824\uba74 ",(0,i.kt)("inlineCode",{parentName:"p"},"foo")," \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 Istio injection \ub77c\ubca8\uc744 \ucd94\uac00\ud574\uc57c \ud55c\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ kubectl create namespace foo\nnamespace/foo created\n\n$ kubectl label namespace foo istio-injection=enabled\nnamespace/foo labeled\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"k3d-k3s-default-agent-0")," \ub178\ub4dc\uc5d0 \ubc30\ud3ec\ud558\uae30 \uc704\ud574 ",(0,i.kt)("inlineCode",{parentName:"p"},"nodeSelector")," \uad6c\ubb38\uc744 \ucd94\uac00\ud558\uace0 ",(0,i.kt)("inlineCode",{parentName:"p"},"foo")," \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 \ubc30\ud3ec\ud55c\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'cat <<EOF | kubectl create -n foo -f -\napiVersion: v1\nkind: Service\nmetadata:\n  name: sleep\n  labels:\n    app: sleep\n    service: sleep\nspec:\n  ports:\n  - port: 80\n    name: http\n  selector:\n    app: sleep\n---\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: sleep\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: sleep\n  template:\n    metadata:\n      labels:\n        app: sleep\n    spec:\n      terminationGracePeriodSeconds: 0\n      containers:\n      - name: sleep\n        image: curlimages/curl\n        command: ["/bin/sleep", "3650d"]\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - mountPath: /etc/sleep/tls\n          name: secret-volume\n      volumes:\n      - name: secret-volume\n        secret:\n          secretName: sleep-secret\n          optional: true\n      nodeSelector:\n        kubernetes.io/hostname: "k3d-k3s-default-agent-0"\n')),(0,i.kt)("p",null,"Ambient \ubaa8\ub4dc\uc774\uc9c0\ub9cc Istio injection\uc774 \uc624\ubc84\ub77c\uc774\ub4dc \ub418\uba74\uc11c \ucd94\uac00\uc801\uc778 \uc0ac\uc774\ub4dc\uce74\uac00 \uc788\ub294\ucc44\ub85c \ubc30\ud3ec\ub41c \uac83\uc744 \ud655\uc778\ud560 \uc218\uc788\ub2e4.\n",(0,i.kt)("img",{alt:"foo",src:n(64649).Z,width:"1274",height:"138"})),(0,i.kt)("h4",{id:"1\ubc88-\ub178\ub4dc-bar-1-\ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0-httpbin-\ubc30\ud3ec"},"1\ubc88 \ub178\ub4dc bar-1 \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 httpbin \ubc30\ud3ec"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"bar-1")," \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0\uc11c ",(0,i.kt)("inlineCode",{parentName:"p"},"httpbin")," \uc11c\ube44\uc2a4\ub97c \uc2e4\ud589\ud558\uace0, \ud574\ub2f9 \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 \ub300\ud574 Ambient \ubaa8\ub4dc\ub97c \uc0ac\uc6a9\ud558\ub824\uba74 ",(0,i.kt)("inlineCode",{parentName:"p"},"bar-1")," \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 \ub77c\ubca8\uc744 \ucd94\uac00\ud574\uc57c \ud55c\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ kubectl create namespace bar-1\nnamespace/foo created\n\n$ kubectl label namespace bar-1 istio.io/dataplane-mode=ambient\nnamespace/bar-1 labeled\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"k3d-k3s-default-agent-1")," \ub178\ub4dc\uc5d0 \ubc30\ud3ec\ud558\uae30 \uc704\ud574 ",(0,i.kt)("inlineCode",{parentName:"p"},"nodeSelector")," \uad6c\ubb38\uc744 \ucd94\uac00\ud558\uace0 ",(0,i.kt)("inlineCode",{parentName:"p"},"bar-1")," \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 \ubc30\ud3ec\ud55c\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'cat <<EOF | kubectl create -n bar-1 -f -\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: httpbin\n  labels:\n    app: httpbin\n    service: httpbin\nspec:\n  ports:\n  - name: http\n    port: 8000\n    targetPort: 80\n  selector:\n    app: httpbin\n---\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: httpbin\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: httpbin\n      version: v1\n  template:\n    metadata:\n      labels:\n        app: httpbin\n        version: v1\n    spec:\n      containers:\n      - image: docker.io/kennethreitz/httpbin\n        imagePullPolicy: IfNotPresent\n        name: httpbin\n        ports:\n        - containerPort: 80\n      nodeSelector:\n        kubernetes.io/hostname: "k3d-k3s-default-agent-1"\nEOF\n')),(0,i.kt)("h4",{id:"2\ubc88-\ub178\ub4dc-waypoint-proxy-\ubc30\ud3ec"},"2\ubc88 \ub178\ub4dc waypoint proxy \ubc30\ud3ec"),(0,i.kt)("p",null,"\uc6e8\uc774\ud3ec\uc778\ud2b8 \ud504\ub85d\uc2dc\ub294 \ucfe0\ubc84\ub124\ud2f0\uc2a4 \uac8c\uc774\ud2b8\uc6e8\uc774 \ub9ac\uc18c\uc2a4\ub97c \uc0ac\uc6a9\ud558\uc5ec \ubc30\ud3ec\ub41c\ub2e4. \ub300\ubd80\ubd84\uc758 \ucfe0\ubc84\ub124\ud2f0\uc2a4 \ud074\ub7ec\uc2a4\ud130\uc5d0\ub294 \uae30\ubcf8\uc801\uc73c\ub85c \ucfe0\ubc84\ub124\ud2f0\uc2a4 \uac8c\uc774\ud2b8\uc6e8\uc774 API CRD\uac00 \uc124\uce58\ub418\uc5b4 \uc788\uc9c0 \uc54a\uc73c\ubbc0\ub85c, \uac8c\uc774\ud2b8\uc6e8\uc774 API\ub97c \uc0ac\uc6a9\ud558\uae30 \uc804\uc5d0 \uc124\uce58\ub418\uc5b4 \uc788\ub294\uc9c0 \ud655\uc778\ud574\uc57c \ud55c\ub2e4. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ kubectl get crd gateways.gateway.networking.k8s.io &> /dev/null || \\\n  { kubectl apply -f https://github.com/kubernetes-sigs/gateway-api/releases/download/v1.1.0/standard-install.yaml; }\n\ncustomresourcedefinition.apiextensions.k8s.io/gatewayclasses.gateway.networking.k8s.io created\ncustomresourcedefinition.apiextensions.k8s.io/gateways.gateway.networking.k8s.io created\ncustomresourcedefinition.apiextensions.k8s.io/grpcroutes.gateway.networking.k8s.io created\ncustomresourcedefinition.apiextensions.k8s.io/httproutes.gateway.networking.k8s.io created\ncustomresourcedefinition.apiextensions.k8s.io/referencegrants.gateway.networking.k8s.io created\n\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"istioctl waypoint")," \uba85\ub839\uc5b4\ub97c \uc0ac\uc6a9\ud558\uc5ec Gateway API \ub9ac\uc18c\uc2a4\ub97c \uc0dd\uc131, \uc801\uc6a9 \ub610\ub294 \ub098\uc5f4\ud560 \uc218 \uc788\ub2e4. waypoint\uac00 \ubc30\ud3ec\ub41c \ud6c4\uc5d0\ub294 \uc804\uccb4 \ub124\uc784\uc2a4\ud398\uc774\uc2a4(\ub610\ub294 \uc120\ud0dd\ud55c \uc11c\ube44\uc2a4 \ub610\ub294 \ud30c\ub4dc)\ub97c \ub4f1\ub85d\ud574\uc57c  \ud55c\ub2e4. \ud2b9\uc815 \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 \ub300\ud55c waypoint proxy\ub97c \ubc30\ud3ec\ud558\uae30 \uc804\uc5d0 \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uac00 ",(0,i.kt)("inlineCode",{parentName:"p"},"istio.io/dataplane-mode: ambient"),"\ub85c \ub808\uc774\ube14\uc774 \uc9c0\uc815\ub418\uc5b4 \uc788\ub294\uc9c0 \ud655\uc778\ud574\uc57c \ud55c\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ kubectl get ns -L istio.io/dataplane-mode\n\nNAME              STATUS   AGE    DATAPLANE-MODE\nargo-rollouts     Active   147m\nargocd            Active   172m\nbar-1             Active   69m    ambient\ndefault           Active   3h\nfoo               Active   102m\nistio-system      Active   176m\nkube-node-lease   Active   3h\nkube-public       Active   3h\nkube-system       Active   3h\n")),(0,i.kt)("p",null,"\ud604\uc7ac Ambient\uac00 \ub4f1\ub85d\ub418\uc5b4 \uc788\ub294 \ub124\uc784\uc2a4\ud398\uc774\uc2a4\ub294 ",(0,i.kt)("inlineCode",{parentName:"p"},"bar-1")," \ubfd0\uc774\ub2e4. "),(0,i.kt)("p",null,"\uad6c\uc131 \uc608\uc2dc \uadf8\ub9bc\uc5d0 \ubcf4\uba74 helloworld \uc571\uc744 ",(0,i.kt)("inlineCode",{parentName:"p"},"bar-2")," \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 \ubc30\ud3ec\ud558\uace0, waypoint\uac00 \ud574\ub2f9 \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc758 \uc11c\ube44\uc2a4\uc5d0 \ub300\ud55c \ud2b8\ub798\ud53d\uc744 \ucc98\ub9ac\ud560 \uc218 \uc788\ub3c4\ub85d \uad6c\uc131\ud560 \uc218 \uc788\ub2e4. \uba3c\uc800, helloworld \uc571\uc744 \ubc30\ud3ec\ud560 \ub124\uc784\uc2a4\ud398\uc774\uc2a4 ",(0,i.kt)("inlineCode",{parentName:"p"},"bar-2"),"\ub97c \ucd94\uac00\ud558\uace0, \ud574\ub2f9 \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 \ub300\ud574 Ambient \ubaa8\ub4dc\ub97c \uc0ac\uc6a9\ud558\uae30 \uc704\ud574 ",(0,i.kt)("inlineCode",{parentName:"p"},"bar-2")," \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 \ub77c\ubca8\uc744 \ucd94\uac00\ud574\uc57c \ud55c\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ kubectl create namespace bar-2\nnamespace/bar-2 created\n\n$ kubectl label namespace bar-2 istio.io/dataplane-mode=ambient\nnamespace/bar-2 labeled\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"istioctl waypoint generate"),"\ub85c waypoint proxy\uc5d0 \ub300\ud55c \ucfe0\ubc84\ub124\ud2f0\uc2a4 ",(0,i.kt)("inlineCode",{parentName:"p"},"Gateway")," API \ub9ac\uc18c\uc2a4 manifest\ub97c \uc0dd\uc131\ud560 \uc218 \uc788\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ istioctl waypoint generate --for service -n bar-2\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"$ kubectl apply -f - <<EOF\napiVersion: gateway.networking.k8s.io/v1\nkind: Gateway\nmetadata:\n  labels:\n    istio.io/waypoint-for: service\n  name: waypoint\n  namespace: bar-2\nspec:\n  gatewayClassName: istio-waypoint\n  listeners:\n  - name: mesh\n    port: 15008\n    protocol: HBONE\nEOF\ngateway.gateway.networking.k8s.io/waypoint created\n")),(0,i.kt)("p",null,"\uc0dd\uc131\ub41c Gateway Resource\ub97c \uc9c1\uc811 \ubc30\ud3ec\ud558\uac70\ub098 \uc544\ub798\uc640 \uac19\uc774 ",(0,i.kt)("inlineCode",{parentName:"p"},"istioctl waypoint apply")," \uba85\ub839\uc744 \uc0ac\uc6a9\ud574\uc11c waypoint\ub97c \ubc30\ud3ec\ud558\ub294 \uacbd\uc6b0 --enroll-namespace \ub9e4\uac1c\ubcc0\uc218\ub97c \uc0ac\uc6a9\ud558\uc5ec \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 \uc790\ub3d9\uc73c\ub85c \ub808\uc774\ube14\uc744 \uc9c0\uc815\ud560 \uc218 \uc788\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'$ istioctl waypoint apply -n bar-2 --enroll-namespace\nwaypoint bar-2/waypoint applied\nnamespace bar-2 labeled with "istio.io/use-waypoint: waypoint"\n')),(0,i.kt)("p",null,"waypoint proxy\uac00 \ubc30\ud3ec\ub418\uba74, \ub9ac\uc18c\uc2a4\uc5d0\uc11c \uba85\uc2dc\uc801\uc73c\ub85c \uc0ac\uc6a9\ud558\ub3c4\ub85d \uad6c\uc131\ud558\uae30 \uc804\uae4c\uc9c0\ub294 \uc5b4\ub5a4 \ub9ac\uc18c\uc2a4\uc5d0\uc11c\ub3c4 waypoint\ub97c \uc0ac\uc6a9\ud558\uc9c0 \uc54a\ub294\ub2e4. "),(0,i.kt)("p",null,"Gateway \ub9ac\uc18c\uc2a4\uac00 \uc801\uc6a9\ub418\uba74 Istiod\ub294 \ub9ac\uc18c\uc2a4\ub97c \ubaa8\ub2c8\ud130\ub9c1\ud558\uace0 \ud574\ub2f9 waypoint \ubc30\ud3ec \ubc0f \uc0ac\uc6a9\uc790\ub97c \uc704\ud55c \uc11c\ube44\uc2a4\ub97c \uc790\ub3d9\uc73c\ub85c \ubc30\ud3ec \ubc0f \uad00\ub9ac\ud558\uac8c \ub41c\ub2e4. waypoint\uac00 \ubaa8\ub4e0 \ud2b8\ub798\ud53d\uc744 \ucc98\ub9ac\ud558\uac70\ub098, \ud074\ub7ec\uc2a4\ud130\uc758 \uc6cc\ud06c\ub85c\ub4dc(\ud3ec\ub4dc \ub610\ub294 VM)\ub85c \uc9c1\uc811 \uc804\uc1a1\ub418\ub294 \ud2b8\ub798\ud53d\ub9cc \ucc98\ub9ac\ud558\uac70\ub098, \ud2b8\ub798\ud53d\uc744 \uc804\ud600 \ucc98\ub9ac\ud558\uc9c0 \uc54a\uc744 \uc218\ub3c4 \uc788\ub2e4. \uc608\ub97c \ub4e4\uc5b4 waypoint\uac00 \ubaa8\ub4e0 \ud2b8\ub798\ud53d\uc744 \ucc98\ub9ac\ud55c\ub2e4\uace0 \uc124\uc815\ud558\ub294 \uacbd\uc6b0 Prometheus \uc2a4\ud06c\ub798\ud551 \uac19\uc740 \ub0b4\ubd80 \uc6a9\ub3c4\ub85c \uc0ac\uc6a9\uc2dc \ubaa8\ub4e0 \ud2b8\ub798\ud53d\uc774 L7 \ucc98\ub9ac\uac00 \ub418\ub294 \uc624\ubc84\ud5e4\ub4dc\uac00 \ubc1c\uc0dd\ud558\uae30 \ub54c\ubb38\uc5d0 \uc544\ub798\uc640 \uac19\uc740 \uc635\uc158\uc744 ",(0,i.kt)("inlineCode",{parentName:"p"},"istio.io/waypoint-for")," \ub808\uc774\ube14\uc5d0 \uc124\uc815\ud574\uc11c \uc815\uc758\ud558\uac8c \ub41c\ub2e4."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"istio.io/waypoint-for: service"),": \ucfe0\ubc84\ub124\ud2f0\uc2a4 \uc11c\ube44\uc2a4"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"istio.io/waypoint-for: workload"),": \ud30c\ub4dc \ub610\ub294 VM IP"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"istio.io/waypoint-for: all"),": \uc11c\ube44\uc2a4\uc640 \uc6cc\ud06c\ub85c\ub4dc \ud2b8\ub798\ud53d \ubaa8\ub450"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"istio.io/waypoint-for: none"),": \uc804\ub2ec \uc5c6\uc74c (\ud14c\uc2a4\ud2b8 \uc6a9)")),(0,i.kt)("p",null,"\ubc30\ud3ec\uac00 \uc644\ub8cc\ub418\uba74 \uc544\ub798\uc640 \uac19\uc774 ",(0,i.kt)("inlineCode",{parentName:"p"},"bar-2")," \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0\uc11c \ucfe0\ubc84\ub124\ud2f0\uc2a4 \uc11c\ube44\uc2a4\ub85c \uc804\ub2ec\ub418\ub294 \ud2b8\ub798\ud53d\uc5d0 \ub300\ud574\uc11c\ub9cc \ud2b8\ub798\ud53d\uc744 \uc218\uc2e0\ud558\ub294 waypoint proxy pod\ub97c \ud655\uc778\ud560 \uc218 \uc788\ub2e4. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ kubectl get gateway -A\nNAMESPACE   NAME       CLASS            ADDRESS        PROGRAMMED   AGE\nbar-2       waypoint   istio-waypoint   10.43.241.18   True         21m\n\n$ kubectl get pod -n bar-2\nNAME                        READY   STATUS    RESTARTS   AGE\nwaypoint-7674fbc875-s9mgw   1/1     Running   0          22m\n")),(0,i.kt)("h4",{id:"3\ubc88-\ub178\ub4dc-helloworld-application-\ubc30\ud3ec"},"3\ubc88 \ub178\ub4dc helloworld Application \ubc30\ud3ec"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"k3d-k3s-default-agent-3")," \ub178\ub4dc\uc5d0 \ubc30\ud3ec\ud558\uae30 \uc704\ud574 ",(0,i.kt)("inlineCode",{parentName:"p"},"nodeSelector")," \uad6c\ubb38\uc744 \ucd94\uac00\ud558\uace0 ",(0,i.kt)("inlineCode",{parentName:"p"},"bar-2")," \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 \ubc30\ud3ec\ud55c\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'cat <<EOF | kubectl create -n bar-2 -f -\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: helloworld\nspec:\n  ports:\n  - port: 5000\n    name: http\n  selector:\n    app: helloworld\n---\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: helloworld\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: helloworld\n      version: v1\n  template:\n    metadata:\n      labels:\n        app: helloworld\n        version: v1\n    spec:\n      containers:\n      - name: helloworld\n        image: docker.io/istio/examples-helloworld-v1\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 5000\n          protocol: TCP\n        resources:\n          requests:\n            cpu: "100m"\n      nodeSelector:\n        kubernetes.io/hostname: "k3d-k3s-default-agent-3"\nEOF\n')),(0,i.kt)("p",null,"\ubc30\ud3ec\uac00 \uc644\ub8cc\ub418\uba74 \uc758\ub3c4\ud55c \ub300\ub85c \uac01 \ub124\uc784\uc2a4\ud398\uc774\uc2a4\uc5d0 \uc815\uc0c1\uc801\uc73c\ub85c \ub4f1\ub85d\ub418\uc5b4 \uc788\ub294\uc9c0 \ud655\uc778\ud55c\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ kubectl get pod -n foo -o wide\nNAME                     READY   STATUS    RESTARTS   AGE     IP          NODE                      NOMINATED NODE   READINESS GATES\nsleep-6885445f75-6zxh5   2/2     Running   0          3h33m   10.42.0.5   k3d-k3s-default-agent-0   <none>           <none>\n\n$ kubectl get pod -n bar-1 -o wide\nNAME                      READY   STATUS    RESTARTS   AGE    IP          NODE                      NOMINATED NODE   READINESS GATES\nhttpbin-55d7b9f77-65rjk   1/1     Running   0          3h7m   10.42.1.7   k3d-k3s-default-agent-1   <none>           <none>\n\n$ kubectl get pod -n bar-2 -o wide\nNAME                        READY   STATUS    RESTARTS   AGE   IP          NODE                       NOMINATED NODE   READINESS GATES\nhelloworld-5996d5d8-2l55k   1/1     Running   0          22m   10.42.2.6   k3d-k3s-default-agent-2    <none>           <none>\nwaypoint-7674fbc875-s9mgw   1/1     Running   0          96m   10.42.4.5   k3d-k3s-default-server-0   <none>           <none>\n")),(0,i.kt)("h3",{id:"\ub124\ud2b8\uc6cc\ud06c-\ud2b8\ub798\ud53d-\ud750\ub984-\uccb4\ud06c-sleep---httpbin"},"\ub124\ud2b8\uc6cc\ud06c \ud2b8\ub798\ud53d \ud750\ub984 \uccb4\ud06c (sleep -> httpbin)"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"sleep"),"\uc5d0\uc11c \ub098\uac00\ub294 \ud2b8\ub798\ud53d\uc758 \ud750\ub984\uc744 \ud655\uc778\ud574\ubcf4\uc790. K3d\ub85c \ubc30\ud3ec\ud588\uae30 \ub54c\ubb38\uc5d0 \ub178\ub4dc \uc811\uadfc\uc740 ",(0,i.kt)("inlineCode",{parentName:"p"},"docker"),"\ub098 ",(0,i.kt)("inlineCode",{parentName:"p"},"nerdctl")," \uba85\ub839\uc73c\ub85c \uc9c4\ud589\ud55c\ub2e4. \uba3c\uc800 httpbin\uc73c\ub85c \uc811\uc18d\ud574\ubcf4\uc790. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'$ \u276f kubectl exec -it deploy/sleep -n foo sleep -- curl http://httpbin.bar-1:8000/get\n{\n  "args": {},\n  "headers": {\n    "Accept": "*/*",\n    "Host": "httpbin.bar-1:8000",\n    "User-Agent": "curl/8.10.1",\n    "X-Envoy-Attempt-Count": "1",\n    "X-Envoy-Decorator-Operation": "httpbin.bar-1.svc.cluster.local:8000/*",\n    "X-Envoy-Peer-Metadata": "ChoKCkNMVVNURVJfSUQSDBoKS3ViZXJuZXRlcwp5CgZMQUJFTFMSbyptCg4KA2FwcBIHGgVzbGVlcAoqCh9zZXJ2aWNlLmlzdGlvLmlvL2Nhbm9uaWNhbC1uYW1lEgcaBXNsZWVwCi8KI3NlcnZpY2UuaXN0aW8uaW8vY2Fub25pY2FsLXJldmlzaW9uEggaBmxhdGVzdAogCgROQU1FEhgaFnNsZWVwLTY4ODU0NDVmNzUtNnp4aDUKEgoJTkFNRVNQQUNFEgUaA2ZvbwpFCgVPV05FUhI8GjprdWJlcm5ldGVzOi8vYXBpcy9hcHBzL3YxL25hbWVzcGFjZXMvZm9vL2RlcGxveW1lbnRzL3NsZWVwChgKDVdPUktMT0FEX05BTUUSBxoFc2xlZXA=",\n    "X-Envoy-Peer-Metadata-Id": "sidecar~10.42.0.5~sleep-6885445f75-6zxh5.foo~foo.svc.cluster.local"\n  },\n  "origin": "10.42.0.5",\n  "url": "http://httpbin.bar-1:8000/get"\n}\n')),(0,i.kt)("p",null,"\ud5e4\ub354\uc758 ",(0,i.kt)("inlineCode",{parentName:"p"},"origin"),"\uc774\ub098 ",(0,i.kt)("inlineCode",{parentName:"p"},"X-Envoy-Peer-Metadata-Id"),"\ub97c \ubcf4\uba74 ",(0,i.kt)("inlineCode",{parentName:"p"},"sleep")," \ud30c\ub4dc\uc5d0\uc11c \ub118\uc5b4\uc628 \ud2b8\ub798\ud53d\uc774\ub77c\ub294 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\ub2e4."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"sleep")," \ud30c\ub4dc\uc758 iptable\uc744 \ud655\uc778\ud574\ubcf4\uc790. ",(0,i.kt)("inlineCode",{parentName:"p"},"istio-proxy")," \ucee8\ud14c\uc774\ub108 PID\ub294 \ub2e4\uc74c\uacfc \uac19\uc774 \ud655\uc778\ud560 \uc218 \uc788\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ docker exec -it k3d-k3s-default-agent-0 ps -ef | grep istio\n24459 1337     /usr/local/bin/envoy -c etc/istio/proxy/envoy-rev.json --drain-t\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"istio-proxy"),"\uc758 iptable\uc744 \uc704\uc5d0\uc11c \ud655\uc778\ud55c PID ",(0,i.kt)("inlineCode",{parentName:"p"},"24459")," \ub124\uc784\uc2a4\ud398\uc774\uc2a4(ns) \ucee8\ud14d\uc2a4\ud2b8\ub85c \uc9c4\uc785\ud574\uc11c \ud655\uc778\ud574\ubcf4\uba74 \ub9c8\uc9c0\ub9c9 ",(0,i.kt)("inlineCode",{parentName:"p"},"ISTIO_REDIRECT")," \uccb4\uc778\uc5d0\uc11c ",(0,i.kt)("inlineCode",{parentName:"p"},"localhost:5001"),"\ub85c Redirect \ub418\ub294 \uac83\uc744 \ubcfc \uc218 \uc788\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"$ docker exec -it k3d-k3s-default-agent-0 nsenter --net --target 24459\n~ # iptables -t nat -vnL\nChain PREROUTING (policy ACCEPT 0 packets, 0 bytes)\n pkts bytes target     prot opt in     out     source               destination\n  908 54480 ISTIO_INBOUND  6    --  *      *       0.0.0.0/0            0.0.0.0/0\n\nChain INPUT (policy ACCEPT 0 packets, 0 bytes)\n pkts bytes target     prot opt in     out     source               destination\n\nChain OUTPUT (policy ACCEPT 0 packets, 0 bytes)\n pkts bytes target     prot opt in     out     source               destination\n   21  1260 ISTIO_OUTPUT  6    --  *      *       0.0.0.0/0            0.0.0.0/0\n\nChain POSTROUTING (policy ACCEPT 0 packets, 0 bytes)\n pkts bytes target     prot opt in     out     source               destination\n\nChain ISTIO_INBOUND (1 references)\n pkts bytes target     prot opt in     out     source               destination\n    0     0 RETURN     6    --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:15008\n    0     0 RETURN     6    --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:15020\n  908 54480 RETURN     6    --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:15021\n    0     0 RETURN     6    --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:15090\n    0     0 ISTIO_IN_REDIRECT  6    --  *      *       0.0.0.0/0            0.0.0.0/0\n\nChain ISTIO_IN_REDIRECT (3 references)\n pkts bytes target     prot opt in     out     source               destination\n    1    60 REDIRECT   6    --  *      *       0.0.0.0/0            0.0.0.0/0            redir ports 15006\n\nChain ISTIO_OUTPUT (1 references)\n pkts bytes target     prot opt in     out     source               destination\n    2   120 RETURN     6    --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:15020\n    0     0 RETURN     0    --  *      lo      127.0.0.6            0.0.0.0/0\n    1    60 ISTIO_IN_REDIRECT  6    --  *      lo      0.0.0.0/0           !127.0.0.1            tcp dpt:!15008 owner UID match 1337\n    0     0 RETURN     0    --  *      lo      0.0.0.0/0            0.0.0.0/0            ! owner UID match 1337\n   15   900 RETURN     0    --  *      *       0.0.0.0/0            0.0.0.0/0            owner UID match 1337\n    0     0 ISTIO_IN_REDIRECT  6    --  *      lo      0.0.0.0/0           !127.0.0.1            tcp dpt:!15008 owner GID match 1337\n    0     0 RETURN     0    --  *      lo      0.0.0.0/0            0.0.0.0/0            ! owner GID match 1337\n    0     0 RETURN     0    --  *      *       0.0.0.0/0            0.0.0.0/0            owner GID match 1337\n    0     0 RETURN     0    --  *      *       0.0.0.0/0            127.0.0.1\n    3   180 ISTIO_REDIRECT  0    --  *      *       0.0.0.0/0            0.0.0.0/0\n\nChain ISTIO_REDIRECT (1 references)\n pkts bytes target     prot opt in     out     source               destination\n    3   180 REDIRECT   6    --  *      *       0.0.0.0/0            0.0.0.0/0            redir ports 15001\n")),(0,i.kt)("p",null,"\uc774\ubc88\uc5d4 ",(0,i.kt)("inlineCode",{parentName:"p"},"httpbin")," \ud30c\ub4dc\uc640 \uac19\uc740 \ub178\ub4dc\uc758 ",(0,i.kt)("inlineCode",{parentName:"p"},"ztunnel")," \ud30c\ub4dc\uc758 \ub85c\uadf8\ub97c \ud655\uc778\ud574\ubcf4\uc790. \uc704\uc5d0\uc11c ",(0,i.kt)("inlineCode",{parentName:"p"},"sleep")," \ud30c\ub4dc\uc5d0\uc11c \uc811\uadfc\ud588\uae30 \ub54c\ubb38\uc5d0 src \uc6cc\ud06c\ub85c\ub4dc\uc758 \uc815\ubcf4\ub97c \ud1b5\ud574 \uc774\ub97c \ud655\uc778\ud560 \uc218 \uc788\ub2e4. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'$ kubectl logs ztunnel-9t97l -n istio-system\n\n2024-10-19T17:46:36.635961Z info    access  connection complete src.addr=10.42.0.5:56742 src.workload="sleep-6885445f75-6zxh5" src.namespace="foo" src.identity="spiffe://cluster.local/ns/foo/sa/default" ..."\n')),(0,i.kt)("h3",{id:"\ub124\ud2b8\uc6cc\ud06c-\ud2b8\ub798\ud53d-\ud750\ub984-\uccb4\ud06c-sleep---helloworld"},"\ub124\ud2b8\uc6cc\ud06c \ud2b8\ub798\ud53d \ud750\ub984 \uccb4\ud06c (sleep -> helloworld)"),(0,i.kt)("p",null,"Istio \ucee8\ud2b8\ub864 \ud50c\ub808\uc778\uc5d0\ub294 \uc11c\ube44\uc2a4 \uba54\uc2dc\uc758 \ubaa8\ub4e0 \uc11c\ube44\uc2a4 \uc815\ubcf4\uc640 \uad6c\uc131\uc774 \uc874\uc7ac\ud55c\ub2e4. ",(0,i.kt)("inlineCode",{parentName:"p"},"helloworld")," \ud30c\ub4dc\uac00 ",(0,i.kt)("inlineCode",{parentName:"p"},"wayfront")," proxy\uc640 \ud568\uaed8 \ubc30\ud3ec\ub418\uba74, ",(0,i.kt)("inlineCode",{parentName:"p"},"sleep")," \ud30c\ub4dc \uc0ac\uc774\ub4dc\uce74\uac00 \uc218\uc2e0\ud558\ub294 ",(0,i.kt)("inlineCode",{parentName:"p"},"helloworld")," \uc11c\ube44\uc2a4\uc758 EDS \uad6c\uc131\uc774 ",(0,i.kt)("inlineCode",{parentName:"p"},"envoy_internal_address")," \uc720\ud615\uc73c\ub85c \ubcc0\uacbd\ub41c\ub2e4. \uc0ac\uc774\ub4dc\uce74\ub97c \ud1b5\uacfc\ud558\ub294 \uc694\uccad \ud2b8\ub798\ud53d\uc774 ",(0,i.kt)("a",{parentName:"p",href:"https://istio.io/latest/docs/ambient/architecture/hbone/"},"HBONE(HTTP \uae30\ubc18 overlay \ub124\ud2b8\uc6cc\ud06c)")," \ud504\ub85c\ud1a0\ucf5c\uc744 \ud1b5\ud574 \uc138\ubc88\uc9f8 \ub178\ub4dc\uc758 ",(0,i.kt)("inlineCode",{parentName:"p"},"wayfront")," proxy \ud3ec\ud2b8 15008\ub85c \ud3ec\uc6cc\ub529\ub418\ub294 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\ub2e4."),(0,i.kt)("h4",{id:"helloworld-\ub85c\uadf8-\ud655\uc778-\uc815\ub9ac\uc911"},"helloworld \ub85c\uadf8 \ud655\uc778 \uc815\ub9ac\uc911"),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"\uc815\ub9ac"},"\uc815\ub9ac"),(0,i.kt)("p",null,"\uc774\ubc88 \ud3ec\uc2a4\ud305\uc5d0\uc11c\ub294 Istio Ambient \ubaa8\ub4dc\uc758 \uae30\ub2a5\uacfc \uc124\uce58 \ubc29\ubc95, \uc0d8\ud50c \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \ubc30\ud3ec \ubc0f \ud2b8\ub798\ud53d \ud750\ub984\uc5d0 \ub300\ud55c \uac1c\uad04\uc801\uc778 \ub0b4\uc6a9\uc744 \uc815\ub9ac\ud574\ubd24\ub2e4. "),(0,i.kt)("h2",{id:"reference"},"Reference"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://istio.io/latest/blog/2022/introducing-ambient-mesh/"},"https://istio.io/latest/blog/2022/introducing-ambient-mesh/")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://sysnet4admin.gitbook.io/cncf/cloud-native/service-mesh/istio/ambient-mesh/introducing-ambient-mesh"},"https://sysnet4admin.gitbook.io/cncf/cloud-native/service-mesh/istio/ambient-mesh/introducing-ambient-mesh")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.youtube.com/watch?v=bbfiYMzHtH0&list=WL&index=1"},"https://www.youtube.com/watch?v=bbfiYMzHtH0&list=WL&index=1")," ")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"\ud574\ub2f9 \ud3ec\uc2a4\ud305\uc740 \ud604\uc7ac \uc7ac\uc9c1\uc911\uc778 \ud68c\uc0ac\uc5d0 \uad00\ub828\uc774 \uc5c6\uace0, \uac1c\uc778 \uc5ed\ub7c9 \uac1c\ubc1c\uc744 \uc704\ud55c \uc2a4\ud130\ub514 \uc790\ub8cc\ub85c \ud65c\uc6a9\ud560 \uc608\uc815\uc785\ub2c8\ub2e4.")))}u.isMDXComponent=!0},64649:function(e,t,n){t.Z=n.p+"assets/images/foo-2f57727301709b8156e6192366520f7f.png"}}]);