"use strict";(self.webpackChunkddii=self.webpackChunkddii||[]).push([[7794],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return k}});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),m=p(n),k=r,d=m["".concat(s,".").concat(k)]||m[k]||u[k]||l;return n?a.createElement(d,i(i({ref:t},c),{},{components:n})):a.createElement(d,i({ref:t},c))}));function k(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,i=new Array(l);i[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,i[1]=o;for(var p=2;p<l;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},49363:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return s},default:function(){return k},frontMatter:function(){return o},metadata:function(){return p},toc:function(){return u}});var a=n(87462),r=n(63366),l=(n(67294),n(3905)),i=["components"],o={layout:"single",title:"kyverno\ub97c \ud65c\uc6a9\ud55c Kubernetes \uc815\ucc45 \uc5d4\uc9c4 \uc801\uc6a9",comments:!0,classes:"wide",description:"kyverno\ub97c \ud65c\uc6a9\ud55c Kubernetes \uc815\ucc45 \uc5d4\uc9c4 \uc801\uc6a9",authors:"jinwoong",toc:!0,toc_label:"Table of Contents",slug:"kubernetes/kyverno/",date:new Date("2023-04-01T00:00:00.000Z"),categories:["Kubernetes"],tags:["Kubernetes","kyverno","policy","security"]},s=void 0,p={permalink:"/kubernetes/kyverno/",editUrl:"https://github.com/ddiiwoong/newblog/tree/main/blog/2023-04-08-kyverno.md",source:"@site/blog/2023-04-08-kyverno.md",title:"kyverno\ub97c \ud65c\uc6a9\ud55c Kubernetes \uc815\ucc45 \uc5d4\uc9c4 \uc801\uc6a9",description:"kyverno\ub97c \ud65c\uc6a9\ud55c Kubernetes \uc815\ucc45 \uc5d4\uc9c4 \uc801\uc6a9",date:"2023-04-01T00:00:00.000Z",formattedDate:"April 1, 2023",tags:[{label:"Kubernetes",permalink:"/tags/kubernetes"},{label:"kyverno",permalink:"/tags/kyverno"},{label:"policy",permalink:"/tags/policy"},{label:"security",permalink:"/tags/security"}],readingTime:10.7,truncated:!0,authors:[{name:"Jinwoong Kim",title:"Technologist and Cloud Consultant",url:"https://www.linkedin.com/in/ddiiwoong/",imageURL:"https://s.gravatar.com/avatar/e8bfebcbeacb5b9a0c90614e792febf2?s=80",key:"jinwoong"}],frontMatter:{layout:"single",title:"kyverno\ub97c \ud65c\uc6a9\ud55c Kubernetes \uc815\ucc45 \uc5d4\uc9c4 \uc801\uc6a9",comments:!0,classes:"wide",description:"kyverno\ub97c \ud65c\uc6a9\ud55c Kubernetes \uc815\ucc45 \uc5d4\uc9c4 \uc801\uc6a9",authors:"jinwoong",toc:!0,toc_label:"Table of Contents",slug:"kubernetes/kyverno/",date:"2023-04-01T00:00:00.000Z",categories:["Kubernetes"],tags:["Kubernetes","kyverno","policy","security"]},prevItem:{title:"prometheus grafana \uc2a4\ud0dd\uc73c\ub85c k6 \ud14c\uc2a4\ud2b8 \uacb0\uacfc \ud655\uc778\ud558\uae30",permalink:"/kubernetes/k6-prometheus/"},nextItem:{title:"Advanced Argo Rollout",permalink:"/kubernetes/argo-rollout-advanced/"}},c={authorsImageUrls:[void 0]},u=[{value:"PKOS Study #5",id:"pkos-study-5",level:2},{value:"kyverno",id:"kyverno",level:2},{value:"kyverno \uad6c\uc870 \ubc0f \ub3d9\uc791 \ubc29\uc2dd",id:"kyverno-\uad6c\uc870-\ubc0f-\ub3d9\uc791-\ubc29\uc2dd",level:2},{value:"YAML\uc744 \uc0ac\uc6a9\ud558\uc5ec Kyverno \uc124\uce58",id:"yaml\uc744-\uc0ac\uc6a9\ud558\uc5ec-kyverno-\uc124\uce58",level:3},{value:"Helm\uc744 \uc0ac\uc6a9\ud558\uc5ec Kyverno \uc124\uce58",id:"helm\uc744-\uc0ac\uc6a9\ud558\uc5ec-kyverno-\uc124\uce58",level:3},{value:"\uc815\ub9ac",id:"\uc815\ub9ac",level:3}],m={toc:u};function k(e){var t=e.components,n=(0,r.Z)(e,i);return(0,l.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"pkos-study-5"},"PKOS Study #5"),(0,l.kt)("p",null,'\uac00\uc2dc\ub2e4\ub2d8\uc758 Production Kubernetes Online Study (=PKOS) 2\uae30 \uba64\ubc84\uac00 \ub418\uc11c \ucfe0\ubc84\ub124\ud2f0\uc2a4 \uc2a4\ud130\ub514\ub97c \uc9c4\ud589\ud558\uace0 \uc788\ub2e4. \uc774\uc815\ud6c8\ub2d8\uc758 \uc9d1\ud544\ud558\uc2e0 "24\ub2e8\uacc4 \uc2e4\uc2b5\uc73c\ub85c \uc815\ubcf5\ud558\ub294 \ucfe0\ubc84\ub124\ud2f0\uc2a4" \ucc45\uc744 \uae30\ubc18\uc73c\ub85c \ud558\ub294 \uc2a4\ud130\ub514\uc774\uba70 \ucd1d (4+1)\uc8fc\uac04 \uc9c4\ud589\uc774 \ub418\uace0 \uc788\uace0 \ub9c8\uc9c0\ub9c9\uc778 \ub2e4\uc12f\ubc88\uc9f8 \uc2a4\ud130\ub514 \uc77c\uc815\uc774 \ub9c8\ubb34\ub9ac \ub418\uc5c8\ub2e4.  '),(0,l.kt)("p",null,"\uc774\ubc88 \uc2a4\ud130\ub514 \uacfc\uc81c\uc5d0\uc11c\ub294 kyverno \ub3c4\uad6c\ub97c \uc774\uc6a9\ud574\uc11c \ucfe0\ubc84\ub124\ud2f0\uc2a4\uc758 \uc815\ucc45 \uc5d4\uc9c4\uc73c\ub85c \ud65c\uc6a9\ud558\uc5ec \ubcf4\uc548\uc744 \ud3ec\ud568\ud55c \ub2e4\uc591\ud55c \uc815\ucc45\uc744 \uc801\uc6a9\ud558\ub294 \ubc29\ubc95\uc744 \uc54c\uc544\ubcf8\ub2e4.  "),(0,l.kt)("h2",{id:"kyverno"},"kyverno"),(0,l.kt)("p",null,'Kyverno\ub294 \uadf8\ub9ac\uc2a4\uc5b4\ub85c "\uc9c0\ubc30\ud558\ub2e4, \ub2e4\uc2a4\ub9ac\ub2e4"\uc758 \ub73b\uc73c\ub85c \ucfe0\ubc84\ub124\ud2f0\uc2a4 \ub124\uc774\ud2f0\ube0c\ub85c \uc124\uacc4\ub41c \uc815\ucc45 \uc5d4\uc9c4(policy engine)\uc774\ub2e4. Kyverno \uc815\ucc45\uc744 \ud65c\uc6a9\ud558\uc5ec \ucfe0\ubc84\ub124\ud2f0\uc2a4 \ub9ac\uc18c\uc2a4\uac00 \uc815\ucc45\uc5d0 \ubd80\ud569\ud558\ub294\uc9c0 \uac80\uc0ac\ud558\uace0, \ud544\uc694\ud558\uba74 \ub9ac\uc18c\uc2a4\ub97c \ubcc0\uacbd\ud558\uac70\ub098 \uc0dd\uc131\ud560 \uc218 \uc788\ub2e4. Kyverno \uad6c\uc870 \ubc0f \ub3d9\uc791 \ubc29\uc2dd\uc744 \uac04\ub2e8\ud788 \uc815\ub9ac\ud55c\ub2e4.'),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://github.com/open-policy-agent/gatekeeper"},"OPA Gatekeeper"),"\ub294 \ub3c5\uc790\uc801\uc778 policy \uc5b8\uc5b4\uc778 Rego\ub97c \uc0ac\uc6a9\ud558\uc5ec policy\ub97c \uc815\uc758\ud558\ub9cc\nkyverno\ub294 \ucfe0\ubc84\ub124\ud2f0\uc2a4 \ub9ac\uc18c\uc2a4\ub85c \uad00\ub9ac\ub418\uba70 \uc815\ucc45\uc744 \uc791\uc131\ud558\ub294 \ub370 \uc0c8\ub85c\uc6b4 \uc5b8\uc5b4\uac00 \ud544\uc694\ud558\uc9c0 \uc54a\ub2e4.  OPA Gatekeeper\uc640 \uc720\uc0ac\ud558\uac8c\xa0",(0,l.kt)("a",{parentName:"p",href:"https://kyverno.io/policies"},"pre-defined policy library"),"\xa0\ub97c \uc81c\uacf5\ud55c\ub2e4."),(0,l.kt)("h2",{id:"kyverno-\uad6c\uc870-\ubc0f-\ub3d9\uc791-\ubc29\uc2dd"},"kyverno \uad6c\uc870 \ubc0f \ub3d9\uc791 \ubc29\uc2dd"),(0,l.kt)("p",null,"Kyverno\ub294 \ud074\ub7ec\uc2a4\ud130\uc5d0\uc11c ",(0,l.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/"},"dynamic admission controller"),"\ub85c \ub3d9\uc791\ud55c\ub2e4. Kyverno\ub294 kube-apiserver\ub85c\ubd80\ud130 admission HTTP callback\ub4e4\uc758 \ud655\uc778 \ub610\ub294 \ubcc0\uacbd\uc744 \uc218\uc2e0\ud558\uace0, \uc815\ucc45 \uc218\uc6a9\uacfc \uc694\uccad \uac70\uc808\uc744 \ubc18\ud658\ud558\uae30 \uc704\ud55c \uc815\ucc45\uc744 \uc801\uc6a9\ud55c\ub2e4. \ub530\ub77c\uc11c kubectl, git, kustomize\uc640 \uac19\uc740 \uc775\uc219\ud55c \ub3c4\uad6c\ub4e4\uc744 \uc0ac\uc6a9\ud558\uc5ec \uc815\ucc45\uc744 \uad00\ub9ac\ud560 \uc218 \uc788\ub2e4.  "),(0,l.kt)("p",null,"\uc815\ucc45\uc744 \ud1b5\ud574 \ucfe0\ubc84\ub124\ud2f0\uc2a4 \ub9ac\uc18c\uc2a4\uc758 \uc720\ud6a8\uc131 \uac80\uc0ac, \ubcc0\uacbd, \uc0dd\uc131, \uc815\ub9ac\ub97c \uc218\ud589\ud560 \uc218 \uc788\uc744 \ubfd0\ub9cc \uc544\ub2c8\ub77c OCI \uc774\ubbf8\uc9c0 \uacf5\uae09\ub9dd(supply chain) \ubcf4\uc548\uc744 \ubcf4\uc7a5\ud55c\ub2e4."),(0,l.kt)("p",null,"Kyverno CLI\ub294 CI/CD \ud30c\uc774\ud504\ub77c\uc778\uc758 \uc77c\ubd80\ub85c \uc815\ucc45\uc744 \ud14c\uc2a4\ud2b8\ud558\uace0 \ub9ac\uc18c\uc2a4\ub97c \uac80\uc99d\ud558\ub294 \ub370 \uc0ac\uc6a9\ud560 \uc218 \uc788\ub2e4."),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://kyverno.io/images/kyverno-architecture.png",alt:"Pasted image 20230408005656.png"})),(0,l.kt)("p",null,"\uace0\uac00\uc6a9\uc131 Kyverno \uc124\uce58\ub294 \uc5ec\ub7ec \uac1c\uc758 replica\ub97c \uc2e4\ud589\ud560 \uc218 \uc788\uc73c\uba70, \uac01 \ubcf5\uc81c\ubcf8\uc5d0\ub294 \uc11c\ub85c \ub2e4\ub978 \uae30\ub2a5\uc744 \uc218\ud589\ud558\ub294 \uc5ec\ub7ec \ucee8\ud2b8\ub864\ub7ec\uac00 \uc788\ub2e4.  "),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Webhook : kube-apiserver\uc758 AdmissionReview \uc694\uccad\uc744 \ucc98\ub9ac"),(0,l.kt)("li",{parentName:"ul"},"Monitor : webhook\uc5d0 \ud544\uc694\ud55c \uc124\uc815\uc744 \uc0dd\uc131\ud558\uace0 \uad00\ub9ac"),(0,l.kt)("li",{parentName:"ul"},"PolicyController : policy \ub9ac\uc18c\uc2a4\ub97c \uac10\uc2dc\ud558\uba70, \uc124\uc815\ub41c \uc2a4\uce94 \uac04\uaca9\uc5d0 \ub530\ub77c\uc11c \ubc31\uadf8\ub77c\uc6b4\ub4dc \uc2a4\uce94\uc744 \uc2dc\uc791"),(0,l.kt)("li",{parentName:"ul"},"GenerateController : \uc0dd\uc131\ub41c \ub9ac\uc18c\uc2a4\ub4e4\uc758 \uc0dd\uba85\uc8fc\uae30\ub97c \uad00\ub9ac")),(0,l.kt)("p",null,"Kyverno\ub294 \ucd5c\uc2e0 \ubc84\uc804\uc758 manifest \ub610\ub294 Helm\uc744 \uc0ac\uc6a9\ud558\uc5ec \uc124\uce58\ud560 \uc218 \uc788\ub2e4. Kyverno\ub294 \ucfe0\ubc84\ub124\ud2f0\uc2a4 \ud504\ub85c\uc81d\ud2b8\uc640 \ub3d9\uc77c\ud55c \uc9c0\uc6d0 \uc815\ucc45\uc778 N-2 \uc815\ucc45\uc744 \ub530\ub974\uba70, \uc138 \uac00\uc9c0 \ucd5c\uc2e0 \ub9c8\uc774\ub108 \ub9b4\ub9ac\uc2a4\uac00 \uc720\uc9c0\ub41c\ub2e4.  "),(0,l.kt)("h3",{id:"yaml\uc744-\uc0ac\uc6a9\ud558\uc5ec-kyverno-\uc124\uce58"},"YAML\uc744 \uc0ac\uc6a9\ud558\uc5ec Kyverno \uc124\uce58"),(0,l.kt)("p",null,"\ub2e8\uc77c \uc124\uce58 \ub9e4\ub2c8\ud398\uc2a4\ud2b8\ub97c \uc0ac\uc6a9\ud558\uc5ec Kyverno\ub97c \uc124\uce58\ud560 \uc218\ub3c4 \uc788\uc9c0\ub9cc \ud504\ub85c\ub355\uc158 \uc124\uce58\ub85c \uace0\uac00\uc6a9\uc131\uc73c\ub85c \uad6c\uc131\ud560 \uacbd\uc6b0 \ud5ec\ub984 \ucc28\ud2b8\ub85c \ud574\uc57c \ud55c\ub2e4."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"kubectl create -f https://github.com/kyverno/kyverno/releases/download/v1.9.0/install.yaml\n")),(0,l.kt)("h3",{id:"helm\uc744-\uc0ac\uc6a9\ud558\uc5ec-kyverno-\uc124\uce58"},(0,l.kt)("a",{parentName:"h3",href:"https://kyverno.io/docs/installation/#install-kyverno-using-helm"},"Helm\uc744 \uc0ac\uc6a9\ud558\uc5ec Kyverno \uc124\uce58")),(0,l.kt)("p",null,"\ud5ec\ub984\uc744 \uc0ac\uc6a9\ud558\uc5ec Kyverno\ub97c \uc124\uce58\ud558\ub824\uba74 \uba3c\uc800 Kyverno \ud5ec\ub984 \ub9ac\ud3ec\uc9c0\ud1a0\ub9ac\ub97c \ucd94\uac00\ud55c\ub2e4."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"helm repo add kyverno https://kyverno.github.io/kyverno/\n")),(0,l.kt)("p",null,"\ub9ac\ud3ec\uc9c0\ud1a0\ub9ac\ub97c \uc5c5\ub370\uc774\ud2b8 \ud558\uace0 \ucc28\ud2b8\ub97c \uac80\uc0c9\ud55c\ub2e4."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"helm repo update\nhelm search repo kyverno -l\n")),(0,l.kt)("p",null,"\uace0\uac00\uc6a9\uc131\uc744 \uc704\ud574 replica\ub97c 3\uc73c\ub85c \uc124\uce58\ud55c\ub2e4. "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"helm install kyverno kyverno/kyverno -n kyverno --create-namespace --set replicaCount=3\n")),(0,l.kt)("p",null,"Kyverno \ud30c\ub4dc \ubcf4\uc548 \ud45c\uc900 \uc815\ucc45\uc744 \uc124\uce58\ud558\ub824\uba74 Kyverno\ub97c \uc124\uce58\ud55c \ud6c4 \uc544\ub798 \ud5ec\ub984 \uba85\ub839\uc5b4\ub97c \uc2e4\ud589\ud55c\ub2e4."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"helm install kyverno-policies kyverno/kyverno-policies -n kyverno\n")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://kyverno.io/images/Kyverno-Policy-Structure.png",alt:"Pasted image 20230408020119.png"})),(0,l.kt)("p",null,"\uc815\ucc45\uc5d0 \ub300\ud574\uc11c \uc870\uae08 \uc790\uc138\ud788 \uc0b4\ud3b4\ubcf4\uba74, Policy\ub294 Rule\ub4e4\uc758 \uc9d1\ud569\uc774\uace0, \uac01 rule\uc740 \ud558\ub098\uc758\xa0",(0,l.kt)("a",{parentName:"p",href:"https://kyverno.io/docs/writing-policies/match-exclude/"},"match"),"\uc640\xa0",(0,l.kt)("a",{parentName:"p",href:"https://kyverno.io/docs/writing-policies/mutate/"},"mutate"),",\xa0",(0,l.kt)("a",{parentName:"p",href:"https://kyverno.io/docs/writing-policies/validate/"},"validate"),",\xa0",(0,l.kt)("a",{parentName:"p",href:"https://kyverno.io/docs/writing-policies/generate"},"generate"),"\xa0resource \ub610\ub294\xa0",(0,l.kt)("a",{parentName:"p",href:"https://kyverno.io/docs/writing-policies/verify-images"},"verifyImages"),"\xa0\uc911 \ud558\ub098\ub85c \uad6c\uc131\ub41c\ub2e4. Policy\uc758 \uc885\ub958(kind)\ub294 \ud074\ub7ec\uc2a4\ud130 \uc804\uccb4\uc5d0 \uc801\uc6a9\ub418\ub294 ClusterPolicy\uc640 namespace\uc5d0 \uc801\uc6a9\ub418\ub294 Policy\uac00 \uc788\ub2e4."),(0,l.kt)("p",null,"\uc815\ucc45\uc740 \uc815\uc758\ub41c \uc21c\uc11c\ub300\ub85c \uc801\uc6a9\ub41c\ub2e4. admission control\uc5d0\uc11c mutation \uaddc\uce59\uc740 validation \uaddc\uce59 \uc804\uc5d0 \uc801\uc6a9\ub418\uae30 \ub54c\ubb38\uc5d0 mutation\uc5d0 \uc758\ud55c \uacb0\uacfc\ub97c validation\ud560 \uc218 \uc788\ub2e4.\xa0\ubaa8\ub4e0 mutation \uaddc\uce59\uc740 \ubaa8\ub4e0 \uc815\ucc45\uc5d0\uc11c validation \uaddc\uce59\uc774 \uc801\uc6a9\ub418\uae30 \uc804\uc5d0 \uc801\uc6a9\ub41c\ub2e4."),(0,l.kt)("p",null,"\uc5ec\ub7ec\uac00\uc9c0 \uc815\ucc45\ub4e4\uc774 \uc788\uc9c0\ub9cc \uac04\ub2e8\ud558\uac8c \ud14c\uc2a4\ud2b8\ub97c \uc9c4\ud589\ud558\ub294 \uc870\uac74\uc73c\ub85c ",(0,l.kt)("inlineCode",{parentName:"p"},"latest")," \ud0dc\uadf8\uac00 \ub2ec\ub9b0 \uc774\ubbf8\uc9c0\ub294 \ubc30\ud3ec\ub418\uc9c0 \uc54a\uac8c \ud558\ub294 \uac83\uc744 \uc9c4\ud589\ud574 \ubcf8\ub2e4. "),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://kyverno.io/policies/best-practices/disallow_latest_tag/disallow_latest_tag/"},"https://kyverno.io/policies/best-practices/disallow_latest_tag/disallow_latest_tag/")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"latest")," \ud0dc\uadf8\ub294 \ubcc0\uacbd \uac00\ub2a5\ud558\uba70 \uc774\ubbf8\uc9c0\uac00 \ubcc0\uacbd\ub418\uba74 \uc608\uae30\uce58 \uc54a\uc740 \uc624\ub958\uac00 \ubc1c\uc0dd\ud560 \uc218 \uc788\ub2e4. \uc77c\ubc18\uc801\uc73c\ub85c \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \ud30c\ub4dc\uc758 \ud2b9\uc815 \ubc84\uc804\uc5d0 \ub9e4\ud551\ub418\ub294 \ubcc0\uacbd \ubd88\uac00\ub2a5\ud55c \ud0dc\uadf8\ub97c \uc0ac\uc6a9\ud558\ub294 \uac83\uc774 \uc88b\ub2e4. \uc774 \uc815\ucc45\uc740 \uc774\ubbf8\uc9c0\uac00 \ud0dc\uadf8\ub97c \uc9c0\uc815\ud558\uace0 \ud574\ub2f9 \ud0dc\uadf8\uac00 ",(0,l.kt)("inlineCode",{parentName:"p"},"latest"),"\ub85c \ud638\ucd9c\ub418\uc9c0 \uc54a\ub294\uc9c0 \ud655\uc778\ud55c\ub2e4. "),(0,l.kt)("p",null,"\uc544\ub798 ClusterPolicy \uc5d0\uc11c ",(0,l.kt)("inlineCode",{parentName:"p"},"spec.validationFailureAction"),"\ub294 \uc720\ud6a8\uc131 \uac80\uc0ac \uc815\ucc45 \uaddc\uce59 \uc2e4\ud328 \uc2dc \uc5b4\ub5a4 \uc561\uc158\uc744 \uc218\ud589\ud560\uc9c0 \uc815\ud558\ub294 \ubd80\ubd84\uc774\ub2e4. ",(0,l.kt)("inlineCode",{parentName:"p"},"enforce")," \ub294 \uc815\ucc45\ub0b4\uc758 \uaddc\uce59(latest \ud0dc\uadf8\uac00 \uc788\ub294 \ud30c\ub4dc\uac00 \ubc30\ud3ec\ub420 \uacbd\uc6b0)\uc5d0 \ud574\ub2f9\ud558\ub294 \uc774\ubca4\ud2b8\uac00 \ubc1c\uc0dd\ud558\uac8c \ub418\uba74 \uac15\uc81c\uc801\uc6a9\ub418\uace0, \uae30\ubcf8\uac12\uc778 ",(0,l.kt)("inlineCode",{parentName:"p"},"audit"),"\uc758 \uacbd\uc6b0\uc5d0\ub294 \uac10\uc0ac\ub85c\uadf8\ub9cc \uc0dd\uc131\uc774 \ub41c\ub2e4. "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: kyverno.io/v1\nkind: ClusterPolicy\nmetadata:\n  name: disallow-latest-tag\n  annotations:\n    policies.kyverno.io/title: Disallow Latest Tag\n    policies.kyverno.io/category: Best Practices\n    policies.kyverno.io/minversion: 1.6.0\n    policies.kyverno.io/severity: medium\n    policies.kyverno.io/subject: Pod\n    policies.kyverno.io/description: >-\n      The \':latest\' tag is mutable and can lead to unexpected errors if the\n      image changes. A best practice is to use an immutable tag that maps to\n      a specific version of an application Pod. This policy validates that the image\n      specifies a tag and that it is not called `latest`.      \nspec:\n  validationFailureAction: enforce\n  background: true\n  rules:\n  - name: require-image-tag\n    match:\n      any:\n      - resources:\n          kinds:\n          - Pod\n    validate:\n      message: "An image tag is required."\n      pattern:\n        spec:\n          containers:\n          - image: "*:*"\n  - name: validate-image-tag\n    match:\n      any:\n      - resources:\n          kinds:\n          - Pod\n    validate:\n      message: "Using a mutable image tag e.g. \'latest\' is not allowed."\n      pattern:\n        spec:\n          containers:\n          - image: "!*:latest"\n\n')),(0,l.kt)("p",null,"\ud14c\uc2a4\ud2b8\ub85c nginx:latest \uc774\ubbf8\uc9c0\ub97c \uc0dd\uc131\ud558\uba74 admission webhook \ub2e8\uacc4\uc5d0\uc11c \uc694\uccad\uc744 \uac70\uc808\ud558\uc5ec deployment \ubc30\ud3ec\uac00 \uc2e4\ud328\ud55c \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\ub2e4. "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ kubectl create deployment nginx --image=nginx:latest\n\nerror: failed to create deployment: admission webhook \"validate.kyverno.svc-fail\" denied the request: \n\npolicy Deployment/default/nginx for resource violation: \n\ndisallow-latest-tag:\n  autogen-validate-image-tag: 'validation error: Using a mutable image tag e.g. ''latest''\n    is not allowed. rule autogen-validate-image-tag failed at path /spec/template/spec/containers/0/image/'\n")),(0,l.kt)("p",null,"event\ub97c \ud655\uc778\ud574\ubcf4\uba74 \ub2e4\uc74c\uacfc \uac19\uc774 nginx \ud30c\ub4dc \uc624\ube0c\uc81d\ud2b8\uac00 Killing \ub418\ub294\uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\ub2e4."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ kubectl get events -A --sort-by=.metadata.creationTimestamp --field-selector type!=Warning\nNAMESPACE   LAST SEEN   TYPE     REASON    OBJECT                       MESSAGE\ndefault     1m         Normal   Killing   pod/nginx-7597c656c9-rlvnr   Stopping container nginx\n")),(0,l.kt)("p",null,"\uc774\ubc88\uc5d0\ub294 \uc815\ucc45 \uc704\ubc18 \uc2dc ",(0,l.kt)("inlineCode",{parentName:"p"},"audit")," \uc635\uc158\uc73c\ub85c \ubc14\uafb8\uace0 \ub611\uac19\uc774 \ubc30\ud3ec\ub97c \uc9c4\ud589\ud574\ubcf4\uba74 \uc815\uc0c1\uc801\uc73c\ub85c \ubc30\ud3ec\ub294 \uc9c4\ud589\ub418\uc9c0\ub9cc, event\ub098 describe\ub85c \ud655\uc778\ud574\ubcf4\uba74 \ub2e4\uc74c\uacfc \uac19\uc774 \uc815\ucc45 \uc704\ubc18 Warning \uba54\uc138\uc9c0\ub97c \ud655\uc778\ud560 \uc218 \uc788\ub2e4."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},'Events:\n  Type     Reason           Age    From               Message\n  ----     ------           ----   ----               -------\n  Normal   Scheduled        2m29s  default-scheduler  Successfully assigned default/nginx-7597c656c9-w897t to i-00b3ebc1b78f19739\n  Normal   Pulling          2m28s  kubelet            Pulling image "nginx:latest"\n  Normal   Pulled           2m21s  kubelet            Successfully pulled image "nginx:latest" in 6.218701714s\n  Normal   Created          2m21s  kubelet            Created container nginx\n  Normal   Started          2m21s  kubelet            Started container nginx\n  Warning  PolicyViolation  118s   kyverno-scan       policy disallow-latest-tag/validate-image-tag fail: validation error: Using a mutable image tag e.g. \'latest\' is not allowed. rule validate-image-tag failed at path /spec/containers/0/image/\n')),(0,l.kt)("p",null,"\uc608\uc2dc\ub85c \uc774\ubbf8\uc9c0 \ud0dc\uadf8\ub97c \uc81c\uc5b4\ud558\ub294 \uc815\ucc45\uc744 \uac00\uc9c0\uace0 \ud14c\uc2a4\ud2b8\ub97c \uc9c4\ud589\ud558\uc600\uc9c0\ub9cc, \uc774\uc678\uc5d0\ub3c4 \ub9ce\uc740 \uc815\ucc45\ub4e4\uc744 \uc801\uc6a9\ud574\ubcfc \uc218 \uc788\ub2e4."),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://kyverno.io/docs/writing-policies/validate/"},"Validate"),"\xa0: Kubernetes API Server\ub85c \ub4e4\uc5b4\uc624\ub294 \uc694\uccad \uc911 \ud544\uc218 \uc124\uc815(\uc608, \ud2b9\uc815 \ub77c\ubca8\uc774 \ub204\ub77d\ub418\uac70\ub098, \uc778\uadf8\ub808\uc2a4 \uc0dd\uc131\uc2dc \uc778\uc99d\uc11c\uac00 \ub204\ub77d\ub41c \uacbd\uc6b0)\uc774 \ub204\ub77d\ub41c \uacbd\uc6b0 \ucc28\ub2e8"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://kyverno.io/docs/writing-policies/mutate/"},"Mutate"),"\xa0: \uc6b4\uc601\ud658\uacbd\uc5d0\uc11c \uc77c\ubd80 \uc124\uc815 \uc624\ub958\ub85c \uc778\ud55c \uc7a5\uc560\uac00 \ubc1c\uc0dd\ud558\uc9c0 \uc54a\ub3c4\ub85d \uc608\ubc29"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://kyverno.io/policies/pod-security/baseline/disallow-capabilities/disallow-capabilities/"},"Disallow Capabilities"),":  \uc815\ucc45\uc5d0 \ub098\uc5f4\ub41c Linux Capability \uc774\uc678\uc758 \uae30\ub2a5\uc744 \ucd94\uac00\ud558\ub294 \uac83\uc740 \ud5c8\uc6a9\ud558\uc9c0 \uc54a\uc74c")),(0,l.kt)("h3",{id:"\uc815\ub9ac"},"\uc815\ub9ac"),(0,l.kt)("p",null,"1.25\ubc84\uc804 \ubd80\ud130 Pod Security Policies(PSPs)\uac00 deprecated \ub418\uba74\uc11c admission controller\uc640 \uc815\ucc45 \uc5d4\uc9c4 \uc601\uc5ed\uc5d0\uc11c \ud65c\uc6a9\uc774 \uac00\ub2a5\ud55c \uc194\ub8e8\uc158\uc774 \ud544\uc694\ud558\uac8c \ub418\uc5c8\ub294\ub370, \uc2a4\ud130\ub514\uc5d0\uc11c \uc18c\uac1c\ud574\uc900 polaris\ub294 \uae54\ub054\ud55c \ub300\uc2dc\ubcf4\ub4dc\uc640 \uc815\ucc45 \uc5d4\uc9c4\uc73c\ub85c\uc11c \ub2e4\uc591\ud55c \uae30\ub2a5\ub4e4\uc744 \ud65c\uc6a9\ud560 \uc218 \uc788\ub2e4. polaris\ub294 \uc624\ud508\uc18c\uc2a4 \uae30\uc900\uc5d0\uc11c\ub3c4 \ubcf4\uc548\uc5d0 \ub300\ud55c \ucde8\uc57d\uc810\uacfc \uc124\uc815\uc744 \uc27d\uac8c \uc54c\uc544\ub0b4\uace0 \ub9ac\ud3ec\ud2b8\ub97c \ubf51\uc544\ub0b4\ub294 \uce21\uba74\uc774 \uac15\ud558\ub2e4\uba74, kyverno\ub294 \uc815\ucc45\uc744 Kubernetes \ub9ac\uc18c\uc2a4\ub85c native\ud558\uac8c \uad00\ub9ac\ud560 \uc218 \uc788\uae30 \ub54c\ubb38\uc5d0 kubectl, git, kustomize\uc640 \uac19\uc740 \ub3c4\uad6c\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc815\ucc45\uc744 \uc870\uae08\ub354 \uc801\uadf9\uc801\uc73c\ub85c \uac10\uc0ac\ud558\uac70\ub098 \ucc28\ub2e8\ud558\ub294 \ud615\ud0dc\uc758 \uad00\ub9ac\uac00 \uac00\ub2a5\ud558\ub2e4."),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\ud574\ub2f9 \ud3ec\uc2a4\ud305\uc740 \ud604\uc7ac \uc7ac\uc9c1\uc911\uc778 \ud68c\uc0ac\uc5d0 \uad00\ub828\uc774 \uc5c6\uace0, \uac1c\uc778 \uc5ed\ub7c9 \uac1c\ubc1c\uc744 \uc704\ud55c \uc790\ub8cc\ub85c \ud65c\uc6a9\ud560 \uc608\uc815\uc785\ub2c8\ub2e4.")))}k.isMDXComponent=!0}}]);