"use strict";(self.webpackChunkddii=self.webpackChunkddii||[]).push([[1663],{3905:function(e,n,t){t.d(n,{Zo:function(){return p},kt:function(){return m}});var a=t(67294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function r(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},l=Object.keys(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var s=a.createContext({}),c=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},p=function(e){var n=c(e.components);return a.createElement(s.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,l=e.originalType,s=e.parentName,p=r(e,["components","mdxType","originalType","parentName"]),d=c(t),m=i,k=d["".concat(s,".").concat(m)]||d[m]||u[m]||l;return t?a.createElement(k,o(o({ref:n},p),{},{components:t})):a.createElement(k,o({ref:n},p))}));function m(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var l=t.length,o=new Array(l);o[0]=d;var r={};for(var s in n)hasOwnProperty.call(n,s)&&(r[s]=n[s]);r.originalType=e,r.mdxType="string"==typeof e?e:i,o[1]=r;for(var c=2;c<l;c++)o[c]=t[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},32920:function(e,n,t){t.r(n),t.d(n,{assets:function(){return p},contentTitle:function(){return s},default:function(){return m},frontMatter:function(){return r},metadata:function(){return c},toc:function(){return u}});var a=t(87462),i=t(63366),l=(t(67294),t(3905)),o=["components"],r={layout:"single",title:"Knative on EKS",comments:!0,classes:"wide",description:"EKS\uc5d0\uc11c\ub3c4 Knative\ub97c \uad6c\uc131\ud574\ubcf4\uc790",slug:"kubernetes/knative-on-aws/",date:new Date("2019-05-14T00:00:00.000Z"),categories:["Kubernetes"],tags:["Knative","Kubernetes","FaaS","AWS","Lambda","Serverless","EKS"]},s=void 0,c={permalink:"/kubernetes/knative-on-aws/",editUrl:"https://github.com/ddiiwoong/newblog/tree/main/blog/2019-05-14-knative-on-aws.md",source:"@site/blog/2019-05-14-knative-on-aws.md",title:"Knative on EKS",description:"EKS\uc5d0\uc11c\ub3c4 Knative\ub97c \uad6c\uc131\ud574\ubcf4\uc790",date:"2019-05-14T00:00:00.000Z",formattedDate:"May 14, 2019",tags:[{label:"Knative",permalink:"/tags/knative"},{label:"Kubernetes",permalink:"/tags/kubernetes"},{label:"FaaS",permalink:"/tags/faa-s"},{label:"AWS",permalink:"/tags/aws"},{label:"Lambda",permalink:"/tags/lambda"},{label:"Serverless",permalink:"/tags/serverless"},{label:"EKS",permalink:"/tags/eks"}],readingTime:11.905,truncated:!1,authors:[],frontMatter:{layout:"single",title:"Knative on EKS",comments:!0,classes:"wide",description:"EKS\uc5d0\uc11c\ub3c4 Knative\ub97c \uad6c\uc131\ud574\ubcf4\uc790",slug:"kubernetes/knative-on-aws/",date:"2019-05-14T00:00:00.000Z",categories:["Kubernetes"],tags:["Knative","Kubernetes","FaaS","AWS","Lambda","Serverless","EKS"]},prevItem:{title:"Yaml \uc791\uc131 \uae30\ubcf8 Tip",permalink:"/kubernetes/CKAD-1/"},nextItem:{title:"eksworkshop",permalink:"/kubernetes/eksworkshop/"}},p={authorsImageUrls:[]},u=[{value:"Knative on EKS",id:"knative-on-eks",level:2},{value:"EKS \ubc30\ud3ec",id:"eks-\ubc30\ud3ec",level:2},{value:"istio \uc124\uce58",id:"istio-\uc124\uce58",level:2},{value:"Knative \uc124\uce58",id:"knative-\uc124\uce58",level:2},{value:"Build\uc5d0\uc11c \uc0ac\uc6a9\ud560 Docker Credential \uc124\uc815",id:"build\uc5d0\uc11c-\uc0ac\uc6a9\ud560-docker-credential-\uc124\uc815",level:2},{value:"Python \ucf54\ub4dc \ubc0f Dockerfile \uc791\uc131",id:"python-\ucf54\ub4dc-\ubc0f-dockerfile-\uc791\uc131",level:2},{value:"Knative Build",id:"knative-build",level:2},{value:"Knative Serving \uc73c\ub85c \ubc30\ud3ec",id:"knative-serving-\uc73c\ub85c-\ubc30\ud3ec",level:2},{value:"service.yaml",id:"serviceyaml",level:4},{value:"\uc815\ub9ac",id:"\uc815\ub9ac",level:2}],d={toc:u};function m(e){var n=e.components,t=(0,i.Z)(e,o);return(0,l.kt)("wrapper",(0,a.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"\uc774\ubc88\uc5d0\ub294 Knative\ub97c EKS\uc5d0 \uad6c\uc131\ud574\ubcf4\ub824\uace0 \ud55c\ub2e4. 4\uc6d4\uc740 \ubc1c\ud45c \ubc0f \uc5ec\ub7ec\uac00\uc9c0 \uc5c5\ubb34\ub85c \uc778\ud574\uc11c \ud3ec\uc2a4\ud305\uc744 \ud560 \uc2dc\uac04\uc774 \ubd80\uc871\ud588\uc9c0\ub9cc 5\uc6d4\ubd80\ud130 \uc870\uae08\uc529 \uc5ec\uc720\uac00 \uc0dd\uaca8\uc11c \ub354 \ubc14\ube60\uc9c0\uae30\uc804\uc5d0 \uc880 \uc368\ubcf4\ub824\uace0 \ud55c\ub2e4. \uc0ac\uc2e4 ",(0,l.kt)("a",{parentName:"p",href:"https://www.facebook.com/yongho1037"},"Facebook @\ucd5c\uc6a9\ud638"),"\ub2d8\uaed8\uc11c \ud55c\ubc88 \ud574\ubcf4\ub294\uac83\ub3c4 \uc88b\uaca0\ub2e4\uace0 \ud558\uc154\uc11c \ud14c\uc2a4\ud2b8\ub97c \uc9c4\ud589\ud558\uc600\ub2e4.  "),(0,l.kt)("h2",{id:"knative-on-eks"},"Knative on EKS"),(0,l.kt)("p",null,"\uc81c\ubaa9\ub9cc \ubcf4\uba74 Lambda\ub098 ECS, Batch \uc11c\ube44\uc2a4\uac00 \uc788\ub294\ub370 \uc65c \uc774\uac78 \uc368\uc57c\ud558\uc9c0? \ub77c\ub294 \uc0dd\uac01\ubd80\ud130 \ud558\ub294 \uc0ac\ub78c\ub3c4 \uc788\uc744\uac83 \uac19\ub2e4. \ud558\uc9c0\ub9cc \uc774\uc804 \ud3ec\uc2a4\ud305\ub4e4\uacfc \ubc1c\ud45c\uc5d0\uc11c\ub3c4 \uc5ec\ub7ec\ubc88 \uc774\uc57c\uae30 \ud55c\uac83\ucc98\ub7fc Knative\ub294 \uac04\ub2e8\ud558\uac8c \uc11c\ubc84\ub9ac\uc2a4 \uc6cc\ud06c\ub85c\ub4dc\ub97c \ube4c\ub4dc, \ubc30\ud3ec, \uad00\ub9ac\ud558\uae30 \uc704\ud55c Kubernetes\uae30\ubc18 FaaS\ud50c\ub7ab\ud3fc\uc774\uace0 \ud604\uc7ac ",(0,l.kt)("a",{parentName:"p",href:"https://landscape.cncf.io/"},"CNCF Landscape"),"\uc5d0\uc11c \uac00\uc7a5 \ube60\ub978 \uc18d\ub3c4\ub85c \uac1c\ubc1c\ub418\uace0 \uc788\ub294 \uc624\ud508\uc18c\uc2a4 \ud504\ub85c\uc81d\ud2b8 \uc911 \ud558\ub098\uc774\ub2e4."),(0,l.kt)("h2",{id:"eks-\ubc30\ud3ec"},"EKS \ubc30\ud3ec"),(0,l.kt)("p",null,"\uc55e\uc120 ",(0,l.kt)("a",{parentName:"p",href:"https://ddii.dev/kubernetes/eksworkshop/"},"eksworkshop \ud3ec\uc2a4\ud305"),"\uc5d0\uc11c\ucc98\ub7fc \uac04\ub2e8\ud55c \ubc30\ud3ec\ub97c \uc704\ud574 ",(0,l.kt)("inlineCode",{parentName:"p"},"eksctl"),"\ub85c 2-node \ud074\ub7ec\uc2a4\ud130\ub97c \ubc30\ud3ec\ud55c\ub2e4.",(0,l.kt)("br",{parentName:"p"}),"\n","\uc0ac\uc804 \uc900\ube44\uc0ac\ud56d\uc740 ",(0,l.kt)("a",{parentName:"p",href:"https://ddii.dev/kubernetes/eksworkshop/"},"\uc774\uc804 \ud3ec\uc2a4\ud305"),"\uc774\ub098 ",(0,l.kt)("a",{parentName:"p",href:"https://eksctl.io/"},"https://eksctl.io/"),"\uc744 \ucc38\uace0\ud558\uc790.  "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ eksctl create cluster --name=eksworkshop-eksctl --nodes=2 --node-ami=auto\n")),(0,l.kt)("p",null,"\uc0dd\uc131\ub41c \ud074\ub7ec\uc2a4\ud130 \uc0c1\ud0dc\ub97c \ud655\uc778\ud55c\ub2e4. "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ kubectl get nodes\nNAME                                                STATUS    ROLES     AGE       VERSION\nip-192-168-24-168.ap-northeast-2.compute.internal   Ready     <none>    2m        v1.11.9\nip-192-168-78-204.ap-northeast-2.compute.internal   Ready     <none>    2m        v1.11.9\n")),(0,l.kt)("h2",{id:"istio-\uc124\uce58"},"istio \uc124\uce58"),(0,l.kt)("p",null,"Knative\ub294 istio \uc758\uc874\uc131\uc744 \uac00\uc9c0\uace0 \uc788\uae30 \ub54c\ubb38\uc5d0 Istio\ub97c \uba3c\uc800 \ubc30\ud3ec\ud55c\ub2e4. \ubb3c\ub860 ",(0,l.kt)("a",{parentName:"p",href:"https://ddii.dev/kubernetes/knative-using-gloo/"},"\uc774\uc804 \ud3ec\uc2a4\ud305"),"\uc5d0\uc11c \uc124\uba85\ud55c\uac83 \ucc98\ub7fc Gloo\ub97c \uc0ac\uc6a9\ud574\ub3c4 \ub418\uc9c0\ub9cc \uc774\ubc88\uc5d0\ub294 Istio\ub97c \uc124\uce58\ud558\uc600\ub2e4.  "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ kubectl apply -f https://github.com/knative/serving/releases/download/v0.5.0/istio-crds.yaml \n$ kubectl apply -f https://github.com/knative/serving/releases/download/v0.5.0/istio.yaml\n")),(0,l.kt)("p",null,"\ubc30\ud3ec\ub41c Pods, Services, Replicasets \uc744 \ud655\uc778\ud55c\ub2e4."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ kubectl get pods -n istio-system\nNAME                                     READY     STATUS      RESTARTS   AGE\ncluster-local-gateway-65c8b667c8-269cf   1/1       Running     0          17m\nistio-citadel-76bd44d8f7-5cltj           1/1       Running     0          17m\nistio-cleanup-secrets-7jpth              0/1       Completed   0          17m\nistio-egressgateway-b9d56b4f8-pdjhs      1/1       Running     0          17m\nistio-galley-7db7db89db-5stkp            1/1       Running     0          17m\nistio-ingressgateway-f77fbc787-npw9d     1/1       Running     0          17m\nistio-pilot-69f975bf4f-4dq4d             2/2       Running     0          17m\nistio-pilot-69f975bf4f-q9g8g             2/2       Running     0          16m\nistio-pilot-69f975bf4f-tnm92             2/2       Running     0          16m\nistio-policy-8db48cbcd-dl2th             2/2       Running     0          17m\nistio-security-post-install-xv8z6        0/1       Completed   0          17m\nistio-sidecar-injector-cd54ffccd-kj2n6   1/1       Running     0          17m\nistio-telemetry-d78cd45db-8x2cw          2/2       Running     0          17m\n\n$ kubectl get svc -n istio-system\nNAME                     TYPE           CLUSTER-IP       EXTERNAL-IP                                                                   PORT(S)                                                                                                                   AGE\ncluster-local-gateway    ClusterIP      10.100.97.146    <none>                                                                        80/TCP,443/TCP,31400/TCP,15011/TCP,8060/TCP,15030/TCP,15031/TCP                                                           17m\nistio-citadel            ClusterIP      10.100.147.235   <none>                                                                        8060/TCP,9093/TCP                                                                                                         17m\nistio-egressgateway      ClusterIP      10.100.25.44     <none>                                                                        80/TCP,443/TCP                                                                                                            17m\nistio-galley             ClusterIP      10.100.158.45    <none>                                                                        443/TCP,9093/TCP                                                                                                          17m\nistio-ingressgateway     LoadBalancer   10.100.62.157    a4e1d5201758f11e9b7f402c4d4b0376-510368564.ap-northeast-2.elb.amazonaws.com   80:31000/TCP,443:30753/TCP,31400:31922/TCP,15011:31331/TCP,8060:30389/TCP,853:30257/TCP,15030:30827/TCP,15031:30153/TCP   17m\nistio-pilot              ClusterIP      10.100.25.194    <none>                                                                        15010/TCP,15011/TCP,8080/TCP,9093/TCP                                                                                     17m\nistio-policy             ClusterIP      10.100.73.149    <none>                                                                        9091/TCP,15004/TCP,9093/TCP                                                                                               17m\nistio-sidecar-injector   ClusterIP      10.100.117.18    <none>                                                                        443/TCP                                                                                                                   17m\nistio-telemetry          ClusterIP      10.100.87.12     <none>                                                                        9091/TCP,15004/TCP,9093/TCP,42422/TCP                                                                                     17m\n\n$ kubectl get rs -n istio-system\nNAME                               DESIRED   CURRENT   READY     AGE\ncluster-local-gateway-65c8b667c8   1         1         1         17m\nistio-citadel-76bd44d8f7           1         1         1         17m\nistio-egressgateway-b9d56b4f8      1         1         1         17m\nistio-galley-7db7db89db            1         1         1         17m\nistio-ingressgateway-f77fbc787     1         1         1         17m\nistio-pilot-69f975bf4f             3         3         3         17m\nistio-policy-8db48cbcd             1         1         1         17m\nistio-sidecar-injector-cd54ffccd   1         1         1         17m\nistio-telemetry-d78cd45db          1         1         1         17m\n")),(0,l.kt)("p",null,"Istio injection\uc744 \ud558\uae30 \uc704\ud574 \ubc30\ud3ec\ud560 defaults namespace \uc804\uccb4\uc5d0 Labeling\uc744 \ud55c\ub2e4."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ kubectl label namespace default istio-injection=enabled\nnamespace/default labeled\n\n$ kubectl get namespaces --show-labels\nNAME           STATUS    AGE       LABELS\ndefault        Active    43m       istio-injection=enabled\nistio-system   Active    27m       istio-injection=disabled\nkube-public    Active    43m       <none>\nkube-system    Active    43m       <none>\n")),(0,l.kt)("h2",{id:"knative-\uc124\uce58"},"Knative \uc124\uce58"),(0,l.kt)("p",null,"build, evening, serving \ubc0f \ubaa8\ub2c8\ud130\ub9c1 \ub9ac\uc18c\uc2a4\ub97c \ubc30\ud3ec\ud55c\ub2e4."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"kubectl apply -f https://github.com/knative/serving/releases/download/v0.5.0/serving.yaml \\\n   -f https://github.com/knative/build/releases/download/v0.5.0/build.yaml \\\n   -f https://github.com/knative/eventing/releases/download/v0.5.0/release.yaml \\\n   -f https://github.com/knative/eventing-sources/releases/download/v0.5.0/eventing-sources.yaml \\\n   -f https://github.com/knative/serving/releases/download/v0.5.0/monitoring.yaml \\\n   -f https://raw.githubusercontent.com/knative/serving/v0.5.0/third_party/config/build/clusterrole.yaml\n")),(0,l.kt)("p",null,"\ubaa8\ub4e0 Knative namespaces \ubc0f resources\ub97c \ud655\uc778\ud55c\ub2e4."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ kubectl get namespaces | grep knative\nknative-build        Active    8m\nknative-eventing     Active    8m\nknative-monitoring   Active    8m\nknative-serving      Active    8m\nknative-sources      Active    8m\n\n$ kubectl get pods -n knative-serving\nNAME                          READY     STATUS    RESTARTS   AGE\nactivator-664b5b9598-dsjvq    2/2       Running   0          10m\nautoscaler-64d5bd84b8-bqghq   2/2       Running   0          10m\ncontroller-658b9d5c6c-tnwvz   1/1       Running   0          10m\nwebhook-5dffbfbb8b-525vt      1/1       Running   0          10m\n\n$ kubectl get pods -n knative-build \nNAME                                READY     STATUS    RESTARTS   AGE\nbuild-controller-86f5b5b96d-zg8j2   1/1       Running   0          11m\nbuild-webhook-6fddd7c6df-68fkw      1/1       Running   0          11m\n\n$ kubectl get pods -n knative-eventing \nNAME                                            READY     STATUS    RESTARTS   AGE\neventing-controller-6fdccd8c95-bckws            1/1       Running   0          11m\nin-memory-channel-controller-6fddb6655f-vbc64   1/1       Running   0          11m\nin-memory-channel-dispatcher-7684cd7c7d-ftqhc   2/2       Running   2          11m\nwebhook-d496c66bd-688xz                         1/1       Running   0          11m\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ kubectl get pods -n knative-monitoring \nNAME                                  READY     STATUS    RESTARTS   AGE\nelasticsearch-logging-0               1/1       Running   0          14m\nelasticsearch-logging-1               1/1       Running   0          12m\ngrafana-754bc795bb-wxwml              1/1       Running   0          14m\nkibana-logging-7f7b9698bc-rrnw6       1/1       Running   0          14m\nkube-state-metrics-5bccdf746f-fhv7t   4/4       Running   0          12m\nnode-exporter-w9jlq                   2/2       Running   0          14m\nnode-exporter-wgv2j                   2/2       Running   0          14m\nprometheus-system-0                   1/1       Running   0          14m\nprometheus-system-1                   1/1       Running   0          14m\n")),(0,l.kt)("p",null,"\ubaa8\ub2c8\ud130\ub9c1 \ub9ac\uc18c\uc2a4\ub3c4 \ud655\uc778\ud55c\ub2e4. \uc704\uc758 \ub9ac\uc18c\uc2a4\ub97c \ubcf4\uba74 Fluentd\uac00 \ubc30\ud3ec\ub418\uc9c0 \uc54a\uc740 \uc0c1\ud0dc\uc774\ubbc0\ub85c DaemonSet\uc73c\ub85c \ub3d9\uc791\ud560\uc218 \uc788\ub3c4\ub85d \uc544\ub798\uc640 \uac19\uc774 \uc124\uc815\ud558\uba74 DaemonSet\uc744 \ud655\uc778\ud560 \uc218 \uc788\ub2e4.  "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},'$ kubectl label nodes --all beta.kubernetes.io/fluentd-ds-ready="true"\n')),(0,l.kt)("h2",{id:"build\uc5d0\uc11c-\uc0ac\uc6a9\ud560-docker-credential-\uc124\uc815"},"Build\uc5d0\uc11c \uc0ac\uc6a9\ud560 Docker Credential \uc124\uc815"),(0,l.kt)("p",null,"\uc77c\ub2e8 Knative Build\ub97c \uc218\ud589\ud560\ub54c \uc77c\ubc18\uc801\uc73c\ub85c Container Registry\ub97c \ub9ce\uc774 \uc0ac\uc6a9\ud558\uae30 \ub54c\ubb38\uc5d0 Registry Credential \uc124\uc815\uc744 \ud574\uc57c\ud55c\ub2e4.  "),(0,l.kt)("p",null,"ECR\uc758 \uacbd\uc6b0 ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/knative/build-templates"},"https://github.com/knative/build-templates"),"\uc758 ecr_helper\ub97c \uc0ac\uc6a9\ud558\uba74 \uc27d\uac8c ECR account\ub97c \uc124\uc815\ud560 \uc218 \uc788\uc9c0\ub9cc ",(0,l.kt)("inlineCode",{parentName:"p"},"Serving"),"\ub2e8\uacc4\uc5d0\uc11c 401\uc5d0\ub7ec\uac00 \ub098\ub294 \uc774\uc720\ub97c \uc7a1\uc9c0 \ubabb\ud574\uc11c \uc77c\ub2e8 Dockerhub\ub97c \uac00\uc9c0\uace0 \uc9c4\ud589\ud558\uc600\ub2e4."),(0,l.kt)("p",null,"\uac04\ub2e8\ud55c \ub370\ubaa8\ucf54\ub4dc\ub294 \uc544\ub798 repository\uc5d0 \ubbf8\ub9ac \uc791\uc131\ud574\ub1a8\ub2e4.  "),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://github.com/ddiiwoong/hello-python.git"},"https://github.com/ddiiwoong/hello-python.git")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"docker-secret.yaml")," \uc744 \ubcf4\uba74 dockerhub push\ub97c \uc704\ud574 basic-auth\ub97c \uc218\ud589\ud558\uac8c \ub418\ub294\ub370 dockerhub id/password \ub97c base64\ub85c encoding\ud574\uc11c Secret\uc73c\ub85c \uc800\uc7a5\ud55c\ub2e4.  "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: v1\nkind: Secret\nmetadata:\n  name: basic-user-pass\n  annotations:\n    build.knative.dev/docker-0: https://index.docker.io/v1/\ntype: kubernetes.io/basic-auth\ndata:\n  # Use 'echo -n \"username\" | base64' to generate this string\n  username: BASE64_ENCODED_USERNAME\n  # Use 'echo -n \"password\" | base64' to generate this string\n  password: BASE64_ENCODED_PASSWORD\n")),(0,l.kt)("p",null,"\uadf8\ub9ac\uace0 ServiceAccount ",(0,l.kt)("inlineCode",{parentName:"p"},"build-bot"),"\uc744 \uc0dd\uc131\ud558\uae30 \uc704\ud55c yaml (sa.yaml)\ub97c \uc791\uc131\ud55c\ub2e4.  "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: build-bot\nsecrets:\n  - name: basic-user-pass\n")),(0,l.kt)("p",null,"\uc704\uc5d0\uc11c \uc791\uc131\ud55c Secret(basic-user-pass)\uacfc ServiceAccount(build-bot)\ub97c \ubc30\ud3ec\ud55c\ub2e4.  "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},'$ kubectl apply -f docker-secret.yaml\nsecret "basic-user-pass" created\n$ kubectl apply -f sa.yaml\nserviceaccount "build-bot" created\n')),(0,l.kt)("p",null,"\uc800\uc7a5\ub41c Secret(basic-user-pass)\uacfc ServiceAccount(build-bot)\ub97c \ud655\uc778\ud55c\ub2e4."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ kubectl get secret\nNAME                        TYPE                                  DATA      AGE\nbasic-user-pass             kubernetes.io/basic-auth              2         2h\nbuild-bot-token-gfkg9       kubernetes.io/service-account-token   3         2h\nbuilder-token-kp7ww         kubernetes.io/service-account-token   3         10h\ndefault-token-9cpp5         kubernetes.io/service-account-token   3         10h\necr-creds                   kubernetes.io/basic-auth              2         10h\nistio.build-bot             istio.io/key-and-cert                 3         2h\nistio.builder               istio.io/key-and-cert                 3         10h\nistio.default               istio.io/key-and-cert                 3         10h\nistio.knative-serve         istio.io/key-and-cert                 3         2h\nknative-serve-token-9j82l   kubernetes.io/service-account-token   3         2h\n\n$ kubectl get sa\nNAME            SECRETS   AGE\nbuild-bot       2         2h\nbuilder         2         10h\ndefault         1         10h\nknative-serve   2         2h\n")),(0,l.kt)("h2",{id:"python-\ucf54\ub4dc-\ubc0f-dockerfile-\uc791\uc131"},"Python \ucf54\ub4dc \ubc0f Dockerfile \uc791\uc131"),(0,l.kt)("p",null,"TARGET \ud658\uacbd\ubcc0\uc218\ub97c \ubc1b\uc544\uc11c Hello World\uc640 \uac19\uc774 \ucd9c\ub825\ud558\ub294 \uac04\ub2e8\ud55c Flask\uae30\ubc18 \uc571\uc744 \uc791\uc131\ud55c\ub2e4.  "),(0,l.kt)("p",null,"\uac04\ub2e8\ud55c \ub370\ubaa8\ucf54\ub4dc\ub294 \uc544\ub798 repository\uc5d0 \ubbf8\ub9ac \uc791\uc131\ud574\ub1a8\ub2e4.  "),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://github.com/ddiiwoong/hello-python.git"},"https://github.com/ddiiwoong/hello-python.git")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-py"},"import os\n\nfrom flask import Flask\n\napp = Flask(__name__)\n\n@app.route('/')\ndef hello_world():\n    target = os.environ.get('TARGET', 'NOT SPECIFIED')\n    return 'Hello World: {}!\\n'.format(target)\n\nif __name__ == \"__main__\":\n    app.run(debug=True, host='0.0.0.0', port=int(os.environ.get('PORT', 8080)))\n")),(0,l.kt)("p",null,"\uc704 \uc571(app.py)\uc744 \ubc30\ud3ec\ud558\ub294 Dockerfile\uc744 \uc791\uc131\ud55c\ub2e4."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-dockerfile"},'FROM python:alpine\n\nENV APP_HOME /app\nCOPY . $APP_HOME\nWORKDIR $APP_HOME\n\nRUN pip install Flask\n\nENTRYPOINT ["python"]\nCMD ["app.py"]\n')),(0,l.kt)("h2",{id:"knative-build"},"Knative Build"),(0,l.kt)("p",null,"\ubbf8\ub9ac Dockerhub\uc5d0\uc11c ",(0,l.kt)("inlineCode",{parentName:"p"},"hello-python")," repository(docker.io/ddiiwoong/hello-python)\ub97c \uc0dd\uc131\ud55c\ub2e4.",(0,l.kt)("br",{parentName:"p"}),"\n","\uadf8\ub9ac\uace0 \uc704\uc5d0\uc11c \uc0dd\uc131\ud55c ",(0,l.kt)("inlineCode",{parentName:"p"},"build-bot")," \uacc4\uc815\uacfc image tag ",(0,l.kt)("inlineCode",{parentName:"p"},"hello-python"),"\uc815\ubcf4\ub97c Build template\uc5d0 \uc791\uc131\ud558\uc5ec \ubc30\ud3ec\ud55c\ub2e4.",(0,l.kt)("br",{parentName:"p"}),"\n","\uc544\ub798 Knative Build \uacfc\uc815\uc740 ",(0,l.kt)("inlineCode",{parentName:"p"},"kaniko executor"),"\ub97c \uc0ac\uc6a9\ud558\uc5ec \ub2e4\uc74c\uacfc \uac19\uc740 \uacfc\uc815\uc744 \uc218\ud589\ud55c\ub2e4.  "),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"spec.source")," \uc5d0\uc11c Source Clone (git)\ub97c \uc218\ud589\ud558\uace0 \uc774\ud6c4  "),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("inlineCode",{parentName:"li"},"spec.steps")," \uc5d0\uc11c Docker Build, Tag, Registry Login, Push\ub97c \uc218\ud589\ud55c\ub2e4.  ")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: build.knative.dev/v1alpha1\nkind: Build\nmetadata:\n  name: python-build\nspec:\n  serviceAccountName: build-bot\n  source:\n    git:\n      url: https://github.com/ddiiwoong/hello-python.git\n      revision: master\n  steps:\n  - name: build-and-push\n    image: gcr.io/kaniko-project/executor:v0.1.0\n    args:\n    - --dockerfile=/workspace/Dockerfile\n    - --destination=docker.io/ddiiwoong/hello-python:latest\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"build"),"\ub97c \uc218\ud589\ud55c\ub2e4. "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ kubectl apply -f build.yaml\nbuild.build.knative.dev/python-build created\n\n$ kubectl get build\nNAME           SUCCEEDED   REASON    STARTTIME   COMPLETIONTIME\npython-build   True                  18m\n")),(0,l.kt)("p",null,"\uc815\uc0c1\uc801\uc73c\ub85c Build\uac00 \uc644\ub8cc\ub418\uba74 Dockerhub\uc5d0 \uc815\uc758\ud55c TAG(ddiiwoong/hello-python)\ub85c \uc774\ubbf8\uc9c0\uac00 \ub4f1\ub85d\ub41c\uac78 \ud655\uc778\ud560 \uc218 \uc788\ub2e4.  "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ docker pull ddiiwoong/hello-python\nUsing default tag: latest\nlatest: Pulling from ddiiwoong/hello-python\ne7c96db7181b: Pull complete\n799a5534f213: Pull complete\n913b50bbe755: Pull complete\n11154abc6081: Pull complete\nc805e63f69fe: Pull complete\n6eabcf0f7a50: Pull complete\n74101057f4ec: Pull complete\nDigest: sha256:51dc4a7ce38a5e7894adcfc00eaee6c5ea6aca1ef6c7521f9b7ea6382c013b9b\nStatus: Downloaded newer image for ddiiwoong/hello-python:latest\n")),(0,l.kt)("h2",{id:"knative-serving-\uc73c\ub85c-\ubc30\ud3ec"},"Knative Serving \uc73c\ub85c \ubc30\ud3ec"),(0,l.kt)("h4",{id:"serviceyaml"},"service.yaml"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: serving.knative.dev/v1alpha1\nkind: Service\nmetadata:\n  name: helloworld-python\n  namespace: default\nspec:\n  runLatest:\n    configuration:\n      revisionTemplate:\n        spec:\n          container:\n            image: ddiiwoong/hello-python:latest\n            env:\n            - name: TARGET\n              value: "Python Sample v1 with Knative on EKS"\n')),(0,l.kt)("p",null,"\ube4c\ub4dc\ub41c image (ddiiwoong/hello-python:latest)\ub85c Knative Service\ub97c \uc0dd\uc131\ud55c\ub2e4.  "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ kubectl apply -f service.yaml\nservice.serving.knative.dev/helloworld-python created\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"istio-system")," Namespace\uc5d0 ",(0,l.kt)("inlineCode",{parentName:"p"},"istio-ingressgateway")," Service\ub97c \ud655\uc778\ud55c\ub2e4.  "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"kubectl get svc istio-ingressgateway --namespace istio-system\nNAME                   TYPE           CLUSTER-IP      EXTERNAL-IP                                                                    PORT(S)                                                                                                                   AGE\nistio-ingressgateway   LoadBalancer   10.100.208.80   a220723d475df11e980220a02e220b34-2021915778.ap-northeast-2.elb.amazonaws.com   80:31581/TCP,443:31490/TCP,31400:30367/TCP,15011:32495/TCP,8060:31418/TCP,853:30310/TCP,15030:32405/TCP,15031:31410/TCP   13h\n")),(0,l.kt)("p",null,"ALB: a220723d475df11e980220a02e220b34-2021915778.ap-northeast-2.elb.amazonaws.com  "),(0,l.kt)("p",null,"\uc704\uc640 \uac19\uc774 AWS LoadBalancer\ub85c \ubc30\ud3ec\uba74 ALB\uac00 \uc790\ub3d9\uc73c\ub85c \uc0dd\uc131\ub418\ubbc0\ub85c \ucd94\ud6c4 eksctl\ub85c \ud074\ub7ec\uc2a4\ud130\ub97c \uc0ad\uc81c\ud558\uae30 \uc804\uc5d0 \ubc18\ub4dc\uc2dc LoadBalancer \ud615\ud0dc\ub85c \ubc30\ud3ec\ub41c \uc11c\ube44\uc2a4\ub97c \uc0ad\uc81c\ud558\uace0 \uc9c4\ud589\ud574\uc57c \ud55c\ub2e4.  "),(0,l.kt)("p",null,"Knative Service\ub97c \ud655\uc778\ud55c\ub2e4. "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},"$ kubectl get ksvc\nNAME                DOMAIN                                  LATESTCREATED             LATESTREADY               READY     REASON\nhelloworld-python   helloworld-python.default.example.com   helloworld-python-4rw95   helloworld-python-4rw95   True\n")),(0,l.kt)("p",null,"\uc704\uc5d0\uc11c \uc5bb\uc740 \ub450\uac00\uc9c0 \uc815\ubcf4(LoadBalancer, Domain)\ub85c \uc0dd\uc131\ub41c app\uc744 \ud14c\uc2a4\ud2b8\ud55c\ub2e4.",(0,l.kt)("br",{parentName:"p"}),"\n","Knative\ub294 \ub0b4\ubd80\uc801\uc73c\ub85c example.com\uc774\ub77c\uace0 \ud558\ub294 \uae30\ubcf8 domain\uc744 \uc0ac\uc6a9\ud558\ubbc0\ub85c \ub0b4\ubd80\uc801\uc73c\ub85c\ub294 ",(0,l.kt)("inlineCode",{parentName:"p"},"helloworld-python.default.example.com"),"\uc73c\ub85c curl\uc744 \uc2e4\ud589\ud558\uac8c \ub41c\ub2e4.  "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh"},'$ curl -H "Host:helloworld-python.default.example.com" http://a220723d475df11e980220a02e220b34-2021915778.ap-northeast-2.elb.amazonaws.com\nHello World: Python Sample v1 with Knative on EKS!\n')),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Cold Start"),"(default timeout 5\ubd84) \ub54c\ubb38\uc5d0 \uc7a0\uc2dc \uc751\ub2f5\uc774 \ub2a6\uc5b4\uc9c8 \uc218\ub3c4 \uc788\uc9c0\ub9cc(2-5\ucd08) \uc7a0\uc2dc \uae30\ub2e4\ub9ac\uba74 \uc704\ucc98\ub7fc \uacb0\uacfc\ub97c \ud655\uc778\ud560 \uc218 \uc788\ub2e4.  "),(0,l.kt)("h2",{id:"\uc815\ub9ac"},"\uc815\ub9ac"),(0,l.kt)("p",null,"\uc704\uc5d0\uc11c\ub3c4 \uc7a0\uae50 \uc5b8\uae09\ud588\uc9c0\ub9cc Lambda\ub098 ECS, Batch \uc11c\ube44\uc2a4\uac00 \uc788\ub294\ub370 Knative on EKS \ub97c \uad6c\uc9c0 \uc65c \ud558\ub290\ub0d0\ub77c\uace0 \uad81\uae08\ud574\ud558\ub294 \ubd84\ub4e4\uc774 \uacc4\uc2e4\uc9c0\ub3c4 \ubaa8\ub978\ub2e4. \ud558\uc9c0\ub9cc \ub2e4\ub4e4 \uc544\ub798\uc640 \uac19\uc740 \uace0\ubbfc\uc744 \ud574\ubd24\uc744\uac70\ub77c \uc0dd\uac01\ud55c\ub2e4.  "),(0,l.kt)("p",null,"\ucee8\ud14c\uc774\ub108\uc640 Kubernetes\uac00 DevOps\ub3c4\uad6c\ub85c\uc11c\uc758 \ud45c\uc900\uc774 \ub418\uc5b4\uac00\ub294 \uc2dc\ub300\uc5d0 Lambda\ub97c \uc4f8\uc9c0 \uc624\ud508\uc18c\uc2a4\ub97c \uc4f8\uc9c0\uc5d0 \ub300\ud55c \uace0\ubbfc\uc740 \uacb0\uad6d \uc774\uc2dd\uc131\uacfc \ubca4\ub354 \uc885\uc18d\uc131\uc744 \uc81c\uac70\ud558\uace0 \uc6b4\uc601\ud6a8\uc728\ud654 \uce21\uba74\uc5d0\uc11c \uadf8 \ub2f5\uc744 \ucc3e\uc744\uc218 \uc788\uc744\uac83 \uac19\ub2e4.  "),(0,l.kt)("p",null,"\ud604\uc7ac \ubab8\ub2f4\uace0 \uc788\ub294 \ucd5c\uadfc \ud504\ub85c\uc81d\ud2b8\uc5d0\uc11c Lambda, ECS, Batch \ub4f1\uc744 \uc0ac\uc6a9\ud558\ub294 \uacbd\uc6b0\uac00 \ub9ce\uc544\uc84c\ub294\ub370 \uc2e4\uc81c \uc5d4\ud130\ud504\ub77c\uc774\uc988\uc5d0\uc11c \uc815\ud574\uc9c4 \uc790\uc6d0\ub0b4\uc5d0\uc11c \uc815\ud574\uc9c4 \uc77c\uc744 \ud560\ub54c\ub294 \ub9e4\ub2c8\uc9c0\ub4dc \uc11c\ube44\uc2a4\uac00 \uc801\ud569\ud558\ub2e4\uace0 \uc0dd\uac01\ud55c\ub2e4. \ud558\uc9c0\ub9cc On-Premise \ub610\ub294 \uadf8\uc5d0 \uc900\ud558\ub294 Kubernetes \ud074\ub7ec\uc2a4\ud130\ub97c \uc6b4\uc601\ud558\ub294 \uc870\uc9c1\uc5d0\uc11c\ub294 Knative\ub97c \uc0ac\uc6a9\ud558\uc5ec \ucee8\ud14c\uc774\ub108 \uae30\ubc18 \uc11c\ube44\ub9ac\uc2a4 \uc6cc\ud06c\ub85c\ub4dc\ub97c \uad6c\ud604\ud558\ub294 \uac83\uc774 \ud5a5\ud6c4 Hybrid \uad00\uc810\uc5d0\uc11c \ud655\uc7a5\uc131\uacfc \ubca4\ub354 \uc885\uc18d\uc131\uc744 \uc81c\uac70\ud558\ub294\ub370 \ud070 \ub3c4\uc6c0\uc774 \ub420\uac83\uc774\ub77c \uc0dd\uac01\ud55c\ub2e4.  "),(0,l.kt)("p",null,"\uc870\uae08\uc529 Kubernetes \ubc0f \uc0dd\ud0dc\uacc4 Learning\uc5d0 \ub300\ud55c \ud53c\ub85c\ub3c4\uac00 \uc99d\uac00\ud558\uace0 \uc788\uace0 Hype Driven Development(\uc124\ub808\ubc1c \uc8fc\ub3c4\uac1c\ubc1c)\uac00 \ub418\ub294\uac83 \uac19\uc544\uc11c \uc544\uc26c\uc6b4 \ubd80\ubd84\uc740 \uc788\uc9c0\ub9cc \ud604\uc7ac \uac00\uc7a5 \ud56b\ud55c \uae30\uc220\uc774\uace0 \uad00\uc2ec\ub3c4\uac00 \ub192\uae30 \ub54c\ubb38\uc5d0 \ubc30\uc6cc\ub450\uba74 \uc5b8\uc820\uac00\ub294 \uc368\uba39\uac8c \ub420\uac70\ub77c \ud655\uc2e0\ud55c\ub2e4.  "),(0,l.kt)("p",null,"\ub2e4\uc2dc\ud55c\ubc88 Conference driven development(architecture)\uac00 \ub418\uc9c0 \uc54a\ub3c4\ub85d \uc790\uc911\ud558\uace0 Loudest Guy\uac00 \ub418\uc9c0 \uc54a\ub3c4\ub85d \uc870\uc2ec\ud574\uc57c\ud560 \uac83 \uac19\ub2e4."))}m.isMDXComponent=!0}}]);