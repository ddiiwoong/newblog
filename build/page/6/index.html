<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Act as a catalyst RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Act as a catalyst Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="Act as a catalyst JSON Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-4ZT898XDT2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4ZT898XDT2"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-4ZT898XDT2",{anonymize_ip:!0})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Cloud Catalyst" href="/opensearch.xml">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4362752107119680" crossorigin="anonymous"></script><title data-rh="true">Cloud Catalyst | Cloud Catalyst</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ddii.dev/page/6/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="naver-site-verification" content="cbcc03783e5594725d3951f4e7f16ede80e69881"><meta data-rh="true" property="og:title" content="Cloud Catalyst | Cloud Catalyst"><meta data-rh="true" name="description" content="My little thought may as a catalyst in other engineer&#x27;s career"><meta data-rh="true" property="og:description" content="My little thought may as a catalyst in other engineer&#x27;s career"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ddii.dev/page/6/"><link data-rh="true" rel="alternate" href="https://ddii.dev/page/6/" hreflang="en"><link data-rh="true" rel="alternate" href="https://ddii.dev/page/6/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://UTLA0DRN66-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.1e7a31ee.css">
<link rel="preload" href="/assets/js/runtime~main.e513b537.js" as="script">
<link rel="preload" href="/assets/js/main.da01ed83.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_ObN2"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-catalyst.svg" alt="Cloud Catalyst" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo-catalyst.svg" alt="Cloud Catalyst" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Cloud Catalyst</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Posts</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" docid="introduction" href="/docs/prometheus/introduction/">Docs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/prometheus/introduction/">Prometheus</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/tags/">Tags</a><a class="navbar__item navbar__link" href="/presentation/">Presentation</a><a class="navbar__item navbar__link" href="/archive/">Archive</a><a class="navbar__item navbar__link" href="/about/">About</a><a class="navbar__item navbar__link" href="/pang4u/">Pang4u</a><a href="https://github.com/ddiiwoong/newblog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_a9qW thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_uKok margin-bottom--md">Recent Posts</div><ul class="sidebarItemList_Kvuv"><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kubernetes/k6-prometheus/">prometheus grafana 스택으로 k6 테스트 결과 확인하기</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kubernetes/kyverno/">kyverno를 활용한 Kubernetes 정책 엔진 적용</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kubernetes/argo-rollout-advanced/">Advanced Argo Rollout</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kubernetes/kops-cilium/">kOps with Cilium</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/kubernetes/kops-cloud9/">kOps with Cloud9</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/job/SRE/">SRE (Site Reliablity Engineering)</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2019-01-30T00:00:00.000Z" itemprop="datePublished">January 30, 2019</time> · <!-- -->13 min read</div></header><div class="markdown" itemprop="articleBody"><p>그동안 DevOps 담당자라고 부르짖던 사람들의 Role이 인프라 담당자인지 플랫폼 담당자인지 아니면 개발하는 운영자인지 헷갈릴때가 많았다.</p><p>갑자기 국내에서도 SRE 채용 공고가 많아지는것을 보면서 내 자신도 한번 정리를 하고 가야할것 같은 생각이 들었다.</p><p><a href="https://docs.microsoft.com/ko-kr/learn/modules/intro-to-site-reliability-engineering/" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/ko-kr/learn/modules/intro-to-site-reliability-engineering/</a></p><p>개념정리 측면에서 위 MS Azure의 온라인 교육내용을 정리해봤다.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="sre">SRE<a class="hash-link" href="#sre" title="Direct link to heading">​</a></h2><p>SRE(사이트 안정성 엔지니어링)란 조직이 해당 시스템, 서비스 및 제품에서 적절한 수준의 안정성을 달성하도록 지원하는 엔지니어링 분야이다. </p><p>출처 : <a href="https://landing.google.com/sre/sre-book/chapters/introduction/" target="_blank" rel="noopener noreferrer">https://landing.google.com/sre/sre-book/chapters/introduction/</a></p><p>기본적으로 운영경험이 있는 sysadmin, IT전문가, DevOps실행 담당자 등이 대상이 될 수 있다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="적절한-수준의-안정성">적절한 수준의 안정성<a class="hash-link" href="#적절한-수준의-안정성" title="Direct link to heading">​</a></h3><p>가장 핵심이 되는 단어는 <code>안정성</code>이다. 조직에서 만든 애플리케이션이 안정성이 부족하여 작동하지 않거나 불안정한 경우 실제 비즈니스에 피해를 줄 수 있다는건 누구나 알고 있는 당연한 이야기이지만 100%의 안정적인 시스템은 존재하지 않으므로 적절한 수준(정량적으로 측정하긴 어렵지만 이해관계자들이 납들할만한 수준)의 안정성을 달성하기 위한 일련의 작업들을 수행하는 것이 SRE의 기본 속성이라고 볼수 있다. </p><p>SRE는 Google에서 2003년부터 7명의 소프트웨어 엔지니어로 구성된 팀에서 시작된 이후 (자세한 내용은 위 링크 ebook 참조) Google 사내에 널리 확산되고 내부적인 문화로 조성되는 중에 밖에서는 DevOps라고 하는 문화가 동시에 확산되었다 한다. 결국 동일한 문제를 해결하기 위한 측면에서 두개의 방법론은 다르다고 봐야한다. </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="차이점">차이점<a class="hash-link" href="#차이점" title="Direct link to heading">​</a></h3><ul><li>SRE - 안정성을 위한 엔지니어링, DevOps - 개발과 운영조직 각각의 사일로를 해체하기 위한 문화적인 움직임</li><li>SRE - 저는 SRE 입니다, DevOps - 저는 DevOps를 하는 운영자 또는 개발자 입니다.</li><li>SRE - 규범으로 인식, DevOps - 문화로 인식</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="공통점">공통점<a class="hash-link" href="#공통점" title="Direct link to heading">​</a></h3><ul><li>모니터링/식별 가능, 자동화</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="주요-sre원칙--선순환">주요 SRE원칙 : 선순환<a class="hash-link" href="#주요-sre원칙--선순환" title="Direct link to heading">​</a></h2><p>새로운 서비스의 상태의 지표는 어떻게 정의할까? 보통은 무엇을 <code>SLI(서비스 수준 지표)</code>로 사용할지를 정하는것으로 본다. 일반적으로 성공 및 실패 측정값(200 OK,500 Error), 응답시간(ms), 처리량 등의 조합으로 결정될 수 있다. 보통  카나리아 분석을 통해 Scoring을 한 <code>SLI</code>를 200 OK와 500 또는 에러코드의 비율로 결정하는 방법을 사용하는 경우가 많다.</p><p>서비스 상태를 식별하는 지표를 정하고 나면 고객이나 우리가 원하는 안정성 수준을 결정해야 한다. 개발팀과 운영팀이 같이 만든 원하는 안전성 수준을 <code>SLO(서비스 수준 목표)</code>라고 말하면 된다. </p><p><code>SLO</code>는 Prometheus나 Datadog과 같은 모니터링 시스템을 활용하여 정확하게 측정하고 표시해야 한다. 서비스의 안정성에 대해서 명확하게 이해할수 있는 목표이기도 하다. 반드시 <code>SLO</code>를 만족하는지 못하는지 명확한 측정값으로 데이터가 존재해야 하고 <code>SLO</code>를 충족하지 못하면 문제가 있는것으로 판단하고 문제를 해결해야 한다. </p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="오류-예산">오류 예산<a class="hash-link" href="#오류-예산" title="Direct link to heading">​</a></h3><p>오류 예산이라는 말을 명확히 이해하려면 흔히 고객과 체결하는 계약서 상의 명시된 서비스 가동율(SLA)을 생각하면 될 것 같다. 보통 99.9% 의 <code>SLO</code>를 정한다고 한다면 1년에 8시간 45분 57초의 서비스 다운타임을 허용하는 것이다. 오류 예산은 서비스의 완벽한 안정성과 원하는 안정성의 차이(100%-99.9%=0.01%)를 말한다. 0.01%로 즉 8시간정도의 오류 예산을 가지는 것은 그 시간을 모두 사용할 때까지 추가 릴리스나 패치를 진행할 수 있다는 이야기와 같다. 어떤 팀은 해당 예산을 신규 기능을 릴리스하는데 사용하기도 하고 장애가 발생했을때 문제의 원인을 발견하고 개선하는데 사용하기도 한다. </p><p>일반적으로 서비스에 대한 오류 예산이 모두 사용되면 서비스가 원하는 안정성 수준으로 돌아갈때 까지 해당 서비스의 추가적인 릴리스를 보류하는게 일반적이긴 하지만 특정기간(월 또는 분기 또는 연간) 기준으로 계산되기 때문에 서비스 안정성이 정상 상태라면 오류 예산은 다시 주어지게 되므로 <code>선순환</code> 구조를 가진다고 볼 수 있다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="비난-없는-장애-회고">비난 없는 장애 회고<a class="hash-link" href="#비난-없는-장애-회고" title="Direct link to heading">​</a></h3><p>일반적으로 비즈니스에 크리티컬한 장애가 발생했을때 사후 분석(회고)을 하게 되는데 이때는 <code>비난 없는</code> 분석을 해야한다. 오래전 기억이지만 예전 직장 특정팀에서는 장애가 발생하면 유관자들이 모두 엔지니어 책상 뒤에 서서 모든 화살과 눈총을 주기 때문에 도저히 일을 할 수 없게 만든 경우가 많았었다. </p><p>특정 운영자의 작업 실수로 인해 장애가 발생했다 하더라도 해당 이벤트가 발생하게 된 프로세스나 기술기반에 실패 원인을 파악하는데 중점을 두어야 할것이다.</p><p>시스템의 안정성을 저하시키고 서비스를 중단시킨 작업(릴리스, 패치 등)을 사유로 개인에게 페널티를 주거나 고과에 반영하는 방법은 장애로 부터 교훈을 얻을수가 없고 해당 담당자의 충성도나 생산성 저하를 유발하는 안좋은 장치가 될 수 있다. 내 경험이기도 하지만 한동안 두려워서 아무 변경도 하지 못하는 경우가 종종 있었다. </p><p>회사나 조직, 팀은 시스템 중단으로부터 교훈을 얻고 지속적으로 시스템을 개선할수 있다. 적절한 분석을 통해 후속조치를 수행함으로써 실패를 수용하는 것이 SRE의 핵심 원칙이다. 이러한 내용을 모두에게 공유하고 타 조직이나 팀에게 인사이트를 제공하는 선순환 구조를 만드는것 또한 SRE의 기본 원칙이라고 볼 수 있다.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="주요-sre원칙--사람측면">주요 SRE원칙 : 사람측면<a class="hash-link" href="#주요-sre원칙--사람측면" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="toil수고스런-일-번거로운-작업">Toil(수고스런 일, 번거로운 작업)<a class="hash-link" href="#toil수고스런-일-번거로운-작업" title="Direct link to heading">​</a></h3><p>항상 SRE에서는 Toil에 초점을 맞춰야 한다. Toil은 사람이 수행하는 운영 작업 중 특정한 패턴이나 특성이 있는 작업을 말한다. 종종 반복적이고 자동화 될 수 있는 작업일지라도 대부분 수동작업으로 처리를 한다. 서비스의 규모가 커지거나 고객이 많아지게 되면 보통 우리가 이야기 하는 티켓(또는 SR)의 수가 많아지고 공수가 많이 필요하게 된다. </p><p>배포때마다 Config를 적용하거나 계정 등록, 볼륨이나 디스크 프로비저닝 등 수동으로 처리해야하는 모든 작업이 운영자에게는 부하로 다가올수 있다. 이러한 반복적인 작업을 티켓시스템을 통해 처리를 하게 되면 티켓 생성, 작업계획서 작성, 검토, 승인 단계를 그때 마다 해야하는 아주 번거로운 작업(Toil)을 해야한다.</p><p>SRE는 최대한 이러한 반복적이고 번거로운 작업을 제거하기 위해 노력해야하고 자동화와 Self-Service로 개발자가 편하게 직접 사용할수 있도록 환경을 제공해 주어야 한다. 이러한 요청이나 티켓을 자동으로 처리할 수 있으면 조금 더 생산적인 일을 수행할수 있다. </p><p>위에서 이야기한 적절한 안정성과 비슷한 맥락으로 생각하면 될 것 같다. 번거로운 작업을 없애는것이 다른 중요한 작업보다 우선순위가 떨어지기도 하지만 서비스 상에서 Toil을 제거하는것도 SRE의 주된 업무이다.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="운영작업의-비율">운영작업의 비율<a class="hash-link" href="#운영작업의-비율" title="Direct link to heading">​</a></h2><p>Toil을 제거하거나 서비스/시스템 안정성을 개선하기 위해 SRE는 장애를 해결하고 티켓을 처리하는 시간 비중을 50%를 넘겨서는 안된다. 티켓이 필요하지 않도록 개발자 Self-Service를 구성/제공하고 효율성을 증대시키기 위해서 IaC등(Shell, Ansible, Terraform)과 같이 자동화를 위한 코드를 만드는데에도 집중을 해야한다.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="정리">정리<a class="hash-link" href="#정리" title="Direct link to heading">​</a></h2><p>지금까지 SRE에 대해서 간단하게 소개하고 이해하는 측면에서 정리해 봤다. </p><p><a href="https://landing.google.com/sre/sre-book/chapters/part3/" target="_blank" rel="noopener noreferrer">Service Reliability Hierarchy</a></p><p><img loading="lazy" src="https://lh3.googleusercontent.com/3gX2qgys2I-9HnEIvXUA10ed3AILvg5MclnKWBquEkJKP3g5_kD6WR7Ptwp3TwAGla1DuSmHv64MdTtACNLlArFVq7BwbTrTVhigsA=s0" alt="hierarchy" class="img_E7b_"></p><p>그림과 같이 서비스 안정성 계층 구조에서는 기본적으로 모든 서비스를 모니터링 하는 시스템을 갖추어야 한다고 말한다. 모니터링 시스템이 준비가 되면 서비스에 대한 SLI, SLO를 만들고 모니터링 시스템에서 구현하는것이 첫번째 SRE를 적용하는 방법이라고 할 수 있을 것이다.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="참고-서적">참고 서적<a class="hash-link" href="#참고-서적" title="Direct link to heading">​</a></h2><ul><li><a href="http://shop.oreilly.com/product/0636920041528.do" target="_blank" rel="noopener noreferrer">Site Reliability Engineering: How Google Runs Production Systems(“The SRE Book”)</a></li><li><a href="http://landing.google.com/sre/workbook/toc/" target="_blank" rel="noopener noreferrer">The Site Reliability Workbook: Practical Ways to Implement SRE(“The SRE Workbook”)</a></li><li><a href="http://shop.oreilly.com/product/0636920063964.do" target="_blank" rel="noopener noreferrer">Seeking SRE: Conversations About Running Production Systems at Scale</a></li></ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/sre/">SRE</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/dev-ops/">DevOps</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/retrospective/newyear-plan/">2018 Retrospective</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2019-01-03T00:00:00.000Z" itemprop="datePublished">January 3, 2019</time> · <!-- -->6 min read</div></header><div class="markdown" itemprop="articleBody"><p>한해가 또 훅 가버렸다. 18년도 Retrospective 시작한다.</p><ul><li><p>Work</p><ul><li>17년까지 팀 막내였지만 새로운 부서로 이동하여 서비스개발 파트장을 맞게 되었음. 17년도에 개발이라고는 python를 사용하여 vmware vm을 openstack instance로 migration하는 프로젝트 및 kubernetes 기반 tensorflow 플랫폼을 개발하는 초보개발자 수준이였던 내가 인프라와 클라우드 플랫폼(openstack, vsphere, kubernetes) 경력이 인정되어 서비스 개발 파트를 맡게 되었다. 인생에서 가장 큰 변혁중 하나였다고 생각하고 항상 감사하는 마음으로 일을 하고 있다.  </li><li>CNCF OpenSource들을 활용하여 FaaS(Function as a Service), IaC(Infra as Code) 플랫폼 개발을 진행하였다. 서비스 기획 및 두개 프로젝트의 Scrum Master 역할을 수행하였고 메인 업무는 SRE역할로 Kubernetes 설계 구축, 클러스터 및 스토리지 관리, LB, 인증서 등 클라우드 인프라 자원관리 정도였던것 같다. </li></ul></li><li><p>Tech.</p><ul><li>Public Cloud : AWS, DigitalOcean, IBM Cloud, GCP, Azure, nCloud</li><li>Provisioning : Harbor, Ansible, Portus, Clair, Kubicorn, Terraform, Vault</li><li>Runtime : Rook, Minio, OpenEBS, Calico, REX-ray, WeaveNet, Cilium</li><li>Orchestration : Kubernetes, Envoy, etcd, gRPC, Kong, HAProxy, Istio, Kong, NGINX, Traefik</li><li>App : NATS, Helm, Kafka, Docker-compose, Draft, Gitlab, minikube, Operator, Jenkins, JenkisX, Packer, RabbitMQ, Spinnaker</li><li>Serverless : Dispatch, Fission, Knative, Nuclio, OpenWhisk, OpenFaas</li><li>Monitoring, Logging : Prometheus, Fluentd, Elastic, Grafana, influx, WeaveScope</li><li>기타 : Cert-Manager, Dex, Agones</li></ul></li><li><p>Speak
쓰다보니 사내외 발표를 10번을 넘게 한거 같다.</p><ul><li>4월 사내 Cloud Tech : 컨테이너 기반 SaaS 개발을 위한 고려사항</li><li>5월 사내 DT 솔루션 행사, 클라우드사업부 세션 : Advanced Cloud (Road to Serverless)</li><li>5월 사내 통신사업부문 Tech세션 : Road to Serverless (Functions as Applications)</li><li>6월 Open Infra Days Korea 2018 : <a href="https://www.slideshare.net/JinwoongKim8/provisioning-dedicated-game-server-on-kubernetes-cluster" target="_blank" rel="noopener noreferrer">Provisioning Dedicated Game Server on Kubernetes Cluster</a></li><li>8월 SK DNA 2018 : <a href="https://www.slideshare.net/JinwoongKim8/cloud-z-serverless-118143924" target="_blank" rel="noopener noreferrer">Cloud Z 의 오픈소스 서비스 소개 및 Serverless로 게임 개발하기</a></li><li>10월 DT Labs Meetup : <a href="https://www.slideshare.net/JinwoongKim8/continuous-delivery-with-spinnaker-on-k8skubernetes-cluster-118140930" target="_blank" rel="noopener noreferrer">Continuous Delivery with Spinnaker on K8s(kubernetes) Cluster</a></li><li>10월 NCsoft IO : <a href="https://www.slideshare.net/JinwoongKim8/cloud-native-serverless/JinwoongKim8/cloud-native-serverless" target="_blank" rel="noopener noreferrer">Cloud Native 오픈소스 서비스 소개 및 Serverless로 실제 게임 개발하기</a></li><li>11월 IBM Developer Day : <a href="http://public.dhe.ibm.com/software/kr/TrackB/B3.pdf" target="_blank" rel="noopener noreferrer">Continuous Delivery using Spinnaker on Kubernetes Multi Cluster</a></li><li>11월 &quot;Kubernetes Meetup&quot; 1Day : <a href="https://www.slideshare.net/JinwoongKim8/spinnaker-on-kubernetes-123752186" target="_blank" rel="noopener noreferrer">Spinnaker on Kubernetes</a></li></ul></li></ul><p>쓰고나서 보니 2018년도 회고라기 보다 거의 개발에 필요한 잡일(DevOps라고 두둔하면서)과 발표만 한거 같네...
19년도 부터는 다른업무를 하게 될거 같은데 초심을 잃지 말아야 하겠다.</p><p>최근 화두가 되었던 <code>노력중독</code> 이였던것 같은 18년은 털어버리고
내가 진짜로 좋아하고 하고 싶은 공부와 업무, 그리고 가족을 위해서 로드밸런싱 하면서 지내야 하겠다. </p><p>2006년에 쓴 미래의 내 모습과 어느정도 일치하는거 같지만 목표를 좀더 높이 잡아야할듯 하다.</p><p>번역에 참여하거나 책을 써본다던지 커뮤니티 활동을 좀더 적극적으로 해보고
회사에서 시키는 밋업이 아닌 자발적으로 참여하는 외부 강연이나 밋업을 위주로 해봐야겠다. </p><p>또한 점점 개발영역과 멀어지는거 같은 내모습이 나이가 들면서 더 심화될거 같아서 지인들과 별도의 개발 프로젝트를 진행해보려고 한다.</p><p>내 13년간 직장 생활중 가장 바쁘고 다이내믹하면서 바빴던 한해이자 많은 경험과 공부가 되었던 일년이였던것 같다.</p><p>나를 땡겨주셨던 <code>June</code>, 항상 분위기를 리드했던 <code>Joonbum</code>, 언제나 열정가득하고 최고의 DevOps 플레이어 <code>Jeongho</code>, 든든한 Backender <code>Donghun</code>, Excellent/Free/Kind(a.k.a EFK)한 <code>Minyoung</code>, 내가 인정하는 Frontier <code>Sanghun</code>, Best Rookie <code>Minsoo</code>, sorry because the hy <code>HyunSang</code>, Moontoring <code>Jinsoo</code>, Forever Mentor <code>Jaemoon</code>, Guru of CNI <code>Youngchae</code> 모두에게 감사의 말씀을 전하고 싶다. (무슨 수상소감도 아니고 ㅋㅋ)</p><p>19년에도 남들에게 존경을 받는 사람보다는 무슨일을 하든지 대중에게 욕먹지 않고 필요할때 도움을 요청을 할수 있는 그런 편한 사람이 되어야 겠다.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/retrospective/">Retrospective</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/2018/">2018</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/planning/">Planning</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/change/">Change</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/cloud/cloud/">Cloud Enginner</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2018-12-25T00:00:00.000Z" itemprop="datePublished">December 25, 2018</time> · <!-- -->5 min read</div></header><div class="markdown" itemprop="articleBody"><p>오늘은 쓸데없는 이야기를 주저리 적어본다. </p><p>페친한분이 말씀하신 구절이 떠오른다.
<code>&quot;엔지니어라고 해서 정치력이 필요없는것이 아니다. 오히려 혁신적인 기술은 정치력, 권력이 없으면 적용될 수 없다&quot;</code> - 제프리 페퍼교수의 &quot;권력의 기술&quot;</p><p>나이 40을 넘긴 엔지니어로서 나는 어떤 위치인가?</p><p>Cloud 관련 오픈소스로 비즈니스를 진행하면서 현 직장에서 2년을 보냈다.
보람도 있었고 실패도 있었다.<br>
<!-- -->올해는 기획한 오픈소스 기반 프로젝트로 여러사람의 힘을 합쳐서 서비스를 런칭하기도 하였지만 몇년간 글로벌 플레이어들을 보면서 느낀점은  </p><p>회사가 글로벌 플레이어가 되기위해 노력하는 방법은 다양하지만<br>
<!-- -->결국 이윤을 목적으로 회사에서 허용하고 투자하는것이고<br>
<!-- -->그걸로 돈을 못벌면 바로 쳐낼수 있다는 경영층의 생각은 변함이 없을것이다. </p><p>이런 마음가짐을 변화시키지 않는다면 훌륭한 프로젝트라도 성공이든 실패든 끝까지 가는것은 어렵다고 생각한다. </p><p>처음 클라우드 관련 업무를 시작할때를 생각해본다.</p><ul><li><p>2010년<br>
<!-- -->팀장: 너 클라우드 할래?<br>
<!-- -->나 : 무슨일하는데요?<br>
<!-- -->팀장: 가상화 프로젝트하는데 같이 한번 비즈니스 만들어보자, 너가 하고 싶은대로 기획하고 해봐~<br>
<!-- -->나 : 네^^ 열심히 하겠습니다.  </p></li><li><p><code>개인 성과 및 팀의 목표는 어느정도 달성하였으나 ROI 달성은 쉽지 않았음</code></p></li><li><p>2016년<br>
<!-- -->팀장: 너 주간보고 똑바로 안해?, 지난번 장애보고는 어떻게 된거야?<br>
<!-- -->나: ㅠㅠ<br>
<!-- -->팀장: 우리 팀 수치가 이게 뭐냐... 좀 잘좀 해봐<br>
<!-- -->나: ㅠㅠ<br>
</p></li><li><p><code>결국 퇴사</code></p></li><li><p>2017년<br>
<!-- -->팀장: 하고 싶은대로 해봐
나: 진짜요? 뚝딱뚝딱<br>
<!-- -->회사: 수익모델이 뭐지?<br>
<!-- -->나: ...  </p></li><li><p><code>출시하기도 전에 서비스 종료</code></p></li><li><p>2018년<br>
<!-- -->팀장: 하고 싶은거 해봐요. 대신 돈벌어와야해<br>
<!-- -->나: 진짜요? 뚝딱뚝딱<br>
<!-- -->회사: 흠 좀 부족하지만 앞으로 좀더 잘해주세요. 레퍼런스 확보에 힘써주세요.<br>
<!-- -->나: 서비스 기획자가 필요합니다.<br>
<!-- -->회사: ... 본인이 해야하는거 아닌가요?<br>
<!-- -->나: ...<br>
</p></li><li><p><code>기획을 해야하나 아직 기술력도 부족한데...</code>  </p></li></ul><p>벌써 직장생활 13년차에 마흔살이 넘어가고 있다. </p><p>엔지니어로 살아온날보다 살아가야할날이 적게 남았고 얼마 남지 않았다는 생각이 드는 우울한 하루다.
10년간 공부해왔던 것들보다 2년동안 공부한게 더 파격적이고 다양하고 복잡했다.</p><p>여러모로 아쉬운 한해였다...</p><p>앞으로 내가 부족한 부분을 기술력으로 메꿀것이냐? 협상과 정치력으로 메꿀것이냐?</p><p>잠이 안오는 12월이다.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/cloud/">Cloud</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/enginner/">Enginner</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/kubernetes/spinnaker-advanced-3/">Spinnaker on Kubernetes #3 (Kayenta)</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2018-12-04T00:00:00.000Z" itemprop="datePublished">December 4, 2018</time> · <!-- -->15 min read</div></header><div class="markdown" itemprop="articleBody"><p>3번째 포스팅이다.</p><p>11/23 &quot;Kubernetes Meetup&quot; 1Day에서 발표한 이야기 연장선으로 작성한다.</p><p>고객에게 오퍼링을 위해 준비한 내용과 Kubernetes monitoring과 연계한 내용에 대해서 적어보려고 한다.
최근 발표를 다니면서 많이 받는 질문이 실제 사용할만 한가?라는 질문과 어떻게 활용해야 하는지에 대한 질문들을 많이 받는다.
오늘 최근 Spinnaker Summit 2018에서 중요하게 다뤘던 Kayenta 프로젝트를 가지고 이야기 해보려고 한다. </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kayenta">Kayenta<a class="hash-link" href="#kayenta" title="Direct link to heading">​</a></h2><p>Kayenta는 자동 Canary 분석 오픈소스(Automated Canary Service(ACA))로 Spinnaker의 마이크로서비스중 하나로 동작한다.<br>
<!-- -->Automated Canary Deployments에 사용되고 자세한 내용은 <a href="https://www.spinnaker.io/guides/user/canary/stage/" target="_blank" rel="noopener noreferrer">canary documentation</a>을 확인하면 된다.  </p><p>새 종류의 하나인 Canary는 1차 세계대전중에 인간이 해를 입기 전에 독성가스를 탐지하는 용도로 사용되었다고 한다.
DevOps에서는 CD(Continuous Deployment) 프로세스의 일부로 사용되며 Canary 릴리즈는 새로운 버전의 Software를 Production에 배포하는 위험을 줄여주는 기술이라고 생각하면 된다.</p><p>Canary 신규 버전의 Software를 안정적인 기존 버전과 함께 배포하고 특정사용자나 일부 대상에게 트래픽 일부를 흘려 기존 사용자에게 영향을 최소하하고 새로운 버전의 문제를 신속하게 발견하고 이전의 안정된 버전으로 트래픽을 다시 라우팅시키는것이 주요 기능이라고 보면 된다.  </p><p>보통 품질 테스트 용도로 현재 운영 버전과 신규 버전의 주요한 지표(주로 Prometheus Metric)를 비교하여 평가를 진행하는데 이를 단위 테스트나 통합 테스트를 대체하여 사용해서는 절대 안된다.<br>
<!-- -->위에서 언급하였듯이 예기치 않은 위험을 최소화 하거나 문제를 신속하게 발견하는 것을 주 목적으로 하기 때문이다.</p><p>Spinnaker에서는 기본적으로 3가지 Cluster(Logical Application Group)를 사용한다.</p><ul><li>Production Cluster - 현재 실행중인 운영 버전으로 Replica는 임의로 변경할 수 있다. </li><li>Baseline Cluster - Production Cluster와 동일한 버전으로 실행됨</li><li>Canary Cluster - 변경된 신규 버전의 Software로 실행됨</li></ul><p>기본적으로 수동으로 진행할 경우에는 로그와 수집된 메트릭을 분석하고 객관적인 지표로 평가를 진행하는게 기본이다.
하지만 직접 사람이 하는 일이라 메트릭 데이터를 보다 보면 편견과 착오가 발생할 수 밖에 없다.</p><p>그래서 Netflix는 ACA(Automated Canary Service)라고 하는 자동화된 접근 방식을 통해 카나리 분석을 진행하고 있다.
수동으로 계산된 여러가지 지표를 가중치 기반으로 점수를 내리고 원하는 점수에 도달하면 배포하는 자동화된 방식이다.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="requirements">Requirements<a class="hash-link" href="#requirements" title="Direct link to heading">​</a></h2><ul><li>spinnaker cluster - 1.8+ (1.9.3 이상 추천)</li><li>halyard - 1.0+</li><li>kubernetes cluster - 1.9+</li><li>metric services - datadog, prometheus, stackdriver, signalfx</li><li>persistent storage - S3(or compatible S3), minio, GCS</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kayenta-service-추가하기">Kayenta Service 추가하기<a class="hash-link" href="#kayenta-service-추가하기" title="Direct link to heading">​</a></h2><p>이번 포스팅에서는 아래 환경으로 작성하였다.</p><ul><li>spinnaker cluster - 1.10.5</li><li>halyard - 1.11</li><li>kubernetes cluster - 1.9.7</li><li>metric services - prometheus</li><li>persistent storage - compatible S3(IBM Object Storage)</li></ul><p>일단 기존 halyard config를 백업하자. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ hal backup create</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+ Create backup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Success</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+ Successfully created a backup at location:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/Users/ddii/halbackup-Wed_Nov_28_13-35-31_KST_2018.tar</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>나중에 복구는 아래와 같이 하면 된다. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ hal backup restore --backup-path &lt;backup-name&gt;.tar</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>기존 halyard config를 살펴보면 아래와 같이 canary.enabled=false 로 되어있는 것을 확인 할수 있다.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">currentDeployment: default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deploymentConfigurations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- name: default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  canary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    enabled: false</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>canary analysis을 활성화 한다.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ hal config canary enable</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>그리고 default judgement algorithm은 <code>NetflixACAJudge-v1.0</code> 로 되어있다 다른 걸 이용하려면 다음과 같이 설정할수 있다. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ hal config canary edit --default-judge CUSTOM_JUDGE</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>메트릭 소스로 prometheus를 설정한다. 물론 기존에 사용중인 prometheus endpoint url이 필요하다.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">hal config canary prometheus enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hal config canary prometheus account add my-prometheus --base-url http://YOUR_PROMETHEUS_SERVER:PORT</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>여기서는 IBM Cloud Object Storage(S3 Compatible)을 사용하였지만 aws로 설정한다.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ hal config canary aws enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ hal config canary aws account add my-s3 --bucket spin-bucket --endpoint \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    s3.seo-ap-geo.objectstorage.service.networklayer.com --access-key-id ACCESS_ID \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --secret-access-key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ hal config canary aws edit --s3-enabled=true</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>여러개의 메트릭을 동시에 설정 및 수집이 가능하므로 그중 prometheus 및 관련 account를 기본으로 설정한다.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ hal config canary edit --default-metrics-store prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ hal config canary edit --default-metrics-account my-prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ hal config canary edit --default-storage-account my-s3</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>모든 spinnaker cluster가 준비된 상태의 컨피그는 아래와 같다. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">currentDeployment: default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deploymentConfigurations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- name: default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  canary:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    enabled: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    serviceIntegrations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: google</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      enabled: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      accounts: []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      gcsEnabled: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      stackdriverEnabled: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      enabled: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      accounts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: my-prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        endpoint:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          baseUrl: http://YOUR_PROMETHEUS_SERVER:PORT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        supportedTypes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - METRICS_STORE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: datadog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      enabled: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      accounts: []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: aws</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      enabled: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      accounts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: my-s3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bucket: spin-bucket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rootFolder: kayenta</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        endpoint: s3.seo-ap-geo.objectstorage.service.networklayer.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        accessKeyId: ACCESS_ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        secretAccessKey: ACCESS_KEY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        supportedTypes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - OBJECT_STORE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - CONFIGURATION_STORE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      s3Enabled: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    reduxLoggerEnabled: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    defaultMetricsAccount: my-prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    defaultStorageAccount: my-s3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    defaultJudge: NetflixACAJudge-v1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    defaultMetricsStore: prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stagesEnabled: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    templatesEnabled: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    showAllConfigsEnabled: true</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Spinnaker Cluster를 재배포하게 되면 아래와 같이 spin-kayenta deployments가 추가된 것을 확인할 수 있다.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ hal deploy apply</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                READY     STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spin-clouddriver-555cfc9765-kvnl8   1/1       Running   0          6d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spin-deck-85845b5b48-49ncm          1/1       Running   0          6d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spin-echo-5f9dd4d8ff-mvt7g          1/1       Running   0          6d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spin-fiat-5b945645d8-s2qcq          1/1       Running   0          6d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spin-front50-5c57fcf587-tqz28       1/1       Running   0          6d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spin-gate-57576b8c45-w5v6r          1/1       Running   0          6d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spin-kayenta-6dcd7767d6-rgb9w       1/1       Running   0          6d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spin-orca-788df6b9cc-tk6lk          1/1       Running   0          6d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spin-redis-6c87c456fc-6qbl2         1/1       Running   0          6d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spin-rosco-f6f845d49-btjnd          1/1       Running   0          6d</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>이후 Dashboard에 접속하고 application중 하나의 Config에 들어가면 Features에 Canary메뉴가 생긴것을 확인할 수 있다. 사용설정하고 캐싱하는데 시간이 다소 필요하고 Tasks 메뉴에서 해당 job에 대한 내용을 확인할수 있다. </p><p><img loading="lazy" alt="canary" src="/assets/images/canary_config-57ef01bd86dbbbe0b3463b2bb83c0243.png" width="1045" height="603" class="img_E7b_"></p><p>이후 application delivery 메뉴를 보면 pipelines, canary configs, canary reports라는 메뉴가 생기게 된다. </p><p><img loading="lazy" alt="delivery" src="/assets/images/delivery-eef9175b5a136e62f7cd72a689bcefde.png" width="766" height="169" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="simple-deploy-pipeline-추가">simple deploy pipeline 추가<a class="hash-link" href="#simple-deploy-pipeline-추가" title="Direct link to heading">​</a></h2><p><a href="https://cloud.google.com/solutions/automated-canary-analysis-kubernetes-engine-spinnaker" target="_blank" rel="noopener noreferrer">https://cloud.google.com/solutions/automated-canary-analysis-kubernetes-engine-spinnaker</a> 가이드 처럼 구성해봐도 되나 <code>stackdriver</code>를 써야하고 <code>prometheus metric</code>을 활용한 가이드가 필요해서 적어보고자 한다.</p><p>새로 파이프라인을 추가한 다음 </p><p><img loading="lazy" alt="newpipe" src="/assets/images/newpipe-d4e9f69e18fde50d33ae018234d68016.png" width="595" height="261" class="img_E7b_"></p><p>Pipeline Actions - Edit Pipeline JSON 에서
<a href="https://raw.githubusercontent.com/ddiiwoong/canary-demo-spinnaker/master/simple-deploy.json" target="_blank" rel="noopener noreferrer">https://raw.githubusercontent.com/ddiiwoong/canary-demo-spinnaker/master/simple-deploy.json</a> 을 추가해준다.  </p><p>해당 json pipeline을 추가하고 나면 다음과 같은 화면을 확인할수 있다.
<img loading="lazy" alt="pipe1" src="/assets/images/samplepipe1-fb6117126a3a4c5b9d9f314a19f0aad9.png" width="1151" height="1314" class="img_E7b_">
<img loading="lazy" alt="pipe2" src="/assets/images/samplepipe2-8387265c6cb69906e7cb8adc4c304432.png" width="1058" height="871" class="img_E7b_"></p><p>반드시 Deploy Config, Deploy Stage에서 배포할 Account 지정을 해야한다. </p><p><code>sampleapp image - ddiiwoong/canary-demo-spinnaker:latest</code></p><p>해당 pipeline내의 sampleapp은 python flask 기반으로 구성되어 간단히 internal 500 error를 원하는 비율을 configmap 변수로 구현할 수 있다. <a href="https://github.com/prometheus/client_python#counter" target="_blank" rel="noopener noreferrer">prometheus python client</a>를 사용하여 Gauge, Counter, Metric 서버를 간단하게 구성을 해보았다. 그리고 코드내에서 500 error rate를 구한 이유는 18년 11월 기준 spinnaker kayenta 버전에서는 PromQL(rate,irate와 같은 함수) 지원이 되지 않는다. 개발중인 코드에 포함이 된것을 확인하였고 12월 kubecon때 정식 릴리즈에 포함될거라 생각한다. </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#!/usr/bin/env python</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from random import randrange</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from flask import Flask</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from prometheus_client import start_http_server, Gauge, Counter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app = Flask(&#x27;kayenta-tester&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c = Counter(&#x27;requests&#x27;, &#x27;Number of requests served, by http code&#x27;, [&#x27;http_code&#x27;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">g = Gauge(&#x27;rate_requests&#x27;, &#x27;Rate of success requests&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">responce_500 = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">responce_200 = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rate_responce = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&#x27;/&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def hello():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    global responce_500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    global responce_200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    global rate_responce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if randrange(1, 100) &gt; int(os.environ[&#x27;SUCCESS_RATE&#x27;]):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        c.labels(http_code=&#x27;500&#x27;).inc()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        responce_500 = responce_500 + 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rate_responce = responce_500 / (responce_500+responce_200) * 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        g.set(rate_responce)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return &quot;Internal Server Error\n&quot;, 500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        c.labels(http_code = &#x27;200&#x27;).inc()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        responce_200 = responce_200 + 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rate_responce = responce_500 / (responce_500+responce_200) * 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        g.set(rate_responce)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return &quot;Hello World!\n&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start_http_server(8000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.run(host = &#x27;0.0.0.0&#x27;, port = 8080)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>해당앱을 Start Manual Execuction을 통해 배포한다. Comfirm Execution창에서 SUCCESS_RATE를 원하는 값(예:70%)으로 선택하고 배포를 하고 나면 Infrastructure - Clusters 메뉴에서 해당 샘플앱을 확인할 수 있다. </p><p><img loading="lazy" alt="manaul deploy" src="/assets/images/manual-e2292b9d8cb972b8689b76e151c51dae.png" width="1199" height="389" class="img_E7b_">
<img loading="lazy" alt="success rate" src="/assets/images/successrate-85ead10953b6d655a150d6471669df12.png" width="1212" height="483" class="img_E7b_">
<img loading="lazy" alt="manaul deploy2" src="/assets/images/manual2-7342db27f311edd70cc2d1b07d7c8500.png" width="938" height="383" class="img_E7b_"></p><p>실제 해당 서비스를 접속해보면 위에 설정한 SUCCESS_RATE 비율로 200화면과 500에러를 확인할 수 있다. </p><p><img loading="lazy" alt="flaskweb" src="/assets/images/flaskweb-99e15d6c7aaf0a8305fd3fad53916d95.png" width="606" height="176" class="img_E7b_">
<img loading="lazy" alt="flaskweb2" src="/assets/images/flaskweb2-ca32501038173b934174ce58ecea90a5.png" width="614" height="162" class="img_E7b_"></p><p>해당 메트릭의 통계를 확인하기 위해 curl을 반복적으로 실행하는 injection container 를 실행한다.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl -n default run injector --image=alpine -- \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /bin/sh -c &quot;apk add --no-cache --yes curl; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    while true; do curl -sS --max-time 3 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    http://sampleapp:8080/; done&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>5분정도 후에 Prometheus로 접속하여 코드내 작성한 rate_requests 메트릭을 확인해본다.<br>
<!-- -->PromQL은 아래 쿼리를 실행하였다.  </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">rate_requests{app=&quot;sampleapp&quot;,version=&quot;prod&quot;}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>아래 그림과 같이 4개의 pod에서 70% 정도 200 OK, 30% 정도 500 Error가 발생하는 것을 확인할 수 있다. </p><p><img loading="lazy" alt="500rate" src="/assets/images/500rate-09760c0ab86a09095865edd35592cec8.png" width="1215" height="837" class="img_E7b_"></p><p>이 메트릭을 Spinnaker 에서 확인하기 위해 Canary Pipeline을 만들자.</p><p><a href="https://raw.githubusercontent.com/ddiiwoong/canary-demo-spinnaker/master/automated-canary.json" target="_blank" rel="noopener noreferrer">https://raw.githubusercontent.com/ddiiwoong/canary-demo-spinnaker/master/automated-canary.json</a>를 JSON으로 Pipeline을 생성한다. </p><p><img loading="lazy" alt="canary_auto" src="/assets/images/canary_auto-b1920304073dfe8192b4b35af39902ad.png" width="996" height="471" class="img_E7b_"></p><p>Stage별로 살펴 보기전에 </p><ul><li>Prerequisite<br>Canary Config 구성이 먼저 필요하다. Delivery - Canary Configs 메뉴에서 신규 컨피그를 작성한다. <ul><li>Configuration Name - <code>kayenta-test</code></li><li>Filter Templates 메뉴를 먼저 생성한다. Canary, Baseline구분을 위해 version 정보를 선택하였다. </li><li>Metrics - Add Metric 은 분석을 위한 Prometheus Metric을 설정하는 단계로 <code>error_rate</code>가 증가(increase)하면 Pipeline을 중단시키고 Metric은 앞에서 확인한 <code>rate_requests</code>를 지정한다. Filter Template은 위에서 지정한 version을 선택한다. <img loading="lazy" alt="metric config" src="/assets/images/metric_config-cf291dbd8899fdbbbc5c6ccad0f45988.png" width="894" height="663" class="img_E7b_"></li><li>SCORING - 어짜피 예제는 한가지 Metric분석으로 0점 아니면 100점으로 나올것이므로 Maginal 75, Pass 95를 설정한다.</li></ul></li></ul><ol><li>1st Stage<ul><li>Configuration - Pipeline 실행시 초기 입력값(0-100, 10단위)으로 설정가능한 successRate 라는 Parameter를 설정한다. </li></ul></li><li>2nd Stage<ul><li>Find Baseline - 위에서 작성한 기본 Deploy Pipeline이 선택되었는지와 확인한다.</li><li>Deploy Canary Config - 앞에서 선택한 새로운 Parameter(successRate)를 신규 배포할 Canary Pod ConfigMap으로 설정하는 단계이다.</li></ul></li><li>3rd Stage<ul><li>Deploy Canary - yaml manifest로 Canary 버전을 배포한다. Replicas는 1로 설정하였고 배포될 Account(K8s Cluster)를 지정한다. </li><li>Deploy Baseline - yaml manifest로 Baseline 버전을 배포한다. 위와 동일하게 Replicas는 1로 설정하였고 배포될 Account(K8s Cluster)를 지정한다. </li></ul></li><li>4th Stage<ul><li>Canary Analysis - 중요한 Canary 분석 단계로 아래와 같이 설정을 확인한다. Prerequisite에서 설정한 Config(<code>kayenta-test</code>)를 선택하고 짧은 분석을 위해 1분(60초) 간격으로 3번 수행을 하도록 한다.   Filter Template에서 지정한 version(<code>version=&quot;${scope}&quot;</code>) 분석을 위해 Baseline, Canary 설정을 하고 Location은 Namespaces로 생각하면 된다. <img loading="lazy" alt="aca config" src="/assets/images/aca_config-a0aaf5a5c7a7867a01913ee1d9cca704.png" width="720" height="947" class="img_E7b_"></li></ul></li><li>5th Stage<ul><li>Deploy to Production - Canary 분석이 통과하였을 경우 운영에 배포</li><li>Delete Canary, Delete Baseline - 성공이던 실패이던 Canary, Baseline 배포본을 삭제 </li></ul></li><li>6th Stage<ul><li>Successful deployment - Canary 분석이 통과하였을 경우 최종 완료 표기하는 단계</li></ul></li></ol><p>설정이 마무리가 되면 저장을 하고 Canary 분석에 들어간다.
최초에 <code>successRate</code>을 70으로 배포했다면 그 이하로 설정했을 경우에는 아래와 같이 Score 0점으로 배포가 실패하고 Pipeline이 종료된다.   </p><p><img loading="lazy" alt="fail" src="/assets/images/canary_fail-6eb5d2e8dc82e42f62b21d41acce9f6f.png" width="853" height="1001" class="img_E7b_">  </p><p>70 이상으로 설정하게 되면 Score 100점으로 정상 배포됨을 확인할 수 있다.</p><p><img loading="lazy" alt="success" src="/assets/images/canary_success-27d5394bff7c7d0c7e17dd2697c2d267.png" width="865" height="793" class="img_E7b_">  </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="정리">정리<a class="hash-link" href="#정리" title="Direct link to heading">​</a></h2><p>간단하게 Spinnaker 와 Prometheus Metric을 활용하여 Kayenta 기반 Canary 배포를 해봤다. 현재 Spinnaker 1.10에서 istio가 지원된다고 하니 다시 한번 확인하고 istio 기반 canary 배포와 함께 사용하는 방법을 더 연구해봐야 할 것 같다.  </p><p>올해 AWS re:invent 끝나고 작년보다 큰 현자타임이 왔다. 오픈소스로 먹고사는 사람들의 기분은 다 비슷할거 같다고 생각이 든다. 12월 11일 부터 Kubecon이 열린다고 하니 Kubernetes 관련한 새로운 프로젝트와 기능들에 집중해서 남들보다 한발 나아가야하지 않을까? 오픈소스로 먹고사시는 분들 다들 힘냈으면 좋겠다.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/ci-cd/">CI/CD</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/kubernetes/">Kubernetes</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/spinnaker/">Spinnaker</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/continuous-delivery/">Continuous Delivery</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/continuous-deployment/">Continuous Deployment</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/pipeline/">Pipeline</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/canary/">Canary</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/canary-analysis/">Canary analysis</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/kayenta/">Kayenta</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/automated-canary-service/">Automated Canary Service</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/kubernetes/spinnaker-advanced-2/">Spinnaker on Kubernetes #2</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2018-09-27T00:00:00.000Z" itemprop="datePublished">September 27, 2018</time> · <!-- -->8 min read</div></header><div class="markdown" itemprop="articleBody"><p>이전 포스팅 <a href="https://ddii.dev/kubernetes/spinnaker-advanced-1/" target="_blank" rel="noopener noreferrer">Spinnaker on Kubernetes #1</a>에서 검토할때는 많이 개념을 이해하기 어려웠던것 같지만 어느정도 시간이 지났고 또 몇일 후에 발표도 있어서 다른 이야기를 해보고자 한다.  </p><p>지난 포스팅에 대충 집고 넘어간 용어들에 대한 정리를 다시 하고 기본적인 사상들을 정리해보고자 한다. 허접한 플랫폼 엔지니어 생각이니 언제든 다른 의견을 환영하는 바이다. </p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="what-is-spinnaker-history">What is spinnaker? (+History)<a class="hash-link" href="#what-is-spinnaker-history" title="Direct link to heading">​</a></h2><p>최근 트렌드인 멀티 클라우드를 지향하는 오픈소스 플랫폼이다.<br>
<!-- -->2014년 Netflix의 Asgard로 시작되어 2015년에 오픈소스화 되었다.<br>
<!-- -->빠른 속도와 신뢰도있는 소프트웨어 릴리즈를 위해 만들어졌으며 대부분의 메이저 클라우드 프로바이더들을 지원한다.(AWS,GCP,Azure,openstack..)<br>
<!-- -->현재 Netflix, Google, MS, Veritas등이 Contribution을 하고 있다.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="왜-spinnaker를-써야하지">왜 Spinnaker를 써야하지?<a class="hash-link" href="#왜-spinnaker를-써야하지" title="Direct link to heading">​</a></h2><p>여러가지 이유가 있겠지만</p><ul><li>Multi-Cloud용 Continuous Delivery/Deployment Platform 으로 대체가 가능</li><li>다양한 pipeline 형태로 배포가 가능하고 Rollback이 쉬움</li><li>빠른 배포가 가능하고 여러번 배포가 용이함</li><li>유연한 pipeline management system을 가지고 있음</li><li>다양한 배포전략을 가진다(Blue-Green, Rolling Red/Black, Canary)</li><li>community 활동 활발 (github, slack) - 답은 잘 안해줌 ㅠㅠ</li><li>VM과 Container 동시에 통합관리 가능</li><li>CI통합 용이(Jenkins)</li><li>CLI를 통한 설치 및 관리(halyard)</li><li>VM, Helm Packaging 가능</li><li>RBAC 지원</li><li>Notification - Email, Slack, Hipchat등</li><li>Safe Deployment - Judgement (승인기능)</li><li>Chaos Monkey Built-in</li></ul><p>이정도면 무조건 써야하지 않을까?</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="jenkins-vs-spinnaker">Jenkins vs Spinnaker<a class="hash-link" href="#jenkins-vs-spinnaker" title="Direct link to heading">​</a></h2><table><thead><tr><th align="center">Jenkins</th><th align="center">Spinnaker</th></tr></thead><tbody><tr><td align="center">강력한 빌드서버</td><td align="center">클라우드 자원의 1차 연동</td></tr><tr><td align="center">완전한 deployment tool이 아님</td><td align="center">vm &amp; deployments 안에 빌드되어 있음</td></tr><tr><td align="center">스크립팅이 많이 필요함</td><td align="center">별도의 스크립팅이 많이 필요없음</td></tr><tr><td align="center">기능들이 모두 플러그인 형태</td><td align="center">CI tool이 아님(CI tools이 백엔드로)</td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="kubernetes-vs-spinnaker">Kubernetes vs Spinnaker<a class="hash-link" href="#kubernetes-vs-spinnaker" title="Direct link to heading">​</a></h2><table><thead><tr><th align="center">Kubernetes</th><th align="center">Spinnaker</th></tr></thead><tbody><tr><td align="center">리소스 사용 제한</td><td align="center">정의한 퍼센트로 rollout</td></tr><tr><td align="center">slow rollout</td><td align="center">각 단계별 검증 가능</td></tr><tr><td align="center">High rollback cost</td><td align="center">Fast rollbacks</td></tr><tr><td align="center">Linear rollouts</td><td align="center">resource 사용량이 큼</td></tr><tr><td align="center">검증단계가 없음</td><td align="center"></td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="deploy-pipeline">Deploy Pipeline<a class="hash-link" href="#deploy-pipeline" title="Direct link to heading">​</a></h2><p>Spinnaker를 사용할때 기본적으로 아래와 같은 파이프라인으로 구성한다.<br>
<!-- -->수동으로 UI나 API로 트리거링할수 있고, 자동으로 Jenkins 등과 트리거 연동하여 빌드완료시 배포되도록 할수 있다.</p><p><img loading="lazy" alt="spinnaker-pipeline" src="/assets/images/spinnaker-pipeline-7b27fbf5bddf6d0c506c5f20a8a9f36a.png" width="942" height="399" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="deployment-strategies">Deployment Strategies<a class="hash-link" href="#deployment-strategies" title="Direct link to heading">​</a></h2><p>Spinnaker에서의 배포전략은 다음과 같이 제공된다.</p><p><img loading="lazy" src="https://www.spinnaker.io/concepts/deployment-strategies.png" alt="deployment-strategies" class="img_E7b_"></p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="red--black-same-as-blue--green">Red / Black (same as Blue / Green)<a class="hash-link" href="#red--black-same-as-blue--green" title="Direct link to heading">​</a></h3><ul><li>동일한 양의 instance로 이루어진 새로운 Server Group을 생성한다</li><li>신규 Server Group이 정상상태가 되면 LB는 신규 Server Group에 트래픽을 분산한다. </li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="rolling-redblack">Rolling red/black<a class="hash-link" href="#rolling-redblack" title="Direct link to heading">​</a></h3><ul><li>이전과 동일하지만 인스턴스별 또는 그룹별로 rolling</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="canary">Canary<a class="hash-link" href="#canary" title="Direct link to heading">​</a></h3><ul><li>가장 작은 개수의 인스턴스를 교체시키고</li><li>새로운 버전으로 트래픽을 분산시킨다 (1~5프로)</li><li>새로운 버전에 이슈가 없을때까지 테스트를 진행하고</li><li>특정시간까지 이슈가 없으면 배포를 늘려간다. </li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="용어정리-2탄">용어정리 2탄<a class="hash-link" href="#용어정리-2탄" title="Direct link to heading">​</a></h2><p>이전 <a href="https://ddiiwoong.github.io/2018/spinnaker-advanced-1/" target="_blank" rel="noopener noreferrer">post</a>에서 정리한걸 다시 복기하고 추가적인 내용을들 적어봤다.</p><p>사용하면서 혼돈이 많이 생기는 부분이다 이게 GCE나 EC2를 쓰면 용어 매칭이 쉬운데 k8s를 위한 별도의 메뉴가 아닌 기능을 통합하다보니 용어가 조금 혼동스럽게 구성이 되었다.<br>
<!-- -->특히 Load Balancer 부분은 Service로 매핑되고 퍼블릭 k8s에서 제공하는 Type LoadBalancer는 미지원한다.<br>
<!-- -->그리고 모든 Resource들은 Deploy, Delete, Scale, Rollout(Undo, Pause, Resume)을 지원하며 Versioning이 지원된다.  Versioning은 <a href="https://www.spinnaker.io/reference/providers/kubernetes-v2/#strategy" target="_blank" rel="noopener noreferrer">여기</a>에 설명된 대로 <code>strategy.spinnaker.io/versioned</code> annotation을 통해 manifest별로 재정의가 가능하다.</p><table><thead><tr><th align="center">Spinnaker</th><th align="center">Kubernetes</th><th align="center">비고</th></tr></thead><tbody><tr><td align="center">Server Group</td><td align="center"><a href="https://www.spinnaker.io/reference/providers/kubernetes-v2/#workloads" target="_blank" rel="noopener noreferrer">Workloads</a></td><td align="center"><a href="https://www.spinnaker.io/guides/developer/crd-extensions/" target="_blank" rel="noopener noreferrer">CRD의 경우 별도 Build</a></td></tr><tr><td align="center">Clusters</td><td align="center">Logical Server Group</td><td align="center"></td></tr><tr><td align="center">Load Balancer</td><td align="center">Services</td><td align="center">LoadBalancer(k8s) 미지원</td></tr><tr><td align="center">Firewall</td><td align="center">NetworkPolicies</td><td align="center"></td></tr></tbody></table><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="application-management">Application Management<a class="hash-link" href="#application-management" title="Direct link to heading">​</a></h3><p>Spinnaker에서 Application 이란 배포하려는 서비스를 나타내는 구조라 생각하면 된다.  </p><ul><li>pipeline</li><li>Clusters, Server Group의 집합이며, firewall과 loadbalancer를 포함한다.</li><li>Canary Config</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="cluster">Cluster<a class="hash-link" href="#cluster" title="Direct link to heading">​</a></h3><p>Kubernetes의 Cluster가 아니라 Spinnaker에서 Server Group의 논리적인 그룹</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="server-group">Server Group<a class="hash-link" href="#server-group" title="Direct link to heading">​</a></h3><p>기본자원인 서버그룹은 배포할수 있는 artifacts(vm image, docker image, source)와 인스턴스(pod) 수, Auto-Scaling, metadata 등 기본 구성등을 가지고 있다.<br>
<!-- -->서버그룹은 LoadBalacer나 Firewall 도 선택적으로 연결되고, vm이나 pod 형태로 배포된 application의 집합체라 볼수 있다.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="cloud-provider">Cloud Provider<a class="hash-link" href="#cloud-provider" title="Direct link to heading">​</a></h3><ul><li>IaaS - AWS, GCP, Azure, Oracle, Openstack</li><li>PaaS -  Google App Engine</li><li>Orchestrator - K8s, DC/OS</li><li>Docker v2 Registry</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="account">Account<a class="hash-link" href="#account" title="Direct link to heading">​</a></h3><p>Cloud Provider에 인증하기 위한 Spinnaker에서만 사용하는 Account Name</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="pipeline">Pipeline<a class="hash-link" href="#pipeline" title="Direct link to heading">​</a></h3><p>Pipeline은 주요 배포 관리도구로 사용된다.
Stage라고하는 일련의 Action으로 구성되며 파이프라인을 따라 Stage간 매개변수 전달이 가능하다.<br>
<!-- -->수동으로 시작하거나, Jenkins 작업완료, Docker Registry 신규 Docker 이미지, Cron일정 또는 다른 Stage와 같은 이벤트에 의해 자동으로 트리거링되도록 구성할수 있다.<br>
<!-- -->Pipeline 실행중에(시작/완료/실패) mail, slack, hipchat(사라짐)을 통해 Alert가 가능하다.</p><p><img loading="lazy" src="https://www.spinnaker.io/concepts/pipelines.png" alt="pipeline" class="img_E7b_"></p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="stage-atomic-building-block">Stage (atomic building block)<a class="hash-link" href="#stage-atomic-building-block" title="Direct link to heading">​</a></h3><p>Pipeline이 수행할 동작을 말한다.<br>
<!-- -->Deploy, Resize, Disable, Manual Judgement 등을 수행할수 있다.</p><p><img loading="lazy" src="https://www.spinnaker.io/concepts/pipelines/pipeline-tasks.png" alt="stage" class="img_E7b_"></p><ul><li>Stage - Multiple steps</li><li>Step - 진행되기전에 교정/폴링이 필요한 tasks</li><li>Task - 특정 Cloud Platform으로 동시에 여러 API호출</li><li>Operation - 단위 API</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="정리">정리<a class="hash-link" href="#정리" title="Direct link to heading">​</a></h2><p>용어나 개념은 어느정도 정리된듯 하고 다음 포스팅에서는 실제 multi cluster 환경에서 deploy하고 pipeline을 사용하는 내용을 적어볼 예정이다.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/ci-cd/">CI/CD</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/kubernetes/">Kubernetes</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/spinnaker/">Spinnaker</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/continuous-delivery/">Continuous Delivery</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/continuous-deployment/">Continuous Deployment</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/pipeline/">Pipeline</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/page/5/"><div class="pagination-nav__label">Newer Entries</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/page/7/"><div class="pagination-nav__label">Older Entries</div></a></div></nav></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">Home</a></li><li class="footer__item"><a class="footer__link-item" href="/archive/">Archive</a></li><li class="footer__item"><a class="footer__link-item" href="/tags/">Tags</a></li></ul></div><div class="col footer__col"><div class="footer__title">Sponsors</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/pang4u/">Pang4U</a></li><li class="footer__item"><a href="https://ko-fi.com/ddiiwoong" target="_blank" rel="noopener noreferrer" class="footer__link-item">Buy Me a Coffee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/ddiiwoong" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/ddiiwoong" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/ddiiwoong" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://kr.linkedin.com/in/ddiiwoong" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
<script src="/assets/js/runtime~main.e513b537.js"></script>
<script src="/assets/js/main.da01ed83.js"></script>
</body>
</html>